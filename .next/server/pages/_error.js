/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/_error";
exports.ids = ["pages/_error"];
exports.modules = {

/***/ "./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F_error&preferredRegion=&absolutePagePath=private-next-pages%2F_error&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F_error&preferredRegion=&absolutePagePath=private-next-pages%2F_error&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getServerSideProps: () => (/* binding */ getServerSideProps),\n/* harmony export */   getStaticPaths: () => (/* binding */ getStaticPaths),\n/* harmony export */   getStaticProps: () => (/* binding */ getStaticProps),\n/* harmony export */   reportWebVitals: () => (/* binding */ reportWebVitals),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   unstable_getServerProps: () => (/* binding */ unstable_getServerProps),\n/* harmony export */   unstable_getServerSideProps: () => (/* binding */ unstable_getServerSideProps),\n/* harmony export */   unstable_getStaticParams: () => (/* binding */ unstable_getStaticParams),\n/* harmony export */   unstable_getStaticPaths: () => (/* binding */ unstable_getStaticPaths),\n/* harmony export */   unstable_getStaticProps: () => (/* binding */ unstable_getStaticProps)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages/module.compiled */ \"./node_modules/next/dist/server/future/route-modules/pages/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var private_next_pages_document__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! private-next-pages/_document */ \"./src/pages/_document.tsx\");\n/* harmony import */ var private_next_pages_app__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! private-next-pages/_app */ \"./src/pages/_app.tsx\");\n/* harmony import */ var private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! private-next-pages/_error */ \"./node_modules/next/dist/pages/_error.js\");\n/* harmony import */ var private_next_pages_error__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([private_next_pages_document__WEBPACK_IMPORTED_MODULE_3__, private_next_pages_app__WEBPACK_IMPORTED_MODULE_4__]);\n([private_next_pages_document__WEBPACK_IMPORTED_MODULE_3__, private_next_pages_app__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n// Import the app and document modules.\n\n\n// Import the userland code.\n\n// Re-export the component (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"default\"));\n// Re-export methods.\nconst getStaticProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"getStaticProps\");\nconst getStaticPaths = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"getStaticPaths\");\nconst getServerSideProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"getServerSideProps\");\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"config\");\nconst reportWebVitals = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"reportWebVitals\");\n// Re-export legacy methods.\nconst unstable_getStaticProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"unstable_getStaticProps\");\nconst unstable_getStaticPaths = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"unstable_getStaticPaths\");\nconst unstable_getStaticParams = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"unstable_getStaticParams\");\nconst unstable_getServerProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"unstable_getServerProps\");\nconst unstable_getServerSideProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__, \"unstable_getServerSideProps\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES,\n        page: \"/_error\",\n        pathname: \"/_error\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    components: {\n        App: private_next_pages_app__WEBPACK_IMPORTED_MODULE_4__[\"default\"],\n        Document: private_next_pages_document__WEBPACK_IMPORTED_MODULE_3__[\"default\"]\n    },\n    userland: private_next_pages_error__WEBPACK_IMPORTED_MODULE_5__\n});\n\n//# sourceMappingURL=pages.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTJnBhZ2U9JTJGX2Vycm9yJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD1wcml2YXRlLW5leHQtcGFnZXMlMkZfZXJyb3ImYWJzb2x1dGVBcHBQYXRoPXByaXZhdGUtbmV4dC1wYWdlcyUyRl9hcHAmYWJzb2x1dGVEb2N1bWVudFBhdGg9cHJpdmF0ZS1uZXh0LXBhZ2VzJTJGX2RvY3VtZW50Jm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUErRjtBQUNoQztBQUNMO0FBQzFEO0FBQ29EO0FBQ1Y7QUFDMUM7QUFDc0Q7QUFDdEQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHFEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLHVCQUF1Qix3RUFBSyxDQUFDLHFEQUFRO0FBQ3JDLHVCQUF1Qix3RUFBSyxDQUFDLHFEQUFRO0FBQ3JDLDJCQUEyQix3RUFBSyxDQUFDLHFEQUFRO0FBQ3pDLGVBQWUsd0VBQUssQ0FBQyxxREFBUTtBQUM3Qix3QkFBd0Isd0VBQUssQ0FBQyxxREFBUTtBQUM3QztBQUNPLGdDQUFnQyx3RUFBSyxDQUFDLHFEQUFRO0FBQzlDLGdDQUFnQyx3RUFBSyxDQUFDLHFEQUFRO0FBQzlDLGlDQUFpQyx3RUFBSyxDQUFDLHFEQUFRO0FBQy9DLGdDQUFnQyx3RUFBSyxDQUFDLHFEQUFRO0FBQzlDLG9DQUFvQyx3RUFBSyxDQUFDLHFEQUFRO0FBQ3pEO0FBQ08sd0JBQXdCLHlHQUFnQjtBQUMvQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLFdBQVc7QUFDWCxnQkFBZ0I7QUFDaEIsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELGlDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhaW5pbmctcGxhdGZvcm0vPzQwMGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSBhcHAgYW5kIGRvY3VtZW50IG1vZHVsZXMuXG5pbXBvcnQgRG9jdW1lbnQgZnJvbSBcInByaXZhdGUtbmV4dC1wYWdlcy9fZG9jdW1lbnRcIjtcbmltcG9ydCBBcHAgZnJvbSBcInByaXZhdGUtbmV4dC1wYWdlcy9fYXBwXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwicHJpdmF0ZS1uZXh0LXBhZ2VzL19lcnJvclwiO1xuLy8gUmUtZXhwb3J0IHRoZSBjb21wb25lbnQgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBtZXRob2RzLlxuZXhwb3J0IGNvbnN0IGdldFN0YXRpY1Byb3BzID0gaG9pc3QodXNlcmxhbmQsIFwiZ2V0U3RhdGljUHJvcHNcIik7XG5leHBvcnQgY29uc3QgZ2V0U3RhdGljUGF0aHMgPSBob2lzdCh1c2VybGFuZCwgXCJnZXRTdGF0aWNQYXRoc1wiKTtcbmV4cG9ydCBjb25zdCBnZXRTZXJ2ZXJTaWRlUHJvcHMgPSBob2lzdCh1c2VybGFuZCwgXCJnZXRTZXJ2ZXJTaWRlUHJvcHNcIik7XG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuZXhwb3J0IGNvbnN0IHJlcG9ydFdlYlZpdGFscyA9IGhvaXN0KHVzZXJsYW5kLCBcInJlcG9ydFdlYlZpdGFsc1wiKTtcbi8vIFJlLWV4cG9ydCBsZWdhY3kgbWV0aG9kcy5cbmV4cG9ydCBjb25zdCB1bnN0YWJsZV9nZXRTdGF0aWNQcm9wcyA9IGhvaXN0KHVzZXJsYW5kLCBcInVuc3RhYmxlX2dldFN0YXRpY1Byb3BzXCIpO1xuZXhwb3J0IGNvbnN0IHVuc3RhYmxlX2dldFN0YXRpY1BhdGhzID0gaG9pc3QodXNlcmxhbmQsIFwidW5zdGFibGVfZ2V0U3RhdGljUGF0aHNcIik7XG5leHBvcnQgY29uc3QgdW5zdGFibGVfZ2V0U3RhdGljUGFyYW1zID0gaG9pc3QodXNlcmxhbmQsIFwidW5zdGFibGVfZ2V0U3RhdGljUGFyYW1zXCIpO1xuZXhwb3J0IGNvbnN0IHVuc3RhYmxlX2dldFNlcnZlclByb3BzID0gaG9pc3QodXNlcmxhbmQsIFwidW5zdGFibGVfZ2V0U2VydmVyUHJvcHNcIik7XG5leHBvcnQgY29uc3QgdW5zdGFibGVfZ2V0U2VydmVyU2lkZVByb3BzID0gaG9pc3QodXNlcmxhbmQsIFwidW5zdGFibGVfZ2V0U2VydmVyU2lkZVByb3BzXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVMsXG4gICAgICAgIHBhZ2U6IFwiL19lcnJvclwiLFxuICAgICAgICBwYXRobmFtZTogXCIvX2Vycm9yXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIGNvbXBvbmVudHM6IHtcbiAgICAgICAgQXBwLFxuICAgICAgICBEb2N1bWVudFxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F_error&preferredRegion=&absolutePagePath=private-next-pages%2F_error&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "./src/context/AuthContext.tsx":
/*!*************************************!*\
  !*** ./src/context/AuthContext.tsx ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthProvider: () => (/* binding */ AuthProvider),\n/* harmony export */   useAuth: () => (/* binding */ useAuth)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _services_firebase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/services/firebase */ \"./src/services/firebase.ts\");\n/* harmony import */ var firebase_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! firebase/auth */ \"firebase/auth\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_services_firebase__WEBPACK_IMPORTED_MODULE_2__, firebase_auth__WEBPACK_IMPORTED_MODULE_3__, firebase_firestore__WEBPACK_IMPORTED_MODULE_4__]);\n([_services_firebase__WEBPACK_IMPORTED_MODULE_2__, firebase_auth__WEBPACK_IMPORTED_MODULE_3__, firebase_firestore__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n// src/context/AuthContext.tsx\n\n\n\n\n\nconst initialAuthState = {\n    user: null,\n    loading: true,\n    error: null,\n    initialized: false\n};\nconst AuthContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)({\n    ...initialAuthState,\n    isAuthenticated: false,\n    login: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    loginWithGoogle: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    register: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    logout: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    resetPassword: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    confirmPasswordReset: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    updatePassword: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    updateProfile: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    deleteAccount: async ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    },\n    clearError: ()=>{\n        throw new Error(\"AuthContext not initialized\");\n    }\n});\nconst AuthProvider = ({ children })=>{\n    const [authState, setAuthState] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialAuthState);\n    // superAdmins is stable as it's a constant array defined here.\n    // If it were dynamic, it would need useMemo.\n    const superAdmins = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>[\n            \"egcharle@gmail.com\"\n        ], []);\n    const getUserProfile = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (firebaseUser)=>{\n        const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", firebaseUser.uid);\n        const userDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.getDoc)(userDocRef);\n        const isSuperAdmin = firebaseUser.email ? superAdmins.includes(firebaseUser.email) : false;\n        if (userDoc.exists()) {\n            return userDoc.data();\n        } else {\n            const newUserProfile = {\n                id: firebaseUser.uid,\n                email: firebaseUser.email || \"\",\n                displayName: firebaseUser.displayName || firebaseUser.email?.split(\"@\")[0] || \"User\",\n                photoURL: firebaseUser.photoURL || \"\",\n                roles: {\n                    admin: isSuperAdmin,\n                    instructor: false,\n                    student: true,\n                    manager: false\n                },\n                createdAt: new Date().toISOString(),\n                lastLoginAt: new Date().toISOString(),\n                uid: firebaseUser.uid,\n                country: \"\",\n                city: \"\",\n                departmentId: \"\"\n            };\n            try {\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.setDoc)(userDocRef, newUserProfile);\n                return newUserProfile;\n            } catch (profileError) {\n                console.error(\"Error setting new user profile:\", profileError);\n                return null; // Or handle error appropriately\n            }\n        }\n    }, [\n        superAdmins\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const unsubscribe = (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.onAuthStateChanged)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, async (firebaseUser)=>{\n            if (firebaseUser) {\n                // Optimistically set loading until profile is fetched/updated\n                setAuthState((prev)=>({\n                        ...prev,\n                        loading: true,\n                        error: null\n                    }));\n                try {\n                    const userProfile = await getUserProfile(firebaseUser);\n                    if (userProfile) {\n                        const isSuperAdminNow = firebaseUser.email ? superAdmins.includes(firebaseUser.email) : false;\n                        if (isSuperAdminNow && !userProfile.roles?.admin) {\n                            const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", firebaseUser.uid);\n                            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.updateDoc)(userDocRef, {\n                                \"roles.admin\": true,\n                                updatedAt: new Date().toISOString()\n                            });\n                            const updatedProfile = await getUserProfile(firebaseUser); // Re-fetch to get the absolute latest\n                            setAuthState({\n                                user: updatedProfile,\n                                loading: false,\n                                error: null,\n                                initialized: true\n                            });\n                        } else {\n                            // If lastLoginAt is old, update it\n                            const now = new Date();\n                            const lastLogin = userProfile.lastLoginAt ? new Date(userProfile.lastLoginAt) : new Date(0);\n                            // Update if last login was more than, say, 5 minutes ago, to avoid rapid updates on hot reloads\n                            if (now.getTime() - lastLogin.getTime() > 5 * 60 * 1000) {\n                                const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", firebaseUser.uid);\n                                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.updateDoc)(userDocRef, {\n                                    lastLoginAt: now.toISOString()\n                                });\n                                // Fetch again if you want the absolute latest, or merge optimistically\n                                const updatedProfileWithLogin = {\n                                    ...userProfile,\n                                    lastLoginAt: now.toISOString()\n                                };\n                                setAuthState({\n                                    user: updatedProfileWithLogin,\n                                    loading: false,\n                                    error: null,\n                                    initialized: true\n                                });\n                            } else {\n                                setAuthState({\n                                    user: userProfile,\n                                    loading: false,\n                                    error: null,\n                                    initialized: true\n                                });\n                            }\n                        }\n                    } else {\n                        setAuthState({\n                            user: null,\n                            loading: false,\n                            error: \"Failed to load user profile object.\",\n                            initialized: true\n                        });\n                    }\n                } catch (error) {\n                    console.error(\"AuthContext onAuthStateChanged error:\", error);\n                    setAuthState({\n                        user: null,\n                        loading: false,\n                        error: \"Failed to process user profile: \" + error.message,\n                        initialized: true\n                    });\n                }\n            } else {\n                setAuthState({\n                    user: null,\n                    loading: false,\n                    error: null,\n                    initialized: true\n                });\n            }\n        });\n        return ()=>unsubscribe();\n    }, [\n        getUserProfile,\n        superAdmins\n    ]); // getUserProfile depends on superAdmins\n    const loginWithGoogle = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async ()=>{\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            const provider = new firebase_auth__WEBPACK_IMPORTED_MODULE_3__.GoogleAuthProvider();\n            provider.addScope(\"https://www.googleapis.com/auth/userinfo.email\");\n            provider.addScope(\"https://www.googleapis.com/auth/userinfo.profile\");\n            const result = await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.signInWithPopup)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, provider);\n            const userProfile = await getUserProfile(result.user);\n            if (!userProfile) throw new Error(\"Failed to retrieve profile after Google sign-in.\");\n            const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", userProfile.id);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.updateDoc)(userDocRef, {\n                lastLoginAt: new Date().toISOString()\n            });\n            const updatedProfile = {\n                ...userProfile,\n                lastLoginAt: new Date().toISOString()\n            };\n            setAuthState({\n                user: updatedProfile,\n                loading: false,\n                error: null,\n                initialized: true\n            });\n            return updatedProfile;\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to login with Google\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: null,\n                    loading: false,\n                    error: errorMessage\n                }));\n            throw new Error(errorMessage);\n        }\n    }, [\n        getUserProfile\n    ]);\n    const login = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (credentials)=>{\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            const { email, password } = credentials;\n            const userCredential = await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.signInWithEmailAndPassword)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, email, password);\n            const userProfile = await getUserProfile(userCredential.user);\n            if (!userProfile) throw new Error(\"Failed to retrieve profile after email/password sign-in.\");\n            const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", userProfile.id);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.updateDoc)(userDocRef, {\n                lastLoginAt: new Date().toISOString()\n            });\n            const updatedProfile = {\n                ...userProfile,\n                lastLoginAt: new Date().toISOString()\n            };\n            setAuthState({\n                user: updatedProfile,\n                loading: false,\n                error: null,\n                initialized: true\n            });\n            return updatedProfile;\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to login\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: null,\n                    loading: false,\n                    error: errorMessage\n                }));\n            throw new Error(errorMessage);\n        }\n    }, [\n        getUserProfile\n    ]);\n    const register = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (credentials)=>{\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            const { email, password, displayName, firstName, lastName, company, jobTitle } = credentials;\n            const userCredential = await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.createUserWithEmailAndPassword)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, email, password);\n            const isSuperAdmin = superAdmins.includes(email);\n            const newUserProfile = {\n                id: userCredential.user.uid,\n                email,\n                displayName: displayName || email.split(\"@\")[0],\n                firstName,\n                lastName,\n                company,\n                jobTitle,\n                roles: {\n                    admin: isSuperAdmin,\n                    instructor: false,\n                    student: true,\n                    manager: false\n                },\n                createdAt: new Date().toISOString(),\n                lastLoginAt: new Date().toISOString(),\n                uid: userCredential.user.uid,\n                country: \"\",\n                city: \"\",\n                departmentId: \"\"\n            };\n            const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", newUserProfile.id);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.setDoc)(userDocRef, newUserProfile);\n            setAuthState({\n                user: newUserProfile,\n                loading: false,\n                error: null,\n                initialized: true\n            });\n            return newUserProfile;\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to register\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: null,\n                    loading: false,\n                    error: errorMessage\n                }));\n            throw new Error(errorMessage);\n        }\n    }, [\n        superAdmins\n    ]);\n    const logout = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async ()=>{\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.signOut)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth);\n            setAuthState({\n                user: null,\n                loading: false,\n                error: null,\n                initialized: true\n            });\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to logout\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: null,\n                    loading: false,\n                    error: errorMessage\n                })); // Ensure user is null on logout error too\n            throw new Error(errorMessage);\n        }\n    }, []);\n    const resetPassword = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (data)=>{\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.sendPasswordResetEmail)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, data.email);\n            setAuthState((prev)=>({\n                    ...prev,\n                    loading: false\n                }));\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to send password reset email\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    loading: false,\n                    error: errorMessage\n                }));\n            throw new Error(errorMessage);\n        }\n    }, []);\n    const confirmPasswordReset = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (code, newPassword)=>{\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.confirmPasswordReset)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, code, newPassword);\n            setAuthState((prev)=>({\n                    ...prev,\n                    loading: false\n                }));\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to confirm password reset\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    loading: false,\n                    error: errorMessage\n                }));\n            throw new Error(errorMessage);\n        }\n    }, []);\n    const updatePassword = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (data)=>{\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            const user = _services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser;\n            if (!user || !user.email) {\n                throw new Error(\"User not authenticated for password update.\");\n            }\n            const credential = firebase_auth__WEBPACK_IMPORTED_MODULE_3__.EmailAuthProvider.credential(user.email, data.currentPassword);\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.reauthenticateWithCredential)(user, credential);\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.updatePassword)(user, data.newPassword);\n            setAuthState((prev)=>({\n                    ...prev,\n                    loading: false\n                }));\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to update password\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    loading: false,\n                    error: errorMessage\n                }));\n            throw new Error(errorMessage);\n        }\n    }, []);\n    const updateProfile = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (data)=>{\n        const currentUser = authState.user;\n        if (!currentUser) {\n            const err = new Error(\"User not authenticated for profile update.\");\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: null,\n                    loading: false,\n                    error: err.message,\n                    initialized: true\n                }));\n            throw err;\n        }\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", currentUser.id);\n            // Prepare the data to be sent to Firestore.\n            // Only spread properties that are valid for UserProfile.\n            // 'data' itself is Partial<UserProfile>, so it's already type-checked.\n            const dataForFirestore = typeof data === \"object\" && data !== null ? data : {};\n            // Only update if there's actually data to update, otherwise skip Firestore call\n            if (Object.keys(dataForFirestore).length > 0) {\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.updateDoc)(userDocRef, dataForFirestore);\n            } else {\n            // console.warn(\"updateProfile called with empty data. No Firestore update performed.\");\n            }\n            // Create the updated user profile for the local state\n            const updatedUserProfile = {\n                ...currentUser,\n                ...dataForFirestore // Apply all changes from 'data'\n            };\n            setAuthState({\n                user: updatedUserProfile,\n                loading: false,\n                error: null,\n                initialized: true\n            });\n            return updatedUserProfile;\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to update profile\";\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: currentUser,\n                    loading: false,\n                    error: errorMessage\n                }));\n            throw new Error(errorMessage);\n        }\n    }, [\n        authState.user\n    ]);\n    const deleteAccount = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async ()=>{\n        // Get the current user from authState and Firebase auth *before* setting loading state\n        const currentUserProfile = authState.user; // UserProfile from Firestore\n        const currentFirebaseUser = _services_firebase__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser; // FirebaseUser from auth service\n        if (!currentFirebaseUser) {\n            const err = new Error(\"No Firebase user currently authenticated for account deletion.\");\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: null,\n                    loading: false,\n                    error: err.message,\n                    initialized: true\n                }));\n            throw err;\n        }\n        // currentUserProfile might be null if Firestore sync is off, but currentFirebaseUser is the source of truth for auth deletion\n        setAuthState((prev)=>({\n                ...prev,\n                loading: true,\n                error: null\n            }));\n        try {\n            // Use ID from Firestore profile if available, otherwise fallback to Firebase auth UID\n            // This is important if your Firestore 'id' field is the same as 'uid'\n            const userIdForFirestore = currentUserProfile?.id || currentFirebaseUser.uid;\n            const userDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", userIdForFirestore);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_4__.deleteDoc)(userDocRef); // Delete Firestore profile\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_3__.deleteUser)(currentFirebaseUser); // Delete Firebase auth user\n            setAuthState({\n                user: null,\n                loading: false,\n                error: null,\n                initialized: true\n            });\n        } catch (error) {\n            const errorMessage = error.message || \"Failed to delete account\";\n            // If deletion fails, the user might still be partially authenticated or their Firestore doc might still exist.\n            // Setting user to null is a safe default, but you might want more nuanced error handling.\n            setAuthState((prev)=>({\n                    ...prev,\n                    user: null,\n                    loading: false,\n                    error: errorMessage,\n                    initialized: true\n                }));\n            throw new Error(errorMessage);\n        }\n    }, [\n        authState.user\n    ]); // Dependency on authState.user because it might be used to get the Firestore doc ID.\n    // auth.currentUser is not a reactive dependency for useCallback.\n    const clearError = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(()=>{\n        setAuthState((prev)=>({\n                ...prev,\n                error: null\n            }));\n    }, []);\n    const contextValue = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>{\n        return {\n            user: authState.user,\n            loading: authState.loading,\n            error: authState.error,\n            initialized: authState.initialized,\n            isAuthenticated: !!authState.user,\n            login,\n            loginWithGoogle,\n            register,\n            logout,\n            resetPassword,\n            confirmPasswordReset,\n            updatePassword,\n            updateProfile,\n            deleteAccount,\n            clearError\n        };\n    }, [\n        authState,\n        login,\n        loginWithGoogle,\n        register,\n        logout,\n        resetPassword,\n        confirmPasswordReset,\n        updatePassword,\n        updateProfile,\n        deleteAccount,\n        clearError // Functions\n    ]);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AuthContext.Provider, {\n        value: contextValue,\n        children: children\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\context\\\\AuthContext.tsx\",\n        lineNumber: 376,\n        columnNumber: 5\n    }, undefined);\n};\nconst useAuth = ()=>{\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(AuthContext);\n    if (!context) {\n        throw new Error(\"useAuth must be used within an AuthProvider\");\n    }\n    return context;\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixPQUFPO1lBQ0x1QixNQUFNaUIsVUFBVWpCLElBQUk7WUFDcEJDLFNBQVNnQixVQUFVaEIsT0FBTztZQUMxQkMsT0FBT2UsVUFBVWYsS0FBSztZQUN0QkMsYUFBYWMsVUFBVWQsV0FBVztZQUNsQ0UsaUJBQWlCLENBQUMsQ0FBQ1ksVUFBVWpCLElBQUk7WUFDakNNO1lBQ0FFO1lBQ0FDO1lBQ0FDO1lBQ0FDO1lBQ0EzQjtZQUNBRTtZQUNBMEI7WUFDQUM7WUFDQUM7UUFDSjtJQUNGLEdBQUc7UUFDQ0c7UUFDQVg7UUFBT0U7UUFBaUJDO1FBQVVDO1FBQVFDO1FBQzFDM0I7UUFBc0JFO1FBQWdCMEI7UUFBZUM7UUFBZUMsV0FBVyxZQUFZO0tBQzVGO0lBRUQscUJBQ0UsOERBQUNWLFlBQVlrRixRQUFRO1FBQUNDLE9BQU9GO2tCQUMxQnJFOzs7Ozs7QUFHUCxFQUFFO0FBRUssTUFBTXdFLFVBQVU7SUFDckIsTUFBTUMsVUFBVXBILGlEQUFVQSxDQUFDK0I7SUFDM0IsSUFBSSxDQUFDcUYsU0FBUztRQUNaLE1BQU0sSUFBSWxGLE1BQU07SUFDcEI7SUFDRSxPQUFPa0Y7QUFDVCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhaW5pbmctcGxhdGZvcm0vLi9zcmMvY29udGV4dC9BdXRoQ29udGV4dC50c3g/NmVlNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvY29udGV4dC9BdXRoQ29udGV4dC50c3hcbmltcG9ydCBSZWFjdCwge2NyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZUNhbGxiYWNrLCB1c2VNZW1vIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgQXV0aENvbnRleHRUeXBlLFxuICBBdXRoUHJvdmlkZXJQcm9wcyxcbiAgQXV0aFN0YXRlLFxuICBMb2dpbkNyZWRlbnRpYWxzLFxuICBSZWdpc3RlckNyZWRlbnRpYWxzLFxuICBSZXNldFBhc3N3b3JkRGF0YSxcbiAgVXBkYXRlUGFzc3dvcmREYXRhXG59IGZyb20gJ0AvdHlwZXMvYXV0aC50eXBlcyc7XG5pbXBvcnQge1VzZXJQcm9maWxlIH0gZnJvbSAnQC90eXBlcy91c2VyLnR5cGVzJztcbmltcG9ydCB7YXV0aCwgZmlyZXN0b3JlIH0gZnJvbSAnQC9zZXJ2aWNlcy9maXJlYmFzZSc7XG5pbXBvcnQge1xuICBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQsXG4gIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkLFxuICBzaWduT3V0LFxuICBzZW5kUGFzc3dvcmRSZXNldEVtYWlsLFxuICBjb25maXJtUGFzc3dvcmRSZXNldCBhcyBmaXJlYmFzZUNvbmZpcm1QYXNzd29yZFJlc2V0LFxuICB1cGRhdGVQYXNzd29yZCBhcyBmaXJlYmFzZVVwZGF0ZVBhc3N3b3JkLFxuICBFbWFpbEF1dGhQcm92aWRlcixcbiAgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCxcbiAgZGVsZXRlVXNlcixcbiAgb25BdXRoU3RhdGVDaGFuZ2VkLFxuICBVc2VyIGFzIEZpcmViYXNlVXNlcixcbiAgR29vZ2xlQXV0aFByb3ZpZGVyLFxuICBzaWduSW5XaXRoUG9wdXBcbn0gZnJvbSAnZmlyZWJhc2UvYXV0aCc7XG5pbXBvcnQge2RvYywgZ2V0RG9jLCBzZXREb2MsIHVwZGF0ZURvYywgZGVsZXRlRG9jIH0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJztcblxuY29uc3QgaW5pdGlhbEF1dGhTdGF0ZTogQXV0aFN0YXRlID0ge1xuICB1c2VyOiBudWxsLFxuICBsb2FkaW5nOiB0cnVlLFxuICBlcnJvcjogbnVsbCxcbiAgaW5pdGlhbGl6ZWQ6IGZhbHNlLFxufTtcblxuY29uc3QgQXV0aENvbnRleHQgPSBjcmVhdGVDb250ZXh0PEF1dGhDb250ZXh0VHlwZT4oe1xuICAuLi5pbml0aWFsQXV0aFN0YXRlLFxuICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICBsb2dpbjogYXN5bmMgKCkgPT4ge3Rocm93IG5ldyBFcnJvcignQXV0aENvbnRleHQgbm90IGluaXRpYWxpemVkJyk7IH0sXG4gIGxvZ2luV2l0aEdvb2dsZTogYXN5bmMgKCkgPT4ge3Rocm93IG5ldyBFcnJvcignQXV0aENvbnRleHQgbm90IGluaXRpYWxpemVkJyk7IH0sXG4gIHJlZ2lzdGVyOiBhc3luYyAoKSA9PiB7dGhyb3cgbmV3IEVycm9yKCdBdXRoQ29udGV4dCBub3QgaW5pdGlhbGl6ZWQnKTsgfSxcbiAgbG9nb3V0OiBhc3luYyAoKSA9PiB7dGhyb3cgbmV3IEVycm9yKCdBdXRoQ29udGV4dCBub3QgaW5pdGlhbGl6ZWQnKTsgfSxcbiAgcmVzZXRQYXNzd29yZDogYXN5bmMgKCkgPT4ge3Rocm93IG5ldyBFcnJvcignQXV0aENvbnRleHQgbm90IGluaXRpYWxpemVkJyk7IH0sXG4gIGNvbmZpcm1QYXNzd29yZFJlc2V0OiBhc3luYyAoKSA9PiB7dGhyb3cgbmV3IEVycm9yKCdBdXRoQ29udGV4dCBub3QgaW5pdGlhbGl6ZWQnKTsgfSxcbiAgdXBkYXRlUGFzc3dvcmQ6IGFzeW5jICgpID0+IHt0aHJvdyBuZXcgRXJyb3IoJ0F1dGhDb250ZXh0IG5vdCBpbml0aWFsaXplZCcpOyB9LFxuICB1cGRhdGVQcm9maWxlOiBhc3luYyAoKSA9PiB7dGhyb3cgbmV3IEVycm9yKCdBdXRoQ29udGV4dCBub3QgaW5pdGlhbGl6ZWQnKTsgfSxcbiAgZGVsZXRlQWNjb3VudDogYXN5bmMgKCkgPT4ge3Rocm93IG5ldyBFcnJvcignQXV0aENvbnRleHQgbm90IGluaXRpYWxpemVkJyk7IH0sXG4gIGNsZWFyRXJyb3I6ICgpID0+IHt0aHJvdyBuZXcgRXJyb3IoJ0F1dGhDb250ZXh0IG5vdCBpbml0aWFsaXplZCcpOyB9LFxufSk7XG5cbmV4cG9ydCBjb25zdCBBdXRoUHJvdmlkZXI6IFJlYWN0LkZDPEF1dGhQcm92aWRlclByb3BzPiA9ICh7Y2hpbGRyZW4gfSkgPT4ge1xuICBjb25zdCBbYXV0aFN0YXRlLCBzZXRBdXRoU3RhdGVdID0gdXNlU3RhdGU8QXV0aFN0YXRlPihpbml0aWFsQXV0aFN0YXRlKTtcbiAgXG4gIC8vIHN1cGVyQWRtaW5zIGlzIHN0YWJsZSBhcyBpdCdzIGEgY29uc3RhbnQgYXJyYXkgZGVmaW5lZCBoZXJlLlxuICAvLyBJZiBpdCB3ZXJlIGR5bmFtaWMsIGl0IHdvdWxkIG5lZWQgdXNlTWVtby5cbiAgY29uc3Qgc3VwZXJBZG1pbnMgPSB1c2VNZW1vKCgpID0+IFsnZWdjaGFybGVAZ21haWwuY29tJ10sIFtdKTtcblxuICBjb25zdCBnZXRVc2VyUHJvZmlsZSA9IHVzZUNhbGxiYWNrKGFzeW5jIChmaXJlYmFzZVVzZXI6IEZpcmViYXNlVXNlcik6IFByb21pc2U8VXNlclByb2ZpbGUgfCBudWxsPiA9PiB7XG4gICAgY29uc3QgdXNlckRvY1JlZiA9IGRvYyhmaXJlc3RvcmUsICd1c2VycycsIGZpcmViYXNlVXNlci51aWQpO1xuICAgIGNvbnN0IHVzZXJEb2MgPSBhd2FpdCBnZXREb2ModXNlckRvY1JlZik7XG4gICAgY29uc3QgaXNTdXBlckFkbWluID0gZmlyZWJhc2VVc2VyLmVtYWlsID8gc3VwZXJBZG1pbnMuaW5jbHVkZXMoZmlyZWJhc2VVc2VyLmVtYWlsKSA6IGZhbHNlO1xuXG4gICAgaWYgKHVzZXJEb2MuZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybiB1c2VyRG9jLmRhdGEoKSBhcyBVc2VyUHJvZmlsZTtcbiAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG5ld1VzZXJQcm9maWxlOiBVc2VyUHJvZmlsZSA9IHtcbiAgICAgICAgaWQ6IGZpcmViYXNlVXNlci51aWQsXG4gICAgICAgIGVtYWlsOiBmaXJlYmFzZVVzZXIuZW1haWwgfHwgJycsXG4gICAgICAgIGRpc3BsYXlOYW1lOiBmaXJlYmFzZVVzZXIuZGlzcGxheU5hbWUgfHwgZmlyZWJhc2VVc2VyLmVtYWlsPy5zcGxpdCgnQCcpWzBdIHx8ICdVc2VyJyxcbiAgICAgICAgcGhvdG9VUkw6IGZpcmViYXNlVXNlci5waG90b1VSTCB8fCAnJyxcbiAgICAgICAgcm9sZXM6IHthZG1pbjogaXNTdXBlckFkbWluLCBpbnN0cnVjdG9yOiBmYWxzZSwgc3R1ZGVudDogdHJ1ZSwgbWFuYWdlcjogZmFsc2UgfSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGxhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHVpZDogZmlyZWJhc2VVc2VyLnVpZCxcbiAgICAgICAgY291bnRyeTogJycsXG4gICAgICAgIGNpdHk6ICcnLFxuICAgICAgICBkZXBhcnRtZW50SWQ6ICcnXG4gICAgfTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHNldERvYyh1c2VyRG9jUmVmLCBuZXdVc2VyUHJvZmlsZSk7XG4gICAgICAgIHJldHVybiBuZXdVc2VyUHJvZmlsZTtcbiAgICB9IGNhdGNoIChwcm9maWxlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNldHRpbmcgbmV3IHVzZXIgcHJvZmlsZTpcIiwgcHJvZmlsZUVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7IC8vIE9yIGhhbmRsZSBlcnJvciBhcHByb3ByaWF0ZWx5XG4gICAgfVxuICB9XG59LCBbc3VwZXJBZG1pbnNdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gb25BdXRoU3RhdGVDaGFuZ2VkKGF1dGgsIGFzeW5jIChmaXJlYmFzZVVzZXIpID0+IHtcbiAgICAgIGlmIChmaXJlYmFzZVVzZXIpIHtcbiAgICAgICAgLy8gT3B0aW1pc3RpY2FsbHkgc2V0IGxvYWRpbmcgdW50aWwgcHJvZmlsZSBpcyBmZXRjaGVkL3VwZGF0ZWRcbiAgICAgICAgc2V0QXV0aFN0YXRlKHByZXYgPT4gKHsuLi5wcmV2LCBsb2FkaW5nOiB0cnVlLCBlcnJvcjogbnVsbCB9KSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgdXNlclByb2ZpbGUgPSBhd2FpdCBnZXRVc2VyUHJvZmlsZShmaXJlYmFzZVVzZXIpO1xuICAgICAgICAgIGlmICh1c2VyUHJvZmlsZSkge1xuICAgICAgICAgICAgY29uc3QgaXNTdXBlckFkbWluTm93ID0gZmlyZWJhc2VVc2VyLmVtYWlsID8gc3VwZXJBZG1pbnMuaW5jbHVkZXMoZmlyZWJhc2VVc2VyLmVtYWlsKSA6IGZhbHNlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaXNTdXBlckFkbWluTm93ICYmICF1c2VyUHJvZmlsZS5yb2xlcz8uYWRtaW4pIHtcbiAgICAgICAgICAgICAgY29uc3QgdXNlckRvY1JlZiA9IGRvYyhmaXJlc3RvcmUsICd1c2VycycsIGZpcmViYXNlVXNlci51aWQpO1xuICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVEb2ModXNlckRvY1JlZiwgeydyb2xlcy5hZG1pbic6IHRydWUsIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH0pO1xuICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkUHJvZmlsZSA9IGF3YWl0IGdldFVzZXJQcm9maWxlKGZpcmViYXNlVXNlcik7IC8vIFJlLWZldGNoIHRvIGdldCB0aGUgYWJzb2x1dGUgbGF0ZXN0XG4gICAgICAgICAgICAgIHNldEF1dGhTdGF0ZSh7dXNlcjogdXBkYXRlZFByb2ZpbGUsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogbnVsbCwgaW5pdGlhbGl6ZWQ6IHRydWUgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy8gSWYgbGFzdExvZ2luQXQgaXMgb2xkLCB1cGRhdGUgaXRcbiAgICAgICAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgY29uc3QgbGFzdExvZ2luID0gdXNlclByb2ZpbGUubGFzdExvZ2luQXQgPyBuZXcgRGF0ZSh1c2VyUHJvZmlsZS5sYXN0TG9naW5BdCkgOiBuZXcgRGF0ZSgwKTtcbiAgICAgICAgICAgICAgLy8gVXBkYXRlIGlmIGxhc3QgbG9naW4gd2FzIG1vcmUgdGhhbiwgc2F5LCA1IG1pbnV0ZXMgYWdvLCB0byBhdm9pZCByYXBpZCB1cGRhdGVzIG9uIGhvdCByZWxvYWRzXG4gICAgICAgICAgICAgIGlmIChub3cuZ2V0VGltZSgpIC0gbGFzdExvZ2luLmdldFRpbWUoKSA+IDUgKiA2MCAqIDEwMDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VyRG9jUmVmID0gZG9jKGZpcmVzdG9yZSwgJ3VzZXJzJywgZmlyZWJhc2VVc2VyLnVpZCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlRG9jKHVzZXJEb2NSZWYsIHtsYXN0TG9naW5BdDogbm93LnRvSVNPU3RyaW5nKCkgfSk7XG4gICAgICAgICAgICAgICAgLy8gRmV0Y2ggYWdhaW4gaWYgeW91IHdhbnQgdGhlIGFic29sdXRlIGxhdGVzdCwgb3IgbWVyZ2Ugb3B0aW1pc3RpY2FsbHlcbiAgICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZFByb2ZpbGVXaXRoTG9naW4gPSB7Li4udXNlclByb2ZpbGUsIGxhc3RMb2dpbkF0OiBub3cudG9JU09TdHJpbmcoKSB9O1xuICAgICAgICAgICAgICAgICBzZXRBdXRoU3RhdGUoe3VzZXI6IHVwZGF0ZWRQcm9maWxlV2l0aExvZ2luLCBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6IG51bGwsIGluaXRpYWxpemVkOiB0cnVlIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgc2V0QXV0aFN0YXRlKHt1c2VyOiB1c2VyUHJvZmlsZSwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBudWxsLCBpbml0aWFsaXplZDogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRBdXRoU3RhdGUoe3VzZXI6IG51bGwsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBsb2FkIHVzZXIgcHJvZmlsZSBvYmplY3QuJywgaW5pdGlhbGl6ZWQ6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQXV0aENvbnRleHQgb25BdXRoU3RhdGVDaGFuZ2VkIGVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgc2V0QXV0aFN0YXRlKHt1c2VyOiBudWxsLCBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gcHJvY2VzcyB1c2VyIHByb2ZpbGU6ICcgKyBlcnJvci5tZXNzYWdlLCBpbml0aWFsaXplZDogdHJ1ZSB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBzZXRBdXRoU3RhdGUoe3VzZXI6IG51bGwsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogbnVsbCwgaW5pdGlhbGl6ZWQ6IHRydWUgfSk7XG4gICAgfVxuICB9KTtcblxuICAgIHJldHVybiAoKSA9PiB1bnN1YnNjcmliZSgpO1xufSwgW2dldFVzZXJQcm9maWxlLCBzdXBlckFkbWluc10pOyAvLyBnZXRVc2VyUHJvZmlsZSBkZXBlbmRzIG9uIHN1cGVyQWRtaW5zXG5cbiAgY29uc3QgbG9naW5XaXRoR29vZ2xlID0gdXNlQ2FsbGJhY2soYXN5bmMgKCk6IFByb21pc2U8VXNlclByb2ZpbGU+ID0+IHtcbiAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IHRydWUsIGVycm9yOiBudWxsIH0pKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XG4gICAgICBwcm92aWRlci5hZGRTY29wZSgnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC91c2VyaW5mby5lbWFpbCcpO1xuICAgICAgcHJvdmlkZXIuYWRkU2NvcGUoJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvdXNlcmluZm8ucHJvZmlsZScpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcbiAgICAgIGNvbnN0IHVzZXJQcm9maWxlID0gYXdhaXQgZ2V0VXNlclByb2ZpbGUocmVzdWx0LnVzZXIpO1xuXG4gICAgICBpZiAoIXVzZXJQcm9maWxlKSB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmV0cmlldmUgcHJvZmlsZSBhZnRlciBHb29nbGUgc2lnbi1pbi5cIik7XG5cbiAgICAgIGNvbnN0IHVzZXJEb2NSZWYgPSBkb2MoZmlyZXN0b3JlLCAndXNlcnMnLCB1c2VyUHJvZmlsZS5pZCk7XG4gICAgICBhd2FpdCB1cGRhdGVEb2ModXNlckRvY1JlZiwge2xhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSk7XG4gICAgICBjb25zdCB1cGRhdGVkUHJvZmlsZSA9IHsuLi51c2VyUHJvZmlsZSwgbGFzdExvZ2luQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9O1xuXG4gICAgICBzZXRBdXRoU3RhdGUoe3VzZXI6IHVwZGF0ZWRQcm9maWxlLCBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6IG51bGwsIGluaXRpYWxpemVkOiB0cnVlIH0pO1xuICAgICAgcmV0dXJuIHVwZGF0ZWRQcm9maWxlO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gbG9naW4gd2l0aCBHb29nbGUnO1xuICAgICAgc2V0QXV0aFN0YXRlKHByZXYgPT4gKHsuLi5wcmV2LCB1c2VyOiBudWxsLCBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6IGVycm9yTWVzc2FnZSB9KSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfVxufSwgW2dldFVzZXJQcm9maWxlXSk7XG5cbiAgY29uc3QgbG9naW4gPSB1c2VDYWxsYmFjayhhc3luYyAoY3JlZGVudGlhbHM6IExvZ2luQ3JlZGVudGlhbHMpOiBQcm9taXNlPFVzZXJQcm9maWxlPiA9PiB7XG4gICAgc2V0QXV0aFN0YXRlKHByZXYgPT4gKHsuLi5wcmV2LCBsb2FkaW5nOiB0cnVlLCBlcnJvcjogbnVsbCB9KSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtlbWFpbCwgcGFzc3dvcmQgfSA9IGNyZWRlbnRpYWxzO1xuICAgICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpO1xuICAgICAgY29uc3QgdXNlclByb2ZpbGUgPSBhd2FpdCBnZXRVc2VyUHJvZmlsZSh1c2VyQ3JlZGVudGlhbC51c2VyKTtcblxuICAgICAgaWYgKCF1c2VyUHJvZmlsZSkgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIHByb2ZpbGUgYWZ0ZXIgZW1haWwvcGFzc3dvcmQgc2lnbi1pbi5cIik7XG5cbiAgICAgIGNvbnN0IHVzZXJEb2NSZWYgPSBkb2MoZmlyZXN0b3JlLCAndXNlcnMnLCB1c2VyUHJvZmlsZS5pZCk7XG4gICAgICBhd2FpdCB1cGRhdGVEb2ModXNlckRvY1JlZiwge2xhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSk7XG4gICAgICBjb25zdCB1cGRhdGVkUHJvZmlsZSA9IHsuLi51c2VyUHJvZmlsZSwgbGFzdExvZ2luQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9O1xuXG4gICAgICBzZXRBdXRoU3RhdGUoe3VzZXI6IHVwZGF0ZWRQcm9maWxlLCBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6IG51bGwsIGluaXRpYWxpemVkOiB0cnVlIH0pO1xuICAgICAgcmV0dXJuIHVwZGF0ZWRQcm9maWxlO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gbG9naW4nO1xuICAgICAgc2V0QXV0aFN0YXRlKHByZXYgPT4gKHsuLi5wcmV2LCB1c2VyOiBudWxsLCBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6IGVycm9yTWVzc2FnZSB9KSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfVxufSwgW2dldFVzZXJQcm9maWxlXSk7XG5cbiAgY29uc3QgcmVnaXN0ZXIgPSB1c2VDYWxsYmFjayhhc3luYyAoY3JlZGVudGlhbHM6IFJlZ2lzdGVyQ3JlZGVudGlhbHMpOiBQcm9taXNlPFVzZXJQcm9maWxlPiA9PiB7XG4gICAgc2V0QXV0aFN0YXRlKHByZXYgPT4gKHsuLi5wcmV2LCBsb2FkaW5nOiB0cnVlLCBlcnJvcjogbnVsbCB9KSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtlbWFpbCwgcGFzc3dvcmQsIGRpc3BsYXlOYW1lLCBmaXJzdE5hbWUsIGxhc3ROYW1lLCBjb21wYW55LCBqb2JUaXRsZSB9ID0gY3JlZGVudGlhbHM7XG4gICAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpO1xuICAgICAgY29uc3QgaXNTdXBlckFkbWluID0gc3VwZXJBZG1pbnMuaW5jbHVkZXMoZW1haWwpO1xuXG4gICAgICBjb25zdCBuZXdVc2VyUHJvZmlsZTogVXNlclByb2ZpbGUgPSB7XG4gICAgICAgIGlkOiB1c2VyQ3JlZGVudGlhbC51c2VyLnVpZCxcbiAgICAgICAgZW1haWwsXG4gICAgICAgIGRpc3BsYXlOYW1lOiBkaXNwbGF5TmFtZSB8fCBlbWFpbC5zcGxpdCgnQCcpWzBdLFxuICAgICAgICBmaXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lLFxuICAgICAgICBjb21wYW55LFxuICAgICAgICBqb2JUaXRsZSxcbiAgICAgICAgcm9sZXM6IHthZG1pbjogaXNTdXBlckFkbWluLCBpbnN0cnVjdG9yOiBmYWxzZSwgc3R1ZGVudDogdHJ1ZSwgbWFuYWdlcjogZmFsc2UgfSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGxhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHVpZDogdXNlckNyZWRlbnRpYWwudXNlci51aWQsXG4gICAgICAgIGNvdW50cnk6ICcnLFxuICAgICAgICBjaXR5OiAnJyxcbiAgICAgICAgZGVwYXJ0bWVudElkOiAnJ1xuICAgIH07XG4gICAgICBjb25zdCB1c2VyRG9jUmVmID0gZG9jKGZpcmVzdG9yZSwgJ3VzZXJzJywgbmV3VXNlclByb2ZpbGUuaWQpO1xuICAgICAgYXdhaXQgc2V0RG9jKHVzZXJEb2NSZWYsIG5ld1VzZXJQcm9maWxlKTtcbiAgICAgIHNldEF1dGhTdGF0ZSh7dXNlcjogbmV3VXNlclByb2ZpbGUsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogbnVsbCwgaW5pdGlhbGl6ZWQ6IHRydWUgfSk7XG4gICAgICByZXR1cm4gbmV3VXNlclByb2ZpbGU7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpICAgICAge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHJlZ2lzdGVyJztcbiAgICAgIHNldEF1dGhTdGF0ZShwcmV2ID0+ICh7Li4ucHJldiwgdXNlcjogbnVsbCwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBlcnJvck1lc3NhZ2UgfSkpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gIH1cbn0sIFtzdXBlckFkbWluc10pO1xuXG4gIGNvbnN0IGxvZ291dCA9IHVzZUNhbGxiYWNrKGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IHRydWUsIGVycm9yOiBudWxsIH0pKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgc2lnbk91dChhdXRoKTtcbiAgICAgIHNldEF1dGhTdGF0ZSh7dXNlcjogbnVsbCwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBudWxsLCBpbml0aWFsaXplZDogdHJ1ZSB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGxvZ291dCc7XG4gICAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIHVzZXI6IG51bGwsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogZXJyb3JNZXNzYWdlIH0pKTsgLy8gRW5zdXJlIHVzZXIgaXMgbnVsbCBvbiBsb2dvdXQgZXJyb3IgdG9vXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfVxufSwgW10pO1xuXG4gIGNvbnN0IHJlc2V0UGFzc3dvcmQgPSB1c2VDYWxsYmFjayhhc3luYyAoZGF0YTogUmVzZXRQYXNzd29yZERhdGEpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IHRydWUsIGVycm9yOiBudWxsIH0pKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChhdXRoLCBkYXRhLmVtYWlsKTtcbiAgICAgIHNldEF1dGhTdGF0ZShwcmV2ID0+ICh7Li4ucHJldiwgbG9hZGluZzogZmFsc2UgfSkpO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gc2VuZCBwYXNzd29yZCByZXNldCBlbWFpbCc7XG4gICAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogZXJyb3JNZXNzYWdlIH0pKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICB9XG59LCBbXSk7XG5cbiAgY29uc3QgY29uZmlybVBhc3N3b3JkUmVzZXQgPSB1c2VDYWxsYmFjayhhc3luYyAoY29kZTogc3RyaW5nLCBuZXdQYXNzd29yZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgc2V0QXV0aFN0YXRlKHByZXYgPT4gKHsuLi5wcmV2LCBsb2FkaW5nOiB0cnVlLCBlcnJvcjogbnVsbCB9KSk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGZpcmViYXNlQ29uZmlybVBhc3N3b3JkUmVzZXQoYXV0aCwgY29kZSwgbmV3UGFzc3dvcmQpO1xuICAgICAgc2V0QXV0aFN0YXRlKHByZXYgPT4gKHsuLi5wcmV2LCBsb2FkaW5nOiBmYWxzZSB9KSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBjb25maXJtIHBhc3N3b3JkIHJlc2V0JztcbiAgICAgIHNldEF1dGhTdGF0ZShwcmV2ID0+ICh7Li4ucHJldiwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBlcnJvck1lc3NhZ2UgfSkpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gIH1cbn0sIFtdKTtcblxuICBjb25zdCB1cGRhdGVQYXNzd29yZCA9IHVzZUNhbGxiYWNrKGFzeW5jIChkYXRhOiBVcGRhdGVQYXNzd29yZERhdGEpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IHRydWUsIGVycm9yOiBudWxsIH0pKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgICBpZiAoIXVzZXIgfHwgIXVzZXIuZW1haWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkIGZvciBwYXNzd29yZCB1cGRhdGUuJyk7XG4gICAgfVxuICAgICAgY29uc3QgY3JlZGVudGlhbCA9IEVtYWlsQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodXNlci5lbWFpbCwgZGF0YS5jdXJyZW50UGFzc3dvcmQpO1xuICAgICAgYXdhaXQgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCh1c2VyLCBjcmVkZW50aWFsKTtcbiAgICAgIGF3YWl0IGZpcmViYXNlVXBkYXRlUGFzc3dvcmQodXNlciwgZGF0YS5uZXdQYXNzd29yZCk7XG4gICAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IGZhbHNlIH0pKTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHVwZGF0ZSBwYXNzd29yZCc7XG4gICAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogZXJyb3JNZXNzYWdlIH0pKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICB9XG59LCBbXSk7XG5cbiAgY29uc3QgdXBkYXRlUHJvZmlsZSA9IHVzZUNhbGxiYWNrKGFzeW5jIChkYXRhOiBQYXJ0aWFsPFVzZXJQcm9maWxlPik6IFByb21pc2U8VXNlclByb2ZpbGU+ID0+IHtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IGF1dGhTdGF0ZS51c2VyO1xuXG4gICAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkIGZvciBwcm9maWxlIHVwZGF0ZS4nKTtcbiAgICAgIHNldEF1dGhTdGF0ZShwcmV2ID0+ICh7Li4ucHJldiwgdXNlcjogbnVsbCwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBlcnIubWVzc2FnZSwgaW5pdGlhbGl6ZWQ6IHRydWUgfSkpO1xuICAgICAgdGhyb3cgZXJyO1xuICB9XG5cbiAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IHRydWUsIGVycm9yOiBudWxsIH0pKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyRG9jUmVmID0gZG9jKGZpcmVzdG9yZSwgJ3VzZXJzJywgY3VycmVudFVzZXIuaWQpO1xuICAgICAgXG4gICAgICAvLyBQcmVwYXJlIHRoZSBkYXRhIHRvIGJlIHNlbnQgdG8gRmlyZXN0b3JlLlxuICAgICAgLy8gT25seSBzcHJlYWQgcHJvcGVydGllcyB0aGF0IGFyZSB2YWxpZCBmb3IgVXNlclByb2ZpbGUuXG4gICAgICAvLyAnZGF0YScgaXRzZWxmIGlzIFBhcnRpYWw8VXNlclByb2ZpbGU+LCBzbyBpdCdzIGFscmVhZHkgdHlwZS1jaGVja2VkLlxuICAgICAgY29uc3QgZGF0YUZvckZpcmVzdG9yZTogUGFydGlhbDxVc2VyUHJvZmlsZT4gPSBcbiAgICAgICAgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsID8gZGF0YSA6IHt9KTtcbiAgICAgIFxuICAgICAgLy8gT25seSB1cGRhdGUgaWYgdGhlcmUncyBhY3R1YWxseSBkYXRhIHRvIHVwZGF0ZSwgb3RoZXJ3aXNlIHNraXAgRmlyZXN0b3JlIGNhbGxcbiAgICAgIGlmIChPYmplY3Qua2V5cyhkYXRhRm9yRmlyZXN0b3JlKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGF3YWl0IHVwZGF0ZURvYyh1c2VyRG9jUmVmLCBkYXRhRm9yRmlyZXN0b3JlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb25zb2xlLndhcm4oXCJ1cGRhdGVQcm9maWxlIGNhbGxlZCB3aXRoIGVtcHR5IGRhdGEuIE5vIEZpcmVzdG9yZSB1cGRhdGUgcGVyZm9ybWVkLlwiKTtcbiAgICB9XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSB0aGUgdXBkYXRlZCB1c2VyIHByb2ZpbGUgZm9yIHRoZSBsb2NhbCBzdGF0ZVxuICAgICAgY29uc3QgdXBkYXRlZFVzZXJQcm9maWxlOiBVc2VyUHJvZmlsZSA9IHtcbiAgICAgICAgLi4uY3VycmVudFVzZXIsICAgIC8vIFN0YXJ0IHdpdGggdGhlIGN1cnJlbnQgdXNlciBwcm9maWxlXG4gICAgICAgIC4uLmRhdGFGb3JGaXJlc3RvcmUgLy8gQXBwbHkgYWxsIGNoYW5nZXMgZnJvbSAnZGF0YSdcbiAgICB9O1xuXG4gICAgICBzZXRBdXRoU3RhdGUoe3VzZXI6IHVwZGF0ZWRVc2VyUHJvZmlsZSwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBudWxsLCBpbml0aWFsaXplZDogdHJ1ZSB9KTtcbiAgICAgIHJldHVybiB1cGRhdGVkVXNlclByb2ZpbGU7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byB1cGRhdGUgcHJvZmlsZSc7XG4gICAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIHVzZXI6IGN1cnJlbnRVc2VyLCBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6IGVycm9yTWVzc2FnZSB9KSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfVxufSwgW2F1dGhTdGF0ZS51c2VyXSk7XG5cbiAgY29uc3QgZGVsZXRlQWNjb3VudCA9IHVzZUNhbGxiYWNrKGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgdXNlciBmcm9tIGF1dGhTdGF0ZSBhbmQgRmlyZWJhc2UgYXV0aCAqYmVmb3JlKiBzZXR0aW5nIGxvYWRpbmcgc3RhdGVcbiAgICBjb25zdCBjdXJyZW50VXNlclByb2ZpbGUgPSBhdXRoU3RhdGUudXNlcjsgLy8gVXNlclByb2ZpbGUgZnJvbSBGaXJlc3RvcmVcbiAgICBjb25zdCBjdXJyZW50RmlyZWJhc2VVc2VyID0gYXV0aC5jdXJyZW50VXNlcjsgLy8gRmlyZWJhc2VVc2VyIGZyb20gYXV0aCBzZXJ2aWNlXG5cbiAgICBpZiAoIWN1cnJlbnRGaXJlYmFzZVVzZXIpIHtcbiAgICAgIGNvbnN0IGVyciA9IG5ldyBFcnJvcignTm8gRmlyZWJhc2UgdXNlciBjdXJyZW50bHkgYXV0aGVudGljYXRlZCBmb3IgYWNjb3VudCBkZWxldGlvbi4nKTtcbiAgICAgIHNldEF1dGhTdGF0ZShwcmV2ID0+ICh7Li4ucHJldiwgdXNlcjogbnVsbCwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBlcnIubWVzc2FnZSwgaW5pdGlhbGl6ZWQ6IHRydWUgfSkpO1xuICAgICAgdGhyb3cgZXJyO1xuICB9XG4gICAgLy8gY3VycmVudFVzZXJQcm9maWxlIG1pZ2h0IGJlIG51bGwgaWYgRmlyZXN0b3JlIHN5bmMgaXMgb2ZmLCBidXQgY3VycmVudEZpcmViYXNlVXNlciBpcyB0aGUgc291cmNlIG9mIHRydXRoIGZvciBhdXRoIGRlbGV0aW9uXG5cbiAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGxvYWRpbmc6IHRydWUsIGVycm9yOiBudWxsIH0pKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgSUQgZnJvbSBGaXJlc3RvcmUgcHJvZmlsZSBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSBmYWxsYmFjayB0byBGaXJlYmFzZSBhdXRoIFVJRFxuICAgICAgLy8gVGhpcyBpcyBpbXBvcnRhbnQgaWYgeW91ciBGaXJlc3RvcmUgJ2lkJyBmaWVsZCBpcyB0aGUgc2FtZSBhcyAndWlkJ1xuICAgICAgY29uc3QgdXNlcklkRm9yRmlyZXN0b3JlID0gY3VycmVudFVzZXJQcm9maWxlPy5pZCB8fCBjdXJyZW50RmlyZWJhc2VVc2VyLnVpZDtcbiAgICAgIGNvbnN0IHVzZXJEb2NSZWYgPSBkb2MoZmlyZXN0b3JlLCAndXNlcnMnLCB1c2VySWRGb3JGaXJlc3RvcmUpO1xuICAgICAgXG4gICAgICBhd2FpdCBkZWxldGVEb2ModXNlckRvY1JlZik7IC8vIERlbGV0ZSBGaXJlc3RvcmUgcHJvZmlsZVxuXG4gICAgICBhd2FpdCBkZWxldGVVc2VyKGN1cnJlbnRGaXJlYmFzZVVzZXIpOyAvLyBEZWxldGUgRmlyZWJhc2UgYXV0aCB1c2VyXG5cbiAgICAgIHNldEF1dGhTdGF0ZSh7dXNlcjogbnVsbCwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBudWxsLCBpbml0aWFsaXplZDogdHJ1ZSB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGRlbGV0ZSBhY2NvdW50JztcbiAgICAgIC8vIElmIGRlbGV0aW9uIGZhaWxzLCB0aGUgdXNlciBtaWdodCBzdGlsbCBiZSBwYXJ0aWFsbHkgYXV0aGVudGljYXRlZCBvciB0aGVpciBGaXJlc3RvcmUgZG9jIG1pZ2h0IHN0aWxsIGV4aXN0LlxuICAgICAgLy8gU2V0dGluZyB1c2VyIHRvIG51bGwgaXMgYSBzYWZlIGRlZmF1bHQsIGJ1dCB5b3UgbWlnaHQgd2FudCBtb3JlIG51YW5jZWQgZXJyb3IgaGFuZGxpbmcuXG4gICAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIHVzZXI6IG51bGwsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogZXJyb3JNZXNzYWdlLCBpbml0aWFsaXplZDogdHJ1ZSB9KSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfVxufSwgW2F1dGhTdGF0ZS51c2VyXSk7IC8vIERlcGVuZGVuY3kgb24gYXV0aFN0YXRlLnVzZXIgYmVjYXVzZSBpdCBtaWdodCBiZSB1c2VkIHRvIGdldCB0aGUgRmlyZXN0b3JlIGRvYyBJRC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF1dGguY3VycmVudFVzZXIgaXMgbm90IGEgcmVhY3RpdmUgZGVwZW5kZW5jeSBmb3IgdXNlQ2FsbGJhY2suXG5cbiAgY29uc3QgY2xlYXJFcnJvciA9IHVzZUNhbGxiYWNrKCgpOiB2b2lkID0+IHtcbiAgICBzZXRBdXRoU3RhdGUocHJldiA9PiAoey4uLnByZXYsIGVycm9yOiBudWxsIH0pKTtcbn0sIFtdKTtcblxuICBjb25zdCBjb250ZXh0VmFsdWUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlcjogYXV0aFN0YXRlLnVzZXIsXG4gICAgICBsb2FkaW5nOiBhdXRoU3RhdGUubG9hZGluZyxcbiAgICAgIGVycm9yOiBhdXRoU3RhdGUuZXJyb3IsXG4gICAgICBpbml0aWFsaXplZDogYXV0aFN0YXRlLmluaXRpYWxpemVkLFxuICAgICAgaXNBdXRoZW50aWNhdGVkOiAhIWF1dGhTdGF0ZS51c2VyLFxuICAgICAgbG9naW4sXG4gICAgICBsb2dpbldpdGhHb29nbGUsXG4gICAgICByZWdpc3RlcixcbiAgICAgIGxvZ291dCxcbiAgICAgIHJlc2V0UGFzc3dvcmQsXG4gICAgICBjb25maXJtUGFzc3dvcmRSZXNldCxcbiAgICAgIHVwZGF0ZVBhc3N3b3JkLFxuICAgICAgdXBkYXRlUHJvZmlsZSxcbiAgICAgIGRlbGV0ZUFjY291bnQsXG4gICAgICBjbGVhckVycm9yLFxuICB9O1xufSwgW1xuICAgIGF1dGhTdGF0ZSwgLy8gTWFpbiBkZXBlbmRlbmN5IGZvciB1c2VyLCBsb2FkaW5nLCBlcnJvciwgaW5pdGlhbGl6ZWQsIGlzQXV0aGVudGljYXRlZFxuICAgIGxvZ2luLCBsb2dpbldpdGhHb29nbGUsIHJlZ2lzdGVyLCBsb2dvdXQsIHJlc2V0UGFzc3dvcmQsIFxuICAgIGNvbmZpcm1QYXNzd29yZFJlc2V0LCB1cGRhdGVQYXNzd29yZCwgdXBkYXRlUHJvZmlsZSwgZGVsZXRlQWNjb3VudCwgY2xlYXJFcnJvciAvLyBGdW5jdGlvbnNcbiAgXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8QXV0aENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHRWYWx1ZX0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9BdXRoQ29udGV4dC5Qcm92aWRlcj5cbiAgKTtcbn07XG5cbmV4cG9ydCBjb25zdCB1c2VBdXRoID0gKCk6IEF1dGhDb250ZXh0VHlwZSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KEF1dGhDb250ZXh0KTtcbiAgaWYgKCFjb250ZXh0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCd1c2VBdXRoIG11c3QgYmUgdXNlZCB3aXRoaW4gYW4gQXV0aFByb3ZpZGVyJyk7XG59XG4gIHJldHVybiBjb250ZXh0O1xufTsiXSwibmFtZXMiOlsiUmVhY3QiLCJjcmVhdGVDb250ZXh0IiwidXNlQ29udGV4dCIsInVzZUVmZmVjdCIsInVzZVN0YXRlIiwidXNlQ2FsbGJhY2siLCJ1c2VNZW1vIiwiYXV0aCIsImZpcmVzdG9yZSIsImNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZCIsInNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkIiwic2lnbk91dCIsInNlbmRQYXNzd29yZFJlc2V0RW1haWwiLCJjb25maXJtUGFzc3dvcmRSZXNldCIsImZpcmViYXNlQ29uZmlybVBhc3N3b3JkUmVzZXQiLCJ1cGRhdGVQYXNzd29yZCIsImZpcmViYXNlVXBkYXRlUGFzc3dvcmQiLCJFbWFpbEF1dGhQcm92aWRlciIsInJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWwiLCJkZWxldGVVc2VyIiwib25BdXRoU3RhdGVDaGFuZ2VkIiwiR29vZ2xlQXV0aFByb3ZpZGVyIiwic2lnbkluV2l0aFBvcHVwIiwiZG9jIiwiZ2V0RG9jIiwic2V0RG9jIiwidXBkYXRlRG9jIiwiZGVsZXRlRG9jIiwiaW5pdGlhbEF1dGhTdGF0ZSIsInVzZXIiLCJsb2FkaW5nIiwiZXJyb3IiLCJpbml0aWFsaXplZCIsIkF1dGhDb250ZXh0IiwiaXNBdXRoZW50aWNhdGVkIiwibG9naW4iLCJFcnJvciIsImxvZ2luV2l0aEdvb2dsZSIsInJlZ2lzdGVyIiwibG9nb3V0IiwicmVzZXRQYXNzd29yZCIsInVwZGF0ZVByb2ZpbGUiLCJkZWxldGVBY2NvdW50IiwiY2xlYXJFcnJvciIsIkF1dGhQcm92aWRlciIsImNoaWxkcmVuIiwiYXV0aFN0YXRlIiwic2V0QXV0aFN0YXRlIiwic3VwZXJBZG1pbnMiLCJnZXRVc2VyUHJvZmlsZSIsImZpcmViYXNlVXNlciIsInVzZXJEb2NSZWYiLCJ1aWQiLCJ1c2VyRG9jIiwiaXNTdXBlckFkbWluIiwiZW1haWwiLCJpbmNsdWRlcyIsImV4aXN0cyIsImRhdGEiLCJuZXdVc2VyUHJvZmlsZSIsImlkIiwiZGlzcGxheU5hbWUiLCJzcGxpdCIsInBob3RvVVJMIiwicm9sZXMiLCJhZG1pbiIsImluc3RydWN0b3IiLCJzdHVkZW50IiwibWFuYWdlciIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImxhc3RMb2dpbkF0IiwiY291bnRyeSIsImNpdHkiLCJkZXBhcnRtZW50SWQiLCJwcm9maWxlRXJyb3IiLCJjb25zb2xlIiwidW5zdWJzY3JpYmUiLCJwcmV2IiwidXNlclByb2ZpbGUiLCJpc1N1cGVyQWRtaW5Ob3ciLCJ1cGRhdGVkQXQiLCJ1cGRhdGVkUHJvZmlsZSIsIm5vdyIsImxhc3RMb2dpbiIsImdldFRpbWUiLCJ1cGRhdGVkUHJvZmlsZVdpdGhMb2dpbiIsIm1lc3NhZ2UiLCJwcm92aWRlciIsImFkZFNjb3BlIiwicmVzdWx0IiwiZXJyb3JNZXNzYWdlIiwiY3JlZGVudGlhbHMiLCJwYXNzd29yZCIsInVzZXJDcmVkZW50aWFsIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJjb21wYW55Iiwiam9iVGl0bGUiLCJjb2RlIiwibmV3UGFzc3dvcmQiLCJjdXJyZW50VXNlciIsImNyZWRlbnRpYWwiLCJjdXJyZW50UGFzc3dvcmQiLCJlcnIiLCJkYXRhRm9yRmlyZXN0b3JlIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInVwZGF0ZWRVc2VyUHJvZmlsZSIsImN1cnJlbnRVc2VyUHJvZmlsZSIsImN1cnJlbnRGaXJlYmFzZVVzZXIiLCJ1c2VySWRGb3JGaXJlc3RvcmUiLCJjb250ZXh0VmFsdWUiLCJQcm92aWRlciIsInZhbHVlIiwidXNlQXV0aCIsImNvbnRleHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/context/AuthContext.tsx\n");

/***/ }),

/***/ "./src/context/CourseContext.tsx":
/*!***************************************!*\
  !*** ./src/context/CourseContext.tsx ***!
  \***************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CourseContext: () => (/* binding */ CourseContext),\n/* harmony export */   CourseProvider: () => (/* binding */ CourseProvider),\n/* harmony export */   useCourses: () => (/* binding */ useCourses)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _services_firebase__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/services/firebase */ \"./src/services/firebase.ts\");\n/* harmony import */ var _AuthContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AuthContext */ \"./src/context/AuthContext.tsx\");\n/* harmony import */ var _services_courseProgressService__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/services/courseProgressService */ \"./src/services/courseProgressService.ts\");\n/* harmony import */ var _services_moduleService__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/services/moduleService */ \"./src/services/moduleService.ts\");\n/* harmony import */ var _tanstack_react_query__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @tanstack/react-query */ \"@tanstack/react-query\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, _services_firebase__WEBPACK_IMPORTED_MODULE_3__, _AuthContext__WEBPACK_IMPORTED_MODULE_4__, _services_courseProgressService__WEBPACK_IMPORTED_MODULE_5__, _services_moduleService__WEBPACK_IMPORTED_MODULE_6__, _tanstack_react_query__WEBPACK_IMPORTED_MODULE_7__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, _services_firebase__WEBPACK_IMPORTED_MODULE_3__, _AuthContext__WEBPACK_IMPORTED_MODULE_4__, _services_courseProgressService__WEBPACK_IMPORTED_MODULE_5__, _services_moduleService__WEBPACK_IMPORTED_MODULE_6__, _tanstack_react_query__WEBPACK_IMPORTED_MODULE_7__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n // Added useCallback, useMemo\n\n\n // Assuming AuthContext is already stabilized\n\n\n // Kept from your snippet\nconst CourseContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(undefined);\nconst CourseProvider = ({ children })=>{\n    const { user } = (0,_AuthContext__WEBPACK_IMPORTED_MODULE_4__.useAuth)(); // Assuming useAuth() provides a stable 'user' object\n    const [courses, setCourses] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [enrolledCourses, setEnrolledCourses] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [completedCourses, setCompletedCourses] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [featuredCourses, setFeaturedCourses] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [courseProgress, setCourseProgress] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({});\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const queryClient = (0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_7__.useQueryClient)(); // From your snippet\n    // --- START OF MEMOIZED FUNCTIONS (Order Matters) ---\n    const getFirestoreUserId = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(()=>{\n        // Relies on 'user' from useAuth\n        if (!user || !user.id) {\n            console.error(\"Attempted Firestore operation without authenticated user ID.\");\n            throw new Error(\"User not authenticated for this operation\");\n        }\n        return user.id;\n    }, [\n        user\n    ]);\n    // Define fetchCourse early as it's a common dependency\n    const fetchCourse = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (courseId, internalCall = false)=>{\n        // Relies on setLoading, setError (stable state setters)\n        // Relies on verifyAllModuleLessonCounts (stable import)\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const courseDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, \"courses\", courseId));\n            if (!courseDoc.exists()) {\n                throw new Error(\"Course not found\");\n            }\n            const courseData = courseDoc.data();\n            return {\n                ...courseData,\n                id: courseDoc.id\n            };\n        } catch (error) {\n            console.error(`Failed to fetch course ${courseId}:`, error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to fetch course\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, []); // Dependencies: Stable setters, stable imports\n    // Define fetchCourses\n    const fetchCourses = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (options, internalCall = false)=>{\n        // Relies on setLoading, setError, setCourses (stable state setters)\n        // Relies on verifyAllModuleLessonCounts (stable import)\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            if (options?.verifyModuleLessonCounts && options.courseId) {\n                await (0,_services_moduleService__WEBPACK_IMPORTED_MODULE_6__.verifyAllModuleLessonCounts)(options.courseId);\n            }\n            const coursesQueryBuilder = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, \"courses\");\n            const constraints = [];\n            if (options?.status) {\n                constraints.push((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"status\", \"==\", options.status));\n            } else {\n                constraints.push((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"status\", \"==\", \"published\"));\n            }\n            if (options?.featured !== undefined) {\n                constraints.push((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"featured\", \"==\", options.featured));\n            }\n            constraints.push((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.orderBy)(\"title\", \"asc\"));\n            if (options?.limit && typeof options.limit === \"number\") {\n                constraints.push((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.limit)(options.limit));\n            }\n            const finalQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.query)(coursesQueryBuilder, ...constraints);\n            const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDocs)(finalQuery);\n            const fetchedCoursesData = [];\n            querySnapshot.forEach((docSnap)=>{\n                const data = docSnap.data();\n                fetchedCoursesData.push({\n                    id: docSnap.id,\n                    ...data\n                });\n            });\n            if (!options?.featured) {\n                setCourses(fetchedCoursesData);\n            }\n            return fetchedCoursesData;\n        } catch (error) {\n            console.error(\"Failed to fetch courses:\", error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to fetch courses\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, []); // Dependencies: Stable setters, stable imports\n    // Define fetchCourseProgress\n    const fetchCourseProgress = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (courseId)=>{\n        // Relies on user, getFirestoreUserId (memoized), setCourseProgress (stable)\n        // Relies on courseProgressService.getCourseProgress (stable import)\n        if (!user?.id) {\n            return null;\n        }\n        const userId = getFirestoreUserId();\n        try {\n            const progress = await _services_courseProgressService__WEBPACK_IMPORTED_MODULE_5__.getCourseProgress(userId, courseId);\n            if (progress) {\n                setCourseProgress((prev)=>({\n                        ...prev,\n                        [courseId]: progress\n                    }));\n            } else {\n                setCourseProgress((prev)=>{\n                    const newState = {\n                        ...prev\n                    };\n                    delete newState[courseId];\n                    return newState;\n                });\n            }\n            return progress;\n        } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : \"An unknown error occurred\";\n            console.error(`Error fetching course progress for ${courseId}:`, error);\n            return null;\n        }\n    }, [\n        user,\n        getFirestoreUserId\n    ]);\n    // --- End of Part 1 ---\n    // --- Continuation from Part 1 ---\n    // fetchCourseProgress was the last function in Part 1\n    // --- Part 2 Functions ---\n    const fetchEnrolledCourses = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (internalCall = false)=>{\n        // Relies on user, getFirestoreUserId, fetchCourse, fetchCourseProgress (all memoized/stable)\n        // Relies on stable setters: setEnrolledCourses, setCompletedCourses, setCourseProgress, setLoading, setError\n        if (!user?.id) {\n            setEnrolledCourses([]);\n            setCompletedCourses([]);\n            setCourseProgress({});\n            return [];\n        }\n        const userId = getFirestoreUserId();\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const enrollmentsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, `users/${userId}/enrollments`);\n            const enrollmentsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.query)(enrollmentsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"status\", \"==\", \"active\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.orderBy)(\"enrolledAt\", \"desc\"));\n            const enrollmentsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDocs)(enrollmentsQuery);\n            const enrollments = enrollmentsSnapshot.docs.map((d)=>({\n                    ...d.data(),\n                    enrollmentId: d.id\n                }));\n            const uniqueEnrollmentsByCourseId = Array.from(enrollments.reduce((map, enrollment)=>{\n                const existingEnrollment = map.get(enrollment.courseId);\n                if (!existingEnrollment || enrollment.enrolledAt && existingEnrollment.enrolledAt && new Date(enrollment.enrolledAt) > new Date(existingEnrollment.enrolledAt)) {\n                    map.set(enrollment.courseId, enrollment);\n                }\n                return map;\n            }, new Map()).values());\n            const progressPromises = uniqueEnrollmentsByCourseId.map((e)=>fetchCourseProgress(e.courseId));\n            const progressResults = await Promise.all(progressPromises);\n            const tempProgressMap = {};\n            progressResults.forEach((p)=>{\n                if (p) {\n                    tempProgressMap[p.courseId] = p;\n                }\n            });\n            const enrolledCoursesDetailsPromises = uniqueEnrollmentsByCourseId.map(async (e)=>{\n                try {\n                    const course = await fetchCourse(e.courseId, true);\n                    const progress = tempProgressMap[course.id];\n                    return {\n                        ...course,\n                        progress: progress?.overallProgress || 0\n                    };\n                } catch (error) {\n                    console.error(`Error fetching details for enrolled course ${e.courseId} in fetchEnrolledCourses:`, error);\n                    return undefined;\n                }\n            });\n            const finalEnrolledCourses = (await Promise.all(enrolledCoursesDetailsPromises)).filter((c)=>c !== undefined);\n            const completed = [];\n            const inProgress = [];\n            finalEnrolledCourses.forEach((c)=>{\n                c.progress === 100 ? completed.push(c) : inProgress.push(c);\n            });\n            setEnrolledCourses(inProgress);\n            setCompletedCourses(completed);\n            setCourseProgress((prevGlobalProgress)=>({\n                    ...prevGlobalProgress,\n                    ...tempProgressMap\n                }));\n            return finalEnrolledCourses;\n        } catch (error) {\n            console.error(\"Error fetching enrolled courses:\", error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to fetch enrolled courses\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        user,\n        getFirestoreUserId,\n        fetchCourse,\n        fetchCourseProgress\n    ]);\n    const fetchCompletedCourses = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (internalCall = false)=>{\n        // Relies on user, getFirestoreUserId, fetchCourse (all memoized/stable)\n        // Relies on stable setters: setCompletedCourses, setLoading, setError\n        if (!user?.id) {\n            setCompletedCourses([]);\n            return [];\n        }\n        const userId = getFirestoreUserId();\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const progressQ = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, \"courseProgress\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"completed\", \"==\", true), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.orderBy)(\"completedDate\", \"desc\"));\n            const progressSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDocs)(progressQ);\n            const completedProgressDocs = progressSnapshot.docs.map((d)=>d.data());\n            const completedCoursesPromises = completedProgressDocs.map(async (progressItem)=>{\n                try {\n                    const course = await fetchCourse(progressItem.courseId, true);\n                    return {\n                        ...course,\n                        progress: 100\n                    };\n                } catch (error) {\n                    console.error(`Error fetching details for completed course ${progressItem.courseId}:`, error);\n                    return undefined;\n                }\n            });\n            const completedCoursesData = (await Promise.all(completedCoursesPromises)).filter((c)=>c !== undefined);\n            setCompletedCourses(completedCoursesData);\n            return completedCoursesData;\n        } catch (error) {\n            console.error(\"Error fetching completed courses:\", error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to fetch completed courses\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        user,\n        getFirestoreUserId,\n        fetchCourse\n    ]);\n    const enrollInCourse = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (courseId, internalCall = false)=>{\n        // Relies on user, getFirestoreUserId, fetchCourse, fetchEnrolledCourses (all memoized/stable)\n        // Relies on stable setters: setLoading, setError\n        if (!user?.id) throw new Error(\"User not authenticated\");\n        const userId = getFirestoreUserId();\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const enrollmentsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, `users/${userId}/enrollments`);\n            const enrollmentQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.query)(enrollmentsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"courseId\", \"==\", courseId));\n            const enrollmentSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDocs)(enrollmentQuery);\n            if (!enrollmentSnapshot.empty) {\n                const enrollmentDoc = enrollmentSnapshot.docs[0];\n                const enrollmentData = enrollmentDoc.data();\n                if (enrollmentData.status !== \"active\") {\n                    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.updateDoc)(enrollmentDoc.ref, {\n                        status: \"active\",\n                        enrolledAt: new Date().toISOString(),\n                        updatedAt: new Date().toISOString()\n                    });\n                    const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n                    const progressSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDoc)(progressRef);\n                    if (progressSnap.exists()) {\n                        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.updateDoc)(progressRef, {\n                            completed: false,\n                            completedDate: null,\n                            certificateId: null\n                        }).catch(console.warn);\n                    }\n                } else return;\n            } else {\n                const course = await fetchCourse(courseId, true);\n                const newEnrollmentData = {\n                    courseId,\n                    courseName: course.title,\n                    enrolledAt: new Date().toISOString(),\n                    status: \"active\",\n                    progress: 0,\n                    completedLessons: [],\n                    lastAccessedAt: new Date().toISOString()\n                };\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.addDoc)(enrollmentsRef, newEnrollmentData);\n                const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n                const progressDocSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDoc)(progressRef);\n                if (!progressDocSnap.exists()) {\n                    const newProgressData = {\n                        courseId,\n                        userId: userId,\n                        startDate: new Date().toISOString(),\n                        lastAccessDate: new Date().toISOString(),\n                        completedLessons: [],\n                        completedModules: [],\n                        quizScores: {},\n                        quizAttempts: {},\n                        lessonProgress: {},\n                        moduleProgress: {},\n                        overallProgress: 0,\n                        completed: false,\n                        timeSpent: 0,\n                        lastPosition: undefined\n                    };\n                    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.setDoc)(progressRef, newProgressData);\n                } else {\n                    const existingProgress = progressDocSnap.data();\n                    if (existingProgress.completed) {\n                        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.updateDoc)(progressRef, {\n                            completed: false,\n                            completedDate: null,\n                            certificateId: null,\n                            certificateIssueDate: null\n                        });\n                    }\n                }\n            }\n            await fetchEnrolledCourses(true);\n        } catch (error) {\n            console.error(`Failed to enroll in course ${courseId}:`, error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to enroll in course\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        user,\n        getFirestoreUserId,\n        fetchCourse,\n        fetchEnrolledCourses\n    ]);\n    const unenrollFromCourse = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (courseId, internalCall = false)=>{\n        // Relies on user, getFirestoreUserId, fetchEnrolledCourses (all memoized/stable)\n        // Relies on stable setters: setLoading, setError\n        if (!user?.id) throw new Error(\"User not authenticated\");\n        const userId = getFirestoreUserId();\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const enrollmentsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, `users/${userId}/enrollments`);\n            const enrollmentQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.query)(enrollmentsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"courseId\", \"==\", courseId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.where)(\"status\", \"==\", \"active\"));\n            const enrollmentSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDocs)(enrollmentQuery);\n            if (enrollmentSnapshot.empty) {\n                console.warn(`Attempted to unenroll from course ${courseId} but no active enrollment found.`);\n                return;\n            }\n            const enrollmentDocRef = enrollmentSnapshot.docs[0].ref;\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.updateDoc)(enrollmentDocRef, {\n                status: \"inactive\",\n                updatedAt: new Date().toISOString()\n            });\n            await fetchEnrolledCourses(true);\n        } catch (error) {\n            console.error(`Failed to unenroll from course ${courseId}:`, error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to unenroll from course\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        user,\n        getFirestoreUserId,\n        fetchEnrolledCourses\n    ]);\n    // --- End of Part 2 ---\n    // --- Continuation from Part 2 ---\n    // unenrollFromCourse was the last function in Part 2\n    // --- Part 3 Functions, useEffects, contextValue, return ---\n    const updateCourseProgress = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (courseId, lessonId, completed, internalCall = false)=>{\n        // Relies on user, getFirestoreUserId, fetchCourse, fetchEnrolledCourses (all memoized/stable)\n        // Relies on stable setters: setLoading, setError, setCourseProgress\n        // Relies on stable import: courseProgressService.updateLessonProgress\n        if (!user?.id) throw new Error(\"User not authenticated\");\n        const userId = getFirestoreUserId();\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const course = await fetchCourse(courseId, true);\n            const totalLessons = course.modulesList?.reduce((total, moduleId)=>{\n                // Check if moduleId is actually a Module object (for backward compatibility)\n                if (typeof moduleId === \"object\" && moduleId !== null) {\n                    const moduleObj = moduleId;\n                    return total + (moduleObj.lessons?.length || 0);\n                }\n                // If it's a string ID, we can't directly access lessons\n                // This is likely the source of your type error\n                return total;\n            }, 0) || 0;\n            const updatedProgressData = await _services_courseProgressService__WEBPACK_IMPORTED_MODULE_5__.updateLessonProgress(userId, courseId, course.title, lessonId, completed, totalLessons);\n            if (updatedProgressData) {\n                setCourseProgress((prev)=>({\n                        ...prev,\n                        [courseId]: updatedProgressData\n                    }));\n            } else {\n                console.warn(`updateLessonProgress service did not return updated progress for ${courseId}.`);\n            }\n            await fetchEnrolledCourses(true);\n        } catch (error) {\n            console.error(`Failed to update progress for lesson ${lessonId} in course ${courseId}:`, error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to update course progress\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        user,\n        getFirestoreUserId,\n        fetchCourse,\n        fetchEnrolledCourses\n    ]);\n    const markModuleComplete = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (courseId, moduleId, internalCall = false)=>{\n        // Relies on user, getFirestoreUserId, fetchEnrolledCourses (all memoized/stable)\n        // Relies on stable setters: setLoading, setError, setCourseProgress\n        // Relies on stable import: courseProgressService.markModuleComplete\n        if (!user?.id) throw new Error(\"User not authenticated\");\n        const userId = getFirestoreUserId();\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const updatedProgressData = await _services_courseProgressService__WEBPACK_IMPORTED_MODULE_5__.markModuleComplete(userId, courseId, moduleId);\n            if (updatedProgressData) {\n                setCourseProgress((prev)=>({\n                        ...prev,\n                        [courseId]: updatedProgressData\n                    }));\n            } else {\n                console.warn(`markModuleComplete service did not return updated progress for ${courseId}.`);\n            }\n            await fetchEnrolledCourses(true);\n        } catch (error) {\n            console.error(`Failed to mark module ${moduleId} complete in course ${courseId}:`, error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to mark module complete\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        user,\n        getFirestoreUserId,\n        fetchEnrolledCourses\n    ]);\n    const markCourseComplete = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (courseId, internalCall = false)=>{\n        // Relies on user, getFirestoreUserId, fetchCourse, fetchEnrolledCourses (all memoized/stable)\n        // Relies on stable setters: setLoading, setError, setCourseProgress\n        // Relies on stable import: courseProgressService.markCourseComplete\n        if (!user?.id) throw new Error(\"User not authenticated\");\n        const userId = getFirestoreUserId();\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            const course = await fetchCourse(courseId, true);\n            const verificationCode = `CERT-${Math.random().toString(36).substring(2, 10).toUpperCase()}`;\n            const tempId = \"generating\";\n            const certificateRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, \"certificates\"), {\n                userId: userId,\n                courseId: courseId,\n                courseName: course.title,\n                userName: user.displayName || \"Learner\",\n                issueDate: new Date().toISOString(),\n                templateId: \"default\",\n                pdfUrl: `/certificates/${tempId}.pdf`,\n                thumbnailUrl: `/certificates/${tempId}.jpg`,\n                verificationCode: verificationCode,\n                status: \"active\",\n                instructor: course.instructor || null,\n                instructorTitle: course.instructorTitle || null\n            });\n            const certificateDocId = certificateRef.id;\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.updateDoc)(certificateRef, {\n                pdfUrl: `/certificates/${certificateDocId}.pdf`,\n                thumbnailUrl: `/certificates/${certificateDocId}.jpg`\n            });\n            const updatedServiceProgress = await _services_courseProgressService__WEBPACK_IMPORTED_MODULE_5__.markCourseComplete(userId, courseId, course.title);\n            setCourseProgress((prev)=>{\n                const baseProgress = updatedServiceProgress || prev[courseId] || {\n                    courseId,\n                    userId\n                };\n                return {\n                    ...prev,\n                    [courseId]: {\n                        ...baseProgress,\n                        // Use the progress values from the service rather than overriding them\n                        // This ensures we use the single source of truth from the backend\n                        certificateId: certificateDocId,\n                        certificateIssueDate: new Date().toISOString()\n                    }\n                };\n            });\n            await fetchEnrolledCourses(true);\n            return certificateDocId;\n        } catch (error) {\n            console.error(`Failed to mark course ${courseId} complete:`, error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to mark course complete\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        user,\n        getFirestoreUserId,\n        fetchCourse,\n        fetchEnrolledCourses\n    ]); // Depends on user from auth\n    const searchCourses = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (queryText, filters, internalCall = false)=>{\n        // Relies on 'courses' state variable\n        // Relies on stable setters: setLoading, setError\n        if (!internalCall) {\n            setLoading(true);\n            setError(null);\n        }\n        try {\n            let filteredResults = [\n                ...courses\n            ]; // Use the 'courses' state from CourseProvider scope\n            if (queryText) {\n                const queryLower = queryText.toLowerCase();\n                filteredResults = filteredResults.filter((course)=>course.title.toLowerCase().includes(queryLower) || course.description?.toLowerCase().includes(queryLower) || course.longDescription?.toLowerCase().includes(queryLower) || course.tags?.some((tag)=>tag.toLowerCase().includes(queryLower)));\n            }\n            if (filters) {\n                if (filters.categories && filters.categories.length > 0) {\n                    filteredResults = filteredResults.filter((c)=>c.categoryIds?.some((catId)=>filters.categories?.includes(catId)));\n                }\n                if (filters.levels && filters.levels.length > 0) {\n                    filteredResults = filteredResults.filter((c)=>filters.levels?.includes(c.level));\n                }\n                if (filters.durations && filters.durations.length > 0) {\n                    filteredResults = filteredResults.filter((c)=>{\n                        let totalSeconds = c.durationDetails?.totalSeconds;\n                        if (totalSeconds === undefined && c.duration) {\n                            const parts = c.duration.split(\" \");\n                            if (parts.length === 2) {\n                                const value = parseFloat(parts[0]);\n                                const unit = parts[1].toLowerCase();\n                                if (!isNaN(value)) {\n                                    if (unit.startsWith(\"hour\")) totalSeconds = value * 3600;\n                                    else if (unit.startsWith(\"minute\")) totalSeconds = value * 60;\n                                }\n                            }\n                        }\n                        if (totalSeconds === undefined) return false;\n                        return filters.durations?.some((fDuration)=>{\n                            if (fDuration === \"short\") return totalSeconds < 2 * 3600;\n                            if (fDuration === \"medium\") return totalSeconds >= 2 * 3600 && totalSeconds <= 4 * 3600;\n                            if (fDuration === \"long\") return totalSeconds > 4 * 3600;\n                            return false;\n                        });\n                    });\n                }\n                if (filters.priceRange && typeof filters.priceRange?.min === \"number\" && typeof filters.priceRange?.max === \"number\") {\n                    filteredResults = filteredResults.filter((c)=>{\n                        const price = c.price || 0;\n                        const isFree = c.isFree || false;\n                        if (filters.priceRange?.min === 0 && isFree) return true;\n                        return price >= (filters.priceRange?.min ?? 0) && price <= (filters.priceRange?.max ?? Infinity);\n                    });\n                }\n                if (filters.rating !== undefined && filters.rating > 0) {\n                    filteredResults = filteredResults.filter((c)=>c.rating !== undefined && c.rating >= filters.rating);\n                }\n            }\n            return filteredResults;\n        } catch (error) {\n            console.error(\"Failed to search courses:\", error);\n            const errorMessage = error instanceof Error ? error.message : \"Failed to search courses\";\n            if (!internalCall) setError(errorMessage);\n            throw new Error(errorMessage);\n        } finally{\n            if (!internalCall) setLoading(false);\n        }\n    }, [\n        courses\n    ]); // Depends only on the 'courses' state variable\n    // --- End of All Memoized Functions ---\n    // --- useEffect Hooks (should now use memoized functions if they call them) ---\n    // Fetch featured courses on mount\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const loadFeaturedCourses = async ()=>{\n            try {\n                // Calls memoized fetchCourses\n                const featuredCoursesData = await fetchCourses({\n                    featured: true,\n                    limit: 6\n                }, true);\n                setFeaturedCourses(featuredCoursesData);\n            } catch (error) {\n                console.error(\"Error loading featured courses:\", error);\n            }\n        };\n        loadFeaturedCourses();\n    }, [\n        fetchCourses\n    ]); // Dependency is the memoized fetchCourses\n    // Fetch enrolled courses when user changes\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (user?.id) {\n            // Calls memoized fetchEnrolledCourses\n            fetchEnrolledCourses(true); // Use internal call = true\n        } else {\n            setEnrolledCourses([]);\n            setCompletedCourses([]);\n            setCourseProgress({});\n        }\n    }, [\n        user?.id,\n        fetchEnrolledCourses\n    ]); // Dependencies are user.id and the memoized fetchEnrolledCourses\n    // --- contextValue wrapped in useMemo ---\n    const contextValue = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>{\n        // console.log(\"[CourseContext] Recalculating contextValue\"); // Keep commented unless debugging\n        return {\n            // State values\n            courses,\n            enrolledCourses,\n            completedCourses,\n            featuredCourses,\n            courseProgress,\n            loading,\n            error,\n            // Memoized functions\n            fetchCourses,\n            fetchCourse,\n            fetchEnrolledCourses,\n            fetchCompletedCourses,\n            enrollInCourse,\n            unenrollFromCourse,\n            updateCourseProgress,\n            markModuleComplete,\n            markCourseComplete,\n            fetchCourseProgress,\n            searchCourses\n        };\n    }, [\n        // State dependencies\n        courses,\n        enrolledCourses,\n        completedCourses,\n        featuredCourses,\n        courseProgress,\n        loading,\n        error,\n        // Function dependencies (now stable references)\n        fetchCourses,\n        fetchCourse,\n        fetchEnrolledCourses,\n        fetchCompletedCourses,\n        enrollInCourse,\n        unenrollFromCourse,\n        updateCourseProgress,\n        markModuleComplete,\n        markCourseComplete,\n        fetchCourseProgress,\n        searchCourses\n    ]);\n    // --- Provider Return ---\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(CourseContext.Provider, {\n        value: contextValue,\n        children: children\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\context\\\\CourseContext.tsx\",\n        lineNumber: 664,\n        columnNumber: 5\n    }, undefined);\n}; // End of CourseProvider Component\n// --- useCourses Hook (remains the same) ---\nconst useCourses = ()=>{\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(CourseContext);\n    if (!context) {\n        throw new Error(\"useCourses must be used within a CourseProvider\");\n    }\n    return context;\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MENBQTBDO0lBQzFDLE1BQU1xSixlQUFlM04sOENBQU9BLENBQUM7UUFDM0IsZ0dBQWdHO1FBQ2hHLE9BQU87WUFDTCxlQUFlO1lBQ2Z1QjtZQUNBRTtZQUNBRTtZQUNBRTtZQUNBRTtZQUNBRTtZQUNBRTtZQUNBLHFCQUFxQjtZQUNyQmdCO1lBQ0FUO1lBQ0E0QjtZQUNBcUM7WUFDQU87WUFDQWlDO1lBQ0FFO1lBQ0FXO1lBQ0FDO1lBQ0FqRztZQUNBcUg7UUFDSjtJQUNGLEdBQUc7UUFDQyxxQkFBcUI7UUFDckI5SjtRQUFTRTtRQUFpQkU7UUFBa0JFO1FBQWlCRTtRQUFnQkU7UUFBU0U7UUFDdEYsZ0RBQWdEO1FBQ2hEZ0I7UUFBY1Q7UUFBYTRCO1FBQXNCcUM7UUFBdUJPO1FBQ3hFaUM7UUFBb0JFO1FBQXNCVztRQUFvQkM7UUFDOURqRztRQUFxQnFIO0tBQ3RCO0lBRUQsMEJBQTBCO0lBQzFCLHFCQUNFLDhEQUFDbkssY0FBYzBNLFFBQVE7UUFBQ2hCLE9BQU9lO2tCQUM1QnRNOzs7Ozs7QUFJUCxFQUFFLENBQUMsa0NBQWtDO0FBRXJDLDZDQUE2QztBQUN0QyxNQUFNd00sYUFBYTtJQUN4QixNQUFNQyxVQUFVak8saURBQVVBLENBQUNxQjtJQUMzQixJQUFJLENBQUM0TSxTQUFTO1FBQ1osTUFBTSxJQUFJckwsTUFBTTtJQUNwQjtJQUNFLE9BQU9xTDtBQUNULEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmFpbmluZy1wbGF0Zm9ybS8uL3NyYy9jb250ZXh0L0NvdXJzZUNvbnRleHQudHN4PzhhY2IiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7Y3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7IC8vIEFkZGVkIHVzZUNhbGxiYWNrLCB1c2VNZW1vXG5pbXBvcnQge1xuICBjb2xsZWN0aW9uLFxuICBkb2MsXG4gIGdldERvYyxcbiAgZ2V0RG9jcyxcbiAgcXVlcnksXG4gIHdoZXJlLFxuICB1cGRhdGVEb2MsXG4gIHNldERvYyxcbiAgYWRkRG9jLFxuICBkZWxldGVEb2MsXG4gIG9yZGVyQnksXG4gIGxpbWl0LFxuICBzdGFydEFmdGVyLCAgICAgICAgIC8vIEtlcHQgZnJvbSB5b3VyIHNuaXBwZXRcbiAgRG9jdW1lbnREYXRhLFxuICBRdWVyeURvY3VtZW50U25hcHNob3QsXG4gIFRpbWVzdGFtcCwgICAgICAgICAgLy8gS2VwdCBmcm9tIHlvdXIgc25pcHBldFxuICBRdWVyeUNvbnN0cmFpbnQsXG59IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7XG5pbXBvcnQge2ZpcmVzdG9yZSB9IGZyb20gJ0Avc2VydmljZXMvZmlyZWJhc2UnO1xuaW1wb3J0IHtcbiAgQ291cnNlLFxuICBDb3Vyc2VQcm9ncmVzcyxcbiAgQ291cnNlRW5yb2xsbWVudCxcbiAgQ291cnNlTGV2ZWwsXG4gIENvdXJzZUR1cmF0aW9uLCAgICAgLy8gS2VwdCBmcm9tIHlvdXIgc25pcHBldFxuICBNb2R1bGUsICAgICAgICAgICAgIC8vIEtlcHQgZnJvbSB5b3VyIHNuaXBwZXRcbn0gZnJvbSAnQC90eXBlcy9jb3Vyc2UudHlwZXMnO1xuaW1wb3J0IHt1c2VBdXRoIH0gZnJvbSAnLi9BdXRoQ29udGV4dCc7IC8vIEFzc3VtaW5nIEF1dGhDb250ZXh0IGlzIGFscmVhZHkgc3RhYmlsaXplZFxuaW1wb3J0ICogYXMgY291cnNlUHJvZ3Jlc3NTZXJ2aWNlIGZyb20gJ0Avc2VydmljZXMvY291cnNlUHJvZ3Jlc3NTZXJ2aWNlJztcbmltcG9ydCB7dmVyaWZ5QWxsTW9kdWxlTGVzc29uQ291bnRzIH0gZnJvbSAnQC9zZXJ2aWNlcy9tb2R1bGVTZXJ2aWNlJztcbmltcG9ydCB7dXNlUXVlcnksIHVzZU11dGF0aW9uLCB1c2VRdWVyeUNsaWVudCB9IGZyb20gJ0B0YW5zdGFjay9yZWFjdC1xdWVyeSc7IC8vIEtlcHQgZnJvbSB5b3VyIHNuaXBwZXRcblxuLy8gRGVmaW5lIGludGVyZmFjZXMgKGFscmVhZHkgcHJvdmlkZWQgYW5kIHJldmlld2VkKVxuaW50ZXJmYWNlIENvdXJzZUNvbnRleHRUeXBlIHtcbiAgY291cnNlczogQ291cnNlW107XG4gIGVucm9sbGVkQ291cnNlczogQ291cnNlW107XG4gIGNvbXBsZXRlZENvdXJzZXM6IENvdXJzZVtdO1xuICBmZWF0dXJlZENvdXJzZXM6IENvdXJzZVtdO1xuICBjb3Vyc2VQcm9ncmVzczogUmVjb3JkPHN0cmluZywgQ291cnNlUHJvZ3Jlc3M+O1xuICBsb2FkaW5nOiBib29sZWFuO1xuICBlcnJvcjogc3RyaW5nIHwgbnVsbDtcbiAgZmV0Y2hDb3Vyc2VzOiAob3B0aW9ucz86IEZldGNoQ291cnNlc09wdGlvbnMsIGludGVybmFsQ2FsbD86IGJvb2xlYW4pID0+IFByb21pc2U8Q291cnNlW10+O1xuICBmZXRjaENvdXJzZTogKGNvdXJzZUlkOiBzdHJpbmcsIGludGVybmFsQ2FsbD86IGJvb2xlYW4pID0+IFByb21pc2U8Q291cnNlPjtcbiAgZmV0Y2hFbnJvbGxlZENvdXJzZXM6IChpbnRlcm5hbENhbGw/OiBib29sZWFuKSA9PiBQcm9taXNlPENvdXJzZVtdPjtcbiAgZmV0Y2hDb21wbGV0ZWRDb3Vyc2VzOiAoaW50ZXJuYWxDYWxsPzogYm9vbGVhbikgPT4gUHJvbWlzZTxDb3Vyc2VbXT47XG4gIGVucm9sbEluQ291cnNlOiAoY291cnNlSWQ6IHN0cmluZywgaW50ZXJuYWxDYWxsPzogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPjtcbiAgdW5lbnJvbGxGcm9tQ291cnNlOiAoY291cnNlSWQ6IHN0cmluZywgaW50ZXJuYWxDYWxsPzogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPjtcbiAgdXBkYXRlQ291cnNlUHJvZ3Jlc3M6IChjb3Vyc2VJZDogc3RyaW5nLCBsZXNzb25JZDogc3RyaW5nLCBjb21wbGV0ZWQ6IGJvb2xlYW4sIGludGVybmFsQ2FsbD86IGJvb2xlYW4pID0+IFByb21pc2U8dm9pZD47XG4gIG1hcmtNb2R1bGVDb21wbGV0ZTogKGNvdXJzZUlkOiBzdHJpbmcsIG1vZHVsZUlkOiBzdHJpbmcsIGludGVybmFsQ2FsbD86IGJvb2xlYW4pID0+IFByb21pc2U8dm9pZD47XG4gIG1hcmtDb3Vyc2VDb21wbGV0ZTogKGNvdXJzZUlkOiBzdHJpbmcsIGludGVybmFsQ2FsbD86IGJvb2xlYW4pID0+IFByb21pc2U8c3RyaW5nPjtcbiAgZmV0Y2hDb3Vyc2VQcm9ncmVzczogKGNvdXJzZUlkOiBzdHJpbmcpID0+IFByb21pc2U8Q291cnNlUHJvZ3Jlc3MgfCBudWxsPjtcbiAgc2VhcmNoQ291cnNlczogKHF1ZXJ5VGV4dDogc3RyaW5nLCBmaWx0ZXJzPzogQ291cnNlRmlsdGVycywgaW50ZXJuYWxDYWxsPzogYm9vbGVhbikgPT4gUHJvbWlzZTxDb3Vyc2VbXT47IC8vIFJlbmFtZWQgcXVlcnkgdG8gcXVlcnlUZXh0XG59XG5cbmludGVyZmFjZSBGZXRjaENvdXJzZXNPcHRpb25zIHtcbiAgY2F0ZWdvcnk/OiBzdHJpbmc7XG4gIGxldmVsPzogQ291cnNlTGV2ZWw7XG4gIGxpbWl0PzogbnVtYmVyO1xuICBsYXN0VmlzaWJsZT86IFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdDxEb2N1bWVudERhdGE+O1xuICBmZWF0dXJlZD86IGJvb2xlYW47XG4gIHN0YXR1cz86ICdkcmFmdCcgfCAncHVibGlzaGVkJztcbiAgdmVyaWZ5TW9kdWxlTGVzc29uQ291bnRzPzogYm9vbGVhbjtcbiAgY291cnNlSWQ/OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBDb3Vyc2VGaWx0ZXJzIHtcbiAgY2F0ZWdvcmllcz86IHN0cmluZ1tdO1xuICBsZXZlbHM/OiBDb3Vyc2VMZXZlbFtdO1xuICBkdXJhdGlvbnM/OiAoJ3Nob3J0JyB8ICdtZWRpdW0nIHwgJ2xvbmcnKVtdO1xuICBwcmljZVJhbmdlPzoge21pbjogbnVtYmVyOyBtYXg6IG51bWJlciB9O1xuICByYXRpbmc/OiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBDb3Vyc2VQcm92aWRlclByb3BzIHtcbiAgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZTtcbn1cblxuZXhwb3J0IGNvbnN0IENvdXJzZUNvbnRleHQgPSBjcmVhdGVDb250ZXh0PENvdXJzZUNvbnRleHRUeXBlIHwgdW5kZWZpbmVkPih1bmRlZmluZWQpO1xuXG5leHBvcnQgY29uc3QgQ291cnNlUHJvdmlkZXI6IFJlYWN0LkZDPENvdXJzZVByb3ZpZGVyUHJvcHM+ID0gKHtjaGlsZHJlbiB9KSA9PiB7XG4gIGNvbnN0IHt1c2VyIH0gPSB1c2VBdXRoKCk7IC8vIEFzc3VtaW5nIHVzZUF1dGgoKSBwcm92aWRlcyBhIHN0YWJsZSAndXNlcicgb2JqZWN0XG4gIGNvbnN0IFtjb3Vyc2VzLCBzZXRDb3Vyc2VzXSA9IHVzZVN0YXRlPENvdXJzZVtdPihbXSk7XG4gIGNvbnN0IFtlbnJvbGxlZENvdXJzZXMsIHNldEVucm9sbGVkQ291cnNlc10gPSB1c2VTdGF0ZTxDb3Vyc2VbXT4oW10pO1xuICBjb25zdCBbY29tcGxldGVkQ291cnNlcywgc2V0Q29tcGxldGVkQ291cnNlc10gPSB1c2VTdGF0ZTxDb3Vyc2VbXT4oW10pO1xuICBjb25zdCBbZmVhdHVyZWRDb3Vyc2VzLCBzZXRGZWF0dXJlZENvdXJzZXNdID0gdXNlU3RhdGU8Q291cnNlW10+KFtdKTtcbiAgY29uc3QgW2NvdXJzZVByb2dyZXNzLCBzZXRDb3Vyc2VQcm9ncmVzc10gPSB1c2VTdGF0ZTxSZWNvcmQ8c3RyaW5nLCBDb3Vyc2VQcm9ncmVzcz4+KHt9KTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBxdWVyeUNsaWVudCA9IHVzZVF1ZXJ5Q2xpZW50KCk7IC8vIEZyb20geW91ciBzbmlwcGV0XG5cbiAgLy8gLS0tIFNUQVJUIE9GIE1FTU9JWkVEIEZVTkNUSU9OUyAoT3JkZXIgTWF0dGVycykgLS0tXG5cbiAgY29uc3QgZ2V0RmlyZXN0b3JlVXNlcklkID0gdXNlQ2FsbGJhY2soKCk6IHN0cmluZyA9PiB7XG4gICAgLy8gUmVsaWVzIG9uICd1c2VyJyBmcm9tIHVzZUF1dGhcbiAgICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F0dGVtcHRlZCBGaXJlc3RvcmUgb3BlcmF0aW9uIHdpdGhvdXQgYXV0aGVudGljYXRlZCB1c2VyIElELicpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkIGZvciB0aGlzIG9wZXJhdGlvbicpO1xuICB9XG4gICAgcmV0dXJuIHVzZXIuaWQ7XG59LCBbdXNlcl0pO1xuXG4gIC8vIERlZmluZSBmZXRjaENvdXJzZSBlYXJseSBhcyBpdCdzIGEgY29tbW9uIGRlcGVuZGVuY3lcbiAgY29uc3QgZmV0Y2hDb3Vyc2UgPSB1c2VDYWxsYmFjayhhc3luYyAoY291cnNlSWQ6IHN0cmluZywgaW50ZXJuYWxDYWxsOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPENvdXJzZT4gPT4ge1xuICAgIC8vIFJlbGllcyBvbiBzZXRMb2FkaW5nLCBzZXRFcnJvciAoc3RhYmxlIHN0YXRlIHNldHRlcnMpXG4gICAgLy8gUmVsaWVzIG9uIHZlcmlmeUFsbE1vZHVsZUxlc3NvbkNvdW50cyAoc3RhYmxlIGltcG9ydClcbiAgICBpZiAoIWludGVybmFsQ2FsbCkge1xuICAgICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICAgIHNldEVycm9yKG51bGwpO1xuICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvdXJzZURvYyA9IGF3YWl0IGdldERvYyhkb2MoZmlyZXN0b3JlLCAnY291cnNlcycsIGNvdXJzZUlkKSk7XG4gICAgICBpZiAoIWNvdXJzZURvYy5leGlzdHMoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdXJzZSBub3QgZm91bmQnKTtcbiAgICB9XG4gICAgICBjb25zdCBjb3Vyc2VEYXRhID0gY291cnNlRG9jLmRhdGEoKSBhcyBDb3Vyc2U7XG4gICAgICByZXR1cm4gey4uLmNvdXJzZURhdGEsIGlkOiBjb3Vyc2VEb2MuaWQgfSBhcyBDb3Vyc2U7XG4gIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggY291cnNlICR7Y291cnNlSWR9OmAsIGVycm9yKTtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBjb3Vyc2UnO1xuICAgICAgaWYgKCFpbnRlcm5hbENhbGwpIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfSBmaW5hbGx5IHtcbiAgICAgIGlmICghaW50ZXJuYWxDYWxsKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgfVxufSwgW10pOyAvLyBEZXBlbmRlbmNpZXM6IFN0YWJsZSBzZXR0ZXJzLCBzdGFibGUgaW1wb3J0c1xuXG4gIC8vIERlZmluZSBmZXRjaENvdXJzZXNcbiAgY29uc3QgZmV0Y2hDb3Vyc2VzID0gdXNlQ2FsbGJhY2soYXN5bmMgKG9wdGlvbnM/OiBGZXRjaENvdXJzZXNPcHRpb25zLCBpbnRlcm5hbENhbGw6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8Q291cnNlW10+ID0+IHtcbiAgICAvLyBSZWxpZXMgb24gc2V0TG9hZGluZywgc2V0RXJyb3IsIHNldENvdXJzZXMgKHN0YWJsZSBzdGF0ZSBzZXR0ZXJzKVxuICAgIC8vIFJlbGllcyBvbiB2ZXJpZnlBbGxNb2R1bGVMZXNzb25Db3VudHMgKHN0YWJsZSBpbXBvcnQpXG4gICAgaWYgKCFpbnRlcm5hbENhbGwpIHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgfVxuICAgIHRyeSB7XG4gICAgICBpZiAob3B0aW9ucz8udmVyaWZ5TW9kdWxlTGVzc29uQ291bnRzICYmIG9wdGlvbnMuY291cnNlSWQpIHtcbiAgICAgICAgYXdhaXQgdmVyaWZ5QWxsTW9kdWxlTGVzc29uQ291bnRzKG9wdGlvbnMuY291cnNlSWQpO1xuICAgIH1cbiAgICAgIGNvbnN0IGNvdXJzZXNRdWVyeUJ1aWxkZXIgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ2NvdXJzZXMnKTtcbiAgICAgIGNvbnN0IGNvbnN0cmFpbnRzOiBRdWVyeUNvbnN0cmFpbnRbXSA9IFtdO1xuICAgICAgaWYgKG9wdGlvbnM/LnN0YXR1cykge1xuICAgICAgICBjb25zdHJhaW50cy5wdXNoKHdoZXJlKCdzdGF0dXMnLCAnPT0nLCBvcHRpb25zLnN0YXR1cykpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0cmFpbnRzLnB1c2god2hlcmUoJ3N0YXR1cycsICc9PScsICdwdWJsaXNoZWQnKSk7XG4gICAgfVxuICAgICAgaWYgKG9wdGlvbnM/LmZlYXR1cmVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3RyYWludHMucHVzaCh3aGVyZSgnZmVhdHVyZWQnLCAnPT0nLCBvcHRpb25zLmZlYXR1cmVkKSk7XG4gICAgfVxuICAgICAgY29uc3RyYWludHMucHVzaChvcmRlckJ5KCd0aXRsZScsICdhc2MnKSk7XG4gICAgICBpZiAob3B0aW9ucz8ubGltaXQgJiYgdHlwZW9mIG9wdGlvbnMubGltaXQgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGNvbnN0cmFpbnRzLnB1c2gobGltaXQob3B0aW9ucy5saW1pdCkpO1xuICAgIH1cbiAgICAgIGNvbnN0IGZpbmFsUXVlcnkgPSBxdWVyeShjb3Vyc2VzUXVlcnlCdWlsZGVyLCAuLi5jb25zdHJhaW50cyk7XG4gICAgICBjb25zdCBxdWVyeVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhmaW5hbFF1ZXJ5KTtcbiAgICAgIGNvbnN0IGZldGNoZWRDb3Vyc2VzRGF0YTogQ291cnNlW10gPSBbXTtcbiAgICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jU25hcCkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gZG9jU25hcC5kYXRhKCkgYXMgQ291cnNlO1xuICAgICAgICBmZXRjaGVkQ291cnNlc0RhdGEucHVzaCh7aWQ6IGRvY1NuYXAuaWQsIC4uLmRhdGEgfSBhcyBDb3Vyc2UpO1xuICAgIH0pO1xuICAgICAgaWYgKCFvcHRpb25zPy5mZWF0dXJlZCkge1xuICAgICAgICBzZXRDb3Vyc2VzKGZldGNoZWRDb3Vyc2VzRGF0YSk7XG4gICAgfVxuICAgICAgcmV0dXJuIGZldGNoZWRDb3Vyc2VzRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBjb3Vyc2VzOicsIGVycm9yKTtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBjb3Vyc2VzJztcbiAgICAgIGlmICghaW50ZXJuYWxDYWxsKSBzZXRFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gIH0gZmluYWxseSB7XG4gICAgICBpZiAoIWludGVybmFsQ2FsbCkgc2V0TG9hZGluZyhmYWxzZSk7XG4gIH1cbn0sIFtdKTsgLy8gRGVwZW5kZW5jaWVzOiBTdGFibGUgc2V0dGVycywgc3RhYmxlIGltcG9ydHNcblxuICAvLyBEZWZpbmUgZmV0Y2hDb3Vyc2VQcm9ncmVzc1xuICBjb25zdCBmZXRjaENvdXJzZVByb2dyZXNzID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPENvdXJzZVByb2dyZXNzIHwgbnVsbD4gPT4ge1xuICAgIC8vIFJlbGllcyBvbiB1c2VyLCBnZXRGaXJlc3RvcmVVc2VySWQgKG1lbW9pemVkKSwgc2V0Q291cnNlUHJvZ3Jlc3MgKHN0YWJsZSlcbiAgICAvLyBSZWxpZXMgb24gY291cnNlUHJvZ3Jlc3NTZXJ2aWNlLmdldENvdXJzZVByb2dyZXNzIChzdGFibGUgaW1wb3J0KVxuICAgIGlmICghdXNlcj8uaWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICB9XG4gICAgY29uc3QgdXNlcklkID0gZ2V0RmlyZXN0b3JlVXNlcklkKCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2dyZXNzID0gYXdhaXQgY291cnNlUHJvZ3Jlc3NTZXJ2aWNlLmdldENvdXJzZVByb2dyZXNzKHVzZXJJZCwgY291cnNlSWQpO1xuICAgICAgaWYgKHByb2dyZXNzKSB7XG4gICAgICAgIHNldENvdXJzZVByb2dyZXNzKHByZXYgPT4gKHsuLi5wcmV2LCBbY291cnNlSWRdOiBwcm9ncmVzcyB9KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2V0Q291cnNlUHJvZ3Jlc3MocHJldiA9PiB7XG4gICAgICAgICAgY29uc3QgbmV3U3RhdGUgPSB7Li4ucHJldiB9O1xuICAgICAgICAgIGRlbGV0ZSBuZXdTdGF0ZVtjb3Vyc2VJZF07XG4gICAgICAgICAgcmV0dXJuIG5ld1N0YXRlO1xuICAgICAgfSk7XG4gICAgfVxuICAgICAgcmV0dXJuIHByb2dyZXNzO1xuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQnO1xuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGZldGNoaW5nIGNvdXJzZSBwcm9ncmVzcyBmb3IgJHtjb3Vyc2VJZH06YCwgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59LCBbdXNlciwgZ2V0RmlyZXN0b3JlVXNlcklkXSk7XG5cbiAgLy8gLS0tIEVuZCBvZiBQYXJ0IDEgLS0tXG5cbiAgICAvLyAtLS0gQ29udGludWF0aW9uIGZyb20gUGFydCAxIC0tLVxuICAvLyBmZXRjaENvdXJzZVByb2dyZXNzIHdhcyB0aGUgbGFzdCBmdW5jdGlvbiBpbiBQYXJ0IDFcblxuICAvLyAtLS0gUGFydCAyIEZ1bmN0aW9ucyAtLS1cblxuICBjb25zdCBmZXRjaEVucm9sbGVkQ291cnNlcyA9IHVzZUNhbGxiYWNrKGFzeW5jIChpbnRlcm5hbENhbGw6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8Q291cnNlW10+ID0+IHtcbiAgICAvLyBSZWxpZXMgb24gdXNlciwgZ2V0RmlyZXN0b3JlVXNlcklkLCBmZXRjaENvdXJzZSwgZmV0Y2hDb3Vyc2VQcm9ncmVzcyAoYWxsIG1lbW9pemVkL3N0YWJsZSlcbiAgICAvLyBSZWxpZXMgb24gc3RhYmxlIHNldHRlcnM6IHNldEVucm9sbGVkQ291cnNlcywgc2V0Q29tcGxldGVkQ291cnNlcywgc2V0Q291cnNlUHJvZ3Jlc3MsIHNldExvYWRpbmcsIHNldEVycm9yXG4gICAgaWYgKCF1c2VyPy5pZCkge1xuICAgICAgc2V0RW5yb2xsZWRDb3Vyc2VzKFtdKTtcbiAgICAgIHNldENvbXBsZXRlZENvdXJzZXMoW10pO1xuICAgICAgc2V0Q291cnNlUHJvZ3Jlc3Moe30pO1xuICAgICAgcmV0dXJuIFtdO1xuICB9XG4gICAgY29uc3QgdXNlcklkID0gZ2V0RmlyZXN0b3JlVXNlcklkKCk7XG4gICAgaWYgKCFpbnRlcm5hbENhbGwpIHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBlbnJvbGxtZW50c1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCBgdXNlcnMvJHt1c2VySWR9L2Vucm9sbG1lbnRzYCk7XG4gICAgICBjb25zdCBlbnJvbGxtZW50c1F1ZXJ5ID0gcXVlcnkoZW5yb2xsbWVudHNSZWYsIHdoZXJlKCdzdGF0dXMnLCAnPT0nLCAnYWN0aXZlJyksIG9yZGVyQnkoJ2Vucm9sbGVkQXQnLCAnZGVzYycpKTtcbiAgICAgIGNvbnN0IGVucm9sbG1lbnRzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGVucm9sbG1lbnRzUXVlcnkpO1xuICAgICAgY29uc3QgZW5yb2xsbWVudHMgPSBlbnJvbGxtZW50c1NuYXBzaG90LmRvY3MubWFwKGQgPT4gKHsuLi4oZC5kYXRhKCkgYXMgQ291cnNlRW5yb2xsbWVudCksIGVucm9sbG1lbnRJZDogZC5pZCB9KSk7XG4gICAgICBjb25zdCB1bmlxdWVFbnJvbGxtZW50c0J5Q291cnNlSWQgPSBBcnJheS5mcm9tKFxuICAgICAgICBlbnJvbGxtZW50cy5yZWR1Y2UoKG1hcCwgZW5yb2xsbWVudCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRW5yb2xsbWVudCA9IG1hcC5nZXQoZW5yb2xsbWVudC5jb3Vyc2VJZCk7XG4gICAgICAgICAgaWYgKCFleGlzdGluZ0Vucm9sbG1lbnQgfHwgKGVucm9sbG1lbnQuZW5yb2xsZWRBdCAmJiBleGlzdGluZ0Vucm9sbG1lbnQuZW5yb2xsZWRBdCAmJiBuZXcgRGF0ZShlbnJvbGxtZW50LmVucm9sbGVkQXQpID4gbmV3IERhdGUoZXhpc3RpbmdFbnJvbGxtZW50LmVucm9sbGVkQXQpKSkge1xuICAgICAgICAgICAgbWFwLnNldChlbnJvbGxtZW50LmNvdXJzZUlkLCBlbnJvbGxtZW50KTtcbiAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBtYXA7XG4gICAgICB9LCBuZXcgTWFwPHN0cmluZywgQ291cnNlRW5yb2xsbWVudCAmIHtlbnJvbGxtZW50SWQ6IHN0cmluZyB9PigpKS52YWx1ZXMoKVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcHJvZ3Jlc3NQcm9taXNlcyA9IHVuaXF1ZUVucm9sbG1lbnRzQnlDb3Vyc2VJZC5tYXAoZSA9PiBmZXRjaENvdXJzZVByb2dyZXNzKGUuY291cnNlSWQpKTtcbiAgICAgIGNvbnN0IHByb2dyZXNzUmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHByb2dyZXNzUHJvbWlzZXMpO1xuICAgICAgY29uc3QgdGVtcFByb2dyZXNzTWFwOiBSZWNvcmQ8c3RyaW5nLCBDb3Vyc2VQcm9ncmVzcz4gPSB7fTtcbiAgICAgIHByb2dyZXNzUmVzdWx0cy5mb3JFYWNoKHAgPT4ge2lmIChwKSB7dGVtcFByb2dyZXNzTWFwW3AuY291cnNlSWRdID0gcDsgfSB9KTtcblxuICAgICAgY29uc3QgZW5yb2xsZWRDb3Vyc2VzRGV0YWlsc1Byb21pc2VzID0gdW5pcXVlRW5yb2xsbWVudHNCeUNvdXJzZUlkLm1hcChhc3luYyBlID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjb3Vyc2UgPSBhd2FpdCBmZXRjaENvdXJzZShlLmNvdXJzZUlkLCB0cnVlKTtcbiAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9IHRlbXBQcm9ncmVzc01hcFtjb3Vyc2UuaWRdO1xuICAgICAgICAgIHJldHVybiB7Li4uY291cnNlLCBwcm9ncmVzczogcHJvZ3Jlc3M/Lm92ZXJhbGxQcm9ncmVzcyB8fCAwIH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGZldGNoaW5nIGRldGFpbHMgZm9yIGVucm9sbGVkIGNvdXJzZSAke2UuY291cnNlSWR9IGluIGZldGNoRW5yb2xsZWRDb3Vyc2VzOmAsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH0pO1xuICAgICAgY29uc3QgZmluYWxFbnJvbGxlZENvdXJzZXMgPSAoYXdhaXQgUHJvbWlzZS5hbGwoZW5yb2xsZWRDb3Vyc2VzRGV0YWlsc1Byb21pc2VzKSkuZmlsdGVyKChjKTogYyBpcyBDb3Vyc2UgJiB7cHJvZ3Jlc3M6IG51bWJlciB9ID0+IGMgIT09IHVuZGVmaW5lZCk7XG5cbiAgICAgIGNvbnN0IGNvbXBsZXRlZDogKENvdXJzZSAmIHtwcm9ncmVzczogbnVtYmVyIH0pW10gPSBbXTtcbiAgICAgIGNvbnN0IGluUHJvZ3Jlc3M6IChDb3Vyc2UgJiB7cHJvZ3Jlc3M6IG51bWJlciB9KVtdID0gW107XG4gICAgICBmaW5hbEVucm9sbGVkQ291cnNlcy5mb3JFYWNoKGMgPT4geyhjLnByb2dyZXNzID09PSAxMDAgPyBjb21wbGV0ZWQucHVzaChjKSA6IGluUHJvZ3Jlc3MucHVzaChjKSk7IH0pO1xuXG4gICAgICBzZXRFbnJvbGxlZENvdXJzZXMoaW5Qcm9ncmVzcyk7XG4gICAgICBzZXRDb21wbGV0ZWRDb3Vyc2VzKGNvbXBsZXRlZCk7XG4gICAgICBzZXRDb3Vyc2VQcm9ncmVzcyhwcmV2R2xvYmFsUHJvZ3Jlc3MgPT4gKHsuLi5wcmV2R2xvYmFsUHJvZ3Jlc3MsIC4uLnRlbXBQcm9ncmVzc01hcCB9KSk7XG4gICAgICByZXR1cm4gZmluYWxFbnJvbGxlZENvdXJzZXM7XG4gIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBlbnJvbGxlZCBjb3Vyc2VzOicsIGVycm9yKTtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBlbnJvbGxlZCBjb3Vyc2VzJztcbiAgICAgIGlmKCFpbnRlcm5hbENhbGwpIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfSBmaW5hbGx5IHtcbiAgICAgIGlmICghaW50ZXJuYWxDYWxsKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgfVxufSwgW3VzZXIsIGdldEZpcmVzdG9yZVVzZXJJZCwgZmV0Y2hDb3Vyc2UsIGZldGNoQ291cnNlUHJvZ3Jlc3NdKTtcblxuICBjb25zdCBmZXRjaENvbXBsZXRlZENvdXJzZXMgPSB1c2VDYWxsYmFjayhhc3luYyAoaW50ZXJuYWxDYWxsOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPENvdXJzZVtdPiA9PiB7XG4gICAgLy8gUmVsaWVzIG9uIHVzZXIsIGdldEZpcmVzdG9yZVVzZXJJZCwgZmV0Y2hDb3Vyc2UgKGFsbCBtZW1vaXplZC9zdGFibGUpXG4gICAgLy8gUmVsaWVzIG9uIHN0YWJsZSBzZXR0ZXJzOiBzZXRDb21wbGV0ZWRDb3Vyc2VzLCBzZXRMb2FkaW5nLCBzZXRFcnJvclxuICAgIGlmICghdXNlcj8uaWQpIHtcbiAgICAgIHNldENvbXBsZXRlZENvdXJzZXMoW10pO1xuICAgICAgcmV0dXJuIFtdO1xuICB9XG4gICAgY29uc3QgdXNlcklkID0gZ2V0RmlyZXN0b3JlVXNlcklkKCk7XG4gICAgaWYgKCFpbnRlcm5hbENhbGwpIHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcm9ncmVzc1EgPSBxdWVyeShjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ2NvdXJzZVByb2dyZXNzJyksIHdoZXJlKCd1c2VySWQnLCAnPT0nLCB1c2VySWQpLCB3aGVyZSgnY29tcGxldGVkJywgJz09JywgdHJ1ZSksIG9yZGVyQnkoJ2NvbXBsZXRlZERhdGUnLCAnZGVzYycpKTtcbiAgICAgIGNvbnN0IHByb2dyZXNzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHByb2dyZXNzUSk7XG4gICAgICBjb25zdCBjb21wbGV0ZWRQcm9ncmVzc0RvY3MgPSBwcm9ncmVzc1NuYXBzaG90LmRvY3MubWFwKGQgPT4gZC5kYXRhKCkgYXMgQ291cnNlUHJvZ3Jlc3MpO1xuICAgICAgY29uc3QgY29tcGxldGVkQ291cnNlc1Byb21pc2VzID0gY29tcGxldGVkUHJvZ3Jlc3NEb2NzLm1hcChhc3luYyBwcm9ncmVzc0l0ZW0gPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IGNvdXJzZSA9IGF3YWl0IGZldGNoQ291cnNlKHByb2dyZXNzSXRlbS5jb3Vyc2VJZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgIHJldHVybiB7Li4uY291cnNlLCBwcm9ncmVzczogMTAwIH0gYXMgQ291cnNlICYge3Byb2dyZXNzOiBudW1iZXIgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZmV0Y2hpbmcgZGV0YWlscyBmb3IgY29tcGxldGVkIGNvdXJzZSAke3Byb2dyZXNzSXRlbS5jb3Vyc2VJZH06YCwgZXJyb3IpO1xuICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgICBjb25zdCBjb21wbGV0ZWRDb3Vyc2VzRGF0YSA9IChhd2FpdCBQcm9taXNlLmFsbChjb21wbGV0ZWRDb3Vyc2VzUHJvbWlzZXMpKS5maWx0ZXIoKGMpOiBjIGlzIENvdXJzZSAmIHtwcm9ncmVzczogbnVtYmVyIH0gPT4gYyAhPT0gdW5kZWZpbmVkKTtcbiAgICAgIHNldENvbXBsZXRlZENvdXJzZXMoY29tcGxldGVkQ291cnNlc0RhdGEpO1xuICAgICAgcmV0dXJuIGNvbXBsZXRlZENvdXJzZXNEYXRhO1xuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY29tcGxldGVkIGNvdXJzZXM6JywgZXJyb3IpO1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGZldGNoIGNvbXBsZXRlZCBjb3Vyc2VzJztcbiAgICAgIGlmKCFpbnRlcm5hbENhbGwpIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfSBmaW5hbGx5IHtcbiAgICAgIGlmICghaW50ZXJuYWxDYWxsKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgfVxufSwgW3VzZXIsIGdldEZpcmVzdG9yZVVzZXJJZCwgZmV0Y2hDb3Vyc2VdKTtcblxuICBjb25zdCBlbnJvbGxJbkNvdXJzZSA9IHVzZUNhbGxiYWNrKGFzeW5jIChjb3Vyc2VJZDogc3RyaW5nLCBpbnRlcm5hbENhbGw6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIC8vIFJlbGllcyBvbiB1c2VyLCBnZXRGaXJlc3RvcmVVc2VySWQsIGZldGNoQ291cnNlLCBmZXRjaEVucm9sbGVkQ291cnNlcyAoYWxsIG1lbW9pemVkL3N0YWJsZSlcbiAgICAvLyBSZWxpZXMgb24gc3RhYmxlIHNldHRlcnM6IHNldExvYWRpbmcsIHNldEVycm9yXG4gICAgaWYgKCF1c2VyPy5pZCkgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkJyk7XG4gICAgY29uc3QgdXNlcklkID0gZ2V0RmlyZXN0b3JlVXNlcklkKCk7XG4gICAgaWYgKCFpbnRlcm5hbENhbGwpIHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBlbnJvbGxtZW50c1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCBgdXNlcnMvJHt1c2VySWR9L2Vucm9sbG1lbnRzYCk7XG4gICAgICBjb25zdCBlbnJvbGxtZW50UXVlcnkgPSBxdWVyeShlbnJvbGxtZW50c1JlZiwgd2hlcmUoJ2NvdXJzZUlkJywgJz09JywgY291cnNlSWQpKTtcbiAgICAgIGNvbnN0IGVucm9sbG1lbnRTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoZW5yb2xsbWVudFF1ZXJ5KTtcblxuICAgICAgaWYgKCFlbnJvbGxtZW50U25hcHNob3QuZW1wdHkpIHtcbiAgICAgICAgY29uc3QgZW5yb2xsbWVudERvYyA9IGVucm9sbG1lbnRTbmFwc2hvdC5kb2NzWzBdO1xuICAgICAgICBjb25zdCBlbnJvbGxtZW50RGF0YSA9IGVucm9sbG1lbnREb2MuZGF0YSgpIGFzIENvdXJzZUVucm9sbG1lbnQ7XG4gICAgICAgIGlmIChlbnJvbGxtZW50RGF0YS5zdGF0dXMgIT09ICdhY3RpdmUnKSB7XG4gICAgICAgICAgYXdhaXQgdXBkYXRlRG9jKGVucm9sbG1lbnREb2MucmVmLCB7c3RhdHVzOiAnYWN0aXZlJywgZW5yb2xsZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KTtcbiAgICAgICAgICBjb25zdCBwcm9ncmVzc1JlZiA9IGRvYyhmaXJlc3RvcmUsICdjb3Vyc2VQcm9ncmVzcycsIGAke3VzZXJJZH1fJHtjb3Vyc2VJZH1gKTtcbiAgICAgICAgICBjb25zdCBwcm9ncmVzc1NuYXAgPSBhd2FpdCBnZXREb2MocHJvZ3Jlc3NSZWYpO1xuICAgICAgICAgIGlmIChwcm9ncmVzc1NuYXAuZXhpc3RzKCkpe1xuICAgICAgICAgICAgYXdhaXQgdXBkYXRlRG9jKHByb2dyZXNzUmVmLCB7Y29tcGxldGVkOiBmYWxzZSwgY29tcGxldGVkRGF0ZTogbnVsbCwgY2VydGlmaWNhdGVJZDogbnVsbCwgLyogY2VydGlmaWNhdGVJc3N1ZURhdGU6IG51bGwgKi8gfSkuY2F0Y2goY29uc29sZS53YXJuKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHJldHVybjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBjb3Vyc2UgPSBhd2FpdCBmZXRjaENvdXJzZShjb3Vyc2VJZCwgdHJ1ZSk7XG4gICAgICAgIGNvbnN0IG5ld0Vucm9sbG1lbnREYXRhOiBPbWl0PENvdXJzZUVucm9sbG1lbnQsICdpZCc+ID0ge1xuICAgICAgICAgIGNvdXJzZUlkLCBjb3Vyc2VOYW1lOiBjb3Vyc2UudGl0bGUsIGVucm9sbGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgc3RhdHVzOiAnYWN0aXZlJyxcbiAgICAgICAgICBwcm9ncmVzczogMCwgY29tcGxldGVkTGVzc29uczogW10sIGxhc3RBY2Nlc3NlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9O1xuICAgICAgICBhd2FpdCBhZGREb2MoZW5yb2xsbWVudHNSZWYsIG5ld0Vucm9sbG1lbnREYXRhKTtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSBkb2MoZmlyZXN0b3JlLCAnY291cnNlUHJvZ3Jlc3MnLCBgJHt1c2VySWR9XyR7Y291cnNlSWR9YCk7XG4gICAgICAgIGNvbnN0IHByb2dyZXNzRG9jU25hcCA9IGF3YWl0IGdldERvYyhwcm9ncmVzc1JlZik7XG4gICAgICAgIGlmICghcHJvZ3Jlc3NEb2NTbmFwLmV4aXN0cygpKSB7XG4gICAgICAgICAgY29uc3QgbmV3UHJvZ3Jlc3NEYXRhOiBDb3Vyc2VQcm9ncmVzcyA9IHtcbiAgICAgICAgICAgIGNvdXJzZUlkLCB1c2VySWQ6IHVzZXJJZCwgc3RhcnREYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksIGxhc3RBY2Nlc3NEYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBjb21wbGV0ZWRMZXNzb25zOiBbXSwgY29tcGxldGVkTW9kdWxlczogW10sIHF1aXpTY29yZXM6IHt9LCBxdWl6QXR0ZW1wdHM6IHt9LFxuICAgICAgICAgICAgbGVzc29uUHJvZ3Jlc3M6IHt9LCBtb2R1bGVQcm9ncmVzczoge30sIG92ZXJhbGxQcm9ncmVzczogMCwgY29tcGxldGVkOiBmYWxzZSwgdGltZVNwZW50OiAwLCBsYXN0UG9zaXRpb246IHVuZGVmaW5lZCxcbiAgICAgICAgfTtcbiAgICAgICAgICBhd2FpdCBzZXREb2MocHJvZ3Jlc3NSZWYsIG5ld1Byb2dyZXNzRGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUHJvZ3Jlc3MgPSBwcm9ncmVzc0RvY1NuYXAuZGF0YSgpIGFzIENvdXJzZVByb2dyZXNzO1xuICAgICAgICAgIGlmIChleGlzdGluZ1Byb2dyZXNzLmNvbXBsZXRlZCkge1xuICAgICAgICAgICAgYXdhaXQgdXBkYXRlRG9jKHByb2dyZXNzUmVmLCB7Y29tcGxldGVkOiBmYWxzZSwgY29tcGxldGVkRGF0ZTogbnVsbCwgY2VydGlmaWNhdGVJZDogbnVsbCwgY2VydGlmaWNhdGVJc3N1ZURhdGU6IG51bGwgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgICBhd2FpdCBmZXRjaEVucm9sbGVkQ291cnNlcyh0cnVlKTtcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBlbnJvbGwgaW4gY291cnNlICR7Y291cnNlSWR9OmAsIGVycm9yKTtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBlbnJvbGwgaW4gY291cnNlJztcbiAgICAgIGlmKCFpbnRlcm5hbENhbGwpIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfSBmaW5hbGx5IHtcbiAgICAgIGlmICghaW50ZXJuYWxDYWxsKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgfVxufSwgW3VzZXIsIGdldEZpcmVzdG9yZVVzZXJJZCwgZmV0Y2hDb3Vyc2UsIGZldGNoRW5yb2xsZWRDb3Vyc2VzXSk7XG5cbiAgY29uc3QgdW5lbnJvbGxGcm9tQ291cnNlID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcsIGludGVybmFsQ2FsbDogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgLy8gUmVsaWVzIG9uIHVzZXIsIGdldEZpcmVzdG9yZVVzZXJJZCwgZmV0Y2hFbnJvbGxlZENvdXJzZXMgKGFsbCBtZW1vaXplZC9zdGFibGUpXG4gICAgLy8gUmVsaWVzIG9uIHN0YWJsZSBzZXR0ZXJzOiBzZXRMb2FkaW5nLCBzZXRFcnJvclxuICAgIGlmICghdXNlcj8uaWQpIHRocm93IG5ldyBFcnJvcignVXNlciBub3QgYXV0aGVudGljYXRlZCcpO1xuICAgIGNvbnN0IHVzZXJJZCA9IGdldEZpcmVzdG9yZVVzZXJJZCgpO1xuICAgIGlmICghaW50ZXJuYWxDYWxsKSB7XG4gICAgICBzZXRMb2FkaW5nKHRydWUpO1xuICAgICAgc2V0RXJyb3IobnVsbCk7XG4gIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgZW5yb2xsbWVudHNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgYHVzZXJzLyR7dXNlcklkfS9lbnJvbGxtZW50c2ApO1xuICAgICAgY29uc3QgZW5yb2xsbWVudFF1ZXJ5ID0gcXVlcnkoZW5yb2xsbWVudHNSZWYsIHdoZXJlKCdjb3Vyc2VJZCcsICc9PScsIGNvdXJzZUlkKSwgd2hlcmUoJ3N0YXR1cycsICc9PScsICdhY3RpdmUnKSk7XG4gICAgICBjb25zdCBlbnJvbGxtZW50U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGVucm9sbG1lbnRRdWVyeSk7XG4gICAgICBpZiAoZW5yb2xsbWVudFNuYXBzaG90LmVtcHR5KSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgQXR0ZW1wdGVkIHRvIHVuZW5yb2xsIGZyb20gY291cnNlICR7Y291cnNlSWR9IGJ1dCBubyBhY3RpdmUgZW5yb2xsbWVudCBmb3VuZC5gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAgIGNvbnN0IGVucm9sbG1lbnREb2NSZWYgPSBlbnJvbGxtZW50U25hcHNob3QuZG9jc1swXS5yZWY7XG4gICAgICBhd2FpdCB1cGRhdGVEb2MoZW5yb2xsbWVudERvY1JlZiwge3N0YXR1czogJ2luYWN0aXZlJywgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSk7XG4gICAgICBhd2FpdCBmZXRjaEVucm9sbGVkQ291cnNlcyh0cnVlKTtcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byB1bmVucm9sbCBmcm9tIGNvdXJzZSAke2NvdXJzZUlkfTpgLCBlcnJvcik7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gdW5lbnJvbGwgZnJvbSBjb3Vyc2UnO1xuICAgICAgaWYoIWludGVybmFsQ2FsbCkgc2V0RXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICB9IGZpbmFsbHkge1xuICAgICAgaWYgKCFpbnRlcm5hbENhbGwpIHNldExvYWRpbmcoZmFsc2UpO1xuICB9XG59LCBbdXNlciwgZ2V0RmlyZXN0b3JlVXNlcklkLCBmZXRjaEVucm9sbGVkQ291cnNlc10pO1xuXG4gIC8vIC0tLSBFbmQgb2YgUGFydCAyIC0tLVxuXG4gICAgLy8gLS0tIENvbnRpbnVhdGlvbiBmcm9tIFBhcnQgMiAtLS1cbiAgLy8gdW5lbnJvbGxGcm9tQ291cnNlIHdhcyB0aGUgbGFzdCBmdW5jdGlvbiBpbiBQYXJ0IDJcblxuICAvLyAtLS0gUGFydCAzIEZ1bmN0aW9ucywgdXNlRWZmZWN0cywgY29udGV4dFZhbHVlLCByZXR1cm4gLS0tXG5cbiAgY29uc3QgdXBkYXRlQ291cnNlUHJvZ3Jlc3MgPSB1c2VDYWxsYmFjayhhc3luYyAoY291cnNlSWQ6IHN0cmluZywgbGVzc29uSWQ6IHN0cmluZywgY29tcGxldGVkOiBib29sZWFuLCBpbnRlcm5hbENhbGw6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIC8vIFJlbGllcyBvbiB1c2VyLCBnZXRGaXJlc3RvcmVVc2VySWQsIGZldGNoQ291cnNlLCBmZXRjaEVucm9sbGVkQ291cnNlcyAoYWxsIG1lbW9pemVkL3N0YWJsZSlcbiAgICAvLyBSZWxpZXMgb24gc3RhYmxlIHNldHRlcnM6IHNldExvYWRpbmcsIHNldEVycm9yLCBzZXRDb3Vyc2VQcm9ncmVzc1xuICAgIC8vIFJlbGllcyBvbiBzdGFibGUgaW1wb3J0OiBjb3Vyc2VQcm9ncmVzc1NlcnZpY2UudXBkYXRlTGVzc29uUHJvZ3Jlc3NcbiAgICBpZiAoIXVzZXI/LmlkKSB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgbm90IGF1dGhlbnRpY2F0ZWQnKTtcbiAgICBjb25zdCB1c2VySWQgPSBnZXRGaXJlc3RvcmVVc2VySWQoKTtcbiAgICBpZiAoIWludGVybmFsQ2FsbCkge1xuICAgICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICAgIHNldEVycm9yKG51bGwpO1xuICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvdXJzZSA9IGF3YWl0IGZldGNoQ291cnNlKGNvdXJzZUlkLCB0cnVlKTtcbiAgICAgIGNvbnN0IHRvdGFsTGVzc29ucyA9IGNvdXJzZS5tb2R1bGVzTGlzdD8ucmVkdWNlKCh0b3RhbCwgbW9kdWxlSWQpID0+IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgbW9kdWxlSWQgaXMgYWN0dWFsbHkgYSBNb2R1bGUgb2JqZWN0IChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbiAgICAgICAgaWYgKHR5cGVvZiBtb2R1bGVJZCA9PT0gJ29iamVjdCcgJiYgbW9kdWxlSWQgIT09IG51bGwpIHtcbiAgICAgICAgICBjb25zdCBtb2R1bGVPYmogPSBtb2R1bGVJZCBhcyBNb2R1bGU7XG4gICAgICAgICAgcmV0dXJuIHRvdGFsICsgKG1vZHVsZU9iai5sZXNzb25zPy5sZW5ndGggfHwgMCk7XG4gICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJZiBpdCdzIGEgc3RyaW5nIElELCB3ZSBjYW4ndCBkaXJlY3RseSBhY2Nlc3MgbGVzc29uc1xuICAgICAgICAvLyBUaGlzIGlzIGxpa2VseSB0aGUgc291cmNlIG9mIHlvdXIgdHlwZSBlcnJvclxuICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgfSwgMCkgfHwgMDtcbiAgICAgIGNvbnN0IHVwZGF0ZWRQcm9ncmVzc0RhdGEgPSBhd2FpdCBjb3Vyc2VQcm9ncmVzc1NlcnZpY2UudXBkYXRlTGVzc29uUHJvZ3Jlc3ModXNlcklkLCBjb3Vyc2VJZCwgY291cnNlLnRpdGxlLCBsZXNzb25JZCwgY29tcGxldGVkLCB0b3RhbExlc3NvbnMpO1xuICAgICAgaWYgKHVwZGF0ZWRQcm9ncmVzc0RhdGEpIHtcbiAgICAgICAgc2V0Q291cnNlUHJvZ3Jlc3MocHJldiA9PiAoey4uLnByZXYsIFtjb3Vyc2VJZF06IHVwZGF0ZWRQcm9ncmVzc0RhdGEgfSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgdXBkYXRlTGVzc29uUHJvZ3Jlc3Mgc2VydmljZSBkaWQgbm90IHJldHVybiB1cGRhdGVkIHByb2dyZXNzIGZvciAke2NvdXJzZUlkfS5gKTtcbiAgICB9XG4gICAgICBhd2FpdCBmZXRjaEVucm9sbGVkQ291cnNlcyh0cnVlKTtcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byB1cGRhdGUgcHJvZ3Jlc3MgZm9yIGxlc3NvbiAke2xlc3NvbklkfSBpbiBjb3Vyc2UgJHtjb3Vyc2VJZH06YCwgZXJyb3IpO1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIHVwZGF0ZSBjb3Vyc2UgcHJvZ3Jlc3MnO1xuICAgICAgaWYoIWludGVybmFsQ2FsbCkgc2V0RXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICB9IGZpbmFsbHkge1xuICAgICAgaWYgKCFpbnRlcm5hbENhbGwpIHNldExvYWRpbmcoZmFsc2UpO1xuICB9XG59LCBbdXNlciwgZ2V0RmlyZXN0b3JlVXNlcklkLCBmZXRjaENvdXJzZSwgZmV0Y2hFbnJvbGxlZENvdXJzZXNdKTtcblxuICBjb25zdCBtYXJrTW9kdWxlQ29tcGxldGUgPSB1c2VDYWxsYmFjayhhc3luYyAoY291cnNlSWQ6IHN0cmluZywgbW9kdWxlSWQ6IHN0cmluZywgaW50ZXJuYWxDYWxsOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAvLyBSZWxpZXMgb24gdXNlciwgZ2V0RmlyZXN0b3JlVXNlcklkLCBmZXRjaEVucm9sbGVkQ291cnNlcyAoYWxsIG1lbW9pemVkL3N0YWJsZSlcbiAgICAvLyBSZWxpZXMgb24gc3RhYmxlIHNldHRlcnM6IHNldExvYWRpbmcsIHNldEVycm9yLCBzZXRDb3Vyc2VQcm9ncmVzc1xuICAgIC8vIFJlbGllcyBvbiBzdGFibGUgaW1wb3J0OiBjb3Vyc2VQcm9ncmVzc1NlcnZpY2UubWFya01vZHVsZUNvbXBsZXRlXG4gICAgaWYgKCF1c2VyPy5pZCkgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkJyk7XG4gICAgY29uc3QgdXNlcklkID0gZ2V0RmlyZXN0b3JlVXNlcklkKCk7XG4gICAgaWYgKCFpbnRlcm5hbENhbGwpIHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cGRhdGVkUHJvZ3Jlc3NEYXRhID0gYXdhaXQgY291cnNlUHJvZ3Jlc3NTZXJ2aWNlLm1hcmtNb2R1bGVDb21wbGV0ZSh1c2VySWQsIGNvdXJzZUlkLCBtb2R1bGVJZCk7XG4gICAgICBpZiAodXBkYXRlZFByb2dyZXNzRGF0YSkge1xuICAgICAgICBzZXRDb3Vyc2VQcm9ncmVzcyhwcmV2ID0+ICh7Li4ucHJldiwgW2NvdXJzZUlkXTogdXBkYXRlZFByb2dyZXNzRGF0YSB9KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBtYXJrTW9kdWxlQ29tcGxldGUgc2VydmljZSBkaWQgbm90IHJldHVybiB1cGRhdGVkIHByb2dyZXNzIGZvciAke2NvdXJzZUlkfS5gKTtcbiAgICB9XG4gICAgICBhd2FpdCBmZXRjaEVucm9sbGVkQ291cnNlcyh0cnVlKTtcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBtYXJrIG1vZHVsZSAke21vZHVsZUlkfSBjb21wbGV0ZSBpbiBjb3Vyc2UgJHtjb3Vyc2VJZH06YCwgZXJyb3IpO1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIG1hcmsgbW9kdWxlIGNvbXBsZXRlJztcbiAgICAgIGlmKCFpbnRlcm5hbENhbGwpIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgfSBmaW5hbGx5IHtcbiAgICAgIGlmICghaW50ZXJuYWxDYWxsKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgfVxufSwgW3VzZXIsIGdldEZpcmVzdG9yZVVzZXJJZCwgZmV0Y2hFbnJvbGxlZENvdXJzZXNdKTtcblxuICBjb25zdCBtYXJrQ291cnNlQ29tcGxldGUgPSB1c2VDYWxsYmFjayhhc3luYyAoY291cnNlSWQ6IHN0cmluZywgaW50ZXJuYWxDYWxsOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xuICAgIC8vIFJlbGllcyBvbiB1c2VyLCBnZXRGaXJlc3RvcmVVc2VySWQsIGZldGNoQ291cnNlLCBmZXRjaEVucm9sbGVkQ291cnNlcyAoYWxsIG1lbW9pemVkL3N0YWJsZSlcbiAgICAvLyBSZWxpZXMgb24gc3RhYmxlIHNldHRlcnM6IHNldExvYWRpbmcsIHNldEVycm9yLCBzZXRDb3Vyc2VQcm9ncmVzc1xuICAgIC8vIFJlbGllcyBvbiBzdGFibGUgaW1wb3J0OiBjb3Vyc2VQcm9ncmVzc1NlcnZpY2UubWFya0NvdXJzZUNvbXBsZXRlXG4gICAgaWYgKCF1c2VyPy5pZCkgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkJyk7XG4gICAgY29uc3QgdXNlcklkID0gZ2V0RmlyZXN0b3JlVXNlcklkKCk7XG4gICAgaWYgKCFpbnRlcm5hbENhbGwpIHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb3Vyc2UgPSBhd2FpdCBmZXRjaENvdXJzZShjb3Vyc2VJZCwgdHJ1ZSk7XG4gICAgICBjb25zdCB2ZXJpZmljYXRpb25Db2RlID0gYENFUlQtJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgMTApLnRvVXBwZXJDYXNlKCl9YDtcbiAgICAgIGNvbnN0IHRlbXBJZCA9ICdnZW5lcmF0aW5nJztcbiAgICAgIGNvbnN0IGNlcnRpZmljYXRlUmVmID0gYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAnY2VydGlmaWNhdGVzJyksIHtcbiAgICAgICAgdXNlcklkOiB1c2VySWQsIGNvdXJzZUlkOiBjb3Vyc2VJZCwgY291cnNlTmFtZTogY291cnNlLnRpdGxlLCB1c2VyTmFtZTogdXNlci5kaXNwbGF5TmFtZSB8fCAnTGVhcm5lcicsXG4gICAgICAgIGlzc3VlRGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCB0ZW1wbGF0ZUlkOiAnZGVmYXVsdCcsIHBkZlVybDogYC9jZXJ0aWZpY2F0ZXMvJHt0ZW1wSWR9LnBkZmAsXG4gICAgICAgIHRodW1ibmFpbFVybDogYC9jZXJ0aWZpY2F0ZXMvJHt0ZW1wSWR9LmpwZ2AsIHZlcmlmaWNhdGlvbkNvZGU6IHZlcmlmaWNhdGlvbkNvZGUsIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICAgIGluc3RydWN0b3I6IGNvdXJzZS5pbnN0cnVjdG9yIHx8IG51bGwsIGluc3RydWN0b3JUaXRsZTogY291cnNlLmluc3RydWN0b3JUaXRsZSB8fCBudWxsLFxuICAgIH0pO1xuICAgICAgY29uc3QgY2VydGlmaWNhdGVEb2NJZCA9IGNlcnRpZmljYXRlUmVmLmlkO1xuICAgICAgYXdhaXQgdXBkYXRlRG9jKGNlcnRpZmljYXRlUmVmLCB7cGRmVXJsOiBgL2NlcnRpZmljYXRlcy8ke2NlcnRpZmljYXRlRG9jSWR9LnBkZmAsIHRodW1ibmFpbFVybDogYC9jZXJ0aWZpY2F0ZXMvJHtjZXJ0aWZpY2F0ZURvY0lkfS5qcGdgIH0pO1xuICAgICAgY29uc3QgdXBkYXRlZFNlcnZpY2VQcm9ncmVzcyA9IGF3YWl0IGNvdXJzZVByb2dyZXNzU2VydmljZS5tYXJrQ291cnNlQ29tcGxldGUodXNlcklkLCBjb3Vyc2VJZCwgY291cnNlLnRpdGxlKTtcblxuICAgICAgc2V0Q291cnNlUHJvZ3Jlc3MocHJldiA9PiB7XG4gICAgICAgICAgY29uc3QgYmFzZVByb2dyZXNzID0gdXBkYXRlZFNlcnZpY2VQcm9ncmVzcyB8fCBwcmV2W2NvdXJzZUlkXSB8fCB7Y291cnNlSWQsIHVzZXJJZCB9IGFzIENvdXJzZVByb2dyZXNzO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgICAgICAgIFtjb3Vyc2VJZF06IHtcbiAgICAgICAgICAgICAgICAgIC4uLmJhc2VQcm9ncmVzcyxcbiAgICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgcHJvZ3Jlc3MgdmFsdWVzIGZyb20gdGhlIHNlcnZpY2UgcmF0aGVyIHRoYW4gb3ZlcnJpZGluZyB0aGVtXG4gICAgICAgICAgICAgICAgICAvLyBUaGlzIGVuc3VyZXMgd2UgdXNlIHRoZSBzaW5nbGUgc291cmNlIG9mIHRydXRoIGZyb20gdGhlIGJhY2tlbmRcbiAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlSWQ6IGNlcnRpZmljYXRlRG9jSWQsXG4gICAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZUlzc3VlRGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG4gICAgICBhd2FpdCBmZXRjaEVucm9sbGVkQ291cnNlcyh0cnVlKTtcbiAgICAgIHJldHVybiBjZXJ0aWZpY2F0ZURvY0lkO1xuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIG1hcmsgY291cnNlICR7Y291cnNlSWR9IGNvbXBsZXRlOmAsIGVycm9yKTtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBtYXJrIGNvdXJzZSBjb21wbGV0ZSc7XG4gICAgICBpZighaW50ZXJuYWxDYWxsKSBzZXRFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gIH0gZmluYWxseSB7XG4gICAgICBpZiAoIWludGVybmFsQ2FsbCkgc2V0TG9hZGluZyhmYWxzZSk7XG4gIH1cbn0sIFt1c2VyLCBnZXRGaXJlc3RvcmVVc2VySWQsIGZldGNoQ291cnNlLCBmZXRjaEVucm9sbGVkQ291cnNlc10pOyAvLyBEZXBlbmRzIG9uIHVzZXIgZnJvbSBhdXRoXG5cbiAgY29uc3Qgc2VhcmNoQ291cnNlcyA9IHVzZUNhbGxiYWNrKGFzeW5jIChxdWVyeVRleHQ6IHN0cmluZywgZmlsdGVycz86IENvdXJzZUZpbHRlcnMsIGludGVybmFsQ2FsbDogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxDb3Vyc2VbXT4gPT4ge1xuICAgIC8vIFJlbGllcyBvbiAnY291cnNlcycgc3RhdGUgdmFyaWFibGVcbiAgICAvLyBSZWxpZXMgb24gc3RhYmxlIHNldHRlcnM6IHNldExvYWRpbmcsIHNldEVycm9yXG4gICAgaWYgKCFpbnRlcm5hbENhbGwpIHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgfVxuICAgIHRyeSB7XG4gICAgICBsZXQgZmlsdGVyZWRSZXN1bHRzID0gWy4uLmNvdXJzZXNdOyAvLyBVc2UgdGhlICdjb3Vyc2VzJyBzdGF0ZSBmcm9tIENvdXJzZVByb3ZpZGVyIHNjb3BlXG4gICAgICBpZiAocXVlcnlUZXh0KSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5TG93ZXIgPSBxdWVyeVRleHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgZmlsdGVyZWRSZXN1bHRzID0gZmlsdGVyZWRSZXN1bHRzLmZpbHRlcihjb3Vyc2UgPT5cbiAgICAgICAgICBjb3Vyc2UudGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeUxvd2VyKSB8fFxuICAgICAgICAgIChjb3Vyc2UuZGVzY3JpcHRpb24/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnlMb3dlcikpIHx8XG4gICAgICAgICAgKGNvdXJzZS5sb25nRGVzY3JpcHRpb24/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnlMb3dlcikpIHx8XG4gICAgICAgICAgKGNvdXJzZS50YWdzPy5zb21lKHRhZyA9PiB0YWcudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeUxvd2VyKSkpXG4gICAgICAgICk7XG4gICAgfVxuICAgICAgaWYgKGZpbHRlcnMpIHsvLyBBcHBseSBmaWx0ZXJzIChjbGllbnQtc2lkZSlcbiAgICAgICAgaWYgKGZpbHRlcnMuY2F0ZWdvcmllcyAmJiBmaWx0ZXJzLmNhdGVnb3JpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGZpbHRlcmVkUmVzdWx0cyA9IGZpbHRlcmVkUmVzdWx0cy5maWx0ZXIoYyA9PiBjLmNhdGVnb3J5SWRzPy5zb21lKGNhdElkID0+IGZpbHRlcnMuY2F0ZWdvcmllcz8uaW5jbHVkZXMoY2F0SWQpKSk7XG4gICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmxldmVscyAmJiBmaWx0ZXJzLmxldmVscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZmlsdGVyZWRSZXN1bHRzID0gZmlsdGVyZWRSZXN1bHRzLmZpbHRlcihjID0+IGZpbHRlcnMubGV2ZWxzPy5pbmNsdWRlcyhjLmxldmVsKSk7XG4gICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmR1cmF0aW9ucyAmJiBmaWx0ZXJzLmR1cmF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZmlsdGVyZWRSZXN1bHRzID0gZmlsdGVyZWRSZXN1bHRzLmZpbHRlcihjID0+IHtcbiAgICAgICAgICAgIGxldCB0b3RhbFNlY29uZHMgPSBjLmR1cmF0aW9uRGV0YWlscz8udG90YWxTZWNvbmRzO1xuICAgICAgICAgICAgaWYgKHRvdGFsU2Vjb25kcyA9PT0gdW5kZWZpbmVkICYmIGMuZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBjLmR1cmF0aW9uLnNwbGl0KCcgJyk7XG4gICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHBhcnNlRmxvYXQocGFydHNbMF0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHVuaXQgPSBwYXJ0c1sxXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIGlmICghaXNOYU4odmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICBpZiAodW5pdC5zdGFydHNXaXRoKCdob3VyJykpIHRvdGFsU2Vjb25kcyA9IHZhbHVlICogMzYwMDtcbiAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHVuaXQuc3RhcnRzV2l0aCgnbWludXRlJykpIHRvdGFsU2Vjb25kcyA9IHZhbHVlICogNjA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodG90YWxTZWNvbmRzID09PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJzLmR1cmF0aW9ucz8uc29tZShmRHVyYXRpb24gPT4ge1xuICAgICAgICAgICAgICBpZiAoZkR1cmF0aW9uID09PSAnc2hvcnQnKSByZXR1cm4gdG90YWxTZWNvbmRzIDwgKDIgKiAzNjAwKTtcbiAgICAgICAgICAgICAgaWYgKGZEdXJhdGlvbiA9PT0gJ21lZGl1bScpIHJldHVybiB0b3RhbFNlY29uZHMgPj0gKDIgKiAzNjAwKSAmJiB0b3RhbFNlY29uZHMgPD0gKDQgKiAzNjAwKTtcbiAgICAgICAgICAgICAgaWYgKGZEdXJhdGlvbiA9PT0gJ2xvbmcnKSByZXR1cm4gdG90YWxTZWNvbmRzID4gKDQgKiAzNjAwKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgICAgaWYgKGZpbHRlcnMucHJpY2VSYW5nZSAmJiB0eXBlb2YgZmlsdGVycy5wcmljZVJhbmdlPy5taW4gPT09ICdudW1iZXInICYmIHR5cGVvZiBmaWx0ZXJzLnByaWNlUmFuZ2U/Lm1heCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICBmaWx0ZXJlZFJlc3VsdHMgPSBmaWx0ZXJlZFJlc3VsdHMuZmlsdGVyKGMgPT4ge1xuICAgICAgICAgICAgY29uc3QgcHJpY2UgPSBjLnByaWNlIHx8IDA7XG4gICAgICAgICAgICBjb25zdCBpc0ZyZWUgPSBjLmlzRnJlZSB8fCBmYWxzZTtcbiAgICAgICAgICAgIGlmIChmaWx0ZXJzLnByaWNlUmFuZ2U/Lm1pbiA9PT0gMCAmJiBpc0ZyZWUpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIChwcmljZSA+PSAoZmlsdGVycy5wcmljZVJhbmdlPy5taW4gPz8gMCkgJiYgcHJpY2UgPD0gKGZpbHRlcnMucHJpY2VSYW5nZT8ubWF4ID8/IEluZmluaXR5KSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5yYXRpbmcgIT09IHVuZGVmaW5lZCAmJiBmaWx0ZXJzLnJhdGluZyA+IDApIHtcbiAgICAgICAgICBmaWx0ZXJlZFJlc3VsdHMgPSBmaWx0ZXJlZFJlc3VsdHMuZmlsdGVyKGMgPT4gYy5yYXRpbmcgIT09IHVuZGVmaW5lZCAmJiBjLnJhdGluZyA+PSBmaWx0ZXJzLnJhdGluZyEpO1xuICAgICAgfVxuICAgIH1cbiAgICAgIHJldHVybiBmaWx0ZXJlZFJlc3VsdHM7XG4gIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2VhcmNoIGNvdXJzZXM6JywgZXJyb3IpO1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIHNlYXJjaCBjb3Vyc2VzJztcbiAgICAgIGlmICghaW50ZXJuYWxDYWxsKSBzZXRFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gIH0gZmluYWxseSB7XG4gICAgICBpZiAoIWludGVybmFsQ2FsbCkgc2V0TG9hZGluZyhmYWxzZSk7XG4gIH1cbn0sIFtjb3Vyc2VzXSk7IC8vIERlcGVuZHMgb25seSBvbiB0aGUgJ2NvdXJzZXMnIHN0YXRlIHZhcmlhYmxlXG5cbiAgLy8gLS0tIEVuZCBvZiBBbGwgTWVtb2l6ZWQgRnVuY3Rpb25zIC0tLVxuXG5cbiAgLy8gLS0tIHVzZUVmZmVjdCBIb29rcyAoc2hvdWxkIG5vdyB1c2UgbWVtb2l6ZWQgZnVuY3Rpb25zIGlmIHRoZXkgY2FsbCB0aGVtKSAtLS1cblxuICAvLyBGZXRjaCBmZWF0dXJlZCBjb3Vyc2VzIG9uIG1vdW50XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgbG9hZEZlYXR1cmVkQ291cnNlcyA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIENhbGxzIG1lbW9pemVkIGZldGNoQ291cnNlc1xuICAgICAgICBjb25zdCBmZWF0dXJlZENvdXJzZXNEYXRhID0gYXdhaXQgZmV0Y2hDb3Vyc2VzKHtmZWF0dXJlZDogdHJ1ZSwgbGltaXQ6IDYgfSwgdHJ1ZSk7XG4gICAgICAgIHNldEZlYXR1cmVkQ291cnNlcyhmZWF0dXJlZENvdXJzZXNEYXRhKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIGZlYXR1cmVkIGNvdXJzZXM6JywgZXJyb3IpO1xuICAgIH1cbiAgfTtcbiAgICBsb2FkRmVhdHVyZWRDb3Vyc2VzKCk7XG59LCBbZmV0Y2hDb3Vyc2VzXSk7IC8vIERlcGVuZGVuY3kgaXMgdGhlIG1lbW9pemVkIGZldGNoQ291cnNlc1xuXG4gIC8vIEZldGNoIGVucm9sbGVkIGNvdXJzZXMgd2hlbiB1c2VyIGNoYW5nZXNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAodXNlcj8uaWQpIHtcbiAgICAgIC8vIENhbGxzIG1lbW9pemVkIGZldGNoRW5yb2xsZWRDb3Vyc2VzXG4gICAgICBmZXRjaEVucm9sbGVkQ291cnNlcyh0cnVlKTsgLy8gVXNlIGludGVybmFsIGNhbGwgPSB0cnVlXG4gIH0gZWxzZSB7XG4gICAgICBzZXRFbnJvbGxlZENvdXJzZXMoW10pO1xuICAgICAgc2V0Q29tcGxldGVkQ291cnNlcyhbXSk7XG4gICAgICBzZXRDb3Vyc2VQcm9ncmVzcyh7fSk7XG4gIH1cbn0sIFt1c2VyPy5pZCwgZmV0Y2hFbnJvbGxlZENvdXJzZXNdKTsgLy8gRGVwZW5kZW5jaWVzIGFyZSB1c2VyLmlkIGFuZCB0aGUgbWVtb2l6ZWQgZmV0Y2hFbnJvbGxlZENvdXJzZXNcblxuXG4gIC8vIC0tLSBjb250ZXh0VmFsdWUgd3JhcHBlZCBpbiB1c2VNZW1vIC0tLVxuICBjb25zdCBjb250ZXh0VmFsdWUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZyhcIltDb3Vyc2VDb250ZXh0XSBSZWNhbGN1bGF0aW5nIGNvbnRleHRWYWx1ZVwiKTsgLy8gS2VlcCBjb21tZW50ZWQgdW5sZXNzIGRlYnVnZ2luZ1xuICAgIHJldHVybiB7XG4gICAgICAvLyBTdGF0ZSB2YWx1ZXNcbiAgICAgIGNvdXJzZXMsXG4gICAgICBlbnJvbGxlZENvdXJzZXMsXG4gICAgICBjb21wbGV0ZWRDb3Vyc2VzLFxuICAgICAgZmVhdHVyZWRDb3Vyc2VzLFxuICAgICAgY291cnNlUHJvZ3Jlc3MsXG4gICAgICBsb2FkaW5nLFxuICAgICAgZXJyb3IsXG4gICAgICAvLyBNZW1vaXplZCBmdW5jdGlvbnNcbiAgICAgIGZldGNoQ291cnNlcyxcbiAgICAgIGZldGNoQ291cnNlLFxuICAgICAgZmV0Y2hFbnJvbGxlZENvdXJzZXMsXG4gICAgICBmZXRjaENvbXBsZXRlZENvdXJzZXMsXG4gICAgICBlbnJvbGxJbkNvdXJzZSxcbiAgICAgIHVuZW5yb2xsRnJvbUNvdXJzZSxcbiAgICAgIHVwZGF0ZUNvdXJzZVByb2dyZXNzLFxuICAgICAgbWFya01vZHVsZUNvbXBsZXRlLFxuICAgICAgbWFya0NvdXJzZUNvbXBsZXRlLFxuICAgICAgZmV0Y2hDb3Vyc2VQcm9ncmVzcyxcbiAgICAgIHNlYXJjaENvdXJzZXMsXG4gIH07XG59LCBbXG4gICAgLy8gU3RhdGUgZGVwZW5kZW5jaWVzXG4gICAgY291cnNlcywgZW5yb2xsZWRDb3Vyc2VzLCBjb21wbGV0ZWRDb3Vyc2VzLCBmZWF0dXJlZENvdXJzZXMsIGNvdXJzZVByb2dyZXNzLCBsb2FkaW5nLCBlcnJvcixcbiAgICAvLyBGdW5jdGlvbiBkZXBlbmRlbmNpZXMgKG5vdyBzdGFibGUgcmVmZXJlbmNlcylcbiAgICBmZXRjaENvdXJzZXMsIGZldGNoQ291cnNlLCBmZXRjaEVucm9sbGVkQ291cnNlcywgZmV0Y2hDb21wbGV0ZWRDb3Vyc2VzLCBlbnJvbGxJbkNvdXJzZSxcbiAgICB1bmVucm9sbEZyb21Db3Vyc2UsIHVwZGF0ZUNvdXJzZVByb2dyZXNzLCBtYXJrTW9kdWxlQ29tcGxldGUsIG1hcmtDb3Vyc2VDb21wbGV0ZSxcbiAgICBmZXRjaENvdXJzZVByb2dyZXNzLCBzZWFyY2hDb3Vyc2VzXG4gIF0pO1xuXG4gIC8vIC0tLSBQcm92aWRlciBSZXR1cm4gLS0tXG4gIHJldHVybiAoXG4gICAgPENvdXJzZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHRWYWx1ZX0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9Db3Vyc2VDb250ZXh0LlByb3ZpZGVyPlxuICApO1xuXG59OyAvLyBFbmQgb2YgQ291cnNlUHJvdmlkZXIgQ29tcG9uZW50XG5cbi8vIC0tLSB1c2VDb3Vyc2VzIEhvb2sgKHJlbWFpbnMgdGhlIHNhbWUpIC0tLVxuZXhwb3J0IGNvbnN0IHVzZUNvdXJzZXMgPSAoKSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KENvdXJzZUNvbnRleHQpO1xuICBpZiAoIWNvbnRleHQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3VzZUNvdXJzZXMgbXVzdCBiZSB1c2VkIHdpdGhpbiBhIENvdXJzZVByb3ZpZGVyJyk7XG59XG4gIHJldHVybiBjb250ZXh0O1xufTtcblxuXG4iXSwibmFtZXMiOlsiUmVhY3QiLCJjcmVhdGVDb250ZXh0IiwidXNlQ29udGV4dCIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlTWVtbyIsInVzZUNhbGxiYWNrIiwiY29sbGVjdGlvbiIsImRvYyIsImdldERvYyIsImdldERvY3MiLCJxdWVyeSIsIndoZXJlIiwidXBkYXRlRG9jIiwic2V0RG9jIiwiYWRkRG9jIiwib3JkZXJCeSIsImxpbWl0IiwiZmlyZXN0b3JlIiwidXNlQXV0aCIsImNvdXJzZVByb2dyZXNzU2VydmljZSIsInZlcmlmeUFsbE1vZHVsZUxlc3NvbkNvdW50cyIsInVzZVF1ZXJ5Q2xpZW50IiwiQ291cnNlQ29udGV4dCIsInVuZGVmaW5lZCIsIkNvdXJzZVByb3ZpZGVyIiwiY2hpbGRyZW4iLCJ1c2VyIiwiY291cnNlcyIsInNldENvdXJzZXMiLCJlbnJvbGxlZENvdXJzZXMiLCJzZXRFbnJvbGxlZENvdXJzZXMiLCJjb21wbGV0ZWRDb3Vyc2VzIiwic2V0Q29tcGxldGVkQ291cnNlcyIsImZlYXR1cmVkQ291cnNlcyIsInNldEZlYXR1cmVkQ291cnNlcyIsImNvdXJzZVByb2dyZXNzIiwic2V0Q291cnNlUHJvZ3Jlc3MiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsImVycm9yIiwic2V0RXJyb3IiLCJxdWVyeUNsaWVudCIsImdldEZpcmVzdG9yZVVzZXJJZCIsImlkIiwiY29uc29sZSIsIkVycm9yIiwiZmV0Y2hDb3Vyc2UiLCJjb3Vyc2VJZCIsImludGVybmFsQ2FsbCIsImNvdXJzZURvYyIsImV4aXN0cyIsImNvdXJzZURhdGEiLCJkYXRhIiwiZXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsImZldGNoQ291cnNlcyIsIm9wdGlvbnMiLCJ2ZXJpZnlNb2R1bGVMZXNzb25Db3VudHMiLCJjb3Vyc2VzUXVlcnlCdWlsZGVyIiwiY29uc3RyYWludHMiLCJzdGF0dXMiLCJwdXNoIiwiZmVhdHVyZWQiLCJmaW5hbFF1ZXJ5IiwicXVlcnlTbmFwc2hvdCIsImZldGNoZWRDb3Vyc2VzRGF0YSIsImZvckVhY2giLCJkb2NTbmFwIiwiZmV0Y2hDb3Vyc2VQcm9ncmVzcyIsInVzZXJJZCIsInByb2dyZXNzIiwiZ2V0Q291cnNlUHJvZ3Jlc3MiLCJwcmV2IiwibmV3U3RhdGUiLCJmZXRjaEVucm9sbGVkQ291cnNlcyIsImVucm9sbG1lbnRzUmVmIiwiZW5yb2xsbWVudHNRdWVyeSIsImVucm9sbG1lbnRzU25hcHNob3QiLCJlbnJvbGxtZW50cyIsImRvY3MiLCJtYXAiLCJkIiwiZW5yb2xsbWVudElkIiwidW5pcXVlRW5yb2xsbWVudHNCeUNvdXJzZUlkIiwiQXJyYXkiLCJmcm9tIiwicmVkdWNlIiwiZW5yb2xsbWVudCIsImV4aXN0aW5nRW5yb2xsbWVudCIsImdldCIsImVucm9sbGVkQXQiLCJEYXRlIiwic2V0IiwiTWFwIiwidmFsdWVzIiwicHJvZ3Jlc3NQcm9taXNlcyIsImUiLCJwcm9ncmVzc1Jlc3VsdHMiLCJQcm9taXNlIiwiYWxsIiwidGVtcFByb2dyZXNzTWFwIiwicCIsImVucm9sbGVkQ291cnNlc0RldGFpbHNQcm9taXNlcyIsImNvdXJzZSIsIm92ZXJhbGxQcm9ncmVzcyIsImZpbmFsRW5yb2xsZWRDb3Vyc2VzIiwiZmlsdGVyIiwiYyIsImNvbXBsZXRlZCIsImluUHJvZ3Jlc3MiLCJwcmV2R2xvYmFsUHJvZ3Jlc3MiLCJmZXRjaENvbXBsZXRlZENvdXJzZXMiLCJwcm9ncmVzc1EiLCJwcm9ncmVzc1NuYXBzaG90IiwiY29tcGxldGVkUHJvZ3Jlc3NEb2NzIiwiY29tcGxldGVkQ291cnNlc1Byb21pc2VzIiwicHJvZ3Jlc3NJdGVtIiwiY29tcGxldGVkQ291cnNlc0RhdGEiLCJlbnJvbGxJbkNvdXJzZSIsImVucm9sbG1lbnRRdWVyeSIsImVucm9sbG1lbnRTbmFwc2hvdCIsImVtcHR5IiwiZW5yb2xsbWVudERvYyIsImVucm9sbG1lbnREYXRhIiwicmVmIiwidG9JU09TdHJpbmciLCJ1cGRhdGVkQXQiLCJwcm9ncmVzc1JlZiIsInByb2dyZXNzU25hcCIsImNvbXBsZXRlZERhdGUiLCJjZXJ0aWZpY2F0ZUlkIiwiY2F0Y2giLCJ3YXJuIiwibmV3RW5yb2xsbWVudERhdGEiLCJjb3Vyc2VOYW1lIiwidGl0bGUiLCJjb21wbGV0ZWRMZXNzb25zIiwibGFzdEFjY2Vzc2VkQXQiLCJwcm9ncmVzc0RvY1NuYXAiLCJuZXdQcm9ncmVzc0RhdGEiLCJzdGFydERhdGUiLCJsYXN0QWNjZXNzRGF0ZSIsImNvbXBsZXRlZE1vZHVsZXMiLCJxdWl6U2NvcmVzIiwicXVpekF0dGVtcHRzIiwibGVzc29uUHJvZ3Jlc3MiLCJtb2R1bGVQcm9ncmVzcyIsInRpbWVTcGVudCIsImxhc3RQb3NpdGlvbiIsImV4aXN0aW5nUHJvZ3Jlc3MiLCJjZXJ0aWZpY2F0ZUlzc3VlRGF0ZSIsInVuZW5yb2xsRnJvbUNvdXJzZSIsImVucm9sbG1lbnREb2NSZWYiLCJ1cGRhdGVDb3Vyc2VQcm9ncmVzcyIsImxlc3NvbklkIiwidG90YWxMZXNzb25zIiwibW9kdWxlc0xpc3QiLCJ0b3RhbCIsIm1vZHVsZUlkIiwibW9kdWxlT2JqIiwibGVzc29ucyIsImxlbmd0aCIsInVwZGF0ZWRQcm9ncmVzc0RhdGEiLCJ1cGRhdGVMZXNzb25Qcm9ncmVzcyIsIm1hcmtNb2R1bGVDb21wbGV0ZSIsIm1hcmtDb3Vyc2VDb21wbGV0ZSIsInZlcmlmaWNhdGlvbkNvZGUiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJ0b1VwcGVyQ2FzZSIsInRlbXBJZCIsImNlcnRpZmljYXRlUmVmIiwidXNlck5hbWUiLCJkaXNwbGF5TmFtZSIsImlzc3VlRGF0ZSIsInRlbXBsYXRlSWQiLCJwZGZVcmwiLCJ0aHVtYm5haWxVcmwiLCJpbnN0cnVjdG9yIiwiaW5zdHJ1Y3RvclRpdGxlIiwiY2VydGlmaWNhdGVEb2NJZCIsInVwZGF0ZWRTZXJ2aWNlUHJvZ3Jlc3MiLCJiYXNlUHJvZ3Jlc3MiLCJzZWFyY2hDb3Vyc2VzIiwicXVlcnlUZXh0IiwiZmlsdGVycyIsImZpbHRlcmVkUmVzdWx0cyIsInF1ZXJ5TG93ZXIiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiZGVzY3JpcHRpb24iLCJsb25nRGVzY3JpcHRpb24iLCJ0YWdzIiwic29tZSIsInRhZyIsImNhdGVnb3JpZXMiLCJjYXRlZ29yeUlkcyIsImNhdElkIiwibGV2ZWxzIiwibGV2ZWwiLCJkdXJhdGlvbnMiLCJ0b3RhbFNlY29uZHMiLCJkdXJhdGlvbkRldGFpbHMiLCJkdXJhdGlvbiIsInBhcnRzIiwic3BsaXQiLCJ2YWx1ZSIsInBhcnNlRmxvYXQiLCJ1bml0IiwiaXNOYU4iLCJzdGFydHNXaXRoIiwiZkR1cmF0aW9uIiwicHJpY2VSYW5nZSIsIm1pbiIsIm1heCIsInByaWNlIiwiaXNGcmVlIiwiSW5maW5pdHkiLCJyYXRpbmciLCJsb2FkRmVhdHVyZWRDb3Vyc2VzIiwiZmVhdHVyZWRDb3Vyc2VzRGF0YSIsImNvbnRleHRWYWx1ZSIsIlByb3ZpZGVyIiwidXNlQ291cnNlcyIsImNvbnRleHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/context/CourseContext.tsx\n");

/***/ }),

/***/ "./src/context/SettingsContext.tsx":
/*!*****************************************!*\
  !*** ./src/context/SettingsContext.tsx ***!
  \*****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SettingsProvider: () => (/* binding */ SettingsProvider),\n/* harmony export */   useSettings: () => (/* binding */ useSettings)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _services_firebase__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/services/firebase */ \"./src/services/firebase.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, _services_firebase__WEBPACK_IMPORTED_MODULE_3__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, _services_firebase__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\nconst defaultSettings = {\n    defaultStudentName: \"\",\n    certificatePreviewTitle: \"Certificate Preview\",\n    defaultPreviewName: \"\",\n    defaultCourseName: \"\",\n    organizationName: \"\",\n    defaultIssuerTitle: \"\",\n    previewDescription: \"\",\n    previewDataTitle: \"Preview Data\"\n};\nconst SettingsContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)({\n    settings: defaultSettings,\n    loading: true,\n    error: null\n});\nconst useSettings = ()=>(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(SettingsContext);\nconst SettingsProvider = ({ children })=>{\n    const [settings, setSettings] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(defaultSettings);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        // Use a one-time query instead of a real-time listener\n        const fetchSettings = async ()=>{\n            try {\n                // Check if we have cached settings\n                const cachedSettings = localStorage.getItem(\"site_settings\");\n                const cacheTimestamp = localStorage.getItem(\"site_settings_timestamp\");\n                // Use cache if it's less than 15 minutes old\n                if (cachedSettings && cacheTimestamp) {\n                    const timestamp = parseInt(cacheTimestamp);\n                    const now = Date.now();\n                    const fifteenMinutes = 15 * 60 * 1000;\n                    if (now - timestamp < fifteenMinutes) {\n                        setSettings({\n                            ...defaultSettings,\n                            ...JSON.parse(cachedSettings)\n                        });\n                        setLoading(false);\n                        return;\n                    }\n                }\n                // Fetch from Firestore if no valid cache\n                const settingsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_3__.firestore, \"settings\", \"site\");\n                const docSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getDoc)(settingsRef);\n                if (docSnapshot.exists()) {\n                    const settingsData = docSnapshot.data();\n                    setSettings({\n                        ...defaultSettings,\n                        ...settingsData\n                    });\n                    // Cache the settings\n                    localStorage.setItem(\"site_settings\", JSON.stringify(settingsData));\n                    localStorage.setItem(\"site_settings_timestamp\", Date.now().toString());\n                }\n                setLoading(false);\n            } catch (error) {\n                const errorMessage = error instanceof Error ? error.message : \"An unknown error occurred\";\n                console.error(\"Error fetching settings:\", error);\n                setError(error.message);\n                setLoading(false);\n                // Try to use cached settings even if they're older\n                const cachedSettings = localStorage.getItem(\"site_settings\");\n                if (cachedSettings) {\n                    setSettings({\n                        ...defaultSettings,\n                        ...JSON.parse(cachedSettings)\n                    });\n                }\n            }\n        };\n        fetchSettings();\n    }, []);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(SettingsContext.Provider, {\n        value: {\n            settings,\n            loading,\n            error\n        },\n        children: children\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\context\\\\SettingsContext.tsx\",\n        lineNumber: 115,\n        columnNumber: 5\n    }, undefined);\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29udGV4dC9TZXR0aW5nc0NvbnRleHQudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUE2RTtBQUM3QjtBQUNEO0FBc0IvQyxNQUFNUSxrQkFBZ0M7SUFDcENDLG9CQUFvQjtJQUNwQkMseUJBQXlCO0lBQ3pCQyxvQkFBb0I7SUFDcEJDLG1CQUFtQjtJQUNuQkMsa0JBQWtCO0lBQ2xCQyxvQkFBb0I7SUFDcEJDLG9CQUFvQjtJQUNwQkMsa0JBQWtCO0FBQ3BCO0FBRUEsTUFBTUMsZ0NBQWtCaEIsb0RBQWFBLENBSWxDO0lBQ0RpQixVQUFVVjtJQUNWVyxTQUFTO0lBQ1RDLE9BQU87QUFDVDtBQUVPLE1BQU1DLGNBQWMsSUFBTW5CLGlEQUFVQSxDQUFDZSxpQkFBaUI7QUFFdEQsTUFBTUssbUJBQTJELENBQUMsRUFBQ0MsUUFBUSxFQUFFO0lBQ2xGLE1BQU0sQ0FBQ0wsVUFBVU0sWUFBWSxHQUFHckIsK0NBQVFBLENBQWVLO0lBQ3ZELE1BQU0sQ0FBQ1csU0FBU00sV0FBVyxHQUFHdEIsK0NBQVFBLENBQUM7SUFDdkMsTUFBTSxDQUFDaUIsT0FBT00sU0FBUyxHQUFHdkIsK0NBQVFBLENBQWdCO0lBRWxEQyxnREFBU0EsQ0FBQztRQUNSLHVEQUF1RDtRQUN2RCxNQUFNdUIsZ0JBQWdCO1lBQ3BCLElBQUk7Z0JBQ0YsbUNBQW1DO2dCQUNuQyxNQUFNQyxpQkFBaUJDLGFBQWFDLE9BQU8sQ0FBQztnQkFDNUMsTUFBTUMsaUJBQWlCRixhQUFhQyxPQUFPLENBQUM7Z0JBRTVDLDZDQUE2QztnQkFDN0MsSUFBSUYsa0JBQWtCRyxnQkFBZ0I7b0JBQ3BDLE1BQU1DLFlBQVlDLFNBQVNGO29CQUMzQixNQUFNRyxNQUFNQyxLQUFLRCxHQUFHO29CQUNwQixNQUFNRSxpQkFBaUIsS0FBSyxLQUFLO29CQUVqQyxJQUFJRixNQUFNRixZQUFZSSxnQkFBZ0I7d0JBQ3BDWixZQUFZOzRCQUNWLEdBQUdoQixlQUFlOzRCQUNsQixHQUFHNkIsS0FBS0MsS0FBSyxDQUFDVixlQUFlO3dCQUNqQzt3QkFDRUgsV0FBVzt3QkFDWDtvQkFDSjtnQkFDRjtnQkFFRSx5Q0FBeUM7Z0JBQ3pDLE1BQU1jLGNBQWNsQyx1REFBR0EsQ0FBQ0UseURBQVNBLEVBQUUsWUFBWTtnQkFDL0MsTUFBTWlDLGNBQWMsTUFBTWxDLDBEQUFNQSxDQUFDaUM7Z0JBRWpDLElBQUlDLFlBQVlDLE1BQU0sSUFBSTtvQkFDeEIsTUFBTUMsZUFBZUYsWUFBWUcsSUFBSTtvQkFDckNuQixZQUFZO3dCQUNWLEdBQUdoQixlQUFlO3dCQUNsQixHQUFHa0MsWUFBWTtvQkFDbkI7b0JBRUUscUJBQXFCO29CQUNyQmIsYUFBYWUsT0FBTyxDQUFDLGlCQUFpQlAsS0FBS1EsU0FBUyxDQUFDSDtvQkFDckRiLGFBQWFlLE9BQU8sQ0FBQywyQkFBMkJULEtBQUtELEdBQUcsR0FBR1ksUUFBUTtnQkFDdkU7Z0JBRUVyQixXQUFXO1lBQ2YsRUFBRSxPQUFPTCxPQUFnQjtnQkFDckIsTUFBTTJCLGVBQWUzQixpQkFBaUI0QixRQUFRNUIsTUFBTTZCLE9BQU8sR0FBRztnQkFDOURDLFFBQVE5QixLQUFLLENBQUMsNEJBQTRCQTtnQkFDMUNNLFNBQVNOLE1BQU02QixPQUFPO2dCQUN0QnhCLFdBQVc7Z0JBRVgsbURBQW1EO2dCQUNuRCxNQUFNRyxpQkFBaUJDLGFBQWFDLE9BQU8sQ0FBQztnQkFDNUMsSUFBSUYsZ0JBQWdCO29CQUNsQkosWUFBWTt3QkFDVixHQUFHaEIsZUFBZTt3QkFDbEIsR0FBRzZCLEtBQUtDLEtBQUssQ0FBQ1YsZUFBZTtvQkFDakM7Z0JBQ0Y7WUFDRjtRQUNGO1FBRUVEO0lBQ0osR0FBRyxFQUFFO0lBRUgscUJBQ0UsOERBQUNWLGdCQUFnQmtDLFFBQVE7UUFBQ0MsT0FBTztZQUFDbEM7WUFBVUM7WUFBU0M7UUFBTTtrQkFDeERHOzs7Ozs7QUFHUCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhaW5pbmctcGxhdGZvcm0vLi9zcmMvY29udGV4dC9TZXR0aW5nc0NvbnRleHQudHN4P2YyMjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7Y3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7ZG9jLCBnZXREb2MgfSBmcm9tICdmaXJlYmFzZS9maXJlc3RvcmUnO1xuaW1wb3J0IHtmaXJlc3RvcmUgfSBmcm9tICdAL3NlcnZpY2VzL2ZpcmViYXNlJztcblxuaW50ZXJmYWNlIExvZ28ge1xuICB1cmw6IHN0cmluZztcbiAgcGF0aDogc3RyaW5nO1xuICB1cGRhdGVkQXQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFNpdGVTZXR0aW5ncyB7XG4gIGRlZmF1bHRTdHVkZW50TmFtZTogc3RyaW5nO1xuICBjZXJ0aWZpY2F0ZVByZXZpZXdUaXRsZTogc3RyaW5nO1xuICBsb2dvPzogTG9nbztcbiAgZm9vdGVyTG9nbz86IExvZ287XG4gIGRlZmF1bHRQcmV2aWV3TmFtZT86IHN0cmluZztcbiAgZGVmYXVsdENvdXJzZU5hbWU/OiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbk5hbWU/OiBzdHJpbmc7XG4gIGRlZmF1bHRJc3N1ZXJUaXRsZT86IHN0cmluZztcbiAgcHJldmlld0Rlc2NyaXB0aW9uPzogc3RyaW5nO1xuICBwcmV2aWV3RGF0YVRpdGxlPzogc3RyaW5nO1xuICBjZXJ0aWZpY2F0ZUhhbmRsZXI/OiAocGRmVXJsOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG59XG5cbmNvbnN0IGRlZmF1bHRTZXR0aW5nczogU2l0ZVNldHRpbmdzID0ge1xuICBkZWZhdWx0U3R1ZGVudE5hbWU6ICcnLFxuICBjZXJ0aWZpY2F0ZVByZXZpZXdUaXRsZTogJ0NlcnRpZmljYXRlIFByZXZpZXcnLFxuICBkZWZhdWx0UHJldmlld05hbWU6ICcnLFxuICBkZWZhdWx0Q291cnNlTmFtZTogJycsXG4gIG9yZ2FuaXphdGlvbk5hbWU6ICcnLFxuICBkZWZhdWx0SXNzdWVyVGl0bGU6ICcnLFxuICBwcmV2aWV3RGVzY3JpcHRpb246ICcnLFxuICBwcmV2aWV3RGF0YVRpdGxlOiAnUHJldmlldyBEYXRhJ1xufTtcblxuY29uc3QgU2V0dGluZ3NDb250ZXh0ID0gY3JlYXRlQ29udGV4dDx7XG4gIHNldHRpbmdzOiBTaXRlU2V0dGluZ3M7XG4gIGxvYWRpbmc6IGJvb2xlYW47XG4gIGVycm9yOiBzdHJpbmcgfCBudWxsO1xufT4oe1xuICBzZXR0aW5nczogZGVmYXVsdFNldHRpbmdzLFxuICBsb2FkaW5nOiB0cnVlLFxuICBlcnJvcjogbnVsbFxufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VTZXR0aW5ncyA9ICgpID0+IHVzZUNvbnRleHQoU2V0dGluZ3NDb250ZXh0KTtcblxuZXhwb3J0IGNvbnN0IFNldHRpbmdzUHJvdmlkZXI6IFJlYWN0LkZDPHtjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0+ID0gKHtjaGlsZHJlbiB9KSA9PiB7XG4gIGNvbnN0IFtzZXR0aW5ncywgc2V0U2V0dGluZ3NdID0gdXNlU3RhdGU8U2l0ZVNldHRpbmdzPihkZWZhdWx0U2V0dGluZ3MpO1xuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFVzZSBhIG9uZS10aW1lIHF1ZXJ5IGluc3RlYWQgb2YgYSByZWFsLXRpbWUgbGlzdGVuZXJcbiAgICBjb25zdCBmZXRjaFNldHRpbmdzID0gYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBjYWNoZWQgc2V0dGluZ3NcbiAgICAgICAgY29uc3QgY2FjaGVkU2V0dGluZ3MgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2l0ZV9zZXR0aW5ncycpO1xuICAgICAgICBjb25zdCBjYWNoZVRpbWVzdGFtcCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaXRlX3NldHRpbmdzX3RpbWVzdGFtcCcpO1xuXG4gICAgICAgIC8vIFVzZSBjYWNoZSBpZiBpdCdzIGxlc3MgdGhhbiAxNSBtaW51dGVzIG9sZFxuICAgICAgICBpZiAoY2FjaGVkU2V0dGluZ3MgJiYgY2FjaGVUaW1lc3RhbXApIHtcbiAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBwYXJzZUludChjYWNoZVRpbWVzdGFtcCk7XG4gICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICBjb25zdCBmaWZ0ZWVuTWludXRlcyA9IDE1ICogNjAgKiAxMDAwO1xuXG4gICAgICAgICAgaWYgKG5vdyAtIHRpbWVzdGFtcCA8IGZpZnRlZW5NaW51dGVzKSB7XG4gICAgICAgICAgICBzZXRTZXR0aW5ncyh7XG4gICAgICAgICAgICAgIC4uLmRlZmF1bHRTZXR0aW5ncyxcbiAgICAgICAgICAgICAgLi4uSlNPTi5wYXJzZShjYWNoZWRTZXR0aW5ncylcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICAgLy8gRmV0Y2ggZnJvbSBGaXJlc3RvcmUgaWYgbm8gdmFsaWQgY2FjaGVcbiAgICAgICAgY29uc3Qgc2V0dGluZ3NSZWYgPSBkb2MoZmlyZXN0b3JlLCAnc2V0dGluZ3MnLCAnc2l0ZScpO1xuICAgICAgICBjb25zdCBkb2NTbmFwc2hvdCA9IGF3YWl0IGdldERvYyhzZXR0aW5nc1JlZik7XG5cbiAgICAgICAgaWYgKGRvY1NuYXBzaG90LmV4aXN0cygpKSB7XG4gICAgICAgICAgY29uc3Qgc2V0dGluZ3NEYXRhID0gZG9jU25hcHNob3QuZGF0YSgpIGFzIFNpdGVTZXR0aW5ncztcbiAgICAgICAgICBzZXRTZXR0aW5ncyh7XG4gICAgICAgICAgICAuLi5kZWZhdWx0U2V0dGluZ3MsXG4gICAgICAgICAgICAuLi5zZXR0aW5nc0RhdGFcbiAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBDYWNoZSB0aGUgc2V0dGluZ3NcbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2l0ZV9zZXR0aW5ncycsIEpTT04uc3RyaW5naWZ5KHNldHRpbmdzRGF0YSkpO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzaXRlX3NldHRpbmdzX3RpbWVzdGFtcCcsIERhdGUubm93KCkudG9TdHJpbmcoKSk7XG4gICAgICB9XG5cbiAgICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCc7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHNldHRpbmdzOicsIGVycm9yKTtcbiAgICAgICAgc2V0RXJyb3IoZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuXG4gICAgICAgIC8vIFRyeSB0byB1c2UgY2FjaGVkIHNldHRpbmdzIGV2ZW4gaWYgdGhleSdyZSBvbGRlclxuICAgICAgICBjb25zdCBjYWNoZWRTZXR0aW5ncyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaXRlX3NldHRpbmdzJyk7XG4gICAgICAgIGlmIChjYWNoZWRTZXR0aW5ncykge1xuICAgICAgICAgIHNldFNldHRpbmdzKHtcbiAgICAgICAgICAgIC4uLmRlZmF1bHRTZXR0aW5ncyxcbiAgICAgICAgICAgIC4uLkpTT04ucGFyc2UoY2FjaGVkU2V0dGluZ3MpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAgIGZldGNoU2V0dGluZ3MoKTtcbn0sIFtdKTtcblxuICByZXR1cm4gKFxuICAgIDxTZXR0aW5nc0NvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3tzZXR0aW5ncywgbG9hZGluZywgZXJyb3IgfX0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9TZXR0aW5nc0NvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59O1xuXG4iXSwibmFtZXMiOlsiUmVhY3QiLCJjcmVhdGVDb250ZXh0IiwidXNlQ29udGV4dCIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwiZG9jIiwiZ2V0RG9jIiwiZmlyZXN0b3JlIiwiZGVmYXVsdFNldHRpbmdzIiwiZGVmYXVsdFN0dWRlbnROYW1lIiwiY2VydGlmaWNhdGVQcmV2aWV3VGl0bGUiLCJkZWZhdWx0UHJldmlld05hbWUiLCJkZWZhdWx0Q291cnNlTmFtZSIsIm9yZ2FuaXphdGlvbk5hbWUiLCJkZWZhdWx0SXNzdWVyVGl0bGUiLCJwcmV2aWV3RGVzY3JpcHRpb24iLCJwcmV2aWV3RGF0YVRpdGxlIiwiU2V0dGluZ3NDb250ZXh0Iiwic2V0dGluZ3MiLCJsb2FkaW5nIiwiZXJyb3IiLCJ1c2VTZXR0aW5ncyIsIlNldHRpbmdzUHJvdmlkZXIiLCJjaGlsZHJlbiIsInNldFNldHRpbmdzIiwic2V0TG9hZGluZyIsInNldEVycm9yIiwiZmV0Y2hTZXR0aW5ncyIsImNhY2hlZFNldHRpbmdzIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImNhY2hlVGltZXN0YW1wIiwidGltZXN0YW1wIiwicGFyc2VJbnQiLCJub3ciLCJEYXRlIiwiZmlmdGVlbk1pbnV0ZXMiLCJKU09OIiwicGFyc2UiLCJzZXR0aW5nc1JlZiIsImRvY1NuYXBzaG90IiwiZXhpc3RzIiwic2V0dGluZ3NEYXRhIiwiZGF0YSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJ0b1N0cmluZyIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsImNvbnNvbGUiLCJQcm92aWRlciIsInZhbHVlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/context/SettingsContext.tsx\n");

/***/ }),

/***/ "./src/contexts/NotificationContext.tsx":
/*!**********************************************!*\
  !*** ./src/contexts/NotificationContext.tsx ***!
  \**********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NotificationProvider: () => (/* binding */ NotificationProvider),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   useNotifications: () => (/* binding */ useNotifications)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _context_AuthContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/context/AuthContext */ \"./src/context/AuthContext.tsx\");\n/* harmony import */ var _services_notificationService__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/services/notificationService */ \"./src/services/notificationService.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, _context_AuthContext__WEBPACK_IMPORTED_MODULE_3__, _services_notificationService__WEBPACK_IMPORTED_MODULE_4__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, _context_AuthContext__WEBPACK_IMPORTED_MODULE_3__, _services_notificationService__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n // Import Timestamp\n\n\nconst NotificationContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(undefined);\nconst useNotifications = ()=>{\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(NotificationContext);\n    if (context === undefined) {\n        throw new Error(\"useNotifications must be used within a NotificationProvider\");\n    }\n    return context;\n};\nconst NotificationProvider = ({ children })=>{\n    const { user } = (0,_context_AuthContext__WEBPACK_IMPORTED_MODULE_3__.useAuth)();\n    const [notifications, setNotifications] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Convert system notification to UI notification format\n    const convertToUINotification = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((notification)=>{\n        // Map notification type to UI notification type\n        let uiType = \"system\";\n        switch(notification.type){\n            case \"course_progress\":\n                uiType = \"reminder\";\n                break;\n            case \"course_completion\":\n                uiType = \"course_completion\";\n                break;\n            case \"certificate_expiration\":\n                uiType = \"reminder\";\n                break;\n            case \"new_course_available\":\n                uiType = \"new_course\";\n                break;\n            case \"inactivity_reminder\":\n                uiType = \"reminder\";\n                break;\n            case \"enrollment_confirmation\":\n                uiType = \"system\";\n                break;\n            case \"quiz_completion\":\n                uiType = \"quiz_passed\";\n                break;\n            case \"achievement_unlocked\":\n                uiType = \"system\";\n                break;\n            case \"welcome_message\":\n                uiType = \"system\";\n                break;\n            default:\n                uiType = \"system\";\n        }\n        // Convert Firestore Timestamp to ISO string if it exists\n        const timestampString = notification.createdAt instanceof firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.Timestamp ? notification.createdAt.toDate().toISOString() : typeof notification.createdAt === \"string\" ? notification.createdAt : new Date().toISOString(); // Fallback to current time if undefined\n        return {\n            id: notification.id,\n            type: uiType,\n            title: notification.title,\n            message: notification.message,\n            timestamp: timestampString,\n            isRead: notification.isRead,\n            link: notification.link,\n            data: notification.data,\n            priority: notification.priority === null || notification.priority === undefined ? undefined : notification.priority\n        };\n    }, []);\n    // Fetch notifications\n    const fetchNotifications = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async ()=>{\n        if (!user?.id) {\n            setNotifications([]);\n            return;\n        }\n        setLoading(true);\n        try {\n            // Fetch notifications from Firestore\n            const systemNotifications = await (0,_services_notificationService__WEBPACK_IMPORTED_MODULE_4__.getUserNotifications)(user.id, 50);\n            // Convert to UI notifications\n            const uiNotifications = systemNotifications.map(convertToUINotification);\n            // Sort notifications by timestamp (newest first)\n            uiNotifications.sort((a, b)=>{\n                return new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime();\n            });\n            setNotifications(uiNotifications);\n        } catch (error) {\n            console.error(\"Error fetching notifications:\", error);\n        } finally{\n            setLoading(false);\n        }\n    }, [\n        user,\n        convertToUINotification\n    ]);\n    // Fetch notifications when user changes\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        fetchNotifications();\n    }, [\n        user\n    ]);\n    // Mark notification as read\n    const markAsRead = async (notificationId)=>{\n        try {\n            // Update in Firestore\n            await (0,_services_notificationService__WEBPACK_IMPORTED_MODULE_4__.markNotificationAsRead)(notificationId);\n            // Update local state\n            setNotifications((prev)=>prev.map((notification)=>notification.id === notificationId ? {\n                        ...notification,\n                        isRead: true\n                    } : notification));\n        } catch (error) {\n            console.error(\"Error marking notification as read:\", error);\n        }\n    };\n    // Mark all notifications as read\n    const markAllAsRead = async ()=>{\n        if (!user?.id) return;\n        try {\n            // Update in Firestore\n            await (0,_services_notificationService__WEBPACK_IMPORTED_MODULE_4__.markAllNotificationsAsRead)(user.id);\n            // Update local state\n            setNotifications((prev)=>prev.map((notification)=>({\n                        ...notification,\n                        isRead: true\n                    })));\n        } catch (error) {\n            console.error(\"Error marking all notifications as read:\", error);\n        }\n    };\n    // Delete notification\n    const deleteNotification = async (notificationId)=>{\n        try {\n            // Delete from Firestore\n            await (0,_services_notificationService__WEBPACK_IMPORTED_MODULE_4__.deleteNotification)(notificationId);\n            // Remove from local state\n            setNotifications((prev)=>prev.filter((notification)=>notification.id !== notificationId));\n        } catch (error) {\n            console.error(\"Error deleting notification:\", error);\n        }\n    };\n    // Calculate unread count\n    const unreadCount = notifications.filter((notification)=>!notification.isRead).length;\n    // Context value\n    const value = {\n        notifications,\n        unreadCount,\n        loading,\n        markAsRead,\n        markAllAsRead,\n        deleteNotification,\n        refreshNotifications: fetchNotifications\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(NotificationContext.Provider, {\n        value: value,\n        children: children\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\contexts\\\\NotificationContext.tsx\",\n        lineNumber: 208,\n        columnNumber: 5\n    }, undefined);\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (NotificationContext);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSx5QkFBeUI7SUFDekIsTUFBTU8sY0FBY3BDLGNBQWNtQyxNQUFNLENBQUM5QixDQUFBQSxlQUFnQixDQUFDQSxhQUFhWSxNQUFNLEVBQUVvQixNQUFNO0lBRXJGLGdCQUFnQjtJQUNoQixNQUFNQyxRQUFRO1FBQ1p0QztRQUNBb0M7UUFDQWxDO1FBQ0E2QjtRQUNBRztRQUNBNUM7UUFDQWlELHNCQUFzQmxCO0lBQzFCO0lBRUUscUJBQ0UsOERBQUM3QixvQkFBb0JnRCxRQUFRO1FBQUNGLE9BQU9BO2tCQUNsQ3hDOzs7Ozs7QUFHUCxFQUFFO0FBRUYsaUVBQWVOLG1CQUFtQkEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL2NvbnRleHRzL05vdGlmaWNhdGlvbkNvbnRleHQudHN4PzUyZGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7Y3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1RpbWVzdGFtcCB9IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7IC8vIEltcG9ydCBUaW1lc3RhbXBcbmltcG9ydCB7dXNlQXV0aCB9IGZyb20gJ0AvY29udGV4dC9BdXRoQ29udGV4dCc7XG5pbXBvcnQge05vdGlmaWNhdGlvbiBhcyBVSU5vdGlmaWNhdGlvbiwgTm90aWZpY2F0aW9uVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50cy9ub3RpZmljYXRpb25zL05vdGlmaWNhdGlvbkl0ZW0nO1xuaW1wb3J0IHtcbiAgTm90aWZpY2F0aW9uLFxuICBnZXRVc2VyTm90aWZpY2F0aW9ucyxcbiAgbWFya05vdGlmaWNhdGlvbkFzUmVhZCxcbiAgbWFya0FsbE5vdGlmaWNhdGlvbnNBc1JlYWQsXG4gIGRlbGV0ZU5vdGlmaWNhdGlvbiBhcyBkZWxldGVOb3RpZlxufSBmcm9tICdAL3NlcnZpY2VzL25vdGlmaWNhdGlvblNlcnZpY2UnO1xuXG4vLyBEZWZpbmUgdGhlIHNoYXBlIG9mIG91ciBVSSBub3RpZmljYXRpb24gKHVzZWQgYnkgdGhlIE5vdGlmaWNhdGlvbkNlbnRlciBjb21wb25lbnQpXG5pbnRlcmZhY2UgTm90aWZpY2F0aW9uVUkge1xuICBpZDogc3RyaW5nO1xuICB0eXBlOiBOb3RpZmljYXRpb25UeXBlO1xuICB0aXRsZTogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xuICBpc1JlYWQ6IGJvb2xlYW47XG4gIGxpbms/OiBzdHJpbmc7XG4gIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICBwcmlvcml0eT86ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCB1bmRlZmluZWQ7XG59XG5cbmludGVyZmFjZSBOb3RpZmljYXRpb25Db250ZXh0VHlwZSB7XG4gIG5vdGlmaWNhdGlvbnM6IE5vdGlmaWNhdGlvblVJW107XG4gIHVucmVhZENvdW50OiBudW1iZXI7XG4gIGxvYWRpbmc6IGJvb2xlYW47XG4gIG1hcmtBc1JlYWQ6IChub3RpZmljYXRpb25JZDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBtYXJrQWxsQXNSZWFkOiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBkZWxldGVOb3RpZmljYXRpb246IChub3RpZmljYXRpb25JZDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuICByZWZyZXNoTm90aWZpY2F0aW9uczogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuY29uc3QgTm90aWZpY2F0aW9uQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8Tm90aWZpY2F0aW9uQ29udGV4dFR5cGUgfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG5cbmV4cG9ydCBjb25zdCB1c2VOb3RpZmljYXRpb25zID0gKCkgPT4ge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChOb3RpZmljYXRpb25Db250ZXh0KTtcbiAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcigndXNlTm90aWZpY2F0aW9ucyBtdXN0IGJlIHVzZWQgd2l0aGluIGEgTm90aWZpY2F0aW9uUHJvdmlkZXInKTtcbn1cbiAgcmV0dXJuIGNvbnRleHQ7XG59O1xuXG5leHBvcnQgY29uc3QgTm90aWZpY2F0aW9uUHJvdmlkZXI6IFJlYWN0LkZDPHtjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0+ID0gKHtjaGlsZHJlbiB9KSA9PiB7XG4gIGNvbnN0IHt1c2VyIH0gPSB1c2VBdXRoKCk7XG4gIGNvbnN0IFtub3RpZmljYXRpb25zLCBzZXROb3RpZmljYXRpb25zXSA9IHVzZVN0YXRlPE5vdGlmaWNhdGlvblVJW10+KFtdKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIENvbnZlcnQgc3lzdGVtIG5vdGlmaWNhdGlvbiB0byBVSSBub3RpZmljYXRpb24gZm9ybWF0XG4gIGNvbnN0IGNvbnZlcnRUb1VJTm90aWZpY2F0aW9uID0gdXNlQ2FsbGJhY2soKG5vdGlmaWNhdGlvbjogTm90aWZpY2F0aW9uKTogTm90aWZpY2F0aW9uVUkgPT4ge1xuICAgIC8vIE1hcCBub3RpZmljYXRpb24gdHlwZSB0byBVSSBub3RpZmljYXRpb24gdHlwZVxuICAgIGxldCB1aVR5cGU6IE5vdGlmaWNhdGlvblR5cGUgPSAnc3lzdGVtJztcblxuICAgIHN3aXRjaCAobm90aWZpY2F0aW9uLnR5cGUpIHtcbiAgICAgIGNhc2UgJ2NvdXJzZV9wcm9ncmVzcyc6XG4gICAgICAgIHVpVHlwZSA9ICdyZW1pbmRlcic7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnY291cnNlX2NvbXBsZXRpb24nOlxuICAgICAgICB1aVR5cGUgPSAnY291cnNlX2NvbXBsZXRpb24nO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2NlcnRpZmljYXRlX2V4cGlyYXRpb24nOlxuICAgICAgICB1aVR5cGUgPSAncmVtaW5kZXInO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ25ld19jb3Vyc2VfYXZhaWxhYmxlJzpcbiAgICAgICAgdWlUeXBlID0gJ25ld19jb3Vyc2UnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2luYWN0aXZpdHlfcmVtaW5kZXInOlxuICAgICAgICB1aVR5cGUgPSAncmVtaW5kZXInO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Vucm9sbG1lbnRfY29uZmlybWF0aW9uJzpcbiAgICAgICAgdWlUeXBlID0gJ3N5c3RlbSc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncXVpel9jb21wbGV0aW9uJzpcbiAgICAgICAgdWlUeXBlID0gJ3F1aXpfcGFzc2VkJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdhY2hpZXZlbWVudF91bmxvY2tlZCc6XG4gICAgICAgIHVpVHlwZSA9ICdzeXN0ZW0nO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3dlbGNvbWVfbWVzc2FnZSc6XG4gICAgICAgIHVpVHlwZSA9ICdzeXN0ZW0nO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHVpVHlwZSA9ICdzeXN0ZW0nO1xuICB9XG5cbiAgICAvLyBDb252ZXJ0IEZpcmVzdG9yZSBUaW1lc3RhbXAgdG8gSVNPIHN0cmluZyBpZiBpdCBleGlzdHNcbiAgICBjb25zdCB0aW1lc3RhbXBTdHJpbmcgPSBub3RpZmljYXRpb24uY3JlYXRlZEF0IGluc3RhbmNlb2YgVGltZXN0YW1wXG4gICAgICA/IG5vdGlmaWNhdGlvbi5jcmVhdGVkQXQudG9EYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgOiB0eXBlb2Ygbm90aWZpY2F0aW9uLmNyZWF0ZWRBdCA9PT0gJ3N0cmluZydcbiAgICAgID8gbm90aWZpY2F0aW9uLmNyZWF0ZWRBdFxuICAgICAgOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7IC8vIEZhbGxiYWNrIHRvIGN1cnJlbnQgdGltZSBpZiB1bmRlZmluZWRcblxuICAgIHJldHVybiB7XG4gICAgICBpZDogbm90aWZpY2F0aW9uLmlkLFxuICAgICAgdHlwZTogdWlUeXBlLFxuICAgICAgdGl0bGU6IG5vdGlmaWNhdGlvbi50aXRsZSxcbiAgICAgIG1lc3NhZ2U6IG5vdGlmaWNhdGlvbi5tZXNzYWdlLFxuICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXBTdHJpbmcsXG4gICAgICBpc1JlYWQ6IG5vdGlmaWNhdGlvbi5pc1JlYWQsXG4gICAgICBsaW5rOiBub3RpZmljYXRpb24ubGluayxcbiAgICAgIGRhdGE6IG5vdGlmaWNhdGlvbi5kYXRhLFxuICAgICAgcHJpb3JpdHk6IG5vdGlmaWNhdGlvbi5wcmlvcml0eSA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24ucHJpb3JpdHkgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IG5vdGlmaWNhdGlvbi5wcmlvcml0eVxuICB9O1xufSwgW10pO1xuXG4gIC8vIEZldGNoIG5vdGlmaWNhdGlvbnNcbiAgY29uc3QgZmV0Y2hOb3RpZmljYXRpb25zID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGlmICghdXNlcj8uaWQpIHtcbiAgICAgIHNldE5vdGlmaWNhdGlvbnMoW10pO1xuICAgICAgcmV0dXJuO1xuICB9XG5cbiAgICBzZXRMb2FkaW5nKHRydWUpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEZldGNoIG5vdGlmaWNhdGlvbnMgZnJvbSBGaXJlc3RvcmVcbiAgICAgIGNvbnN0IHN5c3RlbU5vdGlmaWNhdGlvbnMgPSBhd2FpdCBnZXRVc2VyTm90aWZpY2F0aW9ucyh1c2VyLmlkLCA1MCk7XG5cbiAgICAgIC8vIENvbnZlcnQgdG8gVUkgbm90aWZpY2F0aW9uc1xuICAgICAgY29uc3QgdWlOb3RpZmljYXRpb25zID0gc3lzdGVtTm90aWZpY2F0aW9ucy5tYXAoY29udmVydFRvVUlOb3RpZmljYXRpb24pO1xuXG4gICAgICAvLyBTb3J0IG5vdGlmaWNhdGlvbnMgYnkgdGltZXN0YW1wIChuZXdlc3QgZmlyc3QpXG4gICAgICB1aU5vdGlmaWNhdGlvbnMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoYi50aW1lc3RhbXApLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEudGltZXN0YW1wKS5nZXRUaW1lKCk7XG4gICAgfSk7XG5cbiAgICAgIHNldE5vdGlmaWNhdGlvbnModWlOb3RpZmljYXRpb25zKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG5vdGlmaWNhdGlvbnM6JywgZXJyb3IpO1xuICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gIH1cbn0sIFt1c2VyLCBjb252ZXJ0VG9VSU5vdGlmaWNhdGlvbl0pO1xuXG4gIC8vIEZldGNoIG5vdGlmaWNhdGlvbnMgd2hlbiB1c2VyIGNoYW5nZXNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBmZXRjaE5vdGlmaWNhdGlvbnMoKTtcbn0sIFt1c2VyXSk7XG5cbiAgLy8gTWFyayBub3RpZmljYXRpb24gYXMgcmVhZFxuICBjb25zdCBtYXJrQXNSZWFkID0gYXN5bmMgKG5vdGlmaWNhdGlvbklkOiBzdHJpbmcpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVXBkYXRlIGluIEZpcmVzdG9yZVxuICAgICAgYXdhaXQgbWFya05vdGlmaWNhdGlvbkFzUmVhZChub3RpZmljYXRpb25JZCk7XG5cbiAgICAgIC8vIFVwZGF0ZSBsb2NhbCBzdGF0ZVxuICAgICAgc2V0Tm90aWZpY2F0aW9ucyhwcmV2ID0+XG4gICAgICAgIHByZXYubWFwKG5vdGlmaWNhdGlvbiA9PlxuICAgICAgICAgIG5vdGlmaWNhdGlvbi5pZCA9PT0gbm90aWZpY2F0aW9uSWRcbiAgICAgICAgICAgID8gey4uLm5vdGlmaWNhdGlvbiwgaXNSZWFkOiB0cnVlIH1cbiAgICAgICAgICAgIDogbm90aWZpY2F0aW9uXG4gICAgICAgIClcbiAgICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIG5vdGlmaWNhdGlvbiBhcyByZWFkOicsIGVycm9yKTtcbiAgfVxufTtcblxuICAvLyBNYXJrIGFsbCBub3RpZmljYXRpb25zIGFzIHJlYWRcbiAgY29uc3QgbWFya0FsbEFzUmVhZCA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXVzZXI/LmlkKSByZXR1cm47XG5cbiAgICB0cnkge1xuICAgICAgLy8gVXBkYXRlIGluIEZpcmVzdG9yZVxuICAgICAgYXdhaXQgbWFya0FsbE5vdGlmaWNhdGlvbnNBc1JlYWQodXNlci5pZCk7XG5cbiAgICAgIC8vIFVwZGF0ZSBsb2NhbCBzdGF0ZVxuICAgICAgc2V0Tm90aWZpY2F0aW9ucyhwcmV2ID0+XG4gICAgICAgIHByZXYubWFwKG5vdGlmaWNhdGlvbiA9PiAoey4uLm5vdGlmaWNhdGlvbiwgaXNSZWFkOiB0cnVlIH0pKVxuICAgICAgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG1hcmtpbmcgYWxsIG5vdGlmaWNhdGlvbnMgYXMgcmVhZDonLCBlcnJvcik7XG4gIH1cbn07XG5cbiAgLy8gRGVsZXRlIG5vdGlmaWNhdGlvblxuICBjb25zdCBkZWxldGVOb3RpZmljYXRpb24gPSBhc3luYyAobm90aWZpY2F0aW9uSWQ6IHN0cmluZykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBEZWxldGUgZnJvbSBGaXJlc3RvcmVcbiAgICAgIGF3YWl0IGRlbGV0ZU5vdGlmKG5vdGlmaWNhdGlvbklkKTtcblxuICAgICAgLy8gUmVtb3ZlIGZyb20gbG9jYWwgc3RhdGVcbiAgICAgIHNldE5vdGlmaWNhdGlvbnMocHJldiA9PlxuICAgICAgICBwcmV2LmZpbHRlcihub3RpZmljYXRpb24gPT4gbm90aWZpY2F0aW9uLmlkICE9PSBub3RpZmljYXRpb25JZClcbiAgICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBub3RpZmljYXRpb246JywgZXJyb3IpO1xuICB9XG59O1xuXG4gIC8vIENhbGN1bGF0ZSB1bnJlYWQgY291bnRcbiAgY29uc3QgdW5yZWFkQ291bnQgPSBub3RpZmljYXRpb25zLmZpbHRlcihub3RpZmljYXRpb24gPT4gIW5vdGlmaWNhdGlvbi5pc1JlYWQpLmxlbmd0aDtcblxuICAvLyBDb250ZXh0IHZhbHVlXG4gIGNvbnN0IHZhbHVlID0ge1xuICAgIG5vdGlmaWNhdGlvbnMsXG4gICAgdW5yZWFkQ291bnQsXG4gICAgbG9hZGluZyxcbiAgICBtYXJrQXNSZWFkLFxuICAgIG1hcmtBbGxBc1JlYWQsXG4gICAgZGVsZXRlTm90aWZpY2F0aW9uLFxuICAgIHJlZnJlc2hOb3RpZmljYXRpb25zOiBmZXRjaE5vdGlmaWNhdGlvbnMsXG59O1xuXG4gIHJldHVybiAoXG4gICAgPE5vdGlmaWNhdGlvbkNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3ZhbHVlfT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L05vdGlmaWNhdGlvbkNvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBOb3RpZmljYXRpb25Db250ZXh0O1xuIl0sIm5hbWVzIjpbIlJlYWN0IiwiY3JlYXRlQ29udGV4dCIsInVzZUNvbnRleHQiLCJ1c2VTdGF0ZSIsInVzZUVmZmVjdCIsInVzZUNhbGxiYWNrIiwiVGltZXN0YW1wIiwidXNlQXV0aCIsImdldFVzZXJOb3RpZmljYXRpb25zIiwibWFya05vdGlmaWNhdGlvbkFzUmVhZCIsIm1hcmtBbGxOb3RpZmljYXRpb25zQXNSZWFkIiwiZGVsZXRlTm90aWZpY2F0aW9uIiwiZGVsZXRlTm90aWYiLCJOb3RpZmljYXRpb25Db250ZXh0IiwidW5kZWZpbmVkIiwidXNlTm90aWZpY2F0aW9ucyIsImNvbnRleHQiLCJFcnJvciIsIk5vdGlmaWNhdGlvblByb3ZpZGVyIiwiY2hpbGRyZW4iLCJ1c2VyIiwibm90aWZpY2F0aW9ucyIsInNldE5vdGlmaWNhdGlvbnMiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsImNvbnZlcnRUb1VJTm90aWZpY2F0aW9uIiwibm90aWZpY2F0aW9uIiwidWlUeXBlIiwidHlwZSIsInRpbWVzdGFtcFN0cmluZyIsImNyZWF0ZWRBdCIsInRvRGF0ZSIsInRvSVNPU3RyaW5nIiwiRGF0ZSIsImlkIiwidGl0bGUiLCJtZXNzYWdlIiwidGltZXN0YW1wIiwiaXNSZWFkIiwibGluayIsImRhdGEiLCJwcmlvcml0eSIsImZldGNoTm90aWZpY2F0aW9ucyIsInN5c3RlbU5vdGlmaWNhdGlvbnMiLCJ1aU5vdGlmaWNhdGlvbnMiLCJtYXAiLCJzb3J0IiwiYSIsImIiLCJnZXRUaW1lIiwiZXJyb3IiLCJjb25zb2xlIiwibWFya0FzUmVhZCIsIm5vdGlmaWNhdGlvbklkIiwicHJldiIsIm1hcmtBbGxBc1JlYWQiLCJmaWx0ZXIiLCJ1bnJlYWRDb3VudCIsImxlbmd0aCIsInZhbHVlIiwicmVmcmVzaE5vdGlmaWNhdGlvbnMiLCJQcm92aWRlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/contexts/NotificationContext.tsx\n");

/***/ }),

/***/ "./src/pages/_app.tsx":
/*!****************************!*\
  !*** ./src/pages/_app.tsx ***!
  \****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ App)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_font_google_target_css_path_src_pages_app_tsx_import_Inter_arguments_subsets_latin_variable_font_inter_variableName_inter___WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/font/google/target.css?{\"path\":\"src\\\\pages\\\\_app.tsx\",\"import\":\"Inter\",\"arguments\":[{\"subsets\":[\"latin\"],\"variable\":\"--font-inter\"}],\"variableName\":\"inter\"} */ \"./node_modules/next/font/google/target.css?{\\\"path\\\":\\\"src\\\\\\\\pages\\\\\\\\_app.tsx\\\",\\\"import\\\":\\\"Inter\\\",\\\"arguments\\\":[{\\\"subsets\\\":[\\\"latin\\\"],\\\"variable\\\":\\\"--font-inter\\\"}],\\\"variableName\\\":\\\"inter\\\"}\");\n/* harmony import */ var next_font_google_target_css_path_src_pages_app_tsx_import_Inter_arguments_subsets_latin_variable_font_inter_variableName_inter___WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_font_google_target_css_path_src_pages_app_tsx_import_Inter_arguments_subsets_latin_variable_font_inter_variableName_inter___WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var next_font_google_target_css_path_src_pages_app_tsx_import_Montserrat_arguments_subsets_latin_variable_font_montserrat_variableName_montserrat___WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! next/font/google/target.css?{\"path\":\"src\\\\pages\\\\_app.tsx\",\"import\":\"Montserrat\",\"arguments\":[{\"subsets\":[\"latin\"],\"variable\":\"--font-montserrat\"}],\"variableName\":\"montserrat\"} */ \"./node_modules/next/font/google/target.css?{\\\"path\\\":\\\"src\\\\\\\\pages\\\\\\\\_app.tsx\\\",\\\"import\\\":\\\"Montserrat\\\",\\\"arguments\\\":[{\\\"subsets\\\":[\\\"latin\\\"],\\\"variable\\\":\\\"--font-montserrat\\\"}],\\\"variableName\\\":\\\"montserrat\\\"}\");\n/* harmony import */ var next_font_google_target_css_path_src_pages_app_tsx_import_Montserrat_arguments_subsets_latin_variable_font_montserrat_variableName_montserrat___WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(next_font_google_target_css_path_src_pages_app_tsx_import_Montserrat_arguments_subsets_latin_variable_font_montserrat_variableName_montserrat___WEBPACK_IMPORTED_MODULE_16__);\n/* harmony import */ var next_font_google_target_css_path_src_pages_app_tsx_import_JetBrains_Mono_arguments_subsets_latin_variable_font_jetbrains_mono_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! next/font/google/target.css?{\"path\":\"src\\\\pages\\\\_app.tsx\",\"import\":\"JetBrains_Mono\",\"arguments\":[{\"subsets\":[\"latin\"],\"variable\":\"--font-jetbrains-mono\"}],\"variableName\":\"jetbrainsMono\"} */ \"./node_modules/next/font/google/target.css?{\\\"path\\\":\\\"src\\\\\\\\pages\\\\\\\\_app.tsx\\\",\\\"import\\\":\\\"JetBrains_Mono\\\",\\\"arguments\\\":[{\\\"subsets\\\":[\\\"latin\\\"],\\\"variable\\\":\\\"--font-jetbrains-mono\\\"}],\\\"variableName\\\":\\\"jetbrainsMono\\\"}\");\n/* harmony import */ var next_font_google_target_css_path_src_pages_app_tsx_import_JetBrains_Mono_arguments_subsets_latin_variable_font_jetbrains_mono_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(next_font_google_target_css_path_src_pages_app_tsx_import_JetBrains_Mono_arguments_subsets_latin_variable_font_jetbrains_mono_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_17__);\n/* harmony import */ var _styles_globals_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/styles/globals.css */ \"./src/styles/globals.css\");\n/* harmony import */ var _styles_globals_css__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_styles_globals_css__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var react_hot_toast__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-hot-toast */ \"react-hot-toast\");\n/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @mui/material/styles */ \"@mui/material/styles\");\n/* harmony import */ var _mui_material_CssBaseline__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @mui/material/CssBaseline */ \"@mui/material/CssBaseline\");\n/* harmony import */ var _emotion_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @emotion/react */ \"@emotion/react\");\n/* harmony import */ var _utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/utils/createEmotionCache */ \"./src/utils/createEmotionCache.ts\");\n/* harmony import */ var _context_AuthContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/context/AuthContext */ \"./src/context/AuthContext.tsx\");\n/* harmony import */ var _context_CourseContext__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/context/CourseContext */ \"./src/context/CourseContext.tsx\");\n/* harmony import */ var _contexts_NotificationContext__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/contexts/NotificationContext */ \"./src/contexts/NotificationContext.tsx\");\n/* harmony import */ var _context_SettingsContext__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/context/SettingsContext */ \"./src/context/SettingsContext.tsx\");\n/* harmony import */ var _tanstack_react_query__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @tanstack/react-query */ \"@tanstack/react-query\");\n/* harmony import */ var _tanstack_react_query_devtools__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @tanstack/react-query-devtools */ \"@tanstack/react-query-devtools\");\n/* harmony import */ var _utils_queryClient__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/utils/queryClient */ \"./src/utils/queryClient.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([react_hot_toast__WEBPACK_IMPORTED_MODULE_3__, _mui_material_styles__WEBPACK_IMPORTED_MODULE_4__, _mui_material_CssBaseline__WEBPACK_IMPORTED_MODULE_5__, _emotion_react__WEBPACK_IMPORTED_MODULE_6__, _utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_7__, _context_AuthContext__WEBPACK_IMPORTED_MODULE_8__, _context_CourseContext__WEBPACK_IMPORTED_MODULE_9__, _contexts_NotificationContext__WEBPACK_IMPORTED_MODULE_10__, _context_SettingsContext__WEBPACK_IMPORTED_MODULE_11__, _tanstack_react_query__WEBPACK_IMPORTED_MODULE_12__, _tanstack_react_query_devtools__WEBPACK_IMPORTED_MODULE_13__, _utils_queryClient__WEBPACK_IMPORTED_MODULE_14__]);\n([react_hot_toast__WEBPACK_IMPORTED_MODULE_3__, _mui_material_styles__WEBPACK_IMPORTED_MODULE_4__, _mui_material_CssBaseline__WEBPACK_IMPORTED_MODULE_5__, _emotion_react__WEBPACK_IMPORTED_MODULE_6__, _utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_7__, _context_AuthContext__WEBPACK_IMPORTED_MODULE_8__, _context_CourseContext__WEBPACK_IMPORTED_MODULE_9__, _contexts_NotificationContext__WEBPACK_IMPORTED_MODULE_10__, _context_SettingsContext__WEBPACK_IMPORTED_MODULE_11__, _tanstack_react_query__WEBPACK_IMPORTED_MODULE_12__, _tanstack_react_query_devtools__WEBPACK_IMPORTED_MODULE_13__, _utils_queryClient__WEBPACK_IMPORTED_MODULE_14__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Client-side cache\nconst clientSideEmotionCache = (0,_utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_7__[\"default\"])();\n// Create MUI theme\nconst theme = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_4__.responsiveFontSizes)((0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_4__.createTheme)({\n    palette: {\n        primary: {\n            main: \"#3f51b5\"\n        },\n        secondary: {\n            main: \"#f50057\"\n        }\n    },\n    typography: {\n        fontFamily: \"var(--font-inter), sans-serif\",\n        h1: {\n            fontFamily: \"var(--font-montserrat), sans-serif\"\n        },\n        h2: {\n            fontFamily: \"var(--font-montserrat), sans-serif\"\n        },\n        h3: {\n            fontFamily: \"var(--font-montserrat), sans-serif\"\n        },\n        h4: {\n            fontFamily: \"var(--font-montserrat), sans-serif\"\n        },\n        h5: {\n            fontFamily: \"var(--font-montserrat), sans-serif\"\n        },\n        h6: {\n            fontFamily: \"var(--font-montserrat), sans-serif\"\n        }\n    },\n    components: {\n        MuiButtonBase: {\n            defaultProps: {\n                disableRipple: true\n            }\n        }\n    }\n}));\nfunction App({ Component, pageProps, emotionCache = clientSideEmotionCache }) {\n    // Create the query client - only once when the component mounts\n    // Using lazy initialization to ensure it only runs on the client side\n    const [queryClient, setQueryClient] = react__WEBPACK_IMPORTED_MODULE_2___default().useState(null);\n    // Initialize the query client on the client side only\n    (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{\n        // Create the query client only on the client side\n        setQueryClient((0,_utils_queryClient__WEBPACK_IMPORTED_MODULE_14__.createQueryClient)());\n        // Remove the server-side injected CSS\n        const jssStyles = document.querySelector(\"#jss-server-side\");\n        if (jssStyles?.parentElement) {\n            jssStyles.parentElement.removeChild(jssStyles);\n        }\n    }, []);\n    // Don't render the app until the query client is initialized on the client side\n    // This prevents hydration errors and ensures Firestore persistence is properly set up\n    if (!queryClient) {\n        // Return a minimal loading state that won't cause hydration issues\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_emotion_react__WEBPACK_IMPORTED_MODULE_6__.CacheProvider, {\n            value: emotionCache,\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                style: {\n                    visibility: \"hidden\"\n                },\n                children: \"Loading...\"\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                lineNumber: 97,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n            lineNumber: 96,\n            columnNumber: 7\n        }, this);\n    }\n    // Once the query client is initialized, render the full app\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_emotion_react__WEBPACK_IMPORTED_MODULE_6__.CacheProvider, {\n        value: emotionCache,\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tanstack_react_query__WEBPACK_IMPORTED_MODULE_12__.QueryClientProvider, {\n            client: queryClient,\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mui_material_styles__WEBPACK_IMPORTED_MODULE_4__.StyledEngineProvider, {\n                    injectFirst: true,\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mui_material_styles__WEBPACK_IMPORTED_MODULE_4__.ThemeProvider, {\n                        theme: theme,\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_mui_material_CssBaseline__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {}, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                lineNumber: 108,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_context_AuthContext__WEBPACK_IMPORTED_MODULE_8__.AuthProvider, {\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_context_SettingsContext__WEBPACK_IMPORTED_MODULE_11__.SettingsProvider, {\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_context_CourseContext__WEBPACK_IMPORTED_MODULE_9__.CourseProvider, {\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_contexts_NotificationContext__WEBPACK_IMPORTED_MODULE_10__.NotificationProvider, {\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"main\", {\n                                                className: `${(next_font_google_target_css_path_src_pages_app_tsx_import_Inter_arguments_subsets_latin_variable_font_inter_variableName_inter___WEBPACK_IMPORTED_MODULE_15___default().variable)} ${(next_font_google_target_css_path_src_pages_app_tsx_import_Montserrat_arguments_subsets_latin_variable_font_montserrat_variableName_montserrat___WEBPACK_IMPORTED_MODULE_16___default().variable)} ${(next_font_google_target_css_path_src_pages_app_tsx_import_JetBrains_Mono_arguments_subsets_latin_variable_font_jetbrains_mono_variableName_jetbrainsMono___WEBPACK_IMPORTED_MODULE_17___default().variable)}`,\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n                                                        ...pageProps\n                                                    }, void 0, false, {\n                                                        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                                        lineNumber: 114,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_hot_toast__WEBPACK_IMPORTED_MODULE_3__.Toaster, {\n                                                        position: \"top-right\"\n                                                    }, void 0, false, {\n                                                        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                                        lineNumber: 115,\n                                                        columnNumber: 23\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                                lineNumber: 113,\n                                                columnNumber: 21\n                                            }, this)\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                            lineNumber: 112,\n                                            columnNumber: 19\n                                        }, this)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                        lineNumber: 111,\n                                        columnNumber: 17\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                    lineNumber: 110,\n                                    columnNumber: 15\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                                lineNumber: 109,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                        lineNumber: 107,\n                        columnNumber: 11\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                    lineNumber: 106,\n                    columnNumber: 9\n                }, this),\n                 true && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_tanstack_react_query_devtools__WEBPACK_IMPORTED_MODULE_13__.ReactQueryDevtools, {}, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n                    lineNumber: 123,\n                    columnNumber: 52\n                }, this)\n            ]\n        }, void 0, true, {\n            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n            lineNumber: 105,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_app.tsx\",\n        lineNumber: 104,\n        columnNumber: 5\n    }, this);\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFnZXMvX2FwcC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFrQk1BO0FBQ0FDO0FBQ0FDO0FBcEJ3QjtBQUVVO0FBRUM7QUFDbUU7QUFDeEQ7QUFDUTtBQUNBO0FBQ1I7QUFDSTtBQUNhO0FBQ1Q7QUFDWTtBQUNMO0FBQ1o7QUFPdkQsb0JBQW9CO0FBQ3BCLE1BQU1rQix5QkFBeUJSLHFFQUFrQkE7QUFFakQsbUJBQW1CO0FBQ25CLE1BQU1TLFFBQVFiLHlFQUFtQkEsQ0FBQ0QsaUVBQVdBLENBQUM7SUFDNUNlLFNBQVM7UUFDUEMsU0FBUztZQUNQQyxNQUFNO1FBQ1Y7UUFDRUMsV0FBVztZQUNURCxNQUFNO1FBQ1Y7SUFDRjtJQUNFRSxZQUFZO1FBQ1ZDLFlBQVk7UUFDWkMsSUFBSTtZQUNGRCxZQUFZO1FBQ2hCO1FBQ0VFLElBQUk7WUFDRkYsWUFBWTtRQUNoQjtRQUNFRyxJQUFJO1lBQ0ZILFlBQVk7UUFDaEI7UUFDRUksSUFBSTtZQUNGSixZQUFZO1FBQ2hCO1FBQ0VLLElBQUk7WUFDRkwsWUFBWTtRQUNoQjtRQUNFTSxJQUFJO1lBQ0ZOLFlBQVk7UUFDaEI7SUFDRjtJQUNFTyxZQUFZO1FBQ1ZDLGVBQWU7WUFDYkMsY0FBYztnQkFDWkMsZUFBZTtZQUNuQjtRQUNGO0lBQ0Y7QUFDQTtBQU1lLFNBQVNDLElBQUksRUFDMUJDLFNBQVMsRUFDVEMsU0FBUyxFQUNUQyxlQUFlckIsc0JBQXNCLEVBQzFCO0lBQ1gsZ0VBQWdFO0lBQ2hFLHNFQUFzRTtJQUN0RSxNQUFNLENBQUNzQixhQUFhQyxlQUFlLEdBQUd4QyxxREFBYyxDQUFxQjtJQUV6RSxzREFBc0Q7SUFDdERDLGdEQUFTQSxDQUFDO1FBQ1Isa0RBQWtEO1FBQ2xEdUMsZUFBZXhCLHNFQUFpQkE7UUFFaEMsc0NBQXNDO1FBQ3RDLE1BQU0wQixZQUFZQyxTQUFTQyxhQUFhLENBQUM7UUFDekMsSUFBSUYsV0FBV0csZUFBZTtZQUM1QkgsVUFBVUcsYUFBYSxDQUFDQyxXQUFXLENBQUNKO1FBQ3hDO0lBQ0YsR0FBRyxFQUFFO0lBRUgsZ0ZBQWdGO0lBQ2hGLHNGQUFzRjtJQUN0RixJQUFJLENBQUNILGFBQWE7UUFDaEIsbUVBQW1FO1FBQ25FLHFCQUNFLDhEQUFDL0IseURBQWFBO1lBQUN1QyxPQUFPVDtzQkFDcEIsNEVBQUNVO2dCQUFJQyxPQUFPO29CQUFDQyxZQUFZO2dCQUFROzBCQUFHOzs7Ozs7Ozs7OztJQUc1QztJQUVFLDREQUE0RDtJQUM1RCxxQkFDRSw4REFBQzFDLHlEQUFhQTtRQUFDdUMsT0FBT1Q7a0JBQ3BCLDRFQUFDeEIsdUVBQW1CQTtZQUFDcUMsUUFBUVo7OzhCQUMzQiw4REFBQ2pDLHNFQUFvQkE7b0JBQUM4QyxXQUFXOzhCQUMvQiw0RUFBQ2pELCtEQUFhQTt3QkFBQ2UsT0FBT0E7OzBDQUNwQiw4REFBQ1gsaUVBQVdBOzs7OzswQ0FDWiw4REFBQ0csOERBQVlBOzBDQUNYLDRFQUFDRyx1RUFBZ0JBOzhDQUNmLDRFQUFDRixrRUFBY0E7a0RBQ2IsNEVBQUNDLGdGQUFvQkE7c0RBQ25CLDRFQUFDUztnREFBS2dDLFdBQVcsQ0FBQyxFQUFFeEQsa0xBQWMsQ0FBQyxDQUFDLEVBQUVDLGlNQUFtQixDQUFDLENBQUMsRUFBRUMsNE1BQXNCLENBQUMsQ0FBQzs7a0VBQ25GLDhEQUFDcUM7d0RBQVcsR0FBR0MsU0FBUzs7Ozs7O2tFQUN4Qiw4REFBQ25DLG9EQUFPQTt3REFBQ3FELFVBQVM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Z0JBbEh4QyxLQTBIa0Msa0JBQWlCLDhEQUFDeEMsK0VBQWtCQTs7Ozs7Ozs7Ozs7Ozs7OztBQUl0RSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL3BhZ2VzL19hcHAudHN4P2Y5ZDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdAL3N0eWxlcy9nbG9iYWxzLmNzcyc7XG5pbXBvcnQgdHlwZSB7QXBwUHJvcHMgfSBmcm9tICduZXh0L2FwcCc7XG5pbXBvcnQgUmVhY3QsIHt1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge0ludGVyLCBNb250c2VycmF0LCBKZXRCcmFpbnNfTW9ubyB9IGZyb20gJ25leHQvZm9udC9nb29nbGUnO1xuaW1wb3J0IHtUb2FzdGVyIH0gZnJvbSAncmVhY3QtaG90LXRvYXN0JztcbmltcG9ydCB7VGhlbWVQcm92aWRlciwgY3JlYXRlVGhlbWUsIHJlc3BvbnNpdmVGb250U2l6ZXMsIFN0eWxlZEVuZ2luZVByb3ZpZGVyIH0gZnJvbSAnQG11aS9tYXRlcmlhbC9zdHlsZXMnO1xuaW1wb3J0IENzc0Jhc2VsaW5lIGZyb20gJ0BtdWkvbWF0ZXJpYWwvQ3NzQmFzZWxpbmUnO1xuaW1wb3J0IHtDYWNoZVByb3ZpZGVyLCBFbW90aW9uQ2FjaGUgfSBmcm9tICdAZW1vdGlvbi9yZWFjdCc7XG5pbXBvcnQgY3JlYXRlRW1vdGlvbkNhY2hlIGZyb20gJ0AvdXRpbHMvY3JlYXRlRW1vdGlvbkNhY2hlJztcbmltcG9ydCB7QXV0aFByb3ZpZGVyIH0gZnJvbSAnQC9jb250ZXh0L0F1dGhDb250ZXh0JztcbmltcG9ydCB7Q291cnNlUHJvdmlkZXIgfSBmcm9tICdAL2NvbnRleHQvQ291cnNlQ29udGV4dCc7XG5pbXBvcnQge05vdGlmaWNhdGlvblByb3ZpZGVyIH0gZnJvbSAnQC9jb250ZXh0cy9Ob3RpZmljYXRpb25Db250ZXh0JztcbmltcG9ydCB7U2V0dGluZ3NQcm92aWRlciB9IGZyb20gJ0AvY29udGV4dC9TZXR0aW5nc0NvbnRleHQnO1xuaW1wb3J0IHtRdWVyeUNsaWVudCwgUXVlcnlDbGllbnRQcm92aWRlciB9IGZyb20gJ0B0YW5zdGFjay9yZWFjdC1xdWVyeSc7XG5pbXBvcnQge1JlYWN0UXVlcnlEZXZ0b29scyB9IGZyb20gJ0B0YW5zdGFjay9yZWFjdC1xdWVyeS1kZXZ0b29scyc7XG5pbXBvcnQge2NyZWF0ZVF1ZXJ5Q2xpZW50IH0gZnJvbSAnQC91dGlscy9xdWVyeUNsaWVudCc7XG5cbi8vIEZvbnQgY29uZmlndXJhdGlvblxuY29uc3QgaW50ZXIgPSBJbnRlcih7c3Vic2V0czogWydsYXRpbiddLCB2YXJpYWJsZTogJy0tZm9udC1pbnRlcid9KTtcbmNvbnN0IG1vbnRzZXJyYXQgPSBNb250c2VycmF0KHtzdWJzZXRzOiBbJ2xhdGluJ10sIHZhcmlhYmxlOiAnLS1mb250LW1vbnRzZXJyYXQnfSk7XG5jb25zdCBqZXRicmFpbnNNb25vID0gSmV0QnJhaW5zX01vbm8oe3N1YnNldHM6IFsnbGF0aW4nXSwgdmFyaWFibGU6ICctLWZvbnQtamV0YnJhaW5zLW1vbm8nfSk7XG5cbi8vIENsaWVudC1zaWRlIGNhY2hlXG5jb25zdCBjbGllbnRTaWRlRW1vdGlvbkNhY2hlID0gY3JlYXRlRW1vdGlvbkNhY2hlKCk7XG5cbi8vIENyZWF0ZSBNVUkgdGhlbWVcbmNvbnN0IHRoZW1lID0gcmVzcG9uc2l2ZUZvbnRTaXplcyhjcmVhdGVUaGVtZSh7XG4gIHBhbGV0dGU6IHtcbiAgICBwcmltYXJ5OiB7XG4gICAgICBtYWluOiAnIzNmNTFiNScsXG4gIH0sXG4gICAgc2Vjb25kYXJ5OiB7XG4gICAgICBtYWluOiAnI2Y1MDA1NycsXG4gIH0sXG59LFxuICB0eXBvZ3JhcGh5OiB7XG4gICAgZm9udEZhbWlseTogJ3ZhcigtLWZvbnQtaW50ZXIpLCBzYW5zLXNlcmlmJyxcbiAgICBoMToge1xuICAgICAgZm9udEZhbWlseTogJ3ZhcigtLWZvbnQtbW9udHNlcnJhdCksIHNhbnMtc2VyaWYnLFxuICB9LFxuICAgIGgyOiB7XG4gICAgICBmb250RmFtaWx5OiAndmFyKC0tZm9udC1tb250c2VycmF0KSwgc2Fucy1zZXJpZicsXG4gIH0sXG4gICAgaDM6IHtcbiAgICAgIGZvbnRGYW1pbHk6ICd2YXIoLS1mb250LW1vbnRzZXJyYXQpLCBzYW5zLXNlcmlmJyxcbiAgfSxcbiAgICBoNDoge1xuICAgICAgZm9udEZhbWlseTogJ3ZhcigtLWZvbnQtbW9udHNlcnJhdCksIHNhbnMtc2VyaWYnLFxuICB9LFxuICAgIGg1OiB7XG4gICAgICBmb250RmFtaWx5OiAndmFyKC0tZm9udC1tb250c2VycmF0KSwgc2Fucy1zZXJpZicsXG4gIH0sXG4gICAgaDY6IHtcbiAgICAgIGZvbnRGYW1pbHk6ICd2YXIoLS1mb250LW1vbnRzZXJyYXQpLCBzYW5zLXNlcmlmJyxcbiAgfSxcbn0sXG4gIGNvbXBvbmVudHM6IHtcbiAgICBNdWlCdXR0b25CYXNlOiB7XG4gICAgICBkZWZhdWx0UHJvcHM6IHtcbiAgICAgICAgZGlzYWJsZVJpcHBsZTogdHJ1ZSxcbiAgICB9LFxuICB9LFxufSxcbn0pKTtcblxuaW50ZXJmYWNlIE15QXBwUHJvcHMgZXh0ZW5kcyBBcHBQcm9wcyB7XG4gIGVtb3Rpb25DYWNoZT86IEVtb3Rpb25DYWNoZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQXBwKHtcbiAgQ29tcG9uZW50LFxuICBwYWdlUHJvcHMsXG4gIGVtb3Rpb25DYWNoZSA9IGNsaWVudFNpZGVFbW90aW9uQ2FjaGVcbn06IE15QXBwUHJvcHMpIHtcbiAgLy8gQ3JlYXRlIHRoZSBxdWVyeSBjbGllbnQgLSBvbmx5IG9uY2Ugd2hlbiB0aGUgY29tcG9uZW50IG1vdW50c1xuICAvLyBVc2luZyBsYXp5IGluaXRpYWxpemF0aW9uIHRvIGVuc3VyZSBpdCBvbmx5IHJ1bnMgb24gdGhlIGNsaWVudCBzaWRlXG4gIGNvbnN0IFtxdWVyeUNsaWVudCwgc2V0UXVlcnlDbGllbnRdID0gUmVhY3QudXNlU3RhdGU8UXVlcnlDbGllbnQgfCBudWxsPihudWxsKTtcblxuICAvLyBJbml0aWFsaXplIHRoZSBxdWVyeSBjbGllbnQgb24gdGhlIGNsaWVudCBzaWRlIG9ubHlcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBDcmVhdGUgdGhlIHF1ZXJ5IGNsaWVudCBvbmx5IG9uIHRoZSBjbGllbnQgc2lkZVxuICAgIHNldFF1ZXJ5Q2xpZW50KGNyZWF0ZVF1ZXJ5Q2xpZW50KCkpO1xuXG4gICAgLy8gUmVtb3ZlIHRoZSBzZXJ2ZXItc2lkZSBpbmplY3RlZCBDU1NcbiAgICBjb25zdCBqc3NTdHlsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjanNzLXNlcnZlci1zaWRlJyk7XG4gICAgaWYgKGpzc1N0eWxlcz8ucGFyZW50RWxlbWVudCkge1xuICAgICAganNzU3R5bGVzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoanNzU3R5bGVzKTtcbiAgfVxufSwgW10pO1xuXG4gIC8vIERvbid0IHJlbmRlciB0aGUgYXBwIHVudGlsIHRoZSBxdWVyeSBjbGllbnQgaXMgaW5pdGlhbGl6ZWQgb24gdGhlIGNsaWVudCBzaWRlXG4gIC8vIFRoaXMgcHJldmVudHMgaHlkcmF0aW9uIGVycm9ycyBhbmQgZW5zdXJlcyBGaXJlc3RvcmUgcGVyc2lzdGVuY2UgaXMgcHJvcGVybHkgc2V0IHVwXG4gIGlmICghcXVlcnlDbGllbnQpIHtcbiAgICAvLyBSZXR1cm4gYSBtaW5pbWFsIGxvYWRpbmcgc3RhdGUgdGhhdCB3b24ndCBjYXVzZSBoeWRyYXRpb24gaXNzdWVzXG4gICAgcmV0dXJuIChcbiAgICAgIDxDYWNoZVByb3ZpZGVyIHZhbHVlPXtlbW90aW9uQ2FjaGV9PlxuICAgICAgICA8ZGl2IHN0eWxlPXt7dmlzaWJpbGl0eTogJ2hpZGRlbid9fT5Mb2FkaW5nLi4uPC9kaXY+XG4gICAgICA8L0NhY2hlUHJvdmlkZXI+XG4gICAgKTtcbn1cblxuICAvLyBPbmNlIHRoZSBxdWVyeSBjbGllbnQgaXMgaW5pdGlhbGl6ZWQsIHJlbmRlciB0aGUgZnVsbCBhcHBcbiAgcmV0dXJuIChcbiAgICA8Q2FjaGVQcm92aWRlciB2YWx1ZT17ZW1vdGlvbkNhY2hlfT5cbiAgICAgIDxRdWVyeUNsaWVudFByb3ZpZGVyIGNsaWVudD17cXVlcnlDbGllbnR9PlxuICAgICAgICA8U3R5bGVkRW5naW5lUHJvdmlkZXIgaW5qZWN0Rmlyc3Q+XG4gICAgICAgICAgPFRoZW1lUHJvdmlkZXIgdGhlbWU9e3RoZW1lfT5cbiAgICAgICAgICAgIDxDc3NCYXNlbGluZSAvPlxuICAgICAgICAgICAgPEF1dGhQcm92aWRlcj5cbiAgICAgICAgICAgICAgPFNldHRpbmdzUHJvdmlkZXI+XG4gICAgICAgICAgICAgICAgPENvdXJzZVByb3ZpZGVyPlxuICAgICAgICAgICAgICAgICAgPE5vdGlmaWNhdGlvblByb3ZpZGVyPlxuICAgICAgICAgICAgICAgICAgICA8bWFpbiBjbGFzc05hbWU9e2Ake2ludGVyLnZhcmlhYmxlfSAke21vbnRzZXJyYXQudmFyaWFibGV9ICR7amV0YnJhaW5zTW9uby52YXJpYWJsZX1gfT5cbiAgICAgICAgICAgICAgICAgICAgICA8Q29tcG9uZW50IHsuLi5wYWdlUHJvcHN9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgPFRvYXN0ZXIgcG9zaXRpb249XCJ0b3AtcmlnaHRcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L21haW4+XG4gICAgICAgICAgICAgICAgICA8L05vdGlmaWNhdGlvblByb3ZpZGVyPlxuICAgICAgICAgICAgICAgIDwvQ291cnNlUHJvdmlkZXI+XG4gICAgICAgICAgICAgIDwvU2V0dGluZ3NQcm92aWRlcj5cbiAgICAgICAgICAgIDwvQXV0aFByb3ZpZGVyPlxuICAgICAgICAgIDwvVGhlbWVQcm92aWRlcj5cbiAgICAgICAgPC9TdHlsZWRFbmdpbmVQcm92aWRlcj5cbiAgICAgICAge3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnICYmIDxSZWFjdFF1ZXJ5RGV2dG9vbHMgLz59XG4gICAgICA8L1F1ZXJ5Q2xpZW50UHJvdmlkZXI+XG4gICAgPC9DYWNoZVByb3ZpZGVyPlxuICApO1xufVxuXG4iXSwibmFtZXMiOlsiaW50ZXIiLCJtb250c2VycmF0IiwiamV0YnJhaW5zTW9ubyIsIlJlYWN0IiwidXNlRWZmZWN0IiwiVG9hc3RlciIsIlRoZW1lUHJvdmlkZXIiLCJjcmVhdGVUaGVtZSIsInJlc3BvbnNpdmVGb250U2l6ZXMiLCJTdHlsZWRFbmdpbmVQcm92aWRlciIsIkNzc0Jhc2VsaW5lIiwiQ2FjaGVQcm92aWRlciIsImNyZWF0ZUVtb3Rpb25DYWNoZSIsIkF1dGhQcm92aWRlciIsIkNvdXJzZVByb3ZpZGVyIiwiTm90aWZpY2F0aW9uUHJvdmlkZXIiLCJTZXR0aW5nc1Byb3ZpZGVyIiwiUXVlcnlDbGllbnRQcm92aWRlciIsIlJlYWN0UXVlcnlEZXZ0b29scyIsImNyZWF0ZVF1ZXJ5Q2xpZW50IiwiY2xpZW50U2lkZUVtb3Rpb25DYWNoZSIsInRoZW1lIiwicGFsZXR0ZSIsInByaW1hcnkiLCJtYWluIiwic2Vjb25kYXJ5IiwidHlwb2dyYXBoeSIsImZvbnRGYW1pbHkiLCJoMSIsImgyIiwiaDMiLCJoNCIsImg1IiwiaDYiLCJjb21wb25lbnRzIiwiTXVpQnV0dG9uQmFzZSIsImRlZmF1bHRQcm9wcyIsImRpc2FibGVSaXBwbGUiLCJBcHAiLCJDb21wb25lbnQiLCJwYWdlUHJvcHMiLCJlbW90aW9uQ2FjaGUiLCJxdWVyeUNsaWVudCIsInNldFF1ZXJ5Q2xpZW50IiwidXNlU3RhdGUiLCJqc3NTdHlsZXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlQ2hpbGQiLCJ2YWx1ZSIsImRpdiIsInN0eWxlIiwidmlzaWJpbGl0eSIsImNsaWVudCIsImluamVjdEZpcnN0IiwiY2xhc3NOYW1lIiwidmFyaWFibGUiLCJwb3NpdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/pages/_app.tsx\n");

/***/ }),

/***/ "./src/pages/_document.tsx":
/*!*********************************!*\
  !*** ./src/pages/_document.tsx ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ MyDocument)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_document__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/document */ \"./node_modules/next/document.js\");\n/* harmony import */ var next_document__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_document__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/createEmotionCache */ \"./src/utils/createEmotionCache.ts\");\n/* harmony import */ var _emotion_server_create_instance__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @emotion/server/create-instance */ \"@emotion/server/create-instance\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_3__, _emotion_server_create_instance__WEBPACK_IMPORTED_MODULE_4__]);\n([_utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_3__, _emotion_server_create_instance__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\nclass MyDocument extends (next_document__WEBPACK_IMPORTED_MODULE_2___default()) {\n    render() {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_document__WEBPACK_IMPORTED_MODULE_2__.Html, {\n            lang: \"en\",\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_document__WEBPACK_IMPORTED_MODULE_2__.Head, {\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"meta\", {\n                            name: \"description\",\n                            content: \"Closer College Training Platform - AI-powered sales training\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n                            lineNumber: 11,\n                            columnNumber: 11\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"link\", {\n                            rel: \"icon\",\n                            href: \"/favicon.ico\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n                            lineNumber: 12,\n                            columnNumber: 11\n                        }, this),\n                        this.props.emotionStyleTags\n                    ]\n                }, void 0, true, {\n                    fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n                    lineNumber: 10,\n                    columnNumber: 9\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"body\", {\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_document__WEBPACK_IMPORTED_MODULE_2__.Main, {}, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n                            lineNumber: 17,\n                            columnNumber: 11\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_document__WEBPACK_IMPORTED_MODULE_2__.NextScript, {}, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n                            lineNumber: 18,\n                            columnNumber: 11\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n                    lineNumber: 16,\n                    columnNumber: 9\n                }, this)\n            ]\n        }, void 0, true, {\n            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n            lineNumber: 9,\n            columnNumber: 7\n        }, this);\n    }\n}\n// `getInitialProps` belongs to `_document` (instead of `_app`),\n// it's compatible with static-site generation (SSG).\nMyDocument.getInitialProps = async (ctx)=>{\n    // Resolution order\n    //\n    // On the server:\n    // 1. app.getInitialProps\n    // 2. page.getInitialProps\n    // 3. document.getInitialProps\n    // 4. app.render\n    // 5. page.render\n    // 6. document.render\n    //\n    // On the server with error:\n    // 1. document.getInitialProps\n    // 2. app.render\n    // 3. page.render\n    // 4. document.render\n    //\n    // On the client\n    // 1. app.getInitialProps\n    // 2. page.getInitialProps\n    // 3. app.render\n    // 4. page.render\n    const originalRenderPage = ctx.renderPage;\n    // You can consider sharing the same Emotion cache between all the SSR requests to speed up performance.\n    // However, be aware that it can have global side effects.\n    const cache = (0,_utils_createEmotionCache__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n    const { extractCriticalToChunks } = (0,_emotion_server_create_instance__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(cache);\n    ctx.renderPage = ()=>originalRenderPage({\n            enhanceApp: (App)=>(props)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(App, {\n                        emotionCache: cache,\n                        ...props\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n                        lineNumber: 59,\n                        columnNumber: 44\n                    }, undefined)\n        });\n    const initialProps = await next_document__WEBPACK_IMPORTED_MODULE_2___default().getInitialProps(ctx);\n    // This is important. It prevents Emotion to render invalid HTML.\n    // See https://github.com/mui/material-ui/issues/26561#issuecomment-855286153\n    const emotionStyles = extractCriticalToChunks(initialProps.html);\n    const emotionStyleTags = emotionStyles.styles.map((style)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"style\", {\n            \"data-emotion\": `${style.key} ${style.ids.join(\" \")}`,\n            // eslint-disable-next-line react/no-danger\n            dangerouslySetInnerHTML: {\n                __html: style.css\n            }\n        }, style.key, false, {\n            fileName: \"C:\\\\Users\\\\egcha\\\\Documents\\\\triniloyalty.backup2\\\\SALESCOACHAIIDX2.51-main\\\\training-platform\\\\src\\\\pages\\\\_document.tsx\",\n            lineNumber: 67,\n            columnNumber: 5\n        }, undefined));\n    return {\n        ...initialProps,\n        emotionStyleTags\n    };\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFnZXMvX2RvY3VtZW50LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQStCO0FBQ3VDO0FBQ1Q7QUFDSztBQUVuRCxNQUFNUSxtQkFBbUJQLHNEQUFRQTtJQUM5Q1EsU0FBUztRQUNQLHFCQUNFLDhEQUFDUCwrQ0FBSUE7WUFBQ1EsTUFBSzs7OEJBQ1QsOERBQUNQLCtDQUFJQTs7c0NBQ0gsOERBQUNROzRCQUFLQyxNQUFLOzRCQUFjQyxTQUFROzs7Ozs7c0NBQ2pDLDhEQUFDQzs0QkFBS0MsS0FBSTs0QkFBT0MsTUFBSzs7Ozs7O3dCQUVwQixJQUFJLENBQUNDLEtBQUssQ0FBU0MsZ0JBQWdCOzs7Ozs7OzhCQUV2Qyw4REFBQ0M7O3NDQUNDLDhEQUFDZiwrQ0FBSUE7Ozs7O3NDQUNMLDhEQUFDQyxxREFBVUE7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBSXJCO0FBQ0E7QUFFQSxnRUFBZ0U7QUFDaEUscURBQXFEO0FBQ3JERyxXQUFXWSxlQUFlLEdBQUcsT0FBT0M7SUFDbEMsbUJBQW1CO0lBQ25CLEVBQUU7SUFDRixpQkFBaUI7SUFDakIseUJBQXlCO0lBQ3pCLDBCQUEwQjtJQUMxQiw4QkFBOEI7SUFDOUIsZ0JBQWdCO0lBQ2hCLGlCQUFpQjtJQUNqQixxQkFBcUI7SUFDckIsRUFBRTtJQUNGLDRCQUE0QjtJQUM1Qiw4QkFBOEI7SUFDOUIsZ0JBQWdCO0lBQ2hCLGlCQUFpQjtJQUNqQixxQkFBcUI7SUFDckIsRUFBRTtJQUNGLGdCQUFnQjtJQUNoQix5QkFBeUI7SUFDekIsMEJBQTBCO0lBQzFCLGdCQUFnQjtJQUNoQixpQkFBaUI7SUFFakIsTUFBTUMscUJBQXFCRCxJQUFJRSxVQUFVO0lBRXpDLHdHQUF3RztJQUN4RywwREFBMEQ7SUFDMUQsTUFBTUMsUUFBUWxCLHFFQUFrQkE7SUFDaEMsTUFBTSxFQUFDbUIsdUJBQXVCLEVBQUUsR0FBR2xCLDJFQUFtQkEsQ0FBQ2lCO0lBRXZESCxJQUFJRSxVQUFVLEdBQUcsSUFDZkQsbUJBQW1CO1lBQ2pCSSxZQUFZLENBQUNDLE1BQWEsQ0FBQ1Ysc0JBQVUsOERBQUNVO3dCQUFJQyxjQUFjSjt3QkFBUSxHQUFHUCxLQUFLOzs7Ozs7UUFDNUU7SUFFQSxNQUFNWSxlQUFlLE1BQU01QixvRUFBd0IsQ0FBQ29CO0lBQ3BELGlFQUFpRTtJQUNqRSw2RUFBNkU7SUFDN0UsTUFBTVMsZ0JBQWdCTCx3QkFBd0JJLGFBQWFFLElBQUk7SUFDL0QsTUFBTWIsbUJBQW1CWSxjQUFjRSxNQUFNLENBQUNDLEdBQUcsQ0FBQyxDQUFDQyxzQkFDakQsOERBQUNBO1lBQ0NDLGdCQUFjLENBQUMsRUFBRUQsTUFBTUUsR0FBRyxDQUFDLENBQUMsRUFBRUYsTUFBTUcsR0FBRyxDQUFDQyxJQUFJLENBQUMsS0FBSyxDQUFDO1lBRW5ELDJDQUEyQztZQUMzQ0MseUJBQXlCO2dCQUFDQyxRQUFRTixNQUFNTyxHQUFHO1lBQUM7V0FGdkNQLE1BQU1FLEdBQUc7Ozs7O0lBTWxCLE9BQU87UUFDTCxHQUFHUCxZQUFZO1FBQ2ZYO0lBQ0o7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL3BhZ2VzL19kb2N1bWVudC50c3g/MTg4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgRG9jdW1lbnQsIHtIdG1sLCBIZWFkLCBNYWluLCBOZXh0U2NyaXB0IH0gZnJvbSAnbmV4dC9kb2N1bWVudCc7XG5pbXBvcnQgY3JlYXRlRW1vdGlvbkNhY2hlIGZyb20gJy4uL3V0aWxzL2NyZWF0ZUVtb3Rpb25DYWNoZSc7XG5pbXBvcnQgY3JlYXRlRW1vdGlvblNlcnZlciBmcm9tICdAZW1vdGlvbi9zZXJ2ZXIvY3JlYXRlLWluc3RhbmNlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXlEb2N1bWVudCBleHRlbmRzIERvY3VtZW50IHtcbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8SHRtbCBsYW5nPVwiZW5cIj5cbiAgICAgICAgPEhlYWQ+XG4gICAgICAgICAgPG1ldGEgbmFtZT1cImRlc2NyaXB0aW9uXCIgY29udGVudD1cIkNsb3NlciBDb2xsZWdlIFRyYWluaW5nIFBsYXRmb3JtIC0gQUktcG93ZXJlZCBzYWxlcyB0cmFpbmluZ1wiIC8+XG4gICAgICAgICAgPGxpbmsgcmVsPVwiaWNvblwiIGhyZWY9XCIvZmF2aWNvbi5pY29cIiAvPlxuICAgICAgICAgIHsvKiBJbmplY3QgTVVJIHN0eWxlcyBmaXJzdCB0byBtYXRjaCB3aXRoIHRoZSBwcmVwZW5kOiB0cnVlIGNvbmZpZ3VyYXRpb24uICovfVxuICAgICAgICAgIHsodGhpcy5wcm9wcyBhcyBhbnkpLmVtb3Rpb25TdHlsZVRhZ3N9XG4gICAgICAgIDwvSGVhZD5cbiAgICAgICAgPGJvZHk+XG4gICAgICAgICAgPE1haW4gLz5cbiAgICAgICAgICA8TmV4dFNjcmlwdCAvPlxuICAgICAgICA8L2JvZHk+XG4gICAgICA8L0h0bWw+XG4gICAgKTtcbn1cbn1cblxuLy8gYGdldEluaXRpYWxQcm9wc2AgYmVsb25ncyB0byBgX2RvY3VtZW50YCAoaW5zdGVhZCBvZiBgX2FwcGApLFxuLy8gaXQncyBjb21wYXRpYmxlIHdpdGggc3RhdGljLXNpdGUgZ2VuZXJhdGlvbiAoU1NHKS5cbk15RG9jdW1lbnQuZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKGN0eCkgPT4ge1xuICAvLyBSZXNvbHV0aW9uIG9yZGVyXG4gIC8vXG4gIC8vIE9uIHRoZSBzZXJ2ZXI6XG4gIC8vIDEuIGFwcC5nZXRJbml0aWFsUHJvcHNcbiAgLy8gMi4gcGFnZS5nZXRJbml0aWFsUHJvcHNcbiAgLy8gMy4gZG9jdW1lbnQuZ2V0SW5pdGlhbFByb3BzXG4gIC8vIDQuIGFwcC5yZW5kZXJcbiAgLy8gNS4gcGFnZS5yZW5kZXJcbiAgLy8gNi4gZG9jdW1lbnQucmVuZGVyXG4gIC8vXG4gIC8vIE9uIHRoZSBzZXJ2ZXIgd2l0aCBlcnJvcjpcbiAgLy8gMS4gZG9jdW1lbnQuZ2V0SW5pdGlhbFByb3BzXG4gIC8vIDIuIGFwcC5yZW5kZXJcbiAgLy8gMy4gcGFnZS5yZW5kZXJcbiAgLy8gNC4gZG9jdW1lbnQucmVuZGVyXG4gIC8vXG4gIC8vIE9uIHRoZSBjbGllbnRcbiAgLy8gMS4gYXBwLmdldEluaXRpYWxQcm9wc1xuICAvLyAyLiBwYWdlLmdldEluaXRpYWxQcm9wc1xuICAvLyAzLiBhcHAucmVuZGVyXG4gIC8vIDQuIHBhZ2UucmVuZGVyXG5cbiAgY29uc3Qgb3JpZ2luYWxSZW5kZXJQYWdlID0gY3R4LnJlbmRlclBhZ2U7XG5cbiAgLy8gWW91IGNhbiBjb25zaWRlciBzaGFyaW5nIHRoZSBzYW1lIEVtb3Rpb24gY2FjaGUgYmV0d2VlbiBhbGwgdGhlIFNTUiByZXF1ZXN0cyB0byBzcGVlZCB1cCBwZXJmb3JtYW5jZS5cbiAgLy8gSG93ZXZlciwgYmUgYXdhcmUgdGhhdCBpdCBjYW4gaGF2ZSBnbG9iYWwgc2lkZSBlZmZlY3RzLlxuICBjb25zdCBjYWNoZSA9IGNyZWF0ZUVtb3Rpb25DYWNoZSgpO1xuICBjb25zdCB7ZXh0cmFjdENyaXRpY2FsVG9DaHVua3MgfSA9IGNyZWF0ZUVtb3Rpb25TZXJ2ZXIoY2FjaGUpO1xuXG4gIGN0eC5yZW5kZXJQYWdlID0gKCkgPT5cbiAgICBvcmlnaW5hbFJlbmRlclBhZ2Uoe1xuICAgICAgZW5oYW5jZUFwcDogKEFwcDogYW55KSA9PiAocHJvcHMpID0+IDxBcHAgZW1vdGlvbkNhY2hlPXtjYWNoZX0gey4uLnByb3BzfSAvPixcbiAgfSk7XG5cbiAgY29uc3QgaW5pdGlhbFByb3BzID0gYXdhaXQgRG9jdW1lbnQuZ2V0SW5pdGlhbFByb3BzKGN0eCk7XG4gIC8vIFRoaXMgaXMgaW1wb3J0YW50LiBJdCBwcmV2ZW50cyBFbW90aW9uIHRvIHJlbmRlciBpbnZhbGlkIEhUTUwuXG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vbXVpL21hdGVyaWFsLXVpL2lzc3Vlcy8yNjU2MSNpc3N1ZWNvbW1lbnQtODU1Mjg2MTUzXG4gIGNvbnN0IGVtb3Rpb25TdHlsZXMgPSBleHRyYWN0Q3JpdGljYWxUb0NodW5rcyhpbml0aWFsUHJvcHMuaHRtbCk7XG4gIGNvbnN0IGVtb3Rpb25TdHlsZVRhZ3MgPSBlbW90aW9uU3R5bGVzLnN0eWxlcy5tYXAoKHN0eWxlKSA9PiAoXG4gICAgPHN0eWxlXG4gICAgICBkYXRhLWVtb3Rpb249e2Ake3N0eWxlLmtleX0gJHtzdHlsZS5pZHMuam9pbignICcpfWB9XG4gICAgICBrZXk9e3N0eWxlLmtleX1cbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9uby1kYW5nZXJcbiAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBzdHlsZS5jc3MgfX1cbiAgICAvPlxuICApKTtcblxuICByZXR1cm4ge1xuICAgIC4uLmluaXRpYWxQcm9wcyxcbiAgICBlbW90aW9uU3R5bGVUYWdzLFxufTtcbn07XG4iXSwibmFtZXMiOlsiUmVhY3QiLCJEb2N1bWVudCIsIkh0bWwiLCJIZWFkIiwiTWFpbiIsIk5leHRTY3JpcHQiLCJjcmVhdGVFbW90aW9uQ2FjaGUiLCJjcmVhdGVFbW90aW9uU2VydmVyIiwiTXlEb2N1bWVudCIsInJlbmRlciIsImxhbmciLCJtZXRhIiwibmFtZSIsImNvbnRlbnQiLCJsaW5rIiwicmVsIiwiaHJlZiIsInByb3BzIiwiZW1vdGlvblN0eWxlVGFncyIsImJvZHkiLCJnZXRJbml0aWFsUHJvcHMiLCJjdHgiLCJvcmlnaW5hbFJlbmRlclBhZ2UiLCJyZW5kZXJQYWdlIiwiY2FjaGUiLCJleHRyYWN0Q3JpdGljYWxUb0NodW5rcyIsImVuaGFuY2VBcHAiLCJBcHAiLCJlbW90aW9uQ2FjaGUiLCJpbml0aWFsUHJvcHMiLCJlbW90aW9uU3R5bGVzIiwiaHRtbCIsInN0eWxlcyIsIm1hcCIsInN0eWxlIiwiZGF0YS1lbW90aW9uIiwia2V5IiwiaWRzIiwiam9pbiIsImRhbmdlcm91c2x5U2V0SW5uZXJIVE1MIiwiX19odG1sIiwiY3NzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/pages/_document.tsx\n");

/***/ }),

/***/ "./src/services/blockchainService.ts":
/*!*******************************************!*\
  !*** ./src/services/blockchainService.ts ***!
  \*******************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateCertificateHash: () => (/* binding */ generateCertificateHash),\n/* harmony export */   getBlockchainVerification: () => (/* binding */ getBlockchainVerification),\n/* harmony export */   registerAllCertificatesOnBlockchain: () => (/* binding */ registerAllCertificatesOnBlockchain),\n/* harmony export */   registerCertificateOnBlockchain: () => (/* binding */ registerCertificateOnBlockchain),\n/* harmony export */   verifyBlockchainCertificate: () => (/* binding */ verifyBlockchainCertificate)\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./firebase */ \"./src/services/firebase.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n/**\n * Generate a hash for a certificate\n */ const generateCertificateHash = (certificate)=>{\n    // Create a deterministic string representation of the certificate\n    const certificateData = JSON.stringify({\n        id: certificate.id,\n        userId: certificate.userId,\n        courseId: certificate.courseId,\n        courseName: certificate.courseName,\n        userName: certificate.userName,\n        issueDate: certificate.issueDate,\n        templateId: certificate.templateId,\n        verificationCode: certificate.verificationCode\n    });\n    // Generate SHA-256 hash\n    return (0,crypto__WEBPACK_IMPORTED_MODULE_2__.createHash)(\"sha256\").update(certificateData).digest(\"hex\");\n};\n/**\n * Register a certificate on the blockchain\n * Note: In a real implementation, this would interact with an actual blockchain\n */ const registerCertificateOnBlockchain = async (certificate)=>{\n    try {\n        // Generate certificate hash\n        const certificateHash = generateCertificateHash(certificate);\n        // Check if certificate is already registered\n        const existingVerification = await getBlockchainVerification(certificate.id);\n        if (existingVerification) {\n            return existingVerification;\n        }\n        // Create blockchain verification record\n        const verificationId = certificate.id;\n        const verificationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"blockchainVerifications\", verificationId);\n        // In a real implementation, this would submit the hash to a blockchain\n        // For now, we'll simulate a successful registration\n        const timestamp = new Date().toISOString();\n        // Simulate blockchain transaction data\n        const blockchainData = {\n            transactionId: `tx_${Math.random().toString(36).substring(2, 15)}`,\n            blockNumber: Math.floor(Math.random() * 1000000),\n            blockchainProvider: \"Ethereum\",\n            blockchainNetwork: \"Rinkeby Testnet\",\n            verificationUrl: `https://rinkeby.etherscan.io/tx/${Math.random().toString(36).substring(2, 15)}`\n        };\n        const verification = {\n            id: verificationId,\n            certificateId: certificate.id,\n            certificateHash,\n            transactionId: blockchainData.transactionId,\n            blockchainProvider: blockchainData.blockchainProvider,\n            blockchainNetwork: blockchainData.blockchainNetwork,\n            blockNumber: blockchainData.blockNumber,\n            timestamp,\n            status: \"verified\",\n            verificationUrl: blockchainData.verificationUrl\n        };\n        // Save verification record\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(verificationRef, {\n            ...verification,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Update certificate with blockchain verification\n        const certificateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"certificates\", certificate.id);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(certificateRef, {\n            blockchainVerified: true,\n            blockchainVerificationId: verificationId,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return verification;\n    } catch (error) {\n        console.error(\"Error registering certificate on blockchain:\", error);\n        return null;\n    }\n};\n/**\n * Get blockchain verification for a certificate\n */ const getBlockchainVerification = async (certificateId)=>{\n    try {\n        const verificationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"blockchainVerifications\", certificateId);\n        const verificationSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(verificationRef);\n        if (!verificationSnapshot.exists()) {\n            return null;\n        }\n        return {\n            id: verificationSnapshot.id,\n            ...verificationSnapshot.data()\n        };\n    } catch (error) {\n        console.error(\"Error getting blockchain verification:\", error);\n        return null;\n    }\n};\n/**\n * Verify a certificate against the blockchain\n */ const verifyBlockchainCertificate = async (certificate)=>{\n    try {\n        // Get blockchain verification\n        const verification = await getBlockchainVerification(certificate.id);\n        if (!verification) {\n            return {\n                isValid: false,\n                message: \"Certificate is not registered on the blockchain\"\n            };\n        }\n        // Generate certificate hash\n        const certificateHash = generateCertificateHash(certificate);\n        // Compare hashes\n        if (certificateHash !== verification.certificateHash) {\n            return {\n                isValid: false,\n                message: \"Certificate hash does not match blockchain record\",\n                verification\n            };\n        }\n        return {\n            isValid: true,\n            message: \"Certificate is verified on the blockchain\",\n            verification\n        };\n    } catch (error) {\n        console.error(\"Error verifying certificate on blockchain:\", error);\n        return {\n            isValid: false,\n            message: \"Error verifying certificate on blockchain\"\n        };\n    }\n};\n/**\n * Register all unregistered certificates on the blockchain\n */ const registerAllCertificatesOnBlockchain = async (certificates)=>{\n    let success = 0;\n    let failed = 0;\n    for (const certificate of certificates){\n        try {\n            const result = await registerCertificateOnBlockchain(certificate);\n            if (result) {\n                success++;\n            } else {\n                failed++;\n            }\n        } catch (error) {\n            console.error(`Error registering certificate ${certificate.id} on blockchain:`, error);\n            failed++;\n        }\n    }\n    return {\n        success,\n        failed,\n        total: certificates.length\n    };\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU87WUFDWkMsUUFBUUQsS0FBSyxDQUFDLENBQUMsOEJBQThCLEVBQUUxQyxZQUFZSSxFQUFFLENBQUMsZUFBZSxDQUFDLEVBQUVzQztZQUNoRlc7UUFDSjtJQUNGO0lBRUUsT0FBTztRQUNMRDtRQUNBQztRQUNBRSxPQUFPSixhQUFhSyxNQUFNO0lBQzlCO0FBQ0EsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL3NlcnZpY2VzL2Jsb2NrY2hhaW5TZXJ2aWNlLnRzP2ZhNDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtkb2MsIGdldERvYywgc2V0RG9jLCB1cGRhdGVEb2MsIHNlcnZlclRpbWVzdGFtcCB9IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7XG5pbXBvcnQge2ZpcmVzdG9yZSB9IGZyb20gJy4vZmlyZWJhc2UnO1xuaW1wb3J0IHtDZXJ0aWZpY2F0ZSB9IGZyb20gJ0AvdHlwZXMvY2VydGlmaWNhdGUudHlwZXMnO1xuaW1wb3J0IHtjcmVhdGVIYXNoIH0gZnJvbSAnY3J5cHRvJztcblxuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIGJsb2NrY2hhaW4gdmVyaWZpY2F0aW9uIHJlY29yZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEJsb2NrY2hhaW5WZXJpZmljYXRpb24ge1xuICBpZDogc3RyaW5nO1xuICBjZXJ0aWZpY2F0ZUlkOiBzdHJpbmc7XG4gIGNlcnRpZmljYXRlSGFzaDogc3RyaW5nO1xuICB0cmFuc2FjdGlvbklkPzogc3RyaW5nO1xuICBibG9ja2NoYWluUHJvdmlkZXI6IHN0cmluZztcbiAgYmxvY2tjaGFpbk5ldHdvcms6IHN0cmluZztcbiAgYmxvY2tOdW1iZXI/OiBudW1iZXI7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xuICBzdGF0dXM6ICdwZW5kaW5nJyB8ICd2ZXJpZmllZCcgfCAnZmFpbGVkJztcbiAgdmVyaWZpY2F0aW9uVXJsPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGEgaGFzaCBmb3IgYSBjZXJ0aWZpY2F0ZVxuICovXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVDZXJ0aWZpY2F0ZUhhc2ggPSAoY2VydGlmaWNhdGU6IENlcnRpZmljYXRlKTogc3RyaW5nID0+IHtcbiAgLy8gQ3JlYXRlIGEgZGV0ZXJtaW5pc3RpYyBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNlcnRpZmljYXRlXG4gIGNvbnN0IGNlcnRpZmljYXRlRGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICBpZDogY2VydGlmaWNhdGUuaWQsXG4gICAgdXNlcklkOiBjZXJ0aWZpY2F0ZS51c2VySWQsXG4gICAgY291cnNlSWQ6IGNlcnRpZmljYXRlLmNvdXJzZUlkLFxuICAgIGNvdXJzZU5hbWU6IGNlcnRpZmljYXRlLmNvdXJzZU5hbWUsXG4gICAgdXNlck5hbWU6IGNlcnRpZmljYXRlLnVzZXJOYW1lLFxuICAgIGlzc3VlRGF0ZTogY2VydGlmaWNhdGUuaXNzdWVEYXRlLFxuICAgIHRlbXBsYXRlSWQ6IGNlcnRpZmljYXRlLnRlbXBsYXRlSWQsXG4gICAgdmVyaWZpY2F0aW9uQ29kZTogY2VydGlmaWNhdGUudmVyaWZpY2F0aW9uQ29kZVxufSk7XG4gIFxuICAvLyBHZW5lcmF0ZSBTSEEtMjU2IGhhc2hcbiAgcmV0dXJuIGNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShjZXJ0aWZpY2F0ZURhdGEpLmRpZ2VzdCgnaGV4Jyk7XG59O1xuXG4vKipcbiAqIFJlZ2lzdGVyIGEgY2VydGlmaWNhdGUgb24gdGhlIGJsb2NrY2hhaW5cbiAqIE5vdGU6IEluIGEgcmVhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3b3VsZCBpbnRlcmFjdCB3aXRoIGFuIGFjdHVhbCBibG9ja2NoYWluXG4gKi9cbmV4cG9ydCBjb25zdCByZWdpc3RlckNlcnRpZmljYXRlT25CbG9ja2NoYWluID0gYXN5bmMgKGNlcnRpZmljYXRlOiBDZXJ0aWZpY2F0ZSk6IFByb21pc2U8QmxvY2tjaGFpblZlcmlmaWNhdGlvbiB8IG51bGw+ID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZW5lcmF0ZSBjZXJ0aWZpY2F0ZSBoYXNoXG4gICAgY29uc3QgY2VydGlmaWNhdGVIYXNoID0gZ2VuZXJhdGVDZXJ0aWZpY2F0ZUhhc2goY2VydGlmaWNhdGUpO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIGNlcnRpZmljYXRlIGlzIGFscmVhZHkgcmVnaXN0ZXJlZFxuICAgIGNvbnN0IGV4aXN0aW5nVmVyaWZpY2F0aW9uID0gYXdhaXQgZ2V0QmxvY2tjaGFpblZlcmlmaWNhdGlvbihjZXJ0aWZpY2F0ZS5pZCk7XG4gICAgaWYgKGV4aXN0aW5nVmVyaWZpY2F0aW9uKSB7XG4gICAgICByZXR1cm4gZXhpc3RpbmdWZXJpZmljYXRpb247XG4gIH1cbiAgICBcbiAgICAvLyBDcmVhdGUgYmxvY2tjaGFpbiB2ZXJpZmljYXRpb24gcmVjb3JkXG4gICAgY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBjZXJ0aWZpY2F0ZS5pZDtcbiAgICBjb25zdCB2ZXJpZmljYXRpb25SZWYgPSBkb2MoZmlyZXN0b3JlLCAnYmxvY2tjaGFpblZlcmlmaWNhdGlvbnMnLCB2ZXJpZmljYXRpb25JZCk7XG4gICAgXG4gICAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIHN1Ym1pdCB0aGUgaGFzaCB0byBhIGJsb2NrY2hhaW5cbiAgICAvLyBGb3Igbm93LCB3ZSdsbCBzaW11bGF0ZSBhIHN1Y2Nlc3NmdWwgcmVnaXN0cmF0aW9uXG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIFxuICAgIC8vIFNpbXVsYXRlIGJsb2NrY2hhaW4gdHJhbnNhY3Rpb24gZGF0YVxuICAgIGNvbnN0IGJsb2NrY2hhaW5EYXRhID0ge1xuICAgICAgdHJhbnNhY3Rpb25JZDogYHR4XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDE1KX1gLFxuICAgICAgYmxvY2tOdW1iZXI6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApLFxuICAgICAgYmxvY2tjaGFpblByb3ZpZGVyOiAnRXRoZXJldW0nLFxuICAgICAgYmxvY2tjaGFpbk5ldHdvcms6ICdSaW5rZWJ5IFRlc3RuZXQnLFxuICAgICAgdmVyaWZpY2F0aW9uVXJsOiBgaHR0cHM6Ly9yaW5rZWJ5LmV0aGVyc2Nhbi5pby90eC8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxNSl9YFxuICB9O1xuICAgIFxuICAgIGNvbnN0IHZlcmlmaWNhdGlvbjogQmxvY2tjaGFpblZlcmlmaWNhdGlvbiA9IHtcbiAgICAgIGlkOiB2ZXJpZmljYXRpb25JZCxcbiAgICAgIGNlcnRpZmljYXRlSWQ6IGNlcnRpZmljYXRlLmlkLFxuICAgICAgY2VydGlmaWNhdGVIYXNoLFxuICAgICAgdHJhbnNhY3Rpb25JZDogYmxvY2tjaGFpbkRhdGEudHJhbnNhY3Rpb25JZCxcbiAgICAgIGJsb2NrY2hhaW5Qcm92aWRlcjogYmxvY2tjaGFpbkRhdGEuYmxvY2tjaGFpblByb3ZpZGVyLFxuICAgICAgYmxvY2tjaGFpbk5ldHdvcms6IGJsb2NrY2hhaW5EYXRhLmJsb2NrY2hhaW5OZXR3b3JrLFxuICAgICAgYmxvY2tOdW1iZXI6IGJsb2NrY2hhaW5EYXRhLmJsb2NrTnVtYmVyLFxuICAgICAgdGltZXN0YW1wLFxuICAgICAgc3RhdHVzOiAndmVyaWZpZWQnLFxuICAgICAgdmVyaWZpY2F0aW9uVXJsOiBibG9ja2NoYWluRGF0YS52ZXJpZmljYXRpb25VcmxcbiAgfTtcbiAgICBcbiAgICAvLyBTYXZlIHZlcmlmaWNhdGlvbiByZWNvcmRcbiAgICBhd2FpdCBzZXREb2ModmVyaWZpY2F0aW9uUmVmLCB7XG4gICAgICAuLi52ZXJpZmljYXRpb24sXG4gICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxuICB9KTtcbiAgICBcbiAgICAvLyBVcGRhdGUgY2VydGlmaWNhdGUgd2l0aCBibG9ja2NoYWluIHZlcmlmaWNhdGlvblxuICAgIGNvbnN0IGNlcnRpZmljYXRlUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlcycsIGNlcnRpZmljYXRlLmlkKTtcbiAgICBhd2FpdCB1cGRhdGVEb2MoY2VydGlmaWNhdGVSZWYsIHtcbiAgICAgIGJsb2NrY2hhaW5WZXJpZmllZDogdHJ1ZSxcbiAgICAgIGJsb2NrY2hhaW5WZXJpZmljYXRpb25JZDogdmVyaWZpY2F0aW9uSWQsXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXG4gIH0pO1xuICAgIFxuICAgIHJldHVybiB2ZXJpZmljYXRpb247XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlZ2lzdGVyaW5nIGNlcnRpZmljYXRlIG9uIGJsb2NrY2hhaW46JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xufVxufTtcblxuLyoqXG4gKiBHZXQgYmxvY2tjaGFpbiB2ZXJpZmljYXRpb24gZm9yIGEgY2VydGlmaWNhdGVcbiAqL1xuZXhwb3J0IGNvbnN0IGdldEJsb2NrY2hhaW5WZXJpZmljYXRpb24gPSBhc3luYyAoY2VydGlmaWNhdGVJZDogc3RyaW5nKTogUHJvbWlzZTxCbG9ja2NoYWluVmVyaWZpY2F0aW9uIHwgbnVsbD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvblJlZiA9IGRvYyhmaXJlc3RvcmUsICdibG9ja2NoYWluVmVyaWZpY2F0aW9ucycsIGNlcnRpZmljYXRlSWQpO1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvblNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jKHZlcmlmaWNhdGlvblJlZik7XG4gICAgXG4gICAgaWYgKCF2ZXJpZmljYXRpb25TbmFwc2hvdC5leGlzdHMoKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHZlcmlmaWNhdGlvblNuYXBzaG90LmlkLFxuICAgICAgLi4udmVyaWZpY2F0aW9uU25hcHNob3QuZGF0YSgpXG4gIH0gYXMgQmxvY2tjaGFpblZlcmlmaWNhdGlvbjtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBibG9ja2NoYWluIHZlcmlmaWNhdGlvbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG59XG59O1xuXG4vKipcbiAqIFZlcmlmeSBhIGNlcnRpZmljYXRlIGFnYWluc3QgdGhlIGJsb2NrY2hhaW5cbiAqL1xuZXhwb3J0IGNvbnN0IHZlcmlmeUJsb2NrY2hhaW5DZXJ0aWZpY2F0ZSA9IGFzeW5jIChjZXJ0aWZpY2F0ZTogQ2VydGlmaWNhdGUpOiBQcm9taXNlPHtcbiAgaXNWYWxpZDogYm9vbGVhbjtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICB2ZXJpZmljYXRpb24/OiBCbG9ja2NoYWluVmVyaWZpY2F0aW9uO1xufT4gPT4ge1xuICB0cnkge1xuICAgIC8vIEdldCBibG9ja2NoYWluIHZlcmlmaWNhdGlvblxuICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGdldEJsb2NrY2hhaW5WZXJpZmljYXRpb24oY2VydGlmaWNhdGUuaWQpO1xuICAgIFxuICAgIGlmICghdmVyaWZpY2F0aW9uKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogJ0NlcnRpZmljYXRlIGlzIG5vdCByZWdpc3RlcmVkIG9uIHRoZSBibG9ja2NoYWluJ1xuICAgIH07XG4gIH1cbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBjZXJ0aWZpY2F0ZSBoYXNoXG4gICAgY29uc3QgY2VydGlmaWNhdGVIYXNoID0gZ2VuZXJhdGVDZXJ0aWZpY2F0ZUhhc2goY2VydGlmaWNhdGUpO1xuICAgIFxuICAgIC8vIENvbXBhcmUgaGFzaGVzXG4gICAgaWYgKGNlcnRpZmljYXRlSGFzaCAhPT0gdmVyaWZpY2F0aW9uLmNlcnRpZmljYXRlSGFzaCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdDZXJ0aWZpY2F0ZSBoYXNoIGRvZXMgbm90IG1hdGNoIGJsb2NrY2hhaW4gcmVjb3JkJyxcbiAgICAgICAgdmVyaWZpY2F0aW9uXG4gICAgfTtcbiAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgbWVzc2FnZTogJ0NlcnRpZmljYXRlIGlzIHZlcmlmaWVkIG9uIHRoZSBibG9ja2NoYWluJyxcbiAgICAgIHZlcmlmaWNhdGlvblxuICB9O1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB2ZXJpZnlpbmcgY2VydGlmaWNhdGUgb24gYmxvY2tjaGFpbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgbWVzc2FnZTogJ0Vycm9yIHZlcmlmeWluZyBjZXJ0aWZpY2F0ZSBvbiBibG9ja2NoYWluJ1xuICB9O1xufVxufTtcblxuLyoqXG4gKiBSZWdpc3RlciBhbGwgdW5yZWdpc3RlcmVkIGNlcnRpZmljYXRlcyBvbiB0aGUgYmxvY2tjaGFpblxuICovXG5leHBvcnQgY29uc3QgcmVnaXN0ZXJBbGxDZXJ0aWZpY2F0ZXNPbkJsb2NrY2hhaW4gPSBhc3luYyAoY2VydGlmaWNhdGVzOiBDZXJ0aWZpY2F0ZVtdKTogUHJvbWlzZTx7XG4gIHN1Y2Nlc3M6IG51bWJlcjtcbiAgZmFpbGVkOiBudW1iZXI7XG4gIHRvdGFsOiBudW1iZXI7XG59PiA9PiB7XG4gIGxldCBzdWNjZXNzID0gMDtcbiAgbGV0IGZhaWxlZCA9IDA7XG4gIFxuICBmb3IgKGNvbnN0IGNlcnRpZmljYXRlIG9mIGNlcnRpZmljYXRlcykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZWdpc3RlckNlcnRpZmljYXRlT25CbG9ja2NoYWluKGNlcnRpZmljYXRlKTtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgc3VjY2VzcysrO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZhaWxlZCsrO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHJlZ2lzdGVyaW5nIGNlcnRpZmljYXRlICR7Y2VydGlmaWNhdGUuaWR9IG9uIGJsb2NrY2hhaW46YCwgZXJyb3IpO1xuICAgICAgZmFpbGVkKys7XG4gIH1cbn1cbiAgXG4gIHJldHVybiB7XG4gICAgc3VjY2VzcyxcbiAgICBmYWlsZWQsXG4gICAgdG90YWw6IGNlcnRpZmljYXRlcy5sZW5ndGhcbn07XG59O1xuIl0sIm5hbWVzIjpbImRvYyIsImdldERvYyIsInNldERvYyIsInVwZGF0ZURvYyIsInNlcnZlclRpbWVzdGFtcCIsImZpcmVzdG9yZSIsImNyZWF0ZUhhc2giLCJnZW5lcmF0ZUNlcnRpZmljYXRlSGFzaCIsImNlcnRpZmljYXRlIiwiY2VydGlmaWNhdGVEYXRhIiwiSlNPTiIsInN0cmluZ2lmeSIsImlkIiwidXNlcklkIiwiY291cnNlSWQiLCJjb3Vyc2VOYW1lIiwidXNlck5hbWUiLCJpc3N1ZURhdGUiLCJ0ZW1wbGF0ZUlkIiwidmVyaWZpY2F0aW9uQ29kZSIsInVwZGF0ZSIsImRpZ2VzdCIsInJlZ2lzdGVyQ2VydGlmaWNhdGVPbkJsb2NrY2hhaW4iLCJjZXJ0aWZpY2F0ZUhhc2giLCJleGlzdGluZ1ZlcmlmaWNhdGlvbiIsImdldEJsb2NrY2hhaW5WZXJpZmljYXRpb24iLCJ2ZXJpZmljYXRpb25JZCIsInZlcmlmaWNhdGlvblJlZiIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImJsb2NrY2hhaW5EYXRhIiwidHJhbnNhY3Rpb25JZCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsImJsb2NrTnVtYmVyIiwiZmxvb3IiLCJibG9ja2NoYWluUHJvdmlkZXIiLCJibG9ja2NoYWluTmV0d29yayIsInZlcmlmaWNhdGlvblVybCIsInZlcmlmaWNhdGlvbiIsImNlcnRpZmljYXRlSWQiLCJzdGF0dXMiLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJjZXJ0aWZpY2F0ZVJlZiIsImJsb2NrY2hhaW5WZXJpZmllZCIsImJsb2NrY2hhaW5WZXJpZmljYXRpb25JZCIsImVycm9yIiwiY29uc29sZSIsInZlcmlmaWNhdGlvblNuYXBzaG90IiwiZXhpc3RzIiwiZGF0YSIsInZlcmlmeUJsb2NrY2hhaW5DZXJ0aWZpY2F0ZSIsImlzVmFsaWQiLCJtZXNzYWdlIiwicmVnaXN0ZXJBbGxDZXJ0aWZpY2F0ZXNPbkJsb2NrY2hhaW4iLCJjZXJ0aWZpY2F0ZXMiLCJzdWNjZXNzIiwiZmFpbGVkIiwicmVzdWx0IiwidG90YWwiLCJsZW5ndGgiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/services/blockchainService.ts\n");

/***/ }),

/***/ "./src/services/certificateService.ts":
/*!********************************************!*\
  !*** ./src/services/certificateService.ts ***!
  \********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCertificateTemplate: () => (/* binding */ createCertificateTemplate),\n/* harmony export */   generateCertificate: () => (/* binding */ generateCertificate),\n/* harmony export */   generateQRCode: () => (/* binding */ generateQRCode),\n/* harmony export */   getCertificate: () => (/* binding */ getCertificate),\n/* harmony export */   getCertificateTemplate: () => (/* binding */ getCertificateTemplate),\n/* harmony export */   getCertificateTemplates: () => (/* binding */ getCertificateTemplates),\n/* harmony export */   getCourseCertificates: () => (/* binding */ getCourseCertificates),\n/* harmony export */   getDefaultCertificateTemplate: () => (/* binding */ getDefaultCertificateTemplate),\n/* harmony export */   getUserCertificates: () => (/* binding */ getUserCertificates),\n/* harmony export */   revokeCertificate: () => (/* binding */ revokeCertificate),\n/* harmony export */   searchCertificates: () => (/* binding */ searchCertificates),\n/* harmony export */   updateCertificateTemplate: () => (/* binding */ updateCertificateTemplate),\n/* harmony export */   verifyCertificate: () => (/* binding */ verifyCertificate)\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var firebase_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/storage */ \"firebase/storage\");\n/* harmony import */ var _firebase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./firebase */ \"./src/services/firebase.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var _utils_pdfGenerator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/utils/pdfGenerator */ \"./src/utils/pdfGenerator.ts\");\n/* harmony import */ var qrcode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! qrcode */ \"qrcode\");\n/* harmony import */ var qrcode__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(qrcode__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _blockchainService__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./blockchainService */ \"./src/services/blockchainService.ts\");\n/* harmony import */ var _utils_digitalSignature__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/utils/digitalSignature */ \"./src/utils/digitalSignature.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, firebase_storage__WEBPACK_IMPORTED_MODULE_1__, _firebase__WEBPACK_IMPORTED_MODULE_2__, uuid__WEBPACK_IMPORTED_MODULE_3__, _blockchainService__WEBPACK_IMPORTED_MODULE_6__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, firebase_storage__WEBPACK_IMPORTED_MODULE_1__, _firebase__WEBPACK_IMPORTED_MODULE_2__, uuid__WEBPACK_IMPORTED_MODULE_3__, _blockchainService__WEBPACK_IMPORTED_MODULE_6__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n\n/**\n * Get a certificate template by ID\n */ const getCertificateTemplate = async (templateId)=>{\n    try {\n        const templateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateTemplates\", templateId);\n        const templateSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(templateRef);\n        if (!templateSnapshot.exists()) {\n            return null;\n        }\n        return {\n            id: templateSnapshot.id,\n            ...templateSnapshot.data()\n        };\n    } catch (error) {\n        console.error(\"Error getting certificate template:\", error);\n        return null;\n    }\n};\n/**\n * Get all certificate templates\n */ const getCertificateTemplates = async ()=>{\n    try {\n        const templatesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateTemplates\");\n        const templatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(templatesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const templatesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(templatesQuery);\n        const templates = [];\n        templatesSnapshot.forEach((doc)=>{\n            templates.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return templates;\n    } catch (error) {\n        console.error(\"Error getting certificate templates:\", error);\n        return [];\n    }\n};\n/**\n * Get the default certificate template\n */ const getDefaultCertificateTemplate = async ()=>{\n    try {\n        const templatesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateTemplates\");\n        const templatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(templatesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"isDefault\", \"==\", true), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.limit)(1));\n        const templatesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(templatesQuery);\n        if (templatesSnapshot.empty) {\n            return null;\n        }\n        const templateDoc = templatesSnapshot.docs[0];\n        return {\n            id: templateDoc.id,\n            ...templateDoc.data()\n        };\n    } catch (error) {\n        console.error(\"Error getting default certificate template:\", error);\n        return null;\n    }\n};\n/**\n * Create a new certificate template\n */ const createCertificateTemplate = async (template)=>{\n    try {\n        const templateId = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)();\n        const templateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateTemplates\", templateId);\n        const now = new Date().toISOString();\n        const newTemplate = {\n            ...template,\n            createdAt: now,\n            updatedAt: now\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(templateRef, {\n            ...newTemplate,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            id: templateId,\n            ...newTemplate\n        };\n    } catch (error) {\n        console.error(\"Error creating certificate template:\", error);\n        return null;\n    }\n};\n/**\n * Update a certificate template\n */ const updateCertificateTemplate = async (templateId, template)=>{\n    try {\n        const templateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateTemplates\", templateId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(templateRef, {\n            ...template,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return true;\n    } catch (error) {\n        console.error(\"Error updating certificate template:\", error);\n        return false;\n    }\n};\n/**\n * Generate a certificate for a user who completed a course\n */ const generateCertificate = async (options)=>{\n    try {\n        const { templateId, userId, courseId, values = {}, expiryDate, metadata: inputMetadata = {}, isPublic = false } = options;\n        const metadata = {\n            completionDate: new Date().toISOString(),\n            ...inputMetadata\n        };\n        // Ensure metadata has required completionDate\n        if (!metadata.completionDate) {\n            metadata.completionDate = new Date().toISOString();\n        }\n        // Get the template\n        const template = await getCertificateTemplate(templateId);\n        if (!template) {\n            throw new Error(\"Certificate template not found\");\n        }\n        // Get the user\n        const userRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"users\", userId);\n        const userSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(userRef);\n        if (!userSnapshot.exists()) {\n            throw new Error(\"User not found\");\n        }\n        const userData = userSnapshot.data();\n        // Get the course\n        const courseRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"courses\", courseId);\n        const courseSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(courseRef);\n        if (!courseSnapshot.exists()) {\n            throw new Error(\"Course not found\");\n        }\n        const courseData = courseSnapshot.data();\n        // Generate a unique certificate ID\n        const certificateId = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)();\n        // Generate a verification code\n        const verificationCode = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)();\n        // Create the verification URL\n        const verificationUrl = `${process.env.NEXT_PUBLIC_SITE_URL || \"\"}/verify-certificate/${verificationCode}`;\n        // Generate QR code for verification URL\n        const qrCodeDataUrl = await generateQRCode(verificationUrl);\n        // Current date\n        const now = new Date().toISOString();\n        // Merge default values with provided values\n        const mergedValues = {\n            ...template.defaultValues,\n            studentName: userData.displayName || userData.email || \"Student\",\n            courseName: courseData.title || \"Course\",\n            issueDate: now,\n            certificateId,\n            verificationCode,\n            verificationUrl,\n            qrCode: qrCodeDataUrl,\n            ...values\n        };\n        // Generate the certificate HTML\n        let certificateHtml = template.content;\n        // Replace placeholders with actual values\n        Object.entries(mergedValues).forEach(([key, value])=>{\n            certificateHtml = certificateHtml.replace(new RegExp(`{{${key}}}`, \"g\"), value);\n        });\n        // Generate PDF from HTML\n        const pdfBuffer = await (0,_utils_pdfGenerator__WEBPACK_IMPORTED_MODULE_4__.generatePDF)(certificateHtml, {\n            format: \"A4\",\n            landscape: true,\n            margin: {\n                top: \"1cm\",\n                bottom: \"1cm\",\n                left: \"1cm\",\n                right: \"1cm\"\n            }\n        });\n        // Upload PDF to storage\n        const pdfRef = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.ref)(_firebase__WEBPACK_IMPORTED_MODULE_2__.storage, `certificates/${certificateId}.pdf`);\n        await (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.uploadString)(pdfRef, pdfBuffer.toString(\"base64\"), \"base64\");\n        // Get download URL\n        const downloadUrl = await (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.getDownloadURL)(pdfRef);\n        // Create certificate record with all required fields\n        const certificateData = {\n            userId,\n            userName: userData.displayName || userData.email || \"Student\",\n            courseId,\n            courseName: courseData.title || \"Course\",\n            templateId,\n            issueDate: now,\n            expiryDate: expiryDate || undefined,\n            values: mergedValues,\n            status: \"issued\",\n            verificationCode,\n            verificationUrl,\n            downloadUrl: downloadUrl || \"\",\n            qrCodeUrl: qrCodeDataUrl || \"\",\n            metadata,\n            createdAt: now,\n            isPublic: isPublic || false,\n            pdfUrl: downloadUrl || \"\",\n            thumbnailUrl: \"\",\n            blockchainVerified: false,\n            digitalSignature: undefined\n        };\n        // Generate digital signature for the certificate\n        const signatureData = {\n            id: certificateId,\n            userId,\n            courseId,\n            templateId,\n            issueDate: now,\n            verificationCode\n        };\n        const digitalSignature = (0,_utils_digitalSignature__WEBPACK_IMPORTED_MODULE_7__.generateSignature)(signatureData);\n        // Add digital signature to certificate data\n        certificateData.digitalSignature = digitalSignature || undefined;\n        const certificate = {\n            id: certificateId,\n            ...certificateData\n        };\n        // Save certificate to Firestore\n        const certificateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificates\", certificateId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(certificateRef, {\n            ...certificate,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Update user's course progress to include certificate\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n            certificateId,\n            certificateIssueDate: now,\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Update certificate stats\n        const statsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateStats\", templateId);\n        const statsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(statsRef);\n        if (statsSnapshot.exists()) {\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(statsRef, {\n                totalIssued: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.increment)(1),\n                lastIssued: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n                coursesUsed: courseId\n            });\n        } else {\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(statsRef, {\n                templateId,\n                totalIssued: 1,\n                lastIssued: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n                coursesUsed: [\n                    courseId\n                ]\n            });\n        }\n        // Register certificate on blockchain\n        try {\n            const blockchainVerification = await (0,_blockchainService__WEBPACK_IMPORTED_MODULE_6__.registerCertificateOnBlockchain)(certificate);\n            if (blockchainVerification) {\n                console.log(`Certificate ${certificate.id} registered on blockchain with transaction ID: ${blockchainVerification.transactionId}`);\n            }\n        } catch (blockchainError) {\n            console.error(\"Error registering certificate on blockchain:\", blockchainError);\n        // Continue even if blockchain registration fails\n        }\n        return certificate;\n    } catch (error) {\n        console.error(\"Error generating certificate:\", error);\n        return null;\n    }\n};\n/**\n * Get a certificate by ID\n */ const getCertificate = async (certificateId)=>{\n    try {\n        const certificateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificates\", certificateId);\n        const certificateSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(certificateRef);\n        if (!certificateSnapshot.exists()) {\n            return null;\n        }\n        return {\n            id: certificateSnapshot.id,\n            ...certificateSnapshot.data()\n        };\n    } catch (error) {\n        console.error(\"Error getting certificate:\", error);\n        return null;\n    }\n};\n/**\n * Get certificates for a user\n */ const getUserCertificates = async (userId)=>{\n    try {\n        const certificatesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificates\");\n        const certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"issueDate\", \"desc\"));\n        const certificatesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(certificatesQuery);\n        const certificates = [];\n        certificatesSnapshot.forEach((doc)=>{\n            certificates.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return certificates;\n    } catch (error) {\n        console.error(\"Error getting user certificates:\", error);\n        return [];\n    }\n};\n/**\n * Get certificates for a course\n */ const getCourseCertificates = async (courseId)=>{\n    try {\n        const certificatesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificates\");\n        const certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"courseId\", \"==\", courseId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"issueDate\", \"desc\"));\n        const certificatesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(certificatesQuery);\n        const certificates = [];\n        certificatesSnapshot.forEach((doc)=>{\n            certificates.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return certificates;\n    } catch (error) {\n        console.error(\"Error getting course certificates:\", error);\n        return [];\n    }\n};\n/**\n * Search certificates with filters\n */ const searchCertificates = async (filters)=>{\n    try {\n        const certificatesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificates\");\n        let certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesRef);\n        // Apply filters\n        if (filters.userId) {\n            certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", filters.userId));\n        }\n        if (filters.courseId) {\n            certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"courseId\", \"==\", filters.courseId));\n        }\n        if (filters.templateId) {\n            certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"templateId\", \"==\", filters.templateId));\n        }\n        if (filters.status) {\n            certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", filters.status));\n        }\n        // Add date range filters if provided\n        if (filters.startDate && filters.endDate) {\n            certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"issueDate\", \">=\", filters.startDate), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"issueDate\", \"<=\", filters.endDate));\n        } else if (filters.startDate) {\n            certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"issueDate\", \">=\", filters.startDate));\n        } else if (filters.endDate) {\n            certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"issueDate\", \"<=\", filters.endDate));\n        }\n        // Order by issue date\n        certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesQuery, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"issueDate\", \"desc\"));\n        const certificatesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(certificatesQuery);\n        const certificates = [];\n        certificatesSnapshot.forEach((doc)=>{\n            certificates.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return certificates;\n    } catch (error) {\n        console.error(\"Error searching certificates:\", error);\n        return [];\n    }\n};\n/**\n * Verify a certificate by verification code\n */ const verifyCertificate = async (verificationCode, ipAddress, userAgent)=>{\n    try {\n        const certificatesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificates\");\n        const certificatesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(certificatesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"verificationCode\", \"==\", verificationCode));\n        const certificatesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(certificatesQuery);\n        const now = new Date().toISOString();\n        const verificationId = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)();\n        // Certificate not found\n        if (certificatesSnapshot.empty) {\n            // Log invalid verification attempt\n            await logVerificationAttempt({\n                id: verificationId,\n                verificationCode,\n                status: \"invalid\",\n                verifiedAt: now,\n                verifiedIp: ipAddress,\n                userAgent\n            });\n            return {\n                isValid: false,\n                message: \"Certificate not found\",\n                verifiedAt: now\n            };\n        }\n        const certificateDoc = certificatesSnapshot.docs[0];\n        const certificate = {\n            id: certificateDoc.id,\n            ...certificateDoc.data()\n        };\n        // Check if certificate is revoked\n        if (certificate.status === \"revoked\") {\n            // Log revoked verification attempt\n            await logVerificationAttempt({\n                id: verificationId,\n                certificateId: certificate.id,\n                verificationCode,\n                status: \"revoked\",\n                verifiedAt: now,\n                verifiedIp: ipAddress,\n                userAgent\n            });\n            return {\n                isValid: false,\n                certificate,\n                message: \"Certificate has been revoked\",\n                verifiedAt: now\n            };\n        }\n        // Check if certificate is expired\n        if (certificate.status === \"expired\" || certificate.expiryDate && new Date(certificate.expiryDate) < new Date()) {\n            // Log expired verification attempt\n            await logVerificationAttempt({\n                id: verificationId,\n                certificateId: certificate.id,\n                verificationCode,\n                status: \"expired\",\n                verifiedAt: now,\n                verifiedIp: ipAddress,\n                userAgent\n            });\n            return {\n                isValid: false,\n                certificate,\n                message: \"Certificate has expired\",\n                verifiedAt: now\n            };\n        }\n        // Certificate is valid\n        await logVerificationAttempt({\n            id: verificationId,\n            certificateId: certificate.id,\n            verificationCode,\n            status: \"valid\",\n            verifiedAt: now,\n            verifiedIp: ipAddress,\n            userAgent\n        });\n        // Verify digital signature\n        let signatureValid = false;\n        let signatureMessage = \"Digital signature not found\";\n        if (certificate.digitalSignature) {\n            // Data to verify\n            const signatureData = {\n                id: certificate.id,\n                userId: certificate.userId,\n                courseId: certificate.courseId,\n                templateId: certificate.templateId,\n                issueDate: certificate.issueDate,\n                verificationCode: certificate.verificationCode\n            };\n            signatureValid = (0,_utils_digitalSignature__WEBPACK_IMPORTED_MODULE_7__.verifySignature)(signatureData, certificate.digitalSignature);\n            signatureMessage = signatureValid ? \"Digital signature verified\" : \"Digital signature invalid - certificate may have been tampered with\";\n        }\n        // Verify on blockchain if available\n        let blockchainVerificationResult = undefined;\n        if (certificate.blockchainVerified) {\n            try {\n                const blockchainResult = await (0,_blockchainService__WEBPACK_IMPORTED_MODULE_6__.verifyBlockchainCertificate)(certificate);\n                if (blockchainResult.verification) {\n                    blockchainVerificationResult = {\n                        isValid: blockchainResult.isValid,\n                        message: blockchainResult.message,\n                        transactionId: blockchainResult.verification.transactionId,\n                        blockchainProvider: blockchainResult.verification.blockchainProvider,\n                        blockchainNetwork: blockchainResult.verification.blockchainNetwork,\n                        verificationUrl: blockchainResult.verification.verificationUrl\n                    };\n                } else {\n                    blockchainVerificationResult = {\n                        isValid: false,\n                        message: \"Certificate not found on blockchain\"\n                    };\n                }\n            } catch (blockchainError) {\n                console.error(\"Error verifying certificate on blockchain:\", blockchainError);\n                blockchainVerificationResult = {\n                    isValid: false,\n                    message: \"Error verifying certificate on blockchain\"\n                };\n            }\n        }\n        return {\n            isValid: true,\n            certificate,\n            message: \"Certificate is valid\",\n            verifiedAt: now,\n            digitalSignatureVerification: {\n                isValid: signatureValid,\n                message: signatureMessage\n            },\n            blockchainVerification: blockchainVerificationResult\n        };\n    } catch (error) {\n        console.error(\"Error verifying certificate:\", error);\n        // Log error verification attempt\n        try {\n            await logVerificationAttempt({\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)(),\n                verificationCode,\n                status: \"invalid\",\n                verifiedAt: new Date().toISOString(),\n                verifiedIp: ipAddress,\n                userAgent\n            });\n        } catch (logError) {\n            console.error(\"Error logging verification attempt:\", logError);\n        }\n        return {\n            isValid: false,\n            message: \"Error verifying certificate\",\n            verifiedAt: new Date().toISOString()\n        };\n    }\n};\n/**\n * Log a certificate verification attempt\n */ const logVerificationAttempt = async (verification)=>{\n    try {\n        const verificationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateVerifications\", verification.id || (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)());\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(verificationRef, {\n            ...verification,\n            verifiedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            timestamp: new Date().getTime()\n        });\n    } catch (error) {\n        console.error(\"Error logging verification attempt:\", error);\n    }\n};\n/**\n * Revoke a certificate\n */ const revokeCertificate = async (certificateId, reason)=>{\n    try {\n        const certificateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificates\", certificateId);\n        const certificateDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(certificateRef);\n        if (!certificateDoc.exists()) {\n            throw new Error(\"Certificate not found\");\n        }\n        // Update certificate status\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(certificateRef, {\n            status: \"revoked\",\n            revocationReason: reason,\n            revocationDate: new Date().toISOString(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Log revocation\n        const revocationId = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)();\n        const revocationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_2__.firestore, \"certificateRevocations\", revocationId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(revocationRef, {\n            id: revocationId,\n            certificateId,\n            reason,\n            revokedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            revokedBy: \"admin\",\n            timestamp: new Date().getTime()\n        });\n        return true;\n    } catch (error) {\n        console.error(\"Error revoking certificate:\", error);\n        return false;\n    }\n};\n/**\n * Generate a QR code for a verification URL\n */ const generateQRCode = async (url)=>{\n    try {\n        // Generate QR code as data URL\n        const qrDataUrl = await qrcode__WEBPACK_IMPORTED_MODULE_5___default().toDataURL(url, {\n            errorCorrectionLevel: \"H\",\n            margin: 1,\n            width: 200,\n            color: {\n                dark: \"#000000\",\n                light: \"#ffffff\"\n            }\n        });\n        return qrDataUrl;\n    } catch (error) {\n        console.error(\"Error generating QR code:\", error);\n        return \"\";\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxtRUFBZUE7WUFDMUJrSyxXQUFXO1lBQ1hULFdBQVcsSUFBSW5ILE9BQU9vSCxPQUFPO1FBQ2pDO1FBRUUsT0FBTztJQUNYLEVBQUUsT0FBT3BJLE9BQU87UUFDWkMsUUFBUUQsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsT0FBTztJQUNYO0FBQ0EsRUFBRTtBQUVGOztDQUVDLEdBQ00sTUFBTThDLGlCQUFpQixPQUFPK0Y7SUFDbkMsSUFBSTtRQUNGLCtCQUErQjtRQUMvQixNQUFNQyxZQUFZLE1BQU0xSix1REFBZ0IsQ0FBQ3lKLEtBQUs7WUFDNUNHLHNCQUFzQjtZQUN0QjdFLFFBQVE7WUFDUjhFLE9BQU87WUFDUEMsT0FBTztnQkFDTEMsTUFBTTtnQkFDTkMsT0FBTztZQUNYO1FBQ0Y7UUFFRSxPQUFPTjtJQUNYLEVBQUUsT0FBTzlJLE9BQU87UUFDWkMsUUFBUUQsS0FBSyxDQUFDLDZCQUE2QkE7UUFDM0MsT0FBTztJQUNYO0FBQ0EsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL3NlcnZpY2VzL2NlcnRpZmljYXRlU2VydmljZS50cz8zZjJmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGNvbGxlY3Rpb24sXG4gIGRvYyxcbiAgZ2V0RG9jLFxuICBnZXREb2NzLFxuICBzZXREb2MsXG4gIHVwZGF0ZURvYyxcbiAgcXVlcnksXG4gIHdoZXJlLFxuICBvcmRlckJ5LFxuICBsaW1pdCxcbiAgc2VydmVyVGltZXN0YW1wLFxuICBpbmNyZW1lbnRcbn0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJztcbmltcG9ydCB7cmVmLCB1cGxvYWRTdHJpbmcsIGdldERvd25sb2FkVVJMIH0gZnJvbSAnZmlyZWJhc2Uvc3RvcmFnZSc7XG5pbXBvcnQge2ZpcmVzdG9yZSwgc3RvcmFnZSB9IGZyb20gJy4vZmlyZWJhc2UnO1xuaW1wb3J0IHtcbiAgQ2VydGlmaWNhdGUsXG4gIENlcnRpZmljYXRlVGVtcGxhdGUsXG4gIENlcnRpZmljYXRlR2VuZXJhdGlvbk9wdGlvbnMsXG4gIENlcnRpZmljYXRlVmVyaWZpY2F0aW9uLFxuICBDZXJ0aWZpY2F0ZVNlYXJjaEZpbHRlcnMsXG4gIENlcnRpZmljYXRlVmVyaWZpY2F0aW9uUmVzdWx0LFxufSBmcm9tICdAL3R5cGVzL2NlcnRpZmljYXRlLnR5cGVzJztcbmltcG9ydCB7djQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQge0NvdXJzZSB9IGZyb20gJ0AvdHlwZXMvY291cnNlLnR5cGVzJztcbmltcG9ydCB7VXNlciB9IGZyb20gJ0AvdHlwZXMvdXNlci50eXBlcyc7XG5pbXBvcnQge2dlbmVyYXRlUERGIH0gZnJvbSAnQC91dGlscy9wZGZHZW5lcmF0b3InO1xuaW1wb3J0IFFSQ29kZSBmcm9tICdxcmNvZGUnO1xuaW1wb3J0IHtyZWdpc3RlckNlcnRpZmljYXRlT25CbG9ja2NoYWluLCB2ZXJpZnlCbG9ja2NoYWluQ2VydGlmaWNhdGUgfSBmcm9tICcuL2Jsb2NrY2hhaW5TZXJ2aWNlJztcbmltcG9ydCB7Z2VuZXJhdGVTaWduYXR1cmUsIHZlcmlmeVNpZ25hdHVyZSB9IGZyb20gJ0AvdXRpbHMvZGlnaXRhbFNpZ25hdHVyZSc7XG5cbi8qKlxuICogR2V0IGEgY2VydGlmaWNhdGUgdGVtcGxhdGUgYnkgSURcbiAqL1xuZXhwb3J0IGNvbnN0IGdldENlcnRpZmljYXRlVGVtcGxhdGUgPSBhc3luYyAodGVtcGxhdGVJZDogc3RyaW5nKTogUHJvbWlzZTxDZXJ0aWZpY2F0ZVRlbXBsYXRlIHwgbnVsbD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHRlbXBsYXRlUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlVGVtcGxhdGVzJywgdGVtcGxhdGVJZCk7XG4gICAgY29uc3QgdGVtcGxhdGVTbmFwc2hvdCA9IGF3YWl0IGdldERvYyh0ZW1wbGF0ZVJlZik7XG5cbiAgICBpZiAoIXRlbXBsYXRlU25hcHNob3QuZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHRlbXBsYXRlU25hcHNob3QuaWQsXG4gICAgICAuLi50ZW1wbGF0ZVNuYXBzaG90LmRhdGEoKSBhcyBPbWl0PENlcnRpZmljYXRlVGVtcGxhdGUsICdpZCc+XG4gIH07XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgY2VydGlmaWNhdGUgdGVtcGxhdGU6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xufVxufTtcblxuLyoqXG4gKiBHZXQgYWxsIGNlcnRpZmljYXRlIHRlbXBsYXRlc1xuICovXG5leHBvcnQgY29uc3QgZ2V0Q2VydGlmaWNhdGVUZW1wbGF0ZXMgPSBhc3luYyAoKTogUHJvbWlzZTxDZXJ0aWZpY2F0ZVRlbXBsYXRlW10+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0ZW1wbGF0ZXNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlVGVtcGxhdGVzJyk7XG4gICAgY29uc3QgdGVtcGxhdGVzUXVlcnkgPSBxdWVyeSh0ZW1wbGF0ZXNSZWYsIG9yZGVyQnkoJ2NyZWF0ZWRBdCcsICdkZXNjJykpO1xuICAgIGNvbnN0IHRlbXBsYXRlc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyh0ZW1wbGF0ZXNRdWVyeSk7XG5cbiAgICBjb25zdCB0ZW1wbGF0ZXM6IENlcnRpZmljYXRlVGVtcGxhdGVbXSA9IFtdO1xuXG4gICAgdGVtcGxhdGVzU25hcHNob3QuZm9yRWFjaChkb2MgPT4ge1xuICAgICAgdGVtcGxhdGVzLnB1c2goe1xuICAgICAgICBpZDogZG9jLmlkLFxuICAgICAgICAuLi5kb2MuZGF0YSgpIGFzIE9taXQ8Q2VydGlmaWNhdGVUZW1wbGF0ZSwgJ2lkJz5cbiAgICB9KTtcbiAgfSk7XG5cbiAgICByZXR1cm4gdGVtcGxhdGVzO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGNlcnRpZmljYXRlIHRlbXBsYXRlczonLCBlcnJvcik7XG4gICAgcmV0dXJuIFtdO1xufVxufTtcblxuLyoqXG4gKiBHZXQgdGhlIGRlZmF1bHQgY2VydGlmaWNhdGUgdGVtcGxhdGVcbiAqL1xuZXhwb3J0IGNvbnN0IGdldERlZmF1bHRDZXJ0aWZpY2F0ZVRlbXBsYXRlID0gYXN5bmMgKCk6IFByb21pc2U8Q2VydGlmaWNhdGVUZW1wbGF0ZSB8IG51bGw+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0ZW1wbGF0ZXNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlVGVtcGxhdGVzJyk7XG4gICAgY29uc3QgdGVtcGxhdGVzUXVlcnkgPSBxdWVyeSh0ZW1wbGF0ZXNSZWYsIHdoZXJlKCdpc0RlZmF1bHQnLCAnPT0nLCB0cnVlKSwgbGltaXQoMSkpO1xuICAgIGNvbnN0IHRlbXBsYXRlc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyh0ZW1wbGF0ZXNRdWVyeSk7XG5cbiAgICBpZiAodGVtcGxhdGVzU25hcHNob3QuZW1wdHkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgICBjb25zdCB0ZW1wbGF0ZURvYyA9IHRlbXBsYXRlc1NuYXBzaG90LmRvY3NbMF07XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHRlbXBsYXRlRG9jLmlkLFxuICAgICAgLi4udGVtcGxhdGVEb2MuZGF0YSgpIGFzIE9taXQ8Q2VydGlmaWNhdGVUZW1wbGF0ZSwgJ2lkJz5cbiAgfTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBkZWZhdWx0IGNlcnRpZmljYXRlIHRlbXBsYXRlOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbn1cbn07XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IGNlcnRpZmljYXRlIHRlbXBsYXRlXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVDZXJ0aWZpY2F0ZVRlbXBsYXRlID0gYXN5bmMgKHRlbXBsYXRlOiBPbWl0PENlcnRpZmljYXRlVGVtcGxhdGUsICdpZCcgfCAnY3JlYXRlZEF0JyB8ICd1cGRhdGVkQXQnPik6IFByb21pc2U8Q2VydGlmaWNhdGVUZW1wbGF0ZSB8IG51bGw+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0ZW1wbGF0ZUlkID0gdXVpZHY0KCk7XG4gICAgY29uc3QgdGVtcGxhdGVSZWYgPSBkb2MoZmlyZXN0b3JlLCAnY2VydGlmaWNhdGVUZW1wbGF0ZXMnLCB0ZW1wbGF0ZUlkKTtcblxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcblxuICAgIGNvbnN0IG5ld1RlbXBsYXRlOiBPbWl0PENlcnRpZmljYXRlVGVtcGxhdGUsICdpZCc+ID0ge1xuICAgICAgLi4udGVtcGxhdGUsXG4gICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgIHVwZGF0ZWRBdDogbm93XG4gIH07XG5cbiAgICBhd2FpdCBzZXREb2ModGVtcGxhdGVSZWYsIHtcbiAgICAgIC4uLm5ld1RlbXBsYXRlLFxuICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcbiAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHRlbXBsYXRlSWQsXG4gICAgICAuLi5uZXdUZW1wbGF0ZVxuICB9O1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjZXJ0aWZpY2F0ZSB0ZW1wbGF0ZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG59XG59O1xuXG4vKipcbiAqIFVwZGF0ZSBhIGNlcnRpZmljYXRlIHRlbXBsYXRlXG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVDZXJ0aWZpY2F0ZVRlbXBsYXRlID0gYXN5bmMgKHRlbXBsYXRlSWQ6IHN0cmluZywgdGVtcGxhdGU6IFBhcnRpYWw8Q2VydGlmaWNhdGVUZW1wbGF0ZT4pOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0ZW1wbGF0ZVJlZiA9IGRvYyhmaXJlc3RvcmUsICdjZXJ0aWZpY2F0ZVRlbXBsYXRlcycsIHRlbXBsYXRlSWQpO1xuXG4gICAgYXdhaXQgdXBkYXRlRG9jKHRlbXBsYXRlUmVmLCB7XG4gICAgICAuLi50ZW1wbGF0ZSxcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcbiAgfSk7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2VydGlmaWNhdGUgdGVtcGxhdGU6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbn1cbn07XG5cbi8qKlxuICogR2VuZXJhdGUgYSBjZXJ0aWZpY2F0ZSBmb3IgYSB1c2VyIHdobyBjb21wbGV0ZWQgYSBjb3Vyc2VcbiAqL1xuZXhwb3J0IGNvbnN0IGdlbmVyYXRlQ2VydGlmaWNhdGUgPSBhc3luYyAob3B0aW9uczogQ2VydGlmaWNhdGVHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8Q2VydGlmaWNhdGUgfCBudWxsPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qge3RlbXBsYXRlSWQsIHVzZXJJZCwgY291cnNlSWQsIHZhbHVlcyA9IHt9LCBleHBpcnlEYXRlLCBtZXRhZGF0YTogaW5wdXRNZXRhZGF0YSA9IHt9LCBpc1B1YmxpYyA9IGZhbHNlIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IG1ldGFkYXRhID0ge2NvbXBsZXRpb25EYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksIC4uLmlucHV0TWV0YWRhdGEgfTtcbiAgICAvLyBFbnN1cmUgbWV0YWRhdGEgaGFzIHJlcXVpcmVkIGNvbXBsZXRpb25EYXRlXG4gICAgaWYgKCFtZXRhZGF0YS5jb21wbGV0aW9uRGF0ZSkge1xuICAgICAgbWV0YWRhdGEuY29tcGxldGlvbkRhdGUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIH1cblxuICAgIC8vIEdldCB0aGUgdGVtcGxhdGVcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IGdldENlcnRpZmljYXRlVGVtcGxhdGUodGVtcGxhdGVJZCk7XG5cbiAgICBpZiAoIXRlbXBsYXRlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NlcnRpZmljYXRlIHRlbXBsYXRlIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgICAvLyBHZXQgdGhlIHVzZXJcbiAgICBjb25zdCB1c2VyUmVmID0gZG9jKGZpcmVzdG9yZSwgJ3VzZXJzJywgdXNlcklkKTtcbiAgICBjb25zdCB1c2VyU25hcHNob3QgPSBhd2FpdCBnZXREb2ModXNlclJlZik7XG5cbiAgICBpZiAoIXVzZXJTbmFwc2hvdC5leGlzdHMoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgICBjb25zdCB1c2VyRGF0YSA9IHVzZXJTbmFwc2hvdC5kYXRhKCkgYXMgVXNlcjtcblxuICAgIC8vIEdldCB0aGUgY291cnNlXG4gICAgY29uc3QgY291cnNlUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NvdXJzZXMnLCBjb3Vyc2VJZCk7XG4gICAgY29uc3QgY291cnNlU25hcHNob3QgPSBhd2FpdCBnZXREb2MoY291cnNlUmVmKTtcblxuICAgIGlmICghY291cnNlU25hcHNob3QuZXhpc3RzKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ291cnNlIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgICBjb25zdCBjb3Vyc2VEYXRhID0gY291cnNlU25hcHNob3QuZGF0YSgpIGFzIENvdXJzZTtcblxuICAgIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGNlcnRpZmljYXRlIElEXG4gICAgY29uc3QgY2VydGlmaWNhdGVJZCA9IHV1aWR2NCgpO1xuXG4gICAgLy8gR2VuZXJhdGUgYSB2ZXJpZmljYXRpb24gY29kZVxuICAgIGNvbnN0IHZlcmlmaWNhdGlvbkNvZGUgPSB1dWlkdjQoKTtcblxuICAgIC8vIENyZWF0ZSB0aGUgdmVyaWZpY2F0aW9uIFVSTFxuICAgIGNvbnN0IHZlcmlmaWNhdGlvblVybCA9IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NJVEVfVVJMIHx8ICcnfS92ZXJpZnktY2VydGlmaWNhdGUvJHt2ZXJpZmljYXRpb25Db2RlfWA7XG5cbiAgICAvLyBHZW5lcmF0ZSBRUiBjb2RlIGZvciB2ZXJpZmljYXRpb24gVVJMXG4gICAgY29uc3QgcXJDb2RlRGF0YVVybCA9IGF3YWl0IGdlbmVyYXRlUVJDb2RlKHZlcmlmaWNhdGlvblVybCk7XG5cbiAgICAvLyBDdXJyZW50IGRhdGVcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICAvLyBNZXJnZSBkZWZhdWx0IHZhbHVlcyB3aXRoIHByb3ZpZGVkIHZhbHVlc1xuICAgIGNvbnN0IG1lcmdlZFZhbHVlcyA9IHtcbiAgICAgIC4uLnRlbXBsYXRlLmRlZmF1bHRWYWx1ZXMsXG4gICAgICBzdHVkZW50TmFtZTogdXNlckRhdGEuZGlzcGxheU5hbWUgfHwgdXNlckRhdGEuZW1haWwgfHwgJ1N0dWRlbnQnLFxuICAgICAgY291cnNlTmFtZTogY291cnNlRGF0YS50aXRsZSB8fCAnQ291cnNlJyxcbiAgICAgIGlzc3VlRGF0ZTogbm93LFxuICAgICAgY2VydGlmaWNhdGVJZCxcbiAgICAgIHZlcmlmaWNhdGlvbkNvZGUsXG4gICAgICB2ZXJpZmljYXRpb25VcmwsXG4gICAgICBxckNvZGU6IHFyQ29kZURhdGFVcmwsXG4gICAgICAuLi52YWx1ZXNcbiAgfTtcblxuICAgIC8vIEdlbmVyYXRlIHRoZSBjZXJ0aWZpY2F0ZSBIVE1MXG4gICAgbGV0IGNlcnRpZmljYXRlSHRtbCA9IHRlbXBsYXRlLmNvbnRlbnQ7XG5cbiAgICAvLyBSZXBsYWNlIHBsYWNlaG9sZGVycyB3aXRoIGFjdHVhbCB2YWx1ZXNcbiAgICBPYmplY3QuZW50cmllcyhtZXJnZWRWYWx1ZXMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgY2VydGlmaWNhdGVIdG1sID0gY2VydGlmaWNhdGVIdG1sLnJlcGxhY2UobmV3IFJlZ0V4cChge3ske2tleX19fWAsICdnJyksIHZhbHVlKTtcbiAgfSk7XG5cbiAgICAvLyBHZW5lcmF0ZSBQREYgZnJvbSBIVE1MXG4gICAgY29uc3QgcGRmQnVmZmVyID0gYXdhaXQgZ2VuZXJhdGVQREYoY2VydGlmaWNhdGVIdG1sLCB7XG4gICAgICBmb3JtYXQ6ICdBNCcsXG4gICAgICBsYW5kc2NhcGU6IHRydWUsXG4gICAgICBtYXJnaW46IHtcbiAgICAgICAgdG9wOiAnMWNtJyxcbiAgICAgICAgYm90dG9tOiAnMWNtJyxcbiAgICAgICAgbGVmdDogJzFjbScsXG4gICAgICAgIHJpZ2h0OiAnMWNtJ1xuICAgIH1cbiAgfSk7XG5cbiAgICAvLyBVcGxvYWQgUERGIHRvIHN0b3JhZ2VcbiAgICBjb25zdCBwZGZSZWYgPSByZWYoc3RvcmFnZSwgYGNlcnRpZmljYXRlcy8ke2NlcnRpZmljYXRlSWR9LnBkZmApO1xuICAgIGF3YWl0IHVwbG9hZFN0cmluZyhwZGZSZWYsIHBkZkJ1ZmZlci50b1N0cmluZygnYmFzZTY0JyksICdiYXNlNjQnKTtcblxuICAgIC8vIEdldCBkb3dubG9hZCBVUkxcbiAgICBjb25zdCBkb3dubG9hZFVybCA9IGF3YWl0IGdldERvd25sb2FkVVJMKHBkZlJlZik7XG5cbiAgICAvLyBDcmVhdGUgY2VydGlmaWNhdGUgcmVjb3JkIHdpdGggYWxsIHJlcXVpcmVkIGZpZWxkc1xuICAgIGNvbnN0IGNlcnRpZmljYXRlRGF0YTogT21pdDxDZXJ0aWZpY2F0ZSwgJ2lkJz4gPSB7XG4gICAgICB1c2VySWQsXG4gICAgICB1c2VyTmFtZTogdXNlckRhdGEuZGlzcGxheU5hbWUgfHwgdXNlckRhdGEuZW1haWwgfHwgJ1N0dWRlbnQnLFxuICAgICAgY291cnNlSWQsXG4gICAgICBjb3Vyc2VOYW1lOiBjb3Vyc2VEYXRhLnRpdGxlIHx8ICdDb3Vyc2UnLFxuICAgICAgdGVtcGxhdGVJZCxcbiAgICAgIGlzc3VlRGF0ZTogbm93LFxuICAgICAgZXhwaXJ5RGF0ZTogZXhwaXJ5RGF0ZSB8fCB1bmRlZmluZWQsXG4gICAgICB2YWx1ZXM6IG1lcmdlZFZhbHVlcyxcbiAgICAgIHN0YXR1czogJ2lzc3VlZCcsXG4gICAgICB2ZXJpZmljYXRpb25Db2RlLFxuICAgICAgdmVyaWZpY2F0aW9uVXJsLFxuICAgICAgZG93bmxvYWRVcmw6IGRvd25sb2FkVXJsIHx8ICcnLFxuICAgICAgcXJDb2RlVXJsOiBxckNvZGVEYXRhVXJsIHx8ICcnLFxuICAgICAgbWV0YWRhdGEsXG4gICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgIGlzUHVibGljOiBpc1B1YmxpYyB8fCBmYWxzZSxcbiAgICAgIHBkZlVybDogZG93bmxvYWRVcmwgfHwgJycsXG4gICAgICB0aHVtYm5haWxVcmw6ICcnLFxuICAgICAgYmxvY2tjaGFpblZlcmlmaWVkOiBmYWxzZSxcbiAgICAgIGRpZ2l0YWxTaWduYXR1cmU6IHVuZGVmaW5lZFxuICB9O1xuXG4gICAgLy8gR2VuZXJhdGUgZGlnaXRhbCBzaWduYXR1cmUgZm9yIHRoZSBjZXJ0aWZpY2F0ZVxuICAgIGNvbnN0IHNpZ25hdHVyZURhdGEgPSB7XG4gICAgICBpZDogY2VydGlmaWNhdGVJZCxcbiAgICAgIHVzZXJJZCxcbiAgICAgIGNvdXJzZUlkLFxuICAgICAgdGVtcGxhdGVJZCxcbiAgICAgIGlzc3VlRGF0ZTogbm93LFxuICAgICAgdmVyaWZpY2F0aW9uQ29kZVxuICB9O1xuXG4gICAgY29uc3QgZGlnaXRhbFNpZ25hdHVyZSA9IGdlbmVyYXRlU2lnbmF0dXJlKHNpZ25hdHVyZURhdGEpO1xuXG4gICAgLy8gQWRkIGRpZ2l0YWwgc2lnbmF0dXJlIHRvIGNlcnRpZmljYXRlIGRhdGFcbiAgICBjZXJ0aWZpY2F0ZURhdGEuZGlnaXRhbFNpZ25hdHVyZSA9IGRpZ2l0YWxTaWduYXR1cmUgfHwgdW5kZWZpbmVkO1xuICAgIGNvbnN0IGNlcnRpZmljYXRlOiBDZXJ0aWZpY2F0ZSA9IHtcbiAgICAgIGlkOiBjZXJ0aWZpY2F0ZUlkLFxuICAgICAgLi4uY2VydGlmaWNhdGVEYXRhXG4gIH07XG5cbiAgICAvLyBTYXZlIGNlcnRpZmljYXRlIHRvIEZpcmVzdG9yZVxuICAgIGNvbnN0IGNlcnRpZmljYXRlUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlcycsIGNlcnRpZmljYXRlSWQpO1xuICAgIGF3YWl0IHNldERvYyhjZXJ0aWZpY2F0ZVJlZiwge1xuICAgICAgLi4uY2VydGlmaWNhdGUsXG4gICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXG4gIH0pO1xuXG4gICAgLy8gVXBkYXRlIHVzZXIncyBjb3Vyc2UgcHJvZ3Jlc3MgdG8gaW5jbHVkZSBjZXJ0aWZpY2F0ZVxuICAgIGNvbnN0IHByb2dyZXNzUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NvdXJzZVByb2dyZXNzJywgYCR7dXNlcklkfV8ke2NvdXJzZUlkfWApO1xuICAgIGF3YWl0IHVwZGF0ZURvYyhwcm9ncmVzc1JlZiwge1xuICAgICAgY2VydGlmaWNhdGVJZCxcbiAgICAgIGNlcnRpZmljYXRlSXNzdWVEYXRlOiBub3csXG4gICAgICBsYXN0VXBkYXRlZDogc2VydmVyVGltZXN0YW1wKClcbiAgfSk7XG5cbiAgICAvLyBVcGRhdGUgY2VydGlmaWNhdGUgc3RhdHNcbiAgICBjb25zdCBzdGF0c1JlZiA9IGRvYyhmaXJlc3RvcmUsICdjZXJ0aWZpY2F0ZVN0YXRzJywgdGVtcGxhdGVJZCk7XG4gICAgY29uc3Qgc3RhdHNTbmFwc2hvdCA9IGF3YWl0IGdldERvYyhzdGF0c1JlZik7XG5cbiAgICBpZiAoc3RhdHNTbmFwc2hvdC5leGlzdHMoKSkge1xuICAgICAgYXdhaXQgdXBkYXRlRG9jKHN0YXRzUmVmLCB7XG4gICAgICAgIHRvdGFsSXNzdWVkOiBpbmNyZW1lbnQoMSksXG4gICAgICAgIGxhc3RJc3N1ZWQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgICBjb3Vyc2VzVXNlZDogY291cnNlSWRcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHNldERvYyhzdGF0c1JlZiwge1xuICAgICAgICB0ZW1wbGF0ZUlkLFxuICAgICAgICB0b3RhbElzc3VlZDogMSxcbiAgICAgICAgbGFzdElzc3VlZDogc2VydmVyVGltZXN0YW1wKCksXG4gICAgICAgIGNvdXJzZXNVc2VkOiBbY291cnNlSWRdXG4gICAgfSk7XG4gIH1cblxuICAgIC8vIFJlZ2lzdGVyIGNlcnRpZmljYXRlIG9uIGJsb2NrY2hhaW5cbiAgICB0cnkge1xuICAgICAgY29uc3QgYmxvY2tjaGFpblZlcmlmaWNhdGlvbiA9IGF3YWl0IHJlZ2lzdGVyQ2VydGlmaWNhdGVPbkJsb2NrY2hhaW4oY2VydGlmaWNhdGUpO1xuXG4gICAgICBpZiAoYmxvY2tjaGFpblZlcmlmaWNhdGlvbikge1xuICAgICAgICBjb25zb2xlLmxvZyhgQ2VydGlmaWNhdGUgJHtjZXJ0aWZpY2F0ZS5pZH0gcmVnaXN0ZXJlZCBvbiBibG9ja2NoYWluIHdpdGggdHJhbnNhY3Rpb24gSUQ6ICR7YmxvY2tjaGFpblZlcmlmaWNhdGlvbi50cmFuc2FjdGlvbklkfWApO1xuICAgIH1cbiAgfSBjYXRjaCAoYmxvY2tjaGFpbkVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWdpc3RlcmluZyBjZXJ0aWZpY2F0ZSBvbiBibG9ja2NoYWluOicsIGJsb2NrY2hhaW5FcnJvcik7XG4gICAgICAvLyBDb250aW51ZSBldmVuIGlmIGJsb2NrY2hhaW4gcmVnaXN0cmF0aW9uIGZhaWxzXG4gIH1cblxuICAgIHJldHVybiBjZXJ0aWZpY2F0ZTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2VuZXJhdGluZyBjZXJ0aWZpY2F0ZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG59XG59O1xuXG4vKipcbiAqIEdldCBhIGNlcnRpZmljYXRlIGJ5IElEXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRDZXJ0aWZpY2F0ZSA9IGFzeW5jIChjZXJ0aWZpY2F0ZUlkOiBzdHJpbmcpOiBQcm9taXNlPENlcnRpZmljYXRlIHwgbnVsbD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNlcnRpZmljYXRlUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlcycsIGNlcnRpZmljYXRlSWQpO1xuICAgIGNvbnN0IGNlcnRpZmljYXRlU25hcHNob3QgPSBhd2FpdCBnZXREb2MoY2VydGlmaWNhdGVSZWYpO1xuXG4gICAgaWYgKCFjZXJ0aWZpY2F0ZVNuYXBzaG90LmV4aXN0cygpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBjZXJ0aWZpY2F0ZVNuYXBzaG90LmlkLFxuICAgICAgLi4uY2VydGlmaWNhdGVTbmFwc2hvdC5kYXRhKCkgYXMgT21pdDxDZXJ0aWZpY2F0ZSwgJ2lkJz5cbiAgfTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBjZXJ0aWZpY2F0ZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG59XG59O1xuXG4vKipcbiAqIEdldCBjZXJ0aWZpY2F0ZXMgZm9yIGEgdXNlclxuICovXG5leHBvcnQgY29uc3QgZ2V0VXNlckNlcnRpZmljYXRlcyA9IGFzeW5jICh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Q2VydGlmaWNhdGVbXT4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNlcnRpZmljYXRlc1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAnY2VydGlmaWNhdGVzJyk7XG4gICAgY29uc3QgY2VydGlmaWNhdGVzUXVlcnkgPSBxdWVyeShcbiAgICAgIGNlcnRpZmljYXRlc1JlZixcbiAgICAgIHdoZXJlKCd1c2VySWQnLCAnPT0nLCB1c2VySWQpLFxuICAgICAgb3JkZXJCeSgnaXNzdWVEYXRlJywgJ2Rlc2MnKVxuICAgICk7XG4gICAgY29uc3QgY2VydGlmaWNhdGVzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGNlcnRpZmljYXRlc1F1ZXJ5KTtcblxuICAgIGNvbnN0IGNlcnRpZmljYXRlczogQ2VydGlmaWNhdGVbXSA9IFtdO1xuXG4gICAgY2VydGlmaWNhdGVzU25hcHNob3QuZm9yRWFjaChkb2MgPT4ge1xuICAgICAgY2VydGlmaWNhdGVzLnB1c2goe1xuICAgICAgICBpZDogZG9jLmlkLFxuICAgICAgICAuLi5kb2MuZGF0YSgpIGFzIE9taXQ8Q2VydGlmaWNhdGUsICdpZCc+XG4gICAgfSk7XG4gIH0pO1xuXG4gICAgcmV0dXJuIGNlcnRpZmljYXRlcztcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB1c2VyIGNlcnRpZmljYXRlczonLCBlcnJvcik7XG4gICAgcmV0dXJuIFtdO1xufVxufTtcblxuLyoqXG4gKiBHZXQgY2VydGlmaWNhdGVzIGZvciBhIGNvdXJzZVxuICovXG5leHBvcnQgY29uc3QgZ2V0Q291cnNlQ2VydGlmaWNhdGVzID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPENlcnRpZmljYXRlW10+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjZXJ0aWZpY2F0ZXNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlcycpO1xuICAgIGNvbnN0IGNlcnRpZmljYXRlc1F1ZXJ5ID0gcXVlcnkoXG4gICAgICBjZXJ0aWZpY2F0ZXNSZWYsXG4gICAgICB3aGVyZSgnY291cnNlSWQnLCAnPT0nLCBjb3Vyc2VJZCksXG4gICAgICBvcmRlckJ5KCdpc3N1ZURhdGUnLCAnZGVzYycpXG4gICAgKTtcbiAgICBjb25zdCBjZXJ0aWZpY2F0ZXNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoY2VydGlmaWNhdGVzUXVlcnkpO1xuXG4gICAgY29uc3QgY2VydGlmaWNhdGVzOiBDZXJ0aWZpY2F0ZVtdID0gW107XG5cbiAgICBjZXJ0aWZpY2F0ZXNTbmFwc2hvdC5mb3JFYWNoKGRvYyA9PiB7XG4gICAgICBjZXJ0aWZpY2F0ZXMucHVzaCh7XG4gICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgIC4uLmRvYy5kYXRhKCkgYXMgT21pdDxDZXJ0aWZpY2F0ZSwgJ2lkJz5cbiAgICB9KTtcbiAgfSk7XG5cbiAgICByZXR1cm4gY2VydGlmaWNhdGVzO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGNvdXJzZSBjZXJ0aWZpY2F0ZXM6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbn1cbn07XG5cbi8qKlxuICogU2VhcmNoIGNlcnRpZmljYXRlcyB3aXRoIGZpbHRlcnNcbiAqL1xuZXhwb3J0IGNvbnN0IHNlYXJjaENlcnRpZmljYXRlcyA9IGFzeW5jIChmaWx0ZXJzOiBDZXJ0aWZpY2F0ZVNlYXJjaEZpbHRlcnMpOiBQcm9taXNlPENlcnRpZmljYXRlW10+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjZXJ0aWZpY2F0ZXNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlcycpO1xuICAgIGxldCBjZXJ0aWZpY2F0ZXNRdWVyeSA9IHF1ZXJ5KGNlcnRpZmljYXRlc1JlZik7XG5cbiAgICAvLyBBcHBseSBmaWx0ZXJzXG4gICAgaWYgKGZpbHRlcnMudXNlcklkKSB7XG4gICAgICBjZXJ0aWZpY2F0ZXNRdWVyeSA9IHF1ZXJ5KGNlcnRpZmljYXRlc1F1ZXJ5LCB3aGVyZSgndXNlcklkJywgJz09JywgZmlsdGVycy51c2VySWQpKTtcbiAgfVxuXG4gICAgaWYgKGZpbHRlcnMuY291cnNlSWQpIHtcbiAgICAgIGNlcnRpZmljYXRlc1F1ZXJ5ID0gcXVlcnkoY2VydGlmaWNhdGVzUXVlcnksIHdoZXJlKCdjb3Vyc2VJZCcsICc9PScsIGZpbHRlcnMuY291cnNlSWQpKTtcbiAgfVxuXG4gICAgaWYgKGZpbHRlcnMudGVtcGxhdGVJZCkge1xuICAgICAgY2VydGlmaWNhdGVzUXVlcnkgPSBxdWVyeShjZXJ0aWZpY2F0ZXNRdWVyeSwgd2hlcmUoJ3RlbXBsYXRlSWQnLCAnPT0nLCBmaWx0ZXJzLnRlbXBsYXRlSWQpKTtcbiAgfVxuXG4gICAgaWYgKGZpbHRlcnMuc3RhdHVzKSB7XG4gICAgICBjZXJ0aWZpY2F0ZXNRdWVyeSA9IHF1ZXJ5KGNlcnRpZmljYXRlc1F1ZXJ5LCB3aGVyZSgnc3RhdHVzJywgJz09JywgZmlsdGVycy5zdGF0dXMpKTtcbiAgfVxuXG4gICAgLy8gQWRkIGRhdGUgcmFuZ2UgZmlsdGVycyBpZiBwcm92aWRlZFxuICAgIGlmIChmaWx0ZXJzLnN0YXJ0RGF0ZSAmJiBmaWx0ZXJzLmVuZERhdGUpIHtcbiAgICAgIGNlcnRpZmljYXRlc1F1ZXJ5ID0gcXVlcnkoXG4gICAgICAgIGNlcnRpZmljYXRlc1F1ZXJ5LFxuICAgICAgICB3aGVyZSgnaXNzdWVEYXRlJywgJz49JywgZmlsdGVycy5zdGFydERhdGUpLFxuICAgICAgICB3aGVyZSgnaXNzdWVEYXRlJywgJzw9JywgZmlsdGVycy5lbmREYXRlKVxuICAgICAgKTtcbiAgfSBlbHNlIGlmIChmaWx0ZXJzLnN0YXJ0RGF0ZSkge1xuICAgICAgY2VydGlmaWNhdGVzUXVlcnkgPSBxdWVyeShjZXJ0aWZpY2F0ZXNRdWVyeSwgd2hlcmUoJ2lzc3VlRGF0ZScsICc+PScsIGZpbHRlcnMuc3RhcnREYXRlKSk7XG4gIH0gZWxzZSBpZiAoZmlsdGVycy5lbmREYXRlKSB7XG4gICAgICBjZXJ0aWZpY2F0ZXNRdWVyeSA9IHF1ZXJ5KGNlcnRpZmljYXRlc1F1ZXJ5LCB3aGVyZSgnaXNzdWVEYXRlJywgJzw9JywgZmlsdGVycy5lbmREYXRlKSk7XG4gIH1cblxuICAgIC8vIE9yZGVyIGJ5IGlzc3VlIGRhdGVcbiAgICBjZXJ0aWZpY2F0ZXNRdWVyeSA9IHF1ZXJ5KGNlcnRpZmljYXRlc1F1ZXJ5LCBvcmRlckJ5KCdpc3N1ZURhdGUnLCAnZGVzYycpKTtcblxuICAgIGNvbnN0IGNlcnRpZmljYXRlc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhjZXJ0aWZpY2F0ZXNRdWVyeSk7XG5cbiAgICBjb25zdCBjZXJ0aWZpY2F0ZXM6IENlcnRpZmljYXRlW10gPSBbXTtcblxuICAgIGNlcnRpZmljYXRlc1NuYXBzaG90LmZvckVhY2goZG9jID0+IHtcbiAgICAgIGNlcnRpZmljYXRlcy5wdXNoKHtcbiAgICAgICAgaWQ6IGRvYy5pZCxcbiAgICAgICAgLi4uZG9jLmRhdGEoKSBhcyBPbWl0PENlcnRpZmljYXRlLCAnaWQnPlxuICAgIH0pO1xuICB9KTtcblxuICAgIHJldHVybiBjZXJ0aWZpY2F0ZXM7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlYXJjaGluZyBjZXJ0aWZpY2F0ZXM6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbn1cbn07XG5cbi8qKlxuICogVmVyaWZ5IGEgY2VydGlmaWNhdGUgYnkgdmVyaWZpY2F0aW9uIGNvZGVcbiAqL1xuZXhwb3J0IGNvbnN0IHZlcmlmeUNlcnRpZmljYXRlID0gYXN5bmMgKHZlcmlmaWNhdGlvbkNvZGU6IHN0cmluZywgaXBBZGRyZXNzPzogc3RyaW5nLCB1c2VyQWdlbnQ/OiBzdHJpbmcpOiBQcm9taXNlPENlcnRpZmljYXRlVmVyaWZpY2F0aW9uUmVzdWx0PiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2VydGlmaWNhdGVzUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsICdjZXJ0aWZpY2F0ZXMnKTtcbiAgICBjb25zdCBjZXJ0aWZpY2F0ZXNRdWVyeSA9IHF1ZXJ5KFxuICAgICAgY2VydGlmaWNhdGVzUmVmLFxuICAgICAgd2hlcmUoJ3ZlcmlmaWNhdGlvbkNvZGUnLCAnPT0nLCB2ZXJpZmljYXRpb25Db2RlKVxuICAgICk7XG4gICAgY29uc3QgY2VydGlmaWNhdGVzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGNlcnRpZmljYXRlc1F1ZXJ5KTtcblxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCB2ZXJpZmljYXRpb25JZCA9IHV1aWR2NCgpO1xuXG4gICAgLy8gQ2VydGlmaWNhdGUgbm90IGZvdW5kXG4gICAgaWYgKGNlcnRpZmljYXRlc1NuYXBzaG90LmVtcHR5KSB7XG4gICAgICAvLyBMb2cgaW52YWxpZCB2ZXJpZmljYXRpb24gYXR0ZW1wdFxuICAgICAgYXdhaXQgbG9nVmVyaWZpY2F0aW9uQXR0ZW1wdCh7XG4gICAgICAgIGlkOiB2ZXJpZmljYXRpb25JZCxcbiAgICAgICAgdmVyaWZpY2F0aW9uQ29kZSxcbiAgICAgICAgc3RhdHVzOiAnaW52YWxpZCcsXG4gICAgICAgIHZlcmlmaWVkQXQ6IG5vdyxcbiAgICAgICAgdmVyaWZpZWRJcDogaXBBZGRyZXNzLFxuICAgICAgICB1c2VyQWdlbnRcbiAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdDZXJ0aWZpY2F0ZSBub3QgZm91bmQnLFxuICAgICAgICB2ZXJpZmllZEF0OiBub3dcbiAgICB9O1xuICB9XG5cbiAgICBjb25zdCBjZXJ0aWZpY2F0ZURvYyA9IGNlcnRpZmljYXRlc1NuYXBzaG90LmRvY3NbMF07XG4gICAgY29uc3QgY2VydGlmaWNhdGUgPSB7XG4gICAgICBpZDogY2VydGlmaWNhdGVEb2MuaWQsXG4gICAgICAuLi5jZXJ0aWZpY2F0ZURvYy5kYXRhKCkgYXMgT21pdDxDZXJ0aWZpY2F0ZSwgJ2lkJz5cbiAgfTtcblxuICAgIC8vIENoZWNrIGlmIGNlcnRpZmljYXRlIGlzIHJldm9rZWRcbiAgICBpZiAoY2VydGlmaWNhdGUuc3RhdHVzID09PSAncmV2b2tlZCcpIHtcbiAgICAgIC8vIExvZyByZXZva2VkIHZlcmlmaWNhdGlvbiBhdHRlbXB0XG4gICAgICBhd2FpdCBsb2dWZXJpZmljYXRpb25BdHRlbXB0KHtcbiAgICAgICAgaWQ6IHZlcmlmaWNhdGlvbklkLFxuICAgICAgICBjZXJ0aWZpY2F0ZUlkOiBjZXJ0aWZpY2F0ZS5pZCxcbiAgICAgICAgdmVyaWZpY2F0aW9uQ29kZSxcbiAgICAgICAgc3RhdHVzOiAncmV2b2tlZCcsXG4gICAgICAgIHZlcmlmaWVkQXQ6IG5vdyxcbiAgICAgICAgdmVyaWZpZWRJcDogaXBBZGRyZXNzLFxuICAgICAgICB1c2VyQWdlbnRcbiAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGNlcnRpZmljYXRlLFxuICAgICAgICBtZXNzYWdlOiAnQ2VydGlmaWNhdGUgaGFzIGJlZW4gcmV2b2tlZCcsXG4gICAgICAgIHZlcmlmaWVkQXQ6IG5vd1xuICAgIH07XG4gIH1cblxuICAgIC8vIENoZWNrIGlmIGNlcnRpZmljYXRlIGlzIGV4cGlyZWRcbiAgICBpZiAoY2VydGlmaWNhdGUuc3RhdHVzID09PSAnZXhwaXJlZCcgfHwgKGNlcnRpZmljYXRlLmV4cGlyeURhdGUgJiYgbmV3IERhdGUoY2VydGlmaWNhdGUuZXhwaXJ5RGF0ZSkgPCBuZXcgRGF0ZSgpKSkge1xuICAgICAgLy8gTG9nIGV4cGlyZWQgdmVyaWZpY2F0aW9uIGF0dGVtcHRcbiAgICAgIGF3YWl0IGxvZ1ZlcmlmaWNhdGlvbkF0dGVtcHQoe1xuICAgICAgICBpZDogdmVyaWZpY2F0aW9uSWQsXG4gICAgICAgIGNlcnRpZmljYXRlSWQ6IGNlcnRpZmljYXRlLmlkLFxuICAgICAgICB2ZXJpZmljYXRpb25Db2RlLFxuICAgICAgICBzdGF0dXM6ICdleHBpcmVkJyxcbiAgICAgICAgdmVyaWZpZWRBdDogbm93LFxuICAgICAgICB2ZXJpZmllZElwOiBpcEFkZHJlc3MsXG4gICAgICAgIHVzZXJBZ2VudFxuICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgY2VydGlmaWNhdGUsXG4gICAgICAgIG1lc3NhZ2U6ICdDZXJ0aWZpY2F0ZSBoYXMgZXhwaXJlZCcsXG4gICAgICAgIHZlcmlmaWVkQXQ6IG5vd1xuICAgIH07XG4gIH1cblxuICAgIC8vIENlcnRpZmljYXRlIGlzIHZhbGlkXG4gICAgYXdhaXQgbG9nVmVyaWZpY2F0aW9uQXR0ZW1wdCh7XG4gICAgICBpZDogdmVyaWZpY2F0aW9uSWQsXG4gICAgICBjZXJ0aWZpY2F0ZUlkOiBjZXJ0aWZpY2F0ZS5pZCxcbiAgICAgIHZlcmlmaWNhdGlvbkNvZGUsXG4gICAgICBzdGF0dXM6ICd2YWxpZCcsXG4gICAgICB2ZXJpZmllZEF0OiBub3csXG4gICAgICB2ZXJpZmllZElwOiBpcEFkZHJlc3MsXG4gICAgICB1c2VyQWdlbnRcbiAgfSk7XG5cbiAgICAvLyBWZXJpZnkgZGlnaXRhbCBzaWduYXR1cmVcbiAgICBsZXQgc2lnbmF0dXJlVmFsaWQgPSBmYWxzZTtcbiAgICBsZXQgc2lnbmF0dXJlTWVzc2FnZSA9ICdEaWdpdGFsIHNpZ25hdHVyZSBub3QgZm91bmQnO1xuXG4gICAgaWYgKGNlcnRpZmljYXRlLmRpZ2l0YWxTaWduYXR1cmUpIHtcbiAgICAgIC8vIERhdGEgdG8gdmVyaWZ5XG4gICAgICBjb25zdCBzaWduYXR1cmVEYXRhID0ge1xuICAgICAgICBpZDogY2VydGlmaWNhdGUuaWQsXG4gICAgICAgIHVzZXJJZDogY2VydGlmaWNhdGUudXNlcklkLFxuICAgICAgICBjb3Vyc2VJZDogY2VydGlmaWNhdGUuY291cnNlSWQsXG4gICAgICAgIHRlbXBsYXRlSWQ6IGNlcnRpZmljYXRlLnRlbXBsYXRlSWQsXG4gICAgICAgIGlzc3VlRGF0ZTogY2VydGlmaWNhdGUuaXNzdWVEYXRlLFxuICAgICAgICB2ZXJpZmljYXRpb25Db2RlOiBjZXJ0aWZpY2F0ZS52ZXJpZmljYXRpb25Db2RlXG4gICAgfTtcblxuICAgICAgc2lnbmF0dXJlVmFsaWQgPSB2ZXJpZnlTaWduYXR1cmUoc2lnbmF0dXJlRGF0YSwgY2VydGlmaWNhdGUuZGlnaXRhbFNpZ25hdHVyZSk7XG4gICAgICBzaWduYXR1cmVNZXNzYWdlID0gc2lnbmF0dXJlVmFsaWRcbiAgICAgICAgPyAnRGlnaXRhbCBzaWduYXR1cmUgdmVyaWZpZWQnXG4gICAgICAgIDogJ0RpZ2l0YWwgc2lnbmF0dXJlIGludmFsaWQgLSBjZXJ0aWZpY2F0ZSBtYXkgaGF2ZSBiZWVuIHRhbXBlcmVkIHdpdGgnO1xuICB9XG5cbiAgICAvLyBWZXJpZnkgb24gYmxvY2tjaGFpbiBpZiBhdmFpbGFibGVcbiAgICBsZXQgYmxvY2tjaGFpblZlcmlmaWNhdGlvblJlc3VsdCA9IHVuZGVmaW5lZDtcblxuICAgIGlmIChjZXJ0aWZpY2F0ZS5ibG9ja2NoYWluVmVyaWZpZWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGJsb2NrY2hhaW5SZXN1bHQgPSBhd2FpdCB2ZXJpZnlCbG9ja2NoYWluQ2VydGlmaWNhdGUoY2VydGlmaWNhdGUpO1xuXG4gICAgICAgIGlmIChibG9ja2NoYWluUmVzdWx0LnZlcmlmaWNhdGlvbikge1xuICAgICAgICAgIGJsb2NrY2hhaW5WZXJpZmljYXRpb25SZXN1bHQgPSB7XG4gICAgICAgICAgICBpc1ZhbGlkOiBibG9ja2NoYWluUmVzdWx0LmlzVmFsaWQsXG4gICAgICAgICAgICBtZXNzYWdlOiBibG9ja2NoYWluUmVzdWx0Lm1lc3NhZ2UsXG4gICAgICAgICAgICB0cmFuc2FjdGlvbklkOiBibG9ja2NoYWluUmVzdWx0LnZlcmlmaWNhdGlvbi50cmFuc2FjdGlvbklkLFxuICAgICAgICAgICAgYmxvY2tjaGFpblByb3ZpZGVyOiBibG9ja2NoYWluUmVzdWx0LnZlcmlmaWNhdGlvbi5ibG9ja2NoYWluUHJvdmlkZXIsXG4gICAgICAgICAgICBibG9ja2NoYWluTmV0d29yazogYmxvY2tjaGFpblJlc3VsdC52ZXJpZmljYXRpb24uYmxvY2tjaGFpbk5ldHdvcmssXG4gICAgICAgICAgICB2ZXJpZmljYXRpb25Vcmw6IGJsb2NrY2hhaW5SZXN1bHQudmVyaWZpY2F0aW9uLnZlcmlmaWNhdGlvblVybFxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBibG9ja2NoYWluVmVyaWZpY2F0aW9uUmVzdWx0ID0ge1xuICAgICAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgICAgICBtZXNzYWdlOiAnQ2VydGlmaWNhdGUgbm90IGZvdW5kIG9uIGJsb2NrY2hhaW4nXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBjYXRjaCAoYmxvY2tjaGFpbkVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHZlcmlmeWluZyBjZXJ0aWZpY2F0ZSBvbiBibG9ja2NoYWluOicsIGJsb2NrY2hhaW5FcnJvcik7XG4gICAgICAgIGJsb2NrY2hhaW5WZXJpZmljYXRpb25SZXN1bHQgPSB7XG4gICAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgICAgbWVzc2FnZTogJ0Vycm9yIHZlcmlmeWluZyBjZXJ0aWZpY2F0ZSBvbiBibG9ja2NoYWluJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgY2VydGlmaWNhdGUsXG4gICAgICBtZXNzYWdlOiAnQ2VydGlmaWNhdGUgaXMgdmFsaWQnLFxuICAgICAgdmVyaWZpZWRBdDogbm93LFxuICAgICAgZGlnaXRhbFNpZ25hdHVyZVZlcmlmaWNhdGlvbjoge1xuICAgICAgICBpc1ZhbGlkOiBzaWduYXR1cmVWYWxpZCxcbiAgICAgICAgbWVzc2FnZTogc2lnbmF0dXJlTWVzc2FnZVxuICAgIH0sXG4gICAgICBibG9ja2NoYWluVmVyaWZpY2F0aW9uOiBibG9ja2NoYWluVmVyaWZpY2F0aW9uUmVzdWx0XG4gIH07XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHZlcmlmeWluZyBjZXJ0aWZpY2F0ZTonLCBlcnJvcik7XG5cbiAgICAvLyBMb2cgZXJyb3IgdmVyaWZpY2F0aW9uIGF0dGVtcHRcbiAgICB0cnkge1xuICAgICAgYXdhaXQgbG9nVmVyaWZpY2F0aW9uQXR0ZW1wdCh7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgdmVyaWZpY2F0aW9uQ29kZSxcbiAgICAgICAgc3RhdHVzOiAnaW52YWxpZCcsXG4gICAgICAgIHZlcmlmaWVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdmVyaWZpZWRJcDogaXBBZGRyZXNzLFxuICAgICAgICB1c2VyQWdlbnRcbiAgICAgICAgLy8gZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikgLy8gUmVtb3ZlZCBhcyBpdCdzIG5vdCBpbiBDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbiB0eXBlXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGxvZ0Vycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2dnaW5nIHZlcmlmaWNhdGlvbiBhdHRlbXB0OicsIGxvZ0Vycm9yKTtcbiAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgbWVzc2FnZTogJ0Vycm9yIHZlcmlmeWluZyBjZXJ0aWZpY2F0ZScsXG4gICAgICB2ZXJpZmllZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfTtcbn1cbn07XG5cbi8qKlxuICogTG9nIGEgY2VydGlmaWNhdGUgdmVyaWZpY2F0aW9uIGF0dGVtcHRcbiAqL1xuY29uc3QgbG9nVmVyaWZpY2F0aW9uQXR0ZW1wdCA9IGFzeW5jICh2ZXJpZmljYXRpb246IFBhcnRpYWw8Q2VydGlmaWNhdGVWZXJpZmljYXRpb24+KTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlVmVyaWZpY2F0aW9ucycsIHZlcmlmaWNhdGlvbi5pZCB8fCB1dWlkdjQoKSk7XG5cbiAgICBhd2FpdCBzZXREb2ModmVyaWZpY2F0aW9uUmVmLCB7XG4gICAgICAuLi52ZXJpZmljYXRpb24sXG4gICAgICB2ZXJpZmllZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgfSk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvZ2dpbmcgdmVyaWZpY2F0aW9uIGF0dGVtcHQ6JywgZXJyb3IpO1xufVxufTtcblxuLyoqXG4gKiBSZXZva2UgYSBjZXJ0aWZpY2F0ZVxuICovXG5leHBvcnQgY29uc3QgcmV2b2tlQ2VydGlmaWNhdGUgPSBhc3luYyAoY2VydGlmaWNhdGVJZDogc3RyaW5nLCByZWFzb246IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNlcnRpZmljYXRlUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NlcnRpZmljYXRlcycsIGNlcnRpZmljYXRlSWQpO1xuICAgIGNvbnN0IGNlcnRpZmljYXRlRG9jID0gYXdhaXQgZ2V0RG9jKGNlcnRpZmljYXRlUmVmKTtcblxuICAgIGlmICghY2VydGlmaWNhdGVEb2MuZXhpc3RzKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2VydGlmaWNhdGUgbm90IGZvdW5kJyk7XG4gIH1cblxuICAgIC8vIFVwZGF0ZSBjZXJ0aWZpY2F0ZSBzdGF0dXNcbiAgICBhd2FpdCB1cGRhdGVEb2MoY2VydGlmaWNhdGVSZWYsIHtcbiAgICAgIHN0YXR1czogJ3Jldm9rZWQnLFxuICAgICAgcmV2b2NhdGlvblJlYXNvbjogcmVhc29uLFxuICAgICAgcmV2b2NhdGlvbkRhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcbiAgfSk7XG5cbiAgICAvLyBMb2cgcmV2b2NhdGlvblxuICAgIGNvbnN0IHJldm9jYXRpb25JZCA9IHV1aWR2NCgpO1xuICAgIGNvbnN0IHJldm9jYXRpb25SZWYgPSBkb2MoZmlyZXN0b3JlLCAnY2VydGlmaWNhdGVSZXZvY2F0aW9ucycsIHJldm9jYXRpb25JZCk7XG5cbiAgICBhd2FpdCBzZXREb2MocmV2b2NhdGlvblJlZiwge1xuICAgICAgaWQ6IHJldm9jYXRpb25JZCxcbiAgICAgIGNlcnRpZmljYXRlSWQsXG4gICAgICByZWFzb24sXG4gICAgICByZXZva2VkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgcmV2b2tlZEJ5OiAnYWRtaW4nLCAvLyBJbiBhIHJlYWwgYXBwLCB0aGlzIHdvdWxkIGJlIHRoZSBjdXJyZW50IHVzZXIncyBJRFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICB9KTtcblxuICAgIHJldHVybiB0cnVlO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXZva2luZyBjZXJ0aWZpY2F0ZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xufVxufTtcblxuLyoqXG4gKiBHZW5lcmF0ZSBhIFFSIGNvZGUgZm9yIGEgdmVyaWZpY2F0aW9uIFVSTFxuICovXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVRUkNvZGUgPSBhc3luYyAodXJsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xuICB0cnkge1xuICAgIC8vIEdlbmVyYXRlIFFSIGNvZGUgYXMgZGF0YSBVUkxcbiAgICBjb25zdCBxckRhdGFVcmwgPSBhd2FpdCBRUkNvZGUudG9EYXRhVVJMKHVybCwge1xuICAgICAgZXJyb3JDb3JyZWN0aW9uTGV2ZWw6ICdIJyxcbiAgICAgIG1hcmdpbjogMSxcbiAgICAgIHdpZHRoOiAyMDAsXG4gICAgICBjb2xvcjoge1xuICAgICAgICBkYXJrOiAnIzAwMDAwMCcsXG4gICAgICAgIGxpZ2h0OiAnI2ZmZmZmZidcbiAgICB9XG4gIH0pO1xuXG4gICAgcmV0dXJuIHFyRGF0YVVybDtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2VuZXJhdGluZyBRUiBjb2RlOicsIGVycm9yKTtcbiAgICByZXR1cm4gJyc7XG59XG59O1xuIl0sIm5hbWVzIjpbImNvbGxlY3Rpb24iLCJkb2MiLCJnZXREb2MiLCJnZXREb2NzIiwic2V0RG9jIiwidXBkYXRlRG9jIiwicXVlcnkiLCJ3aGVyZSIsIm9yZGVyQnkiLCJsaW1pdCIsInNlcnZlclRpbWVzdGFtcCIsImluY3JlbWVudCIsInJlZiIsInVwbG9hZFN0cmluZyIsImdldERvd25sb2FkVVJMIiwiZmlyZXN0b3JlIiwic3RvcmFnZSIsInY0IiwidXVpZHY0IiwiZ2VuZXJhdGVQREYiLCJRUkNvZGUiLCJyZWdpc3RlckNlcnRpZmljYXRlT25CbG9ja2NoYWluIiwidmVyaWZ5QmxvY2tjaGFpbkNlcnRpZmljYXRlIiwiZ2VuZXJhdGVTaWduYXR1cmUiLCJ2ZXJpZnlTaWduYXR1cmUiLCJnZXRDZXJ0aWZpY2F0ZVRlbXBsYXRlIiwidGVtcGxhdGVJZCIsInRlbXBsYXRlUmVmIiwidGVtcGxhdGVTbmFwc2hvdCIsImV4aXN0cyIsImlkIiwiZGF0YSIsImVycm9yIiwiY29uc29sZSIsImdldENlcnRpZmljYXRlVGVtcGxhdGVzIiwidGVtcGxhdGVzUmVmIiwidGVtcGxhdGVzUXVlcnkiLCJ0ZW1wbGF0ZXNTbmFwc2hvdCIsInRlbXBsYXRlcyIsImZvckVhY2giLCJwdXNoIiwiZ2V0RGVmYXVsdENlcnRpZmljYXRlVGVtcGxhdGUiLCJlbXB0eSIsInRlbXBsYXRlRG9jIiwiZG9jcyIsImNyZWF0ZUNlcnRpZmljYXRlVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsIm5vdyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm5ld1RlbXBsYXRlIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwidXBkYXRlQ2VydGlmaWNhdGVUZW1wbGF0ZSIsImdlbmVyYXRlQ2VydGlmaWNhdGUiLCJvcHRpb25zIiwidXNlcklkIiwiY291cnNlSWQiLCJ2YWx1ZXMiLCJleHBpcnlEYXRlIiwibWV0YWRhdGEiLCJpbnB1dE1ldGFkYXRhIiwiaXNQdWJsaWMiLCJjb21wbGV0aW9uRGF0ZSIsIkVycm9yIiwidXNlclJlZiIsInVzZXJTbmFwc2hvdCIsInVzZXJEYXRhIiwiY291cnNlUmVmIiwiY291cnNlU25hcHNob3QiLCJjb3Vyc2VEYXRhIiwiY2VydGlmaWNhdGVJZCIsInZlcmlmaWNhdGlvbkNvZGUiLCJ2ZXJpZmljYXRpb25VcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU0lURV9VUkwiLCJxckNvZGVEYXRhVXJsIiwiZ2VuZXJhdGVRUkNvZGUiLCJtZXJnZWRWYWx1ZXMiLCJkZWZhdWx0VmFsdWVzIiwic3R1ZGVudE5hbWUiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwiY291cnNlTmFtZSIsInRpdGxlIiwiaXNzdWVEYXRlIiwicXJDb2RlIiwiY2VydGlmaWNhdGVIdG1sIiwiY29udGVudCIsIk9iamVjdCIsImVudHJpZXMiLCJrZXkiLCJ2YWx1ZSIsInJlcGxhY2UiLCJSZWdFeHAiLCJwZGZCdWZmZXIiLCJmb3JtYXQiLCJsYW5kc2NhcGUiLCJtYXJnaW4iLCJ0b3AiLCJib3R0b20iLCJsZWZ0IiwicmlnaHQiLCJwZGZSZWYiLCJ0b1N0cmluZyIsImRvd25sb2FkVXJsIiwiY2VydGlmaWNhdGVEYXRhIiwidXNlck5hbWUiLCJ1bmRlZmluZWQiLCJzdGF0dXMiLCJxckNvZGVVcmwiLCJwZGZVcmwiLCJ0aHVtYm5haWxVcmwiLCJibG9ja2NoYWluVmVyaWZpZWQiLCJkaWdpdGFsU2lnbmF0dXJlIiwic2lnbmF0dXJlRGF0YSIsImNlcnRpZmljYXRlIiwiY2VydGlmaWNhdGVSZWYiLCJwcm9ncmVzc1JlZiIsImNlcnRpZmljYXRlSXNzdWVEYXRlIiwibGFzdFVwZGF0ZWQiLCJzdGF0c1JlZiIsInN0YXRzU25hcHNob3QiLCJ0b3RhbElzc3VlZCIsImxhc3RJc3N1ZWQiLCJjb3Vyc2VzVXNlZCIsImJsb2NrY2hhaW5WZXJpZmljYXRpb24iLCJsb2ciLCJ0cmFuc2FjdGlvbklkIiwiYmxvY2tjaGFpbkVycm9yIiwiZ2V0Q2VydGlmaWNhdGUiLCJjZXJ0aWZpY2F0ZVNuYXBzaG90IiwiZ2V0VXNlckNlcnRpZmljYXRlcyIsImNlcnRpZmljYXRlc1JlZiIsImNlcnRpZmljYXRlc1F1ZXJ5IiwiY2VydGlmaWNhdGVzU25hcHNob3QiLCJjZXJ0aWZpY2F0ZXMiLCJnZXRDb3Vyc2VDZXJ0aWZpY2F0ZXMiLCJzZWFyY2hDZXJ0aWZpY2F0ZXMiLCJmaWx0ZXJzIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInZlcmlmeUNlcnRpZmljYXRlIiwiaXBBZGRyZXNzIiwidXNlckFnZW50IiwidmVyaWZpY2F0aW9uSWQiLCJsb2dWZXJpZmljYXRpb25BdHRlbXB0IiwidmVyaWZpZWRBdCIsInZlcmlmaWVkSXAiLCJpc1ZhbGlkIiwibWVzc2FnZSIsImNlcnRpZmljYXRlRG9jIiwic2lnbmF0dXJlVmFsaWQiLCJzaWduYXR1cmVNZXNzYWdlIiwiYmxvY2tjaGFpblZlcmlmaWNhdGlvblJlc3VsdCIsImJsb2NrY2hhaW5SZXN1bHQiLCJ2ZXJpZmljYXRpb24iLCJibG9ja2NoYWluUHJvdmlkZXIiLCJibG9ja2NoYWluTmV0d29yayIsImRpZ2l0YWxTaWduYXR1cmVWZXJpZmljYXRpb24iLCJsb2dFcnJvciIsInZlcmlmaWNhdGlvblJlZiIsInRpbWVzdGFtcCIsImdldFRpbWUiLCJyZXZva2VDZXJ0aWZpY2F0ZSIsInJlYXNvbiIsInJldm9jYXRpb25SZWFzb24iLCJyZXZvY2F0aW9uRGF0ZSIsInJldm9jYXRpb25JZCIsInJldm9jYXRpb25SZWYiLCJyZXZva2VkQXQiLCJyZXZva2VkQnkiLCJ1cmwiLCJxckRhdGFVcmwiLCJ0b0RhdGFVUkwiLCJlcnJvckNvcnJlY3Rpb25MZXZlbCIsIndpZHRoIiwiY29sb3IiLCJkYXJrIiwibGlnaHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/services/certificateService.ts\n");

/***/ }),

/***/ "./src/services/courseProgressService.ts":
/*!***********************************************!*\
  !*** ./src/services/courseProgressService.ts ***!
  \***********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addLessonBookmark: () => (/* binding */ addLessonBookmark),\n/* harmony export */   addLessonNote: () => (/* binding */ addLessonNote),\n/* harmony export */   calculateCourseProgress: () => (/* binding */ calculateCourseProgress),\n/* harmony export */   checkInactiveEnrollments: () => (/* binding */ checkInactiveEnrollments),\n/* harmony export */   getCourseProgress: () => (/* binding */ getCourseProgress),\n/* harmony export */   getCoursesInProgress: () => (/* binding */ getCoursesInProgress),\n/* harmony export */   getLessonProgress: () => (/* binding */ getLessonProgress),\n/* harmony export */   initializeCourseProgress: () => (/* binding */ initializeCourseProgress),\n/* harmony export */   markCourseComplete: () => (/* binding */ markCourseComplete),\n/* harmony export */   markLessonCompleted: () => (/* binding */ markLessonCompleted),\n/* harmony export */   markModuleComplete: () => (/* binding */ markModuleComplete),\n/* harmony export */   resetCourseProgress: () => (/* binding */ resetCourseProgress),\n/* harmony export */   syncCourseProgress: () => (/* binding */ syncCourseProgress),\n/* harmony export */   updateLessonProgress: () => (/* binding */ updateLessonProgress),\n/* harmony export */   updateLessonTracking: () => (/* binding */ updateLessonTracking),\n/* harmony export */   updateQuizScore: () => (/* binding */ updateQuizScore)\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./firebase */ \"./src/services/firebase.ts\");\n/* harmony import */ var _reminderService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./reminderService */ \"./src/services/reminderService.ts\");\n/* harmony import */ var _certificateService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./certificateService */ \"./src/services/certificateService.ts\");\n/* harmony import */ var _utils_queryClient__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/utils/queryClient */ \"./src/utils/queryClient.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__, _reminderService__WEBPACK_IMPORTED_MODULE_2__, _certificateService__WEBPACK_IMPORTED_MODULE_3__, _utils_queryClient__WEBPACK_IMPORTED_MODULE_4__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__, _reminderService__WEBPACK_IMPORTED_MODULE_2__, _certificateService__WEBPACK_IMPORTED_MODULE_3__, _utils_queryClient__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n// Cache for progress data\nconst progressCache = new Map();\nconst CACHE_TTL = 10 * 60 * 1000; // 10 minutes\nconst writeQueue = [];\nlet writeTimer = null;\nconst BATCH_INTERVAL = 5000; // 5 seconds\nconst MAX_BATCH_SIZE = 500; // Firestore limit is 500 operations per batch\n/**\n * Queue a write operation to be batched\n */ const queueWrite = (docPath, data)=>{\n    // Add to queue\n    writeQueue.push({\n        docPath,\n        data,\n        timestamp: Date.now()\n    });\n    // Start timer if not already running\n    if (!writeTimer) {\n        writeTimer = setTimeout(()=>{\n            void processBatchWrites();\n        }, BATCH_INTERVAL);\n    }\n};\n/**\n * Process queued write operations in batches\n */ const processBatchWrites = async ()=>{\n    // Clear timer\n    writeTimer = null;\n    // If queue is empty, do nothing\n    if (writeQueue.length === 0) {\n        return;\n    }\n    try {\n        // Get operations to process (up to max batch size)\n        const operations = writeQueue.splice(0, MAX_BATCH_SIZE);\n        // Group by timestamp to avoid hotspotting\n        // This creates multiple batches with operations spread across time\n        const timeGroups = {};\n        operations.forEach((op)=>{\n            // Group by 10-second intervals\n            const timeKey = Math.floor(op.timestamp / 10000).toString();\n            if (!timeGroups[timeKey]) {\n                timeGroups[timeKey] = [];\n            }\n            timeGroups[timeKey].push(op);\n        });\n        // Process each time group\n        for(const timeKey in timeGroups){\n            const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore);\n            const groupOps = timeGroups[timeKey];\n            // Add operations to batch\n            groupOps.forEach((op)=>{\n                const docRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, op.docPath);\n                batch.update(docRef, {\n                    ...op.data,\n                    lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n                });\n            });\n            // Commit batch\n            await batch.commit();\n            console.log(`Processed ${groupOps.length} write operations in batch`);\n        }\n    } catch (error) {\n        console.error(\"Error processing batch writes:\", error);\n        // If there was an error, re-queue operations with exponential backoff\n        if (writeQueue.length < 1000) {\n            setTimeout(()=>{\n                void processBatchWrites();\n            }, BATCH_INTERVAL * 2);\n        }\n    }\n    // If there are more operations, schedule another batch\n    if (writeQueue.length > 0) {\n        writeTimer = setTimeout(()=>{\n            void processBatchWrites();\n        }, BATCH_INTERVAL);\n    }\n};\n/**\n * Get course progress for a user\n */ const getCourseProgress = async (userId, courseId)=>{\n    const docId = `${userId}_${courseId}`;\n    const cached = progressCache.get(docId);\n    if (cached && Date.now() - cached.timestamp < CACHE_TTL) {\n        return cached.data;\n    }\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", docId);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            return null;\n        }\n        const progress = progressDoc.data();\n        progressCache.set(docId, {\n            data: progress,\n            timestamp: Date.now()\n        });\n        return progress;\n    } catch (error) {\n        console.error(\"Error getting course progress:\", error);\n        return null;\n    }\n};\n/**\n * Initialize course progress for a user\n */ const initializeCourseProgress = async (userId, courseId, courseName)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (progressDoc.exists()) {\n            return progressDoc.data();\n        }\n        // Get all modules and lessons to initialize progress tracking\n        const modulesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules`);\n        const modulesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(modulesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"published\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"order\", \"asc\"));\n        const modulesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(modulesQuery);\n        const moduleProgress = {};\n        const lessonProgress = {};\n        // Initialize module and lesson progress\n        for (const moduleDoc of modulesSnapshot.docs){\n            const moduleId = moduleDoc.id;\n            // Get lessons for this module\n            const lessonsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons`);\n            const lessonsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(lessonsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"published\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"order\", \"asc\"));\n            const lessonsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(lessonsQuery);\n            // Initialize module progress\n            moduleProgress[moduleId] = {\n                moduleId,\n                startDate: \"\",\n                lastAccessDate: \"\",\n                completed: false,\n                progress: 0,\n                timeSpent: 0,\n                completedLessons: 0,\n                totalLessons: lessonsSnapshot.size\n            };\n            // Initialize lesson progress\n            lessonsSnapshot.forEach((lessonDoc)=>{\n                const lessonId = lessonDoc.id;\n                lessonProgress[`${moduleId}_${lessonId}`] = {\n                    lessonId,\n                    moduleId,\n                    startDate: \"\",\n                    lastAccessDate: \"\",\n                    completed: false,\n                    timeSpent: 0,\n                    progress: 0,\n                    notes: [],\n                    bookmarks: []\n                };\n            });\n        }\n        const newProgress = {\n            courseId,\n            userId,\n            startDate: new Date().toISOString(),\n            lastAccessDate: new Date().toISOString(),\n            completedLessons: [],\n            completedModules: [],\n            quizScores: {},\n            quizAttempts: {},\n            lessonProgress,\n            moduleProgress,\n            overallProgress: 0,\n            completed: false,\n            timeSpent: 0\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(progressRef, newProgress);\n        // Create initial progress reminder\n        await (0,_reminderService__WEBPACK_IMPORTED_MODULE_2__.createProgressReminder)(userId, courseId, courseName, 0);\n        return newProgress;\n    } catch (error) {\n        console.error(\"Error initializing course progress:\", error);\n        throw error;\n    }\n};\n/**\n * Calculate course progress without database operations\n */ const calculateCourseProgress = (completedLessons, totalLessons)=>{\n    const safeTotalLessons = Math.max(1, totalLessons);\n    const overallProgress = Math.floor(completedLessons.length / safeTotalLessons * 100);\n    const completed = completedLessons.length >= safeTotalLessons && safeTotalLessons > 0;\n    return {\n        overallProgress,\n        completed\n    };\n};\n/**\n * Update lesson progress with optimized writes\n */ const updateLessonProgress = async (userId, courseId, courseName, lessonId, completed, totalLessons)=>{\n    try {\n        // Generate document ID\n        const docId = `${userId}_${courseId}`;\n        const docPath = `courseProgress/${docId}`; // This is the path to the document in Firestore\n        // Get current progress (from cache if possible)\n        let progress;\n        const cached = progressCache.get(docId);\n        if (cached && cached.data && Date.now() - cached.timestamp < CACHE_TTL) {\n            progress = cached.data;\n        } else {\n            const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", docId);\n            const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n            if (!progressDoc.exists()) {\n                throw new Error(\"Course progress not found\");\n            }\n            progress = progressDoc.data();\n            progressCache.set(docId, {\n                data: progress,\n                timestamp: Date.now()\n            });\n        }\n        // Check if we need to update\n        const completedLessons = [\n            ...progress.completedLessons || []\n        ];\n        const lessonIndex = completedLessons.indexOf(lessonId);\n        if (completed && lessonIndex >= 0 || !completed && lessonIndex < 0) {\n            // No change needed\n            return progress;\n        }\n        // Update completed lessons\n        if (completed) {\n            completedLessons.push(lessonId);\n        } else {\n            completedLessons.splice(lessonIndex, 1);\n        }\n        // Calculate new progress\n        const { overallProgress, completed: isCompleted } = calculateCourseProgress(completedLessons, totalLessons);\n        // Prepare update data\n        const updateData = {\n            completedLessons,\n            overallProgress,\n            completed: isCompleted,\n            lastAccessDate: new Date().toISOString()\n        };\n        // Add completion date if newly completed\n        if (isCompleted && !progress.completed) {\n            updateData.completedDate = new Date().toISOString();\n        } else if (!isCompleted && progress.completed) {\n            // Use deleteField() to properly remove the field from Firestore\n            updateData.completedDate = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteField)();\n        }\n        // Queue the write instead of immediate update\n        queueWrite(docPath, updateData);\n        // Separate completedDate from updateData and resolve its type for the cache/return object\n        const { completedDate: rawCompletedDateFromUpdateData, ...restOfUpdateData } = updateData;\n        const resolvedCompletedDateForCache = rawCompletedDateFromUpdateData === (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteField)() ? undefined : typeof rawCompletedDateFromUpdateData === \"string\" ? rawCompletedDateFromUpdateData : undefined;\n        const updatedProgress = {\n            ...progress,\n            ...restOfUpdateData,\n            completedDate: resolvedCompletedDateForCache\n        };\n        progressCache.set(docId, {\n            data: updatedProgress,\n            timestamp: Date.now()\n        });\n        // Return updated progress\n        return updatedProgress;\n    } catch (error) {\n        console.error(\"Error updating lesson progress:\", error);\n        throw error;\n    }\n};\n/**\n * Mark a module as complete\n */ const markModuleComplete = async (userId, courseId, moduleId)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            throw new Error(\"Course progress not found\");\n        }\n        const progress = progressDoc.data();\n        const completedModules = [\n            ...progress.completedModules\n        ];\n        if (!completedModules.includes(moduleId)) {\n            completedModules.push(moduleId);\n        }\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n            completedModules,\n            lastAccessDate: new Date().toISOString(),\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            ...progress,\n            completedModules,\n            lastAccessDate: new Date().toISOString()\n        };\n    } catch (error) {\n        console.error(\"Error marking module complete:\", error);\n        throw error;\n    }\n};\n/**\n * Mark a course as complete\n */ const markCourseComplete = async (userId, courseId, courseName)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            throw new Error(\"Course progress not found\");\n        }\n        const progress = progressDoc.data();\n        // Get all published lessons in the course to verify completion\n        const modulesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules`);\n        const modulesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(modulesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"published\"));\n        const modulesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(modulesQuery);\n        let totalLessons = 0;\n        const moduleIds = [];\n        // Count total lessons and collect module IDs\n        for (const moduleDoc of modulesSnapshot.docs){\n            const moduleId = moduleDoc.id;\n            moduleIds.push(moduleId);\n            const lessonsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons`);\n            const lessonsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(lessonsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"published\"));\n            const lessonsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(lessonsQuery);\n            totalLessons += lessonsSnapshot.size;\n        }\n        // Calculate actual progress based on completed lessons\n        const completedLessons = progress.completedLessons.length;\n        const actualProgress = totalLessons > 0 ? Math.round(completedLessons / totalLessons * 100) : 0;\n        // Only mark as complete if all lessons are actually completed\n        const isActuallyComplete = totalLessons > 0 && completedLessons >= totalLessons;\n        const completionDate = new Date().toISOString();\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n            completed: isActuallyComplete,\n            completionDate: isActuallyComplete ? completionDate : null,\n            overallProgress: actualProgress,\n            lastAccessDate: completionDate,\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Create completion reminder\n        await (0,_reminderService__WEBPACK_IMPORTED_MODULE_2__.createCompletionReminder)(userId, courseId, courseName);\n        // Issue certificate if course is configured to issue certificates\n        await issueCertificateForCourse(userId, courseId, courseName);\n        return {\n            ...progress,\n            completed: true,\n            completionDate,\n            overallProgress: 100,\n            lastAccessDate: completionDate\n        };\n    } catch (error) {\n        console.error(\"Error marking course complete:\", error);\n        throw error;\n    }\n};\n/**\n * Issue a certificate for a completed course\n */ const issueCertificateForCourse = async (userId, courseId, courseName)=>{\n    try {\n        // Get course details to check if certificates are enabled\n        const courseRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courses\", courseId);\n        const courseDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(courseRef);\n        if (!courseDoc.exists()) {\n            console.error(\"Course not found for certificate issuance\");\n            return;\n        }\n        const courseData = courseDoc.data();\n        // Check if certificates are enabled for this course\n        if (!courseData.certificatesEnabled) {\n            console.log(\"Certificates not enabled for this course\");\n            return;\n        }\n        // Get user details\n        const userRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"users\", userId);\n        const userDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(userRef);\n        if (!userDoc.exists()) {\n            console.error(\"User not found for certificate issuance\");\n            return;\n        }\n        const userData = userDoc.data();\n        // Get certificate template (use course-specific template or default)\n        const templateId = courseData.certificateTemplateId || null;\n        let template = null;\n        if (templateId) {\n            // Use course-specific template\n            const templateRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"certificateTemplates\", templateId);\n            const templateDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(templateRef);\n            if (templateDoc.exists()) {\n                template = templateDoc.data();\n            }\n        }\n        // If no template found, use default template\n        if (!template) {\n            const defaultTemplate = await (0,_certificateService__WEBPACK_IMPORTED_MODULE_3__.getDefaultCertificateTemplate)();\n            if (!defaultTemplate) {\n                console.error(\"No certificate template found\");\n                return;\n            }\n            template = defaultTemplate;\n        }\n        // Generate certificate\n        const certificate = await (0,_certificateService__WEBPACK_IMPORTED_MODULE_3__.generateCertificate)({\n            templateId: template.id,\n            userId,\n            courseId,\n            values: {\n                studentName: userData.displayName || userData.email || \"Student\",\n                courseName: courseName || courseData.title || \"Course\",\n                completionDate: new Date().toISOString(),\n                issuerName: courseData.instructorName || \"Instructor\",\n                issuerTitle: courseData.instructorTitle || \"Course Instructor\"\n            },\n            isPublic: courseData.publicCertificates === true\n        });\n        if (certificate) {\n            console.log(`Certificate ${certificate.id} issued successfully for course ${courseId} to user ${userId}`);\n        }\n    } catch (error) {\n        console.error(\"Error issuing certificate:\", error);\n    }\n};\n/**\n * Check for inactive enrollments and create reminders\n */ const checkInactiveEnrollments = async ()=>{\n    try {\n        const now = new Date();\n        const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n        const sevenDaysAgoStr = sevenDaysAgo.toISOString();\n        // Query for progress records that haven't been accessed in a while\n        const progressQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"lastAccessDate\", \"<=\", sevenDaysAgoStr), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"completed\", \"==\", false));\n        const progressSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(progressQuery);\n        let count = 0;\n        // Process each inactive enrollment\n        for (const progressDoc of progressSnapshot.docs){\n            const progress = progressDoc.data();\n            // Get course name\n            const courseRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courses\", progress.courseId);\n            const courseDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(courseRef);\n            if (!courseDoc.exists()) {\n                continue;\n            }\n            const courseData = courseDoc.data();\n            const courseName = courseData.title || \"Unknown Course\";\n            // Calculate days since last access\n            const lastAccessDate = new Date(progress.lastAccessDate);\n            const daysSinceLastAccess = Math.floor((now.getTime() - lastAccessDate.getTime()) / (24 * 60 * 60 * 1000));\n            // Create inactivity reminder\n            await (0,_reminderService__WEBPACK_IMPORTED_MODULE_2__.createInactivityReminder)(progress.userId, progress.courseId, courseName, daysSinceLastAccess);\n            count++;\n        }\n        return count;\n    } catch (error) {\n        console.error(\"Error checking inactive enrollments:\", error);\n        return 0;\n    }\n};\n/**\n * Update quiz score for a lesson\n */ const updateQuizScore = async (userId, courseId, lessonId, score)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            throw new Error(\"Course progress not found\");\n        }\n        const progress = progressDoc.data();\n        const quizScores = {\n            ...progress.quizScores,\n            [lessonId]: score\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n            quizScores,\n            lastAccessDate: new Date().toISOString(),\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            ...progress,\n            quizScores,\n            lastAccessDate: new Date().toISOString()\n        };\n    } catch (error) {\n        console.error(\"Error updating quiz score:\", error);\n        throw error;\n    }\n};\n/**\n * Mark a lesson as completed\n */ \nconst markLessonCompleted = async (userId, courseId, moduleId, lessonId, timeSpent = 0, position = 0)=>{\n    const queryClient = (0,_utils_queryClient__WEBPACK_IMPORTED_MODULE_4__.getQueryClient)();\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            // Create progress if it doesn't exist\n            await initializeCourseProgress(userId, courseId, \"Unknown Course\");\n            return;\n        }\n        const progress = progressDoc.data();\n        const lessonKey = `${moduleId}_${lessonId}`;\n        const now = new Date().toISOString();\n        // Update lesson progress\n        const lessonProgress = progress.lessonProgress || {};\n        const currentLessonProgress = lessonProgress[lessonKey] || {\n            lessonId,\n            moduleId,\n            startDate: now,\n            lastAccessDate: now,\n            completed: false,\n            timeSpent: 0,\n            progress: 0,\n            notes: [],\n            bookmarks: []\n        };\n        // Update lesson progress\n        lessonProgress[lessonKey] = {\n            ...currentLessonProgress,\n            completed: true,\n            completedDate: now,\n            lastAccessDate: now,\n            timeSpent: currentLessonProgress.timeSpent + timeSpent,\n            progress: 100,\n            position: position || currentLessonProgress.position\n        };\n        // Update module progress\n        const moduleProgress = progress.moduleProgress || {};\n        const currentModuleProgress = moduleProgress[moduleId] || {\n            moduleId,\n            startDate: now,\n            lastAccessDate: now,\n            completed: false,\n            progress: 0,\n            timeSpent: 0,\n            completedLessons: 0,\n            totalLessons: 0\n        };\n        // Count completed lessons in this module\n        const completedLessonsInModule = Object.keys(lessonProgress).filter((key)=>key.startsWith(`${moduleId}_`) && lessonProgress[key].completed).length;\n        // Update module progress\n        moduleProgress[moduleId] = {\n            ...currentModuleProgress,\n            lastAccessDate: now,\n            timeSpent: (currentModuleProgress.timeSpent || 0) + timeSpent,\n            completedLessons: completedLessonsInModule,\n            progress: (currentModuleProgress.totalLessons || 0) > 0 ? Math.round(completedLessonsInModule / (currentModuleProgress.totalLessons || 1) * 100) : 0\n        };\n        // Update the progress document\n        const updatedProgress = {\n            completedLessons: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.arrayUnion)(lessonKey),\n            lastAccessDate: now,\n            timeSpent: progress.timeSpent + timeSpent,\n            lessonProgress,\n            moduleProgress,\n            lastPosition: {\n                moduleId,\n                lessonId,\n                position\n            },\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, updatedProgress);\n        // Check if all lessons in the module are completed\n        await checkModuleCompletion(userId, courseId, moduleId);\n        // Update overall progress\n        await updateOverallProgress(userId, courseId);\n        // Invalidate relevant queries to trigger UI updates\n        queryClient.invalidateQueries({\n            queryKey: [\n                \"courseProgress\",\n                userId,\n                courseId\n            ]\n        });\n        queryClient.invalidateQueries({\n            queryKey: [\n                \"enrolledCoursesWithProgress\",\n                userId\n            ]\n        });\n    } catch (error) {\n        console.error(\"Error marking lesson as completed:\", error);\n        throw error;\n    }\n};\n/**\n * Update lesson progress without marking it as completed\n */ const updateLessonTracking = async (userId, courseId, moduleId, lessonId, timeSpent = 0, position = 0, progressPercentage = 0)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            // Create progress if it doesn't exist\n            await initializeCourseProgress(userId, courseId, \"Unknown Course\");\n            return;\n        }\n        const progress = progressDoc.data();\n        const lessonKey = `${moduleId}_${lessonId}`;\n        const now = new Date().toISOString();\n        // Update lesson progress\n        const lessonProgress = progress.lessonProgress || {};\n        const currentLessonProgress = lessonProgress[lessonKey] || {\n            lessonId,\n            moduleId,\n            startDate: now,\n            lastAccessDate: now,\n            completed: false,\n            timeSpent: 0,\n            progress: 0,\n            notes: [],\n            bookmarks: []\n        };\n        // If this is the first time accessing this lesson, set the start date\n        if (!currentLessonProgress.startDate) {\n            currentLessonProgress.startDate = now;\n        }\n        // Update lesson progress\n        lessonProgress[lessonKey] = {\n            ...currentLessonProgress,\n            lastAccessDate: now,\n            timeSpent: currentLessonProgress.timeSpent + timeSpent,\n            progress: Math.max(progressPercentage, currentLessonProgress.progress || 0),\n            position: position\n        };\n        // Update module progress\n        const moduleProgress = progress.moduleProgress || {};\n        const currentModuleProgress = moduleProgress[moduleId] || {\n            moduleId,\n            startDate: now,\n            lastAccessDate: now,\n            completed: false,\n            progress: 0,\n            timeSpent: 0,\n            completedLessons: 0,\n            totalLessons: 0\n        };\n        // If this is the first time accessing this module, set the start date\n        if (!currentModuleProgress.startDate) {\n            currentModuleProgress.startDate = now;\n        }\n        // Count completed lessons in this module\n        const completedLessonsInModule = Object.keys(lessonProgress).filter((key)=>key.startsWith(`${moduleId}_`) && lessonProgress[key].completed).length;\n        // Calculate average progress for incomplete lessons\n        const incompleteLessons = Object.keys(lessonProgress).filter((key)=>key.startsWith(`${moduleId}_`) && !lessonProgress[key].completed);\n        const incompleteProgress = incompleteLessons.reduce((sum, key)=>sum + (lessonProgress[key].progress || 0), 0);\n        const averageIncompleteProgress = incompleteLessons.length > 0 ? incompleteProgress / incompleteLessons.length : 0;\n        // Calculate overall module progress\n        const totalLessons = currentModuleProgress.totalLessons || 1;\n        const moduleProgressPercentage = (completedLessonsInModule * 100 + // Completed lessons count as 100%\n        (totalLessons - completedLessonsInModule) * averageIncompleteProgress / 100 // Add partial progress\n        ) / totalLessons;\n        // Update module progress\n        moduleProgress[moduleId] = {\n            ...currentModuleProgress,\n            lastAccessDate: now,\n            timeSpent: (currentModuleProgress.timeSpent || 0) + timeSpent,\n            completedLessons: completedLessonsInModule,\n            progress: Math.round(moduleProgressPercentage)\n        };\n        // Update the progress document\n        const updatedProgress = {\n            lastAccessDate: now,\n            timeSpent: progress.timeSpent + timeSpent,\n            lessonProgress,\n            moduleProgress,\n            lastPosition: {\n                moduleId,\n                lessonId,\n                position\n            },\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, updatedProgress);\n        // Update overall progress without marking anything as completed\n        await updateOverallProgressCalculation(userId, courseId);\n    } catch (error) {\n        console.error(\"Error updating lesson tracking:\", error);\n    }\n};\n/**\n * Update overall progress calculation without marking anything as completed\n */ const updateOverallProgressCalculation = async (userId, courseId)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            return;\n        }\n        const progress = progressDoc.data();\n        // Calculate overall progress based on module progress\n        const moduleProgressValues = Object.values(progress.moduleProgress || {});\n        if (moduleProgressValues.length === 0) {\n            return;\n        }\n        const overallProgress = Math.round(moduleProgressValues.reduce((sum, module)=>sum + module.progress, 0) / moduleProgressValues.length);\n        // Update progress\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n            overallProgress,\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"Error updating overall progress calculation:\", error);\n    }\n};\n/**\n * Add a bookmark to a lesson\n */ const addLessonBookmark = async (userId, courseId, moduleId, lessonId, position, note)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            // Create progress if it doesn't exist\n            await initializeCourseProgress(userId, courseId, \"Unknown Course\");\n            return;\n        }\n        const progress = progressDoc.data();\n        const lessonKey = `${moduleId}_${lessonId}`;\n        const now = new Date().toISOString();\n        // Update lesson progress\n        const lessonProgress = progress.lessonProgress || {};\n        const currentLessonProgress = lessonProgress[lessonKey] || {\n            lessonId,\n            moduleId,\n            startDate: now,\n            lastAccessDate: now,\n            completed: false,\n            timeSpent: 0,\n            progress: 0,\n            notes: [],\n            bookmarks: []\n        };\n        // Add bookmark\n        const bookmarks = currentLessonProgress.bookmarks || [];\n        const newBookmark = {\n            id: `bookmark_${Date.now()}`,\n            position,\n            note,\n            createdAt: now\n        };\n        // Update lesson progress\n        lessonProgress[lessonKey] = {\n            ...currentLessonProgress,\n            lastAccessDate: now,\n            bookmarks: [\n                ...bookmarks,\n                newBookmark\n            ]\n        };\n        // Update the progress document\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n            lessonProgress,\n            lastAccessDate: now,\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"Error adding lesson bookmark:\", error);\n    }\n};\n/**\n * Add a note to a lesson\n */ const addLessonNote = async (userId, courseId, moduleId, lessonId, note)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            // Create progress if it doesn't exist\n            await initializeCourseProgress(userId, courseId, \"Unknown Course\");\n            return;\n        }\n        const progress = progressDoc.data();\n        const lessonKey = `${moduleId}_${lessonId}`;\n        const now = new Date().toISOString();\n        // Update lesson progress\n        const lessonProgress = progress.lessonProgress || {};\n        const currentLessonProgress = lessonProgress[lessonKey] || {\n            lessonId,\n            moduleId,\n            startDate: now,\n            lastAccessDate: now,\n            completed: false,\n            timeSpent: 0,\n            progress: 0,\n            notes: [],\n            bookmarks: []\n        };\n        // Add note\n        const notes = currentLessonProgress.notes || [];\n        // Update lesson progress\n        lessonProgress[lessonKey] = {\n            ...currentLessonProgress,\n            lastAccessDate: now,\n            notes: [\n                ...notes,\n                note\n            ]\n        };\n        // Update the progress document\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n            lessonProgress,\n            lastAccessDate: now,\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"Error adding lesson note:\", error);\n    }\n};\n/**\n * Check if all lessons in a module are completed\n */ const checkModuleCompletion = async (userId, courseId, moduleId)=>{\n    try {\n        // Get the module data\n        const moduleRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}`);\n        const moduleSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(moduleRef);\n        if (!moduleSnapshot.exists()) {\n            return;\n        }\n        // Get module data\n        // const moduleData = moduleSnapshot.data() as Module; // moduleData is not used\n        // Get all lessons for the module\n        const lessonsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons`);\n        const lessonsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(lessonsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"published\"));\n        const lessonsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(lessonsQuery);\n        const lessonIds = lessonsSnapshot.docs.map((doc)=>doc.id);\n        // Get the user's progress\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `users/${userId}/courseProgress/${courseId}`);\n        const progressSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressSnapshot.exists()) {\n            return;\n        }\n        const progressData = progressSnapshot.data();\n        // Check if all lessons are completed\n        const allLessonsCompleted = lessonIds.every((lessonId)=>progressData.completedLessons.includes(`${moduleId}_${lessonId}`));\n        // If all lessons are completed and the module is not already marked as completed\n        if (allLessonsCompleted && !progressData.completedModules.includes(moduleId)) {\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, {\n                completedModules: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.arrayUnion)(moduleId),\n                lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n        }\n    } catch (error) {\n        console.error(\"Error checking module completion:\", error);\n    }\n};\n/**\n * Update overall course progress\n */ const updateOverallProgress = async (userId, courseId)=>{\n    try {\n        // Get all published lessons in the course\n        const modulesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules`);\n        const modulesQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(modulesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"published\"));\n        const modulesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(modulesQuery);\n        let totalLessons = 0;\n        const moduleIds = [];\n        // Count total lessons\n        for (const moduleDoc of modulesSnapshot.docs){\n            moduleIds.push(moduleDoc.id);\n            const lessonsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleDoc.id}/lessons`);\n            const lessonsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(lessonsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"published\"));\n            const lessonsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(lessonsQuery);\n            totalLessons += lessonsSnapshot.size;\n        }\n        // Get user progress\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `users/${userId}/courseProgress/${courseId}`);\n        const progressSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressSnapshot.exists()) {\n            return;\n        }\n        const progressData = progressSnapshot.data();\n        const completedLessons = progressData.completedLessons.length;\n        // Calculate progress percentage\n        const overallProgress = totalLessons > 0 ? Math.round(completedLessons / totalLessons * 100) : 0;\n        // Check if all modules are completed\n        const allModulesCompleted = moduleIds.every((moduleId)=>progressData.completedModules.includes(moduleId));\n        // Data for the courseProgress document (users/{userId}/courseProgress/{courseId})\n        const courseProgressUpdateData = {\n            overallProgress,\n            completed: allModulesCompleted && overallProgress === 100,\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(progressRef, courseProgressUpdateData);\n        // Also update the corresponding enrollment document in users/{userId}/enrollments/{courseId}\n        try {\n            const enrollmentDocRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `users/${userId}/enrollments/${courseId}`);\n            const enrollmentSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(enrollmentDocRef);\n            let currentEnrollmentStatus = \"active\"; // Default to 'active'\n            if (enrollmentSnap.exists()) {\n                const enrollmentData = enrollmentSnap.data();\n                currentEnrollmentStatus = enrollmentData.status || \"active\";\n            }\n            // Update the main enrollment document with the same progress.\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(enrollmentDocRef, {\n                progress: overallProgress,\n                status: allModulesCompleted && overallProgress === 100 ? \"completed\" : currentEnrollmentStatus,\n                lastAccessedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n        } catch (enrollmentError) {\n            console.error(`Error updating enrollment document for user ${userId}, course ${courseId}:`, enrollmentError);\n        // Decide if this error should propagate or be handled silently\n        }\n        // If course is completed, update user stats\n        if (allModulesCompleted && overallProgress === 100 && !progressData.completed) {\n            // Update user stats\n            const userStatsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `users/${userId}/stats/courses`);\n            const userStatsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(userStatsRef);\n            if (userStatsSnapshot.exists()) {\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(userStatsRef, {\n                    completedCourses: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.increment)(1),\n                    lastCompletionDate: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now()\n                });\n            } else {\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(userStatsRef, {\n                    completedCourses: 1,\n                    lastCompletionDate: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now()\n                });\n            }\n        }\n    } catch (error) {\n        console.error(\"Error updating overall progress:\", error);\n    }\n};\n/**\n * Get all courses in progress for a user\n */ const getCoursesInProgress = async (userId)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `users/${userId}/courseProgress`);\n        const progressSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(progressRef);\n        const coursesInProgress = [];\n        progressSnapshot.forEach((doc)=>{\n            coursesInProgress.push({\n                ...doc.data(),\n                courseId: doc.id,\n                userId\n            });\n        });\n        return coursesInProgress;\n    } catch (error) {\n        console.error(\"Error getting courses in progress:\", error);\n        return [];\n    }\n};\n/**\n * Reset course progress for a user\n */ const resetCourseProgress = async (userId, courseId)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `users/${userId}/courseProgress/${courseId}`);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(progressRef, {\n            courseId,\n            userId,\n            startDate: new Date().toISOString(),\n            lastAccessDate: new Date().toISOString(),\n            completedLessons: [],\n            completedModules: [],\n            quizScores: {},\n            overallProgress: 0,\n            completed: false,\n            lastUpdated: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"Error resetting course progress:\", error);\n    }\n};\n/**\n * Get lesson progress for a user\n */ const getLessonProgress = async (userId, courseId, moduleId, lessonId)=>{\n    try {\n        const progressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courseProgress\", `${userId}_${courseId}`);\n        const progressDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(progressRef);\n        if (!progressDoc.exists()) {\n            return {\n                lessonId,\n                moduleId,\n                completed: false,\n                progress: 0,\n                timeSpent: 0,\n                currentPosition: 0,\n                bookmarks: []\n            };\n        }\n        const progressData = progressDoc.data();\n        const lessonKey = `${moduleId}_${lessonId}`;\n        // Return lesson-specific progress data\n        return progressData.lessonProgress && progressData.lessonProgress[lessonKey] ? progressData.lessonProgress[lessonKey] : {\n            lessonId,\n            moduleId,\n            completed: false,\n            progress: 0,\n            timeSpent: 0,\n            currentPosition: 0,\n            bookmarks: []\n        };\n    } catch (error) {\n        console.error(\"Error getting lesson progress:\", error);\n        return {\n            lessonId,\n            moduleId,\n            completed: false,\n            progress: 0,\n            timeSpent: 0,\n            currentPosition: 0,\n            bookmarks: []\n        };\n    }\n};\n/**\n * Sync course progress with optimized writes\n * This should be called less frequently, e.g., when user leaves the course page\n */ const syncCourseProgress = (userId, courseId)=>{\n    const docId = `${userId}_${courseId}`;\n    const cached = progressCache.get(docId);\n    if (!cached) {\n        return; // Nothing to sync\n    }\n    try {\n        // Get the latest progress from cache\n        const progress = cached.data; // We know it's CourseProgress if cached\n        // Queue the write to the main courseProgress document\n        // The original intention might have been to update a separate 'enrollments' collection,\n        // but the current `queueWrite` is for `courseProgress`.\n        // If a separate enrollments collection needs updating, that's a different logic.\n        // For now, this syncs the cached `courseProgress` data.\n        // The `progress` object itself is what's in `courseProgress/${docId}`\n        // So we are essentially re-queueing the latest state from cache.\n        queueWrite(`courseProgress/${docId}`, progress);\n    } catch (error) {\n        console.error(\"Error syncing course progress:\", error);\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2VydmljZXMvY291cnNlUHJvZ3Jlc3NTZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWtCNEI7QUFDVTtBQU1YO0FBQzhEO0FBVXpGLDBCQUEwQjtBQUMxQixNQUFNcUIsZ0JBQWdCLElBQUlDO0FBQzFCLE1BQU1DLFlBQVksS0FBSyxLQUFLLE1BQU0sYUFBYTtBQVEvQyxNQUFNQyxhQUErQixFQUFFO0FBQ3ZDLElBQUlDLGFBQW9DO0FBQ3hDLE1BQU1DLGlCQUFpQixNQUFNLFlBQVk7QUFDekMsTUFBTUMsaUJBQWlCLEtBQUssOENBQThDO0FBRTFFOztDQUVDLEdBQ0QsTUFBTUMsYUFBYSxDQUFDQyxTQUFpQkM7SUFDbkMsZUFBZTtJQUNmTixXQUFXTyxJQUFJLENBQUM7UUFDZEY7UUFDQUM7UUFDQUUsV0FBV0MsS0FBS0MsR0FBRztJQUN2QjtJQUVFLHFDQUFxQztJQUNyQyxJQUFJLENBQUNULFlBQVk7UUFDZkEsYUFBYVUsV0FBVztZQUFRLEtBQUtDO1FBQXNCLEdBQUdWO0lBQ2xFO0FBQ0E7QUFFQTs7Q0FFQyxHQUNELE1BQU1VLHFCQUFxQjtJQUN6QixjQUFjO0lBQ2RYLGFBQWE7SUFFYixnQ0FBZ0M7SUFDaEMsSUFBSUQsV0FBV2EsTUFBTSxLQUFLLEdBQUc7UUFDM0I7SUFDSjtJQUVFLElBQUk7UUFDRixtREFBbUQ7UUFDbkQsTUFBTUMsYUFBYWQsV0FBV2UsTUFBTSxDQUFDLEdBQUdaO1FBRXhDLDBDQUEwQztRQUMxQyxtRUFBbUU7UUFDbkUsTUFBTWEsYUFBaUQsQ0FBQztRQUN4REYsV0FBV0csT0FBTyxDQUFDQyxDQUFBQTtZQUNqQiwrQkFBK0I7WUFDL0IsTUFBTUMsVUFBVUMsS0FBS0MsS0FBSyxDQUFDSCxHQUFHVixTQUFTLEdBQUcsT0FBT2MsUUFBUTtZQUN6RCxJQUFJLENBQUNOLFVBQVUsQ0FBQ0csUUFBUSxFQUFFO2dCQUN4QkgsVUFBVSxDQUFDRyxRQUFRLEdBQUcsRUFBRTtZQUM1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LFdBQVdMLE9BQU85QixJQUFJLEVBQW9CLHdDQUF3QztRQUV4RixzREFBc0Q7UUFDdEQsd0ZBQXdGO1FBQ3hGLHdEQUF3RDtRQUN4RCxpRkFBaUY7UUFDakYsd0RBQXdEO1FBQ3hELHNFQUFzRTtRQUN0RSxpRUFBaUU7UUFDakVGLFdBQVcsQ0FBQyxlQUFlLEVBQUUrQixNQUFNLENBQUMsRUFBRU07SUFDMUMsRUFBRSxPQUFPVixPQUFPO1FBQ1pGLFFBQVFFLEtBQUssQ0FBQyxrQ0FBa0NBO0lBQ3BEO0FBQ0EsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL3NlcnZpY2VzL2NvdXJzZVByb2dyZXNzU2VydmljZS50cz9iZjljIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGRvYyxcbiAgZ2V0RG9jLFxuICB1cGRhdGVEb2MsXG4gIHNldERvYyxcbiAgY29sbGVjdGlvbixcbiAgcXVlcnksXG4gIHdoZXJlLFxuICBnZXREb2NzLFxuICBzZXJ2ZXJUaW1lc3RhbXAsXG4gIGFycmF5VW5pb24sXG4gIGluY3JlbWVudCxcbiAgVGltZXN0YW1wLFxuICBvcmRlckJ5LFxuICB3cml0ZUJhdGNoLFxuICBkZWxldGVGaWVsZCxcbiAgRmllbGRWYWx1ZSxcbiAgVXBkYXRlRGF0YVxufSBmcm9tICdmaXJlYmFzZS9maXJlc3RvcmUnO1xuaW1wb3J0IHtmaXJlc3RvcmUgfSBmcm9tICcuL2ZpcmViYXNlJztcbmltcG9ydCB7Q291cnNlUHJvZ3Jlc3MsIE1vZHVsZVByb2dyZXNzLCBMZXNzb25Qcm9ncmVzcywgQ291cnNlRW5yb2xsbWVudCB9IGZyb20gJ0AvdHlwZXMvY291cnNlLnR5cGVzJztcbmltcG9ydCB7XG4gIGNyZWF0ZVByb2dyZXNzUmVtaW5kZXIsXG4gIGNyZWF0ZUNvbXBsZXRpb25SZW1pbmRlcixcbiAgY3JlYXRlSW5hY3Rpdml0eVJlbWluZGVyXG59IGZyb20gJy4vcmVtaW5kZXJTZXJ2aWNlJztcbmltcG9ydCB7Z2VuZXJhdGVDZXJ0aWZpY2F0ZSwgZ2V0RGVmYXVsdENlcnRpZmljYXRlVGVtcGxhdGUgfSBmcm9tICcuL2NlcnRpZmljYXRlU2VydmljZSc7XG5cbi8vIERlZmluZSBCb29rbWFyayBsb2NhbGx5IGFzIGl0J3Mgbm90IGV4cG9ydGVkIGZyb20gQC90eXBlcy9jb3Vyc2UudHlwZXNcbmludGVyZmFjZSBCb29rbWFyayB7XG4gIGlkOiBzdHJpbmc7XG4gIHBvc2l0aW9uOiBudW1iZXI7XG4gIG5vdGU6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5cbi8vIENhY2hlIGZvciBwcm9ncmVzcyBkYXRhXG5jb25zdCBwcm9ncmVzc0NhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHtkYXRhOiBDb3Vyc2VQcm9ncmVzcyB8IG51bGwsIHRpbWVzdGFtcDogbnVtYmVyIH0+KCk7XG5jb25zdCBDQUNIRV9UVEwgPSAxMCAqIDYwICogMTAwMDsgLy8gMTAgbWludXRlc1xuXG4vLyBCYXRjaCB3cml0ZSBxdWV1ZVxuaW50ZXJmYWNlIFdyaXRlT3BlcmF0aW9uIHtcbiAgZG9jUGF0aDogc3RyaW5nO1xuICBkYXRhOiBVcGRhdGVEYXRhPENvdXJzZVByb2dyZXNzPjtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5jb25zdCB3cml0ZVF1ZXVlOiBXcml0ZU9wZXJhdGlvbltdID0gW107XG5sZXQgd3JpdGVUaW1lcjogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcbmNvbnN0IEJBVENIX0lOVEVSVkFMID0gNTAwMDsgLy8gNSBzZWNvbmRzXG5jb25zdCBNQVhfQkFUQ0hfU0laRSA9IDUwMDsgLy8gRmlyZXN0b3JlIGxpbWl0IGlzIDUwMCBvcGVyYXRpb25zIHBlciBiYXRjaFxuXG4vKipcbiAqIFF1ZXVlIGEgd3JpdGUgb3BlcmF0aW9uIHRvIGJlIGJhdGNoZWRcbiAqL1xuY29uc3QgcXVldWVXcml0ZSA9IChkb2NQYXRoOiBzdHJpbmcsIGRhdGE6IFVwZGF0ZURhdGE8Q291cnNlUHJvZ3Jlc3M+KSA9PiB7XG4gIC8vIEFkZCB0byBxdWV1ZVxuICB3cml0ZVF1ZXVlLnB1c2goe1xuICAgIGRvY1BhdGgsXG4gICAgZGF0YSxcbiAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbn0pO1xuXG4gIC8vIFN0YXJ0IHRpbWVyIGlmIG5vdCBhbHJlYWR5IHJ1bm5pbmdcbiAgaWYgKCF3cml0ZVRpbWVyKSB7XG4gICAgd3JpdGVUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4geyB2b2lkIHByb2Nlc3NCYXRjaFdyaXRlcygpOyB9LCBCQVRDSF9JTlRFUlZBTCk7XG59XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgcXVldWVkIHdyaXRlIG9wZXJhdGlvbnMgaW4gYmF0Y2hlc1xuICovXG5jb25zdCBwcm9jZXNzQmF0Y2hXcml0ZXMgPSBhc3luYyAoKSA9PiB7XG4gIC8vIENsZWFyIHRpbWVyXG4gIHdyaXRlVGltZXIgPSBudWxsO1xuXG4gIC8vIElmIHF1ZXVlIGlzIGVtcHR5LCBkbyBub3RoaW5nXG4gIGlmICh3cml0ZVF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybjtcbn1cblxuICB0cnkge1xuICAgIC8vIEdldCBvcGVyYXRpb25zIHRvIHByb2Nlc3MgKHVwIHRvIG1heCBiYXRjaCBzaXplKVxuICAgIGNvbnN0IG9wZXJhdGlvbnMgPSB3cml0ZVF1ZXVlLnNwbGljZSgwLCBNQVhfQkFUQ0hfU0laRSk7XG5cbiAgICAvLyBHcm91cCBieSB0aW1lc3RhbXAgdG8gYXZvaWQgaG90c3BvdHRpbmdcbiAgICAvLyBUaGlzIGNyZWF0ZXMgbXVsdGlwbGUgYmF0Y2hlcyB3aXRoIG9wZXJhdGlvbnMgc3ByZWFkIGFjcm9zcyB0aW1lXG4gICAgY29uc3QgdGltZUdyb3Vwczoge1trZXk6IHN0cmluZ106IFdyaXRlT3BlcmF0aW9uW10gfSA9IHt9O1xuICAgIG9wZXJhdGlvbnMuZm9yRWFjaChvcCA9PiB7XG4gICAgICAvLyBHcm91cCBieSAxMC1zZWNvbmQgaW50ZXJ2YWxzXG4gICAgICBjb25zdCB0aW1lS2V5ID0gTWF0aC5mbG9vcihvcC50aW1lc3RhbXAgLyAxMDAwMCkudG9TdHJpbmcoKTtcbiAgICAgIGlmICghdGltZUdyb3Vwc1t0aW1lS2V5XSkge1xuICAgICAgICB0aW1lR3JvdXBzW3RpbWVLZXldID0gW107XG4gICAgfVxuICAgICAgdGltZUdyb3Vwc1t0aW1lS2V5XS5wdXNoKG9wKTtcbiAgfSk7XG5cbiAgICAvLyBQcm9jZXNzIGVhY2ggdGltZSBncm91cFxuICAgIGZvciAoY29uc3QgdGltZUtleSBpbiB0aW1lR3JvdXBzKSB7XG4gICAgICBjb25zdCBiYXRjaCA9IHdyaXRlQmF0Y2goZmlyZXN0b3JlKTtcbiAgICAgIGNvbnN0IGdyb3VwT3BzID0gdGltZUdyb3Vwc1t0aW1lS2V5XTtcblxuICAgICAgLy8gQWRkIG9wZXJhdGlvbnMgdG8gYmF0Y2hcbiAgICAgIGdyb3VwT3BzLmZvckVhY2gob3AgPT4ge1xuICAgICAgICBjb25zdCBkb2NSZWYgPSBkb2MoZmlyZXN0b3JlLCBvcC5kb2NQYXRoKTtcbiAgICAgICAgYmF0Y2gudXBkYXRlKGRvY1JlZiwge1xuICAgICAgICAgIC4uLm9wLmRhdGEsXG4gICAgICAgICAgbGFzdFVwZGF0ZWQ6IHNlcnZlclRpbWVzdGFtcCgpXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgICAgLy8gQ29tbWl0IGJhdGNoXG4gICAgICBhd2FpdCBiYXRjaC5jb21taXQoKTtcbiAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzZWQgJHtncm91cE9wcy5sZW5ndGh9IHdyaXRlIG9wZXJhdGlvbnMgaW4gYmF0Y2hgKTtcbiAgfVxufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIGJhdGNoIHdyaXRlczonLCBlcnJvcik7XG5cbiAgICAvLyBJZiB0aGVyZSB3YXMgYW4gZXJyb3IsIHJlLXF1ZXVlIG9wZXJhdGlvbnMgd2l0aCBleHBvbmVudGlhbCBiYWNrb2ZmXG4gICAgaWYgKHdyaXRlUXVldWUubGVuZ3RoIDwgMTAwMCkgey8vIFByZXZlbnQgaW5maW5pdGUgZ3Jvd3RoXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHsgdm9pZCBwcm9jZXNzQmF0Y2hXcml0ZXMoKTsgfSwgQkFUQ0hfSU5URVJWQUwgKiAyKTtcbiAgfVxufVxuXG4gIC8vIElmIHRoZXJlIGFyZSBtb3JlIG9wZXJhdGlvbnMsIHNjaGVkdWxlIGFub3RoZXIgYmF0Y2hcbiAgaWYgKHdyaXRlUXVldWUubGVuZ3RoID4gMCkge1xuICAgIHdyaXRlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsgdm9pZCBwcm9jZXNzQmF0Y2hXcml0ZXMoKTsgfSwgQkFUQ0hfSU5URVJWQUwpO1xufVxufTtcblxuLyoqXG4gKiBHZXQgY291cnNlIHByb2dyZXNzIGZvciBhIHVzZXJcbiAqL1xuZXhwb3J0IGNvbnN0IGdldENvdXJzZVByb2dyZXNzID0gYXN5bmMgKHVzZXJJZDogc3RyaW5nLCBjb3Vyc2VJZDogc3RyaW5nKTogUHJvbWlzZTxDb3Vyc2VQcm9ncmVzcyB8IG51bGw+ID0+IHtcbiAgY29uc3QgZG9jSWQgPSBgJHt1c2VySWR9XyR7Y291cnNlSWR9YDtcbiAgY29uc3QgY2FjaGVkID0gcHJvZ3Jlc3NDYWNoZS5nZXQoZG9jSWQpO1xuXG4gIGlmIChjYWNoZWQgJiYgKERhdGUubm93KCkgLSBjYWNoZWQudGltZXN0YW1wKSA8IENBQ0hFX1RUTCkge1xuICAgIHJldHVybiBjYWNoZWQuZGF0YTtcbn1cblxuICB0cnkge1xuICAgIGNvbnN0IHByb2dyZXNzUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NvdXJzZVByb2dyZXNzJywgZG9jSWQpO1xuICAgIGNvbnN0IHByb2dyZXNzRG9jID0gYXdhaXQgZ2V0RG9jKHByb2dyZXNzUmVmKTtcblxuICAgIGlmICghcHJvZ3Jlc3NEb2MuZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgICBjb25zdCBwcm9ncmVzcyA9IHByb2dyZXNzRG9jLmRhdGEoKSBhcyBDb3Vyc2VQcm9ncmVzcztcbiAgICBwcm9ncmVzc0NhY2hlLnNldChkb2NJZCwge2RhdGE6IHByb2dyZXNzLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfSk7XG5cbiAgICByZXR1cm4gcHJvZ3Jlc3M7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgY291cnNlIHByb2dyZXNzOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbn1cbn07XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBjb3Vyc2UgcHJvZ3Jlc3MgZm9yIGEgdXNlclxuICovXG5leHBvcnQgY29uc3QgaW5pdGlhbGl6ZUNvdXJzZVByb2dyZXNzID0gYXN5bmMgKHVzZXJJZDogc3RyaW5nLCBjb3Vyc2VJZDogc3RyaW5nLCBjb3Vyc2VOYW1lOiBzdHJpbmcpOiBQcm9taXNlPENvdXJzZVByb2dyZXNzPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSBkb2MoZmlyZXN0b3JlLCAnY291cnNlUHJvZ3Jlc3MnLCBgJHt1c2VySWR9XyR7Y291cnNlSWR9YCk7XG4gICAgY29uc3QgcHJvZ3Jlc3NEb2MgPSBhd2FpdCBnZXREb2MocHJvZ3Jlc3NSZWYpO1xuXG4gICAgaWYgKHByb2dyZXNzRG9jLmV4aXN0cygpKSB7XG4gICAgICByZXR1cm4gcHJvZ3Jlc3NEb2MuZGF0YSgpIGFzIENvdXJzZVByb2dyZXNzO1xuICB9XG5cbiAgICAvLyBHZXQgYWxsIG1vZHVsZXMgYW5kIGxlc3NvbnMgdG8gaW5pdGlhbGl6ZSBwcm9ncmVzcyB0cmFja2luZ1xuICAgIGNvbnN0IG1vZHVsZXNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlc2ApO1xuICAgIGNvbnN0IG1vZHVsZXNRdWVyeSA9IHF1ZXJ5KG1vZHVsZXNSZWYsIHdoZXJlKCdzdGF0dXMnLCAnPT0nLCAncHVibGlzaGVkJyksIG9yZGVyQnkoJ29yZGVyJywgJ2FzYycpKTtcbiAgICBjb25zdCBtb2R1bGVzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKG1vZHVsZXNRdWVyeSk7XG5cbiAgICBjb25zdCBtb2R1bGVQcm9ncmVzczogUmVjb3JkPHN0cmluZywgTW9kdWxlUHJvZ3Jlc3M+ID0ge307XG4gICAgY29uc3QgbGVzc29uUHJvZ3Jlc3M6IFJlY29yZDxzdHJpbmcsIExlc3NvblByb2dyZXNzPiA9IHt9O1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBtb2R1bGUgYW5kIGxlc3NvbiBwcm9ncmVzc1xuICAgIGZvciAoY29uc3QgbW9kdWxlRG9jIG9mIG1vZHVsZXNTbmFwc2hvdC5kb2NzKSB7XG4gICAgICBjb25zdCBtb2R1bGVJZCA9IG1vZHVsZURvYy5pZDtcblxuICAgICAgLy8gR2V0IGxlc3NvbnMgZm9yIHRoaXMgbW9kdWxlXG4gICAgICBjb25zdCBsZXNzb25zUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH0vbGVzc29uc2ApO1xuICAgICAgY29uc3QgbGVzc29uc1F1ZXJ5ID0gcXVlcnkobGVzc29uc1JlZiwgd2hlcmUoJ3N0YXR1cycsICc9PScsICdwdWJsaXNoZWQnKSwgb3JkZXJCeSgnb3JkZXInLCAnYXNjJykpO1xuICAgICAgY29uc3QgbGVzc29uc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhsZXNzb25zUXVlcnkpO1xuXG4gICAgICAvLyBJbml0aWFsaXplIG1vZHVsZSBwcm9ncmVzc1xuICAgICAgbW9kdWxlUHJvZ3Jlc3NbbW9kdWxlSWRdID0ge1xuICAgICAgICBtb2R1bGVJZCxcbiAgICAgICAgc3RhcnREYXRlOiAnJyxcbiAgICAgICAgbGFzdEFjY2Vzc0RhdGU6ICcnLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgICBwcm9ncmVzczogMCxcbiAgICAgICAgdGltZVNwZW50OiAwLFxuICAgICAgICBjb21wbGV0ZWRMZXNzb25zOiAwLFxuICAgICAgICB0b3RhbExlc3NvbnM6IGxlc3NvbnNTbmFwc2hvdC5zaXplXG4gICAgfTtcblxuICAgICAgLy8gSW5pdGlhbGl6ZSBsZXNzb24gcHJvZ3Jlc3NcbiAgICAgIGxlc3NvbnNTbmFwc2hvdC5mb3JFYWNoKGxlc3NvbkRvYyA9PiB7XG4gICAgICAgIGNvbnN0IGxlc3NvbklkID0gbGVzc29uRG9jLmlkO1xuXG4gICAgICAgIGxlc3NvblByb2dyZXNzW2Ake21vZHVsZUlkfV8ke2xlc3NvbklkfWBdID0ge1xuICAgICAgICAgIGxlc3NvbklkLFxuICAgICAgICAgIG1vZHVsZUlkLFxuICAgICAgICAgIHN0YXJ0RGF0ZTogJycsXG4gICAgICAgICAgbGFzdEFjY2Vzc0RhdGU6ICcnLFxuICAgICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgICAgdGltZVNwZW50OiAwLFxuICAgICAgICAgIHByb2dyZXNzOiAwLFxuICAgICAgICAgIG5vdGVzOiBbXSxcbiAgICAgICAgICBib29rbWFya3M6IFtdXG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgICBjb25zdCBuZXdQcm9ncmVzczogQ291cnNlUHJvZ3Jlc3MgPSB7XG4gICAgICBjb3Vyc2VJZCxcbiAgICAgIHVzZXJJZCxcbiAgICAgIHN0YXJ0RGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGNvbXBsZXRlZExlc3NvbnM6IFtdLFxuICAgICAgY29tcGxldGVkTW9kdWxlczogW10sXG4gICAgICBxdWl6U2NvcmVzOiB7fSxcbiAgICAgIHF1aXpBdHRlbXB0czoge30sXG4gICAgICBsZXNzb25Qcm9ncmVzcyxcbiAgICAgIG1vZHVsZVByb2dyZXNzLFxuICAgICAgb3ZlcmFsbFByb2dyZXNzOiAwLFxuICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgIHRpbWVTcGVudDogMFxuICB9O1xuXG4gICAgYXdhaXQgc2V0RG9jKHByb2dyZXNzUmVmLCBuZXdQcm9ncmVzcyk7XG5cbiAgICAvLyBDcmVhdGUgaW5pdGlhbCBwcm9ncmVzcyByZW1pbmRlclxuICAgIGF3YWl0IGNyZWF0ZVByb2dyZXNzUmVtaW5kZXIodXNlcklkLCBjb3Vyc2VJZCwgY291cnNlTmFtZSwgMCk7XG5cbiAgICByZXR1cm4gbmV3UHJvZ3Jlc3M7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBjb3Vyc2UgcHJvZ3Jlc3M6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBDYWxjdWxhdGUgY291cnNlIHByb2dyZXNzIHdpdGhvdXQgZGF0YWJhc2Ugb3BlcmF0aW9uc1xuICovXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlQ291cnNlUHJvZ3Jlc3MgPSAoXG4gIGNvbXBsZXRlZExlc3NvbnM6IHN0cmluZ1tdLFxuICB0b3RhbExlc3NvbnM6IG51bWJlclxuKToge292ZXJhbGxQcm9ncmVzczogbnVtYmVyLCBjb21wbGV0ZWQ6IGJvb2xlYW4gfSA9PiB7XG4gIGNvbnN0IHNhZmVUb3RhbExlc3NvbnMgPSBNYXRoLm1heCgxLCB0b3RhbExlc3NvbnMpO1xuICBjb25zdCBvdmVyYWxsUHJvZ3Jlc3MgPSBNYXRoLmZsb29yKChjb21wbGV0ZWRMZXNzb25zLmxlbmd0aCAvIHNhZmVUb3RhbExlc3NvbnMpICogMTAwKTtcbiAgY29uc3QgY29tcGxldGVkID0gY29tcGxldGVkTGVzc29ucy5sZW5ndGggPj0gc2FmZVRvdGFsTGVzc29ucyAmJiBzYWZlVG90YWxMZXNzb25zID4gMDtcblxuICByZXR1cm4ge292ZXJhbGxQcm9ncmVzcywgY29tcGxldGVkIH07XG59O1xuXG4vKipcbiAqIFVwZGF0ZSBsZXNzb24gcHJvZ3Jlc3Mgd2l0aCBvcHRpbWl6ZWQgd3JpdGVzXG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVMZXNzb25Qcm9ncmVzcyA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIGNvdXJzZU5hbWU6IHN0cmluZyxcbiAgbGVzc29uSWQ6IHN0cmluZyxcbiAgY29tcGxldGVkOiBib29sZWFuLFxuICB0b3RhbExlc3NvbnM6IG51bWJlclxuKTogUHJvbWlzZTxDb3Vyc2VQcm9ncmVzcz4gPT4ge1xuICB0cnkge1xuICAgIC8vIEdlbmVyYXRlIGRvY3VtZW50IElEXG4gICAgY29uc3QgZG9jSWQgPSBgJHt1c2VySWR9XyR7Y291cnNlSWR9YDtcbiAgICBjb25zdCBkb2NQYXRoID0gYGNvdXJzZVByb2dyZXNzLyR7ZG9jSWR9YDsgLy8gVGhpcyBpcyB0aGUgcGF0aCB0byB0aGUgZG9jdW1lbnQgaW4gRmlyZXN0b3JlXG5cbiAgICAvLyBHZXQgY3VycmVudCBwcm9ncmVzcyAoZnJvbSBjYWNoZSBpZiBwb3NzaWJsZSlcbiAgICBsZXQgcHJvZ3Jlc3M6IENvdXJzZVByb2dyZXNzO1xuICAgIGNvbnN0IGNhY2hlZCA9IHByb2dyZXNzQ2FjaGUuZ2V0KGRvY0lkKTtcblxuICAgIGlmIChjYWNoZWQgJiYgY2FjaGVkLmRhdGEgJiYgKERhdGUubm93KCkgLSBjYWNoZWQudGltZXN0YW1wKSA8IENBQ0hFX1RUTCkge1xuICAgICAgcHJvZ3Jlc3MgPSBjYWNoZWQuZGF0YTtcbiAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHByb2dyZXNzUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NvdXJzZVByb2dyZXNzJywgZG9jSWQpO1xuICAgICAgY29uc3QgcHJvZ3Jlc3NEb2MgPSBhd2FpdCBnZXREb2MocHJvZ3Jlc3NSZWYpO1xuXG4gICAgICBpZiAoIXByb2dyZXNzRG9jLmV4aXN0cygpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291cnNlIHByb2dyZXNzIG5vdCBmb3VuZCcpO1xuICAgIH1cbiAgICAgIHByb2dyZXNzID0gcHJvZ3Jlc3NEb2MuZGF0YSgpIGFzIENvdXJzZVByb2dyZXNzO1xuICAgICAgcHJvZ3Jlc3NDYWNoZS5zZXQoZG9jSWQsIHtkYXRhOiBwcm9ncmVzcywgdGltZXN0YW1wOiBEYXRlLm5vdygpIH0pO1xuICB9XG5cbiAgICAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIHVwZGF0ZVxuICAgIGNvbnN0IGNvbXBsZXRlZExlc3NvbnMgPSBbLi4uKHByb2dyZXNzLmNvbXBsZXRlZExlc3NvbnMgfHwgW10pXTtcbiAgICBjb25zdCBsZXNzb25JbmRleCA9IGNvbXBsZXRlZExlc3NvbnMuaW5kZXhPZihsZXNzb25JZCk7XG5cbiAgICBpZiAoKGNvbXBsZXRlZCAmJiBsZXNzb25JbmRleCA+PSAwKSB8fCAoIWNvbXBsZXRlZCAmJiBsZXNzb25JbmRleCA8IDApKSB7XG4gICAgICAvLyBObyBjaGFuZ2UgbmVlZGVkXG4gICAgICByZXR1cm4gcHJvZ3Jlc3M7XG4gIH1cblxuICAgIC8vIFVwZGF0ZSBjb21wbGV0ZWQgbGVzc29uc1xuICAgIGlmIChjb21wbGV0ZWQpIHtcbiAgICAgIGNvbXBsZXRlZExlc3NvbnMucHVzaChsZXNzb25JZCk7XG4gIH0gZWxzZSB7XG4gICAgICBjb21wbGV0ZWRMZXNzb25zLnNwbGljZShsZXNzb25JbmRleCwgMSk7XG4gIH1cblxuICAgIC8vIENhbGN1bGF0ZSBuZXcgcHJvZ3Jlc3NcbiAgICBjb25zdCB7b3ZlcmFsbFByb2dyZXNzLCBjb21wbGV0ZWQ6IGlzQ29tcGxldGVkIH0gPSBjYWxjdWxhdGVDb3Vyc2VQcm9ncmVzcyhcbiAgICAgIGNvbXBsZXRlZExlc3NvbnMsXG4gICAgICB0b3RhbExlc3NvbnNcbiAgICApO1xuXG4gICAgLy8gUHJlcGFyZSB1cGRhdGUgZGF0YVxuICAgIGNvbnN0IHVwZGF0ZURhdGE6IHtcbiAgICAgIGNvbXBsZXRlZExlc3NvbnM6IHN0cmluZ1tdO1xuICAgICAgb3ZlcmFsbFByb2dyZXNzOiBudW1iZXI7XG4gICAgICBjb21wbGV0ZWQ6IGJvb2xlYW47XG4gICAgICBsYXN0QWNjZXNzRGF0ZTogc3RyaW5nO1xuICAgICAgY29tcGxldGVkRGF0ZT86IHN0cmluZyB8IEZpZWxkVmFsdWU7XG4gICAgfSA9IHtcbiAgICAgIGNvbXBsZXRlZExlc3NvbnMsXG4gICAgICBvdmVyYWxsUHJvZ3Jlc3MsXG4gICAgICBjb21wbGV0ZWQ6IGlzQ29tcGxldGVkLFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgLy8gY29tcGxldGVkRGF0ZSB3aWxsIGJlIGFkZGVkIGNvbmRpdGlvbmFsbHlcbiAgfTtcblxuICAgIC8vIEFkZCBjb21wbGV0aW9uIGRhdGUgaWYgbmV3bHkgY29tcGxldGVkXG4gICAgaWYgKGlzQ29tcGxldGVkICYmICFwcm9ncmVzcy5jb21wbGV0ZWQpIHtcbiAgICAgIHVwZGF0ZURhdGEuY29tcGxldGVkRGF0ZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgfSBlbHNlIGlmICghaXNDb21wbGV0ZWQgJiYgcHJvZ3Jlc3MuY29tcGxldGVkKSB7XG4gICAgICAvLyBVc2UgZGVsZXRlRmllbGQoKSB0byBwcm9wZXJseSByZW1vdmUgdGhlIGZpZWxkIGZyb20gRmlyZXN0b3JlXG4gICAgICB1cGRhdGVEYXRhLmNvbXBsZXRlZERhdGUgPSBkZWxldGVGaWVsZCgpO1xuICB9XG5cbiAgICAvLyBRdWV1ZSB0aGUgd3JpdGUgaW5zdGVhZCBvZiBpbW1lZGlhdGUgdXBkYXRlXG4gICAgcXVldWVXcml0ZShkb2NQYXRoLCB1cGRhdGVEYXRhKTtcblxuICAgIC8vIFNlcGFyYXRlIGNvbXBsZXRlZERhdGUgZnJvbSB1cGRhdGVEYXRhIGFuZCByZXNvbHZlIGl0cyB0eXBlIGZvciB0aGUgY2FjaGUvcmV0dXJuIG9iamVjdFxuICAgIGNvbnN0IHsgY29tcGxldGVkRGF0ZTogcmF3Q29tcGxldGVkRGF0ZUZyb21VcGRhdGVEYXRhLCAuLi5yZXN0T2ZVcGRhdGVEYXRhIH0gPSB1cGRhdGVEYXRhO1xuICAgIGNvbnN0IHJlc29sdmVkQ29tcGxldGVkRGF0ZUZvckNhY2hlOiBzdHJpbmcgfCB1bmRlZmluZWQgPVxuICAgICAgcmF3Q29tcGxldGVkRGF0ZUZyb21VcGRhdGVEYXRhID09PSBkZWxldGVGaWVsZCgpID8gdW5kZWZpbmVkIDpcbiAgICAgICh0eXBlb2YgcmF3Q29tcGxldGVkRGF0ZUZyb21VcGRhdGVEYXRhID09PSAnc3RyaW5nJyA/IHJhd0NvbXBsZXRlZERhdGVGcm9tVXBkYXRlRGF0YSA6IHVuZGVmaW5lZCk7XG5cbiAgICBjb25zdCB1cGRhdGVkUHJvZ3Jlc3M6IENvdXJzZVByb2dyZXNzID0ge1xuICAgICAgLi4ucHJvZ3Jlc3MsXG4gICAgICAuLi5yZXN0T2ZVcGRhdGVEYXRhLFxuICAgICAgY29tcGxldGVkRGF0ZTogcmVzb2x2ZWRDb21wbGV0ZWREYXRlRm9yQ2FjaGVcbiAgICB9O1xuICAgIHByb2dyZXNzQ2FjaGUuc2V0KGRvY0lkLCB7ZGF0YTogdXBkYXRlZFByb2dyZXNzLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfSk7XG5cbiAgICAvLyBSZXR1cm4gdXBkYXRlZCBwcm9ncmVzc1xuICAgIHJldHVybiB1cGRhdGVkUHJvZ3Jlc3M7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGxlc3NvbiBwcm9ncmVzczonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIE1hcmsgYSBtb2R1bGUgYXMgY29tcGxldGVcbiAqL1xuZXhwb3J0IGNvbnN0IG1hcmtNb2R1bGVDb21wbGV0ZSA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIG1vZHVsZUlkOiBzdHJpbmdcbik6IFByb21pc2U8Q291cnNlUHJvZ3Jlc3M+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwcm9ncmVzc1JlZiA9IGRvYyhmaXJlc3RvcmUsICdjb3Vyc2VQcm9ncmVzcycsIGAke3VzZXJJZH1fJHtjb3Vyc2VJZH1gKTtcbiAgICBjb25zdCBwcm9ncmVzc0RvYyA9IGF3YWl0IGdldERvYyhwcm9ncmVzc1JlZik7XG5cbiAgICBpZiAoIXByb2dyZXNzRG9jLmV4aXN0cygpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdXJzZSBwcm9ncmVzcyBub3QgZm91bmQnKTtcbiAgfVxuXG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBwcm9ncmVzc0RvYy5kYXRhKCkgYXMgQ291cnNlUHJvZ3Jlc3M7XG4gICAgY29uc3QgY29tcGxldGVkTW9kdWxlcyA9IFsuLi5wcm9ncmVzcy5jb21wbGV0ZWRNb2R1bGVzXTtcblxuICAgIGlmICghY29tcGxldGVkTW9kdWxlcy5pbmNsdWRlcyhtb2R1bGVJZCkpIHtcbiAgICAgIGNvbXBsZXRlZE1vZHVsZXMucHVzaChtb2R1bGVJZCk7XG4gIH1cblxuICAgIGF3YWl0IHVwZGF0ZURvYyhwcm9ncmVzc1JlZiwge1xuICAgICAgY29tcGxldGVkTW9kdWxlcyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBsYXN0VXBkYXRlZDogc2VydmVyVGltZXN0YW1wKClcbiAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4ucHJvZ3Jlc3MsXG4gICAgICBjb21wbGV0ZWRNb2R1bGVzLFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICB9IGFzIENvdXJzZVByb2dyZXNzO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIG1vZHVsZSBjb21wbGV0ZTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIE1hcmsgYSBjb3Vyc2UgYXMgY29tcGxldGVcbiAqL1xuZXhwb3J0IGNvbnN0IG1hcmtDb3Vyc2VDb21wbGV0ZSA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIGNvdXJzZU5hbWU6IHN0cmluZ1xuKTogUHJvbWlzZTxDb3Vyc2VQcm9ncmVzcz4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHByb2dyZXNzUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NvdXJzZVByb2dyZXNzJywgYCR7dXNlcklkfV8ke2NvdXJzZUlkfWApO1xuICAgIGNvbnN0IHByb2dyZXNzRG9jID0gYXdhaXQgZ2V0RG9jKHByb2dyZXNzUmVmKTtcblxuICAgIGlmICghcHJvZ3Jlc3NEb2MuZXhpc3RzKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ291cnNlIHByb2dyZXNzIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgICBjb25zdCBwcm9ncmVzcyA9IHByb2dyZXNzRG9jLmRhdGEoKSBhcyBDb3Vyc2VQcm9ncmVzcztcblxuICAgIC8vIEdldCBhbGwgcHVibGlzaGVkIGxlc3NvbnMgaW4gdGhlIGNvdXJzZSB0byB2ZXJpZnkgY29tcGxldGlvblxuICAgIGNvbnN0IG1vZHVsZXNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlc2ApO1xuICAgIGNvbnN0IG1vZHVsZXNRdWVyeSA9IHF1ZXJ5KG1vZHVsZXNSZWYsIHdoZXJlKCdzdGF0dXMnLCAnPT0nLCAncHVibGlzaGVkJykpO1xuICAgIGNvbnN0IG1vZHVsZXNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MobW9kdWxlc1F1ZXJ5KTtcblxuICAgIGxldCB0b3RhbExlc3NvbnMgPSAwO1xuICAgIGNvbnN0IG1vZHVsZUlkczogc3RyaW5nW10gPSBbXTtcblxuICAgIC8vIENvdW50IHRvdGFsIGxlc3NvbnMgYW5kIGNvbGxlY3QgbW9kdWxlIElEc1xuICAgIGZvciAoY29uc3QgbW9kdWxlRG9jIG9mIG1vZHVsZXNTbmFwc2hvdC5kb2NzKSB7XG4gICAgICBjb25zdCBtb2R1bGVJZCA9IG1vZHVsZURvYy5pZDtcbiAgICAgIG1vZHVsZUlkcy5wdXNoKG1vZHVsZUlkKTtcblxuICAgICAgY29uc3QgbGVzc29uc1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCBgY291cnNlcy8ke2NvdXJzZUlkfS9tb2R1bGVzLyR7bW9kdWxlSWR9L2xlc3NvbnNgKTtcbiAgICAgIGNvbnN0IGxlc3NvbnNRdWVyeSA9IHF1ZXJ5KGxlc3NvbnNSZWYsIHdoZXJlKCdzdGF0dXMnLCAnPT0nLCAncHVibGlzaGVkJykpO1xuICAgICAgY29uc3QgbGVzc29uc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhsZXNzb25zUXVlcnkpO1xuXG4gICAgICB0b3RhbExlc3NvbnMgKz0gbGVzc29uc1NuYXBzaG90LnNpemU7XG4gIH1cblxuICAgIC8vIENhbGN1bGF0ZSBhY3R1YWwgcHJvZ3Jlc3MgYmFzZWQgb24gY29tcGxldGVkIGxlc3NvbnNcbiAgICBjb25zdCBjb21wbGV0ZWRMZXNzb25zID0gcHJvZ3Jlc3MuY29tcGxldGVkTGVzc29ucy5sZW5ndGg7XG4gICAgY29uc3QgYWN0dWFsUHJvZ3Jlc3MgPSB0b3RhbExlc3NvbnMgPiAwID8gTWF0aC5yb3VuZCgoY29tcGxldGVkTGVzc29ucyAvIHRvdGFsTGVzc29ucykgKiAxMDApIDogMDtcblxuICAgIC8vIE9ubHkgbWFyayBhcyBjb21wbGV0ZSBpZiBhbGwgbGVzc29ucyBhcmUgYWN0dWFsbHkgY29tcGxldGVkXG4gICAgY29uc3QgaXNBY3R1YWxseUNvbXBsZXRlID0gdG90YWxMZXNzb25zID4gMCAmJiBjb21wbGV0ZWRMZXNzb25zID49IHRvdGFsTGVzc29ucztcbiAgICBjb25zdCBjb21wbGV0aW9uRGF0ZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcblxuICAgIGF3YWl0IHVwZGF0ZURvYyhwcm9ncmVzc1JlZiwge1xuICAgICAgY29tcGxldGVkOiBpc0FjdHVhbGx5Q29tcGxldGUsXG4gICAgICBjb21wbGV0aW9uRGF0ZTogaXNBY3R1YWxseUNvbXBsZXRlID8gY29tcGxldGlvbkRhdGUgOiBudWxsLFxuICAgICAgb3ZlcmFsbFByb2dyZXNzOiBhY3R1YWxQcm9ncmVzcyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBjb21wbGV0aW9uRGF0ZSxcbiAgICAgIGxhc3RVcGRhdGVkOiBzZXJ2ZXJUaW1lc3RhbXAoKVxuICB9KTtcblxuICAgIC8vIENyZWF0ZSBjb21wbGV0aW9uIHJlbWluZGVyXG4gICAgYXdhaXQgY3JlYXRlQ29tcGxldGlvblJlbWluZGVyKHVzZXJJZCwgY291cnNlSWQsIGNvdXJzZU5hbWUpO1xuXG4gICAgLy8gSXNzdWUgY2VydGlmaWNhdGUgaWYgY291cnNlIGlzIGNvbmZpZ3VyZWQgdG8gaXNzdWUgY2VydGlmaWNhdGVzXG4gICAgYXdhaXQgaXNzdWVDZXJ0aWZpY2F0ZUZvckNvdXJzZSh1c2VySWQsIGNvdXJzZUlkLCBjb3Vyc2VOYW1lKTtcblxuICAgIHJldHVybiB7XG4gICAgICAuLi5wcm9ncmVzcyxcbiAgICAgIGNvbXBsZXRlZDogdHJ1ZSxcbiAgICAgIGNvbXBsZXRpb25EYXRlLFxuICAgICAgb3ZlcmFsbFByb2dyZXNzOiAxMDAsXG4gICAgICBsYXN0QWNjZXNzRGF0ZTogY29tcGxldGlvbkRhdGVcbiAgfSBhcyBDb3Vyc2VQcm9ncmVzcztcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFya2luZyBjb3Vyc2UgY29tcGxldGU6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBJc3N1ZSBhIGNlcnRpZmljYXRlIGZvciBhIGNvbXBsZXRlZCBjb3Vyc2VcbiAqL1xuY29uc3QgaXNzdWVDZXJ0aWZpY2F0ZUZvckNvdXJzZSA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIGNvdXJzZU5hbWU6IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IGNvdXJzZSBkZXRhaWxzIHRvIGNoZWNrIGlmIGNlcnRpZmljYXRlcyBhcmUgZW5hYmxlZFxuICAgIGNvbnN0IGNvdXJzZVJlZiA9IGRvYyhmaXJlc3RvcmUsICdjb3Vyc2VzJywgY291cnNlSWQpO1xuICAgIGNvbnN0IGNvdXJzZURvYyA9IGF3YWl0IGdldERvYyhjb3Vyc2VSZWYpO1xuXG4gICAgaWYgKCFjb3Vyc2VEb2MuZXhpc3RzKCkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvdXJzZSBub3QgZm91bmQgZm9yIGNlcnRpZmljYXRlIGlzc3VhbmNlJyk7XG4gICAgICByZXR1cm47XG4gIH1cblxuICAgIGNvbnN0IGNvdXJzZURhdGEgPSBjb3Vyc2VEb2MuZGF0YSgpO1xuXG4gICAgLy8gQ2hlY2sgaWYgY2VydGlmaWNhdGVzIGFyZSBlbmFibGVkIGZvciB0aGlzIGNvdXJzZVxuICAgIGlmICghY291cnNlRGF0YS5jZXJ0aWZpY2F0ZXNFbmFibGVkKSB7XG4gICAgICBjb25zb2xlLmxvZygnQ2VydGlmaWNhdGVzIG5vdCBlbmFibGVkIGZvciB0aGlzIGNvdXJzZScpO1xuICAgICAgcmV0dXJuO1xuICB9XG5cbiAgICAvLyBHZXQgdXNlciBkZXRhaWxzXG4gICAgY29uc3QgdXNlclJlZiA9IGRvYyhmaXJlc3RvcmUsICd1c2VycycsIHVzZXJJZCk7XG4gICAgY29uc3QgdXNlckRvYyA9IGF3YWl0IGdldERvYyh1c2VyUmVmKTtcblxuICAgIGlmICghdXNlckRvYy5leGlzdHMoKSkge1xuICAgICAgY29uc29sZS5lcnJvcignVXNlciBub3QgZm91bmQgZm9yIGNlcnRpZmljYXRlIGlzc3VhbmNlJyk7XG4gICAgICByZXR1cm47XG4gIH1cblxuICAgIGNvbnN0IHVzZXJEYXRhID0gdXNlckRvYy5kYXRhKCk7XG5cbiAgICAvLyBHZXQgY2VydGlmaWNhdGUgdGVtcGxhdGUgKHVzZSBjb3Vyc2Utc3BlY2lmaWMgdGVtcGxhdGUgb3IgZGVmYXVsdClcbiAgICBjb25zdCB0ZW1wbGF0ZUlkID0gY291cnNlRGF0YS5jZXJ0aWZpY2F0ZVRlbXBsYXRlSWQgYXMgc3RyaW5nIHwgbnVsbCB8fCBudWxsO1xuICAgIGxldCB0ZW1wbGF0ZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCBudWxsID0gbnVsbDtcblxuICAgIGlmICh0ZW1wbGF0ZUlkKSB7XG4gICAgICAvLyBVc2UgY291cnNlLXNwZWNpZmljIHRlbXBsYXRlXG4gICAgICBjb25zdCB0ZW1wbGF0ZVJlZiA9IGRvYyhmaXJlc3RvcmUsICdjZXJ0aWZpY2F0ZVRlbXBsYXRlcycsIHRlbXBsYXRlSWQpO1xuICAgICAgY29uc3QgdGVtcGxhdGVEb2MgPSBhd2FpdCBnZXREb2ModGVtcGxhdGVSZWYpO1xuXG4gICAgICBpZiAodGVtcGxhdGVEb2MuZXhpc3RzKCkpIHtcbiAgICAgICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZURvYy5kYXRhKCkgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgfVxuICB9XG5cbiAgICAvLyBJZiBubyB0ZW1wbGF0ZSBmb3VuZCwgdXNlIGRlZmF1bHQgdGVtcGxhdGVcbiAgICBpZiAoIXRlbXBsYXRlKSB7XG4gICAgICBjb25zdCBkZWZhdWx0VGVtcGxhdGUgPSBhd2FpdCBnZXREZWZhdWx0Q2VydGlmaWNhdGVUZW1wbGF0ZSgpO1xuXG4gICAgICBpZiAoIWRlZmF1bHRUZW1wbGF0ZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdObyBjZXJ0aWZpY2F0ZSB0ZW1wbGF0ZSBmb3VuZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRlbXBsYXRlID0gZGVmYXVsdFRlbXBsYXRlIGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgY2VydGlmaWNhdGVcbiAgICBjb25zdCBjZXJ0aWZpY2F0ZSA9IGF3YWl0IGdlbmVyYXRlQ2VydGlmaWNhdGUoe1xuICAgICAgdGVtcGxhdGVJZDogdGVtcGxhdGUuaWQgYXMgc3RyaW5nLFxuICAgICAgdXNlcklkLFxuICAgICAgY291cnNlSWQsXG4gICAgICB2YWx1ZXM6IHtcbiAgICAgICAgc3R1ZGVudE5hbWU6ICh1c2VyRGF0YS5kaXNwbGF5TmFtZSBhcyBzdHJpbmcpIHx8ICh1c2VyRGF0YS5lbWFpbCBhcyBzdHJpbmcpIHx8ICdTdHVkZW50JyxcbiAgICAgICAgY291cnNlTmFtZTogY291cnNlTmFtZSB8fCAoY291cnNlRGF0YS50aXRsZSBhcyBzdHJpbmcpIHx8ICdDb3Vyc2UnLFxuICAgICAgICBjb21wbGV0aW9uRGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBpc3N1ZXJOYW1lOiAoY291cnNlRGF0YS5pbnN0cnVjdG9yTmFtZSBhcyBzdHJpbmcpIHx8ICdJbnN0cnVjdG9yJyxcbiAgICAgICAgaXNzdWVyVGl0bGU6IChjb3Vyc2VEYXRhLmluc3RydWN0b3JUaXRsZSBhcyBzdHJpbmcpIHx8ICdDb3Vyc2UgSW5zdHJ1Y3RvcidcbiAgICB9LFxuICAgICAgaXNQdWJsaWM6IGNvdXJzZURhdGEucHVibGljQ2VydGlmaWNhdGVzID09PSB0cnVlXG4gIH0pO1xuXG4gICAgaWYgKGNlcnRpZmljYXRlKSB7XG4gICAgICBjb25zb2xlLmxvZyhgQ2VydGlmaWNhdGUgJHtjZXJ0aWZpY2F0ZS5pZH0gaXNzdWVkIHN1Y2Nlc3NmdWxseSBmb3IgY291cnNlICR7Y291cnNlSWR9IHRvIHVzZXIgJHt1c2VySWR9YCk7XG4gIH1cbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaXNzdWluZyBjZXJ0aWZpY2F0ZTonLCBlcnJvcik7XG59XG59O1xuXG4vKipcbiAqIENoZWNrIGZvciBpbmFjdGl2ZSBlbnJvbGxtZW50cyBhbmQgY3JlYXRlIHJlbWluZGVyc1xuICovXG5leHBvcnQgY29uc3QgY2hlY2tJbmFjdGl2ZUVucm9sbG1lbnRzID0gYXN5bmMgKCk6IFByb21pc2U8bnVtYmVyPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBzZXZlbkRheXNBZ28gPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgIGNvbnN0IHNldmVuRGF5c0Fnb1N0ciA9IHNldmVuRGF5c0Fnby50b0lTT1N0cmluZygpO1xuXG4gICAgLy8gUXVlcnkgZm9yIHByb2dyZXNzIHJlY29yZHMgdGhhdCBoYXZlbid0IGJlZW4gYWNjZXNzZWQgaW4gYSB3aGlsZVxuICAgIGNvbnN0IHByb2dyZXNzUXVlcnkgPSBxdWVyeShcbiAgICAgIGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAnY291cnNlUHJvZ3Jlc3MnKSxcbiAgICAgIHdoZXJlKCdsYXN0QWNjZXNzRGF0ZScsICc8PScsIHNldmVuRGF5c0Fnb1N0ciksXG4gICAgICB3aGVyZSgnY29tcGxldGVkJywgJz09JywgZmFsc2UpXG4gICAgKTtcblxuICAgIGNvbnN0IHByb2dyZXNzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHByb2dyZXNzUXVlcnkpO1xuXG4gICAgbGV0IGNvdW50ID0gMDtcblxuICAgIC8vIFByb2Nlc3MgZWFjaCBpbmFjdGl2ZSBlbnJvbGxtZW50XG4gICAgZm9yIChjb25zdCBwcm9ncmVzc0RvYyBvZiBwcm9ncmVzc1NuYXBzaG90LmRvY3MpIHtcbiAgICAgIGNvbnN0IHByb2dyZXNzID0gcHJvZ3Jlc3NEb2MuZGF0YSgpIGFzIENvdXJzZVByb2dyZXNzO1xuXG4gICAgICAvLyBHZXQgY291cnNlIG5hbWVcbiAgICAgIGNvbnN0IGNvdXJzZVJlZiA9IGRvYyhmaXJlc3RvcmUsICdjb3Vyc2VzJywgcHJvZ3Jlc3MuY291cnNlSWQpO1xuICAgICAgY29uc3QgY291cnNlRG9jID0gYXdhaXQgZ2V0RG9jKGNvdXJzZVJlZik7XG5cbiAgICAgIGlmICghY291cnNlRG9jLmV4aXN0cygpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgICAgY29uc3QgY291cnNlRGF0YSA9IGNvdXJzZURvYy5kYXRhKCk7XG4gICAgICBjb25zdCBjb3Vyc2VOYW1lID0gKGNvdXJzZURhdGEudGl0bGUgYXMgc3RyaW5nKSB8fCAnVW5rbm93biBDb3Vyc2UnO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgZGF5cyBzaW5jZSBsYXN0IGFjY2Vzc1xuICAgICAgY29uc3QgbGFzdEFjY2Vzc0RhdGUgPSBuZXcgRGF0ZShwcm9ncmVzcy5sYXN0QWNjZXNzRGF0ZSk7XG4gICAgICBjb25zdCBkYXlzU2luY2VMYXN0QWNjZXNzID0gTWF0aC5mbG9vcigobm93LmdldFRpbWUoKSAtIGxhc3RBY2Nlc3NEYXRlLmdldFRpbWUoKSkgLyAoMjQgKiA2MCAqIDYwICogMTAwMCkpO1xuXG4gICAgICAvLyBDcmVhdGUgaW5hY3Rpdml0eSByZW1pbmRlclxuICAgICAgYXdhaXQgY3JlYXRlSW5hY3Rpdml0eVJlbWluZGVyKFxuICAgICAgICBwcm9ncmVzcy51c2VySWQsXG4gICAgICAgIHByb2dyZXNzLmNvdXJzZUlkLFxuICAgICAgICBjb3Vyc2VOYW1lLFxuICAgICAgICBkYXlzU2luY2VMYXN0QWNjZXNzXG4gICAgICApO1xuXG4gICAgICBjb3VudCsrO1xuICB9XG5cbiAgICByZXR1cm4gY291bnQ7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIGluYWN0aXZlIGVucm9sbG1lbnRzOicsIGVycm9yKTtcbiAgICByZXR1cm4gMDtcbn1cbn07XG5cbi8qKlxuICogVXBkYXRlIHF1aXogc2NvcmUgZm9yIGEgbGVzc29uXG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVRdWl6U2NvcmUgPSBhc3luYyAoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjb3Vyc2VJZDogc3RyaW5nLFxuICBsZXNzb25JZDogc3RyaW5nLFxuICBzY29yZTogbnVtYmVyXG4pOiBQcm9taXNlPENvdXJzZVByb2dyZXNzPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSBkb2MoZmlyZXN0b3JlLCAnY291cnNlUHJvZ3Jlc3MnLCBgJHt1c2VySWR9XyR7Y291cnNlSWR9YCk7XG4gICAgY29uc3QgcHJvZ3Jlc3NEb2MgPSBhd2FpdCBnZXREb2MocHJvZ3Jlc3NSZWYpO1xuXG4gICAgaWYgKCFwcm9ncmVzc0RvYy5leGlzdHMoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3Vyc2UgcHJvZ3Jlc3Mgbm90IGZvdW5kJyk7XG4gIH1cblxuICAgIGNvbnN0IHByb2dyZXNzID0gcHJvZ3Jlc3NEb2MuZGF0YSgpIGFzIENvdXJzZVByb2dyZXNzO1xuICAgIGNvbnN0IHF1aXpTY29yZXMgPSB7Li4ucHJvZ3Jlc3MucXVpelNjb3JlcywgW2xlc3NvbklkXTogc2NvcmUgfTtcblxuICAgIGF3YWl0IHVwZGF0ZURvYyhwcm9ncmVzc1JlZiwge1xuICAgICAgcXVpelNjb3JlcyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBsYXN0VXBkYXRlZDogc2VydmVyVGltZXN0YW1wKClcbiAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4ucHJvZ3Jlc3MsXG4gICAgICBxdWl6U2NvcmVzLFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICB9IGFzIENvdXJzZVByb2dyZXNzO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBxdWl6IHNjb3JlOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbn1cbn07XG5cbi8qKlxuICogTWFyayBhIGxlc3NvbiBhcyBjb21wbGV0ZWRcbiAqL1xuaW1wb3J0IHsgZ2V0UXVlcnlDbGllbnQgfSBmcm9tICdAL3V0aWxzL3F1ZXJ5Q2xpZW50JztcblxuZXhwb3J0IGNvbnN0IG1hcmtMZXNzb25Db21wbGV0ZWQgPSBhc3luYyAoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjb3Vyc2VJZDogc3RyaW5nLFxuICBtb2R1bGVJZDogc3RyaW5nLFxuICBsZXNzb25JZDogc3RyaW5nLFxuICB0aW1lU3BlbnQ6IG51bWJlciA9IDAsXG4gIHBvc2l0aW9uOiBudW1iZXIgPSAwXG4pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgY29uc3QgcXVlcnlDbGllbnQgPSBnZXRRdWVyeUNsaWVudCgpO1xuICB0cnkge1xuICAgIGNvbnN0IHByb2dyZXNzUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NvdXJzZVByb2dyZXNzJywgYCR7dXNlcklkfV8ke2NvdXJzZUlkfWApO1xuICAgIGNvbnN0IHByb2dyZXNzRG9jID0gYXdhaXQgZ2V0RG9jKHByb2dyZXNzUmVmKTtcblxuICAgIGlmICghcHJvZ3Jlc3NEb2MuZXhpc3RzKCkpIHtcbiAgICAgIC8vIENyZWF0ZSBwcm9ncmVzcyBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgICBhd2FpdCBpbml0aWFsaXplQ291cnNlUHJvZ3Jlc3ModXNlcklkLCBjb3Vyc2VJZCwgJ1Vua25vd24gQ291cnNlJyk7XG4gICAgICByZXR1cm47XG4gIH1cblxuICAgIGNvbnN0IHByb2dyZXNzID0gcHJvZ3Jlc3NEb2MuZGF0YSgpIGFzIENvdXJzZVByb2dyZXNzO1xuICAgIGNvbnN0IGxlc3NvbktleSA9IGAke21vZHVsZUlkfV8ke2xlc3NvbklkfWA7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuXG4gICAgLy8gVXBkYXRlIGxlc3NvbiBwcm9ncmVzc1xuICAgIGNvbnN0IGxlc3NvblByb2dyZXNzID0gcHJvZ3Jlc3MubGVzc29uUHJvZ3Jlc3MgfHwge307XG4gICAgY29uc3QgY3VycmVudExlc3NvblByb2dyZXNzID0gbGVzc29uUHJvZ3Jlc3NbbGVzc29uS2V5XSB8fCB7XG4gICAgICBsZXNzb25JZCxcbiAgICAgIG1vZHVsZUlkLFxuICAgICAgc3RhcnREYXRlOiBub3csXG4gICAgICBsYXN0QWNjZXNzRGF0ZTogbm93LFxuICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgIHRpbWVTcGVudDogMCxcbiAgICAgIHByb2dyZXNzOiAwLFxuICAgICAgbm90ZXM6IFtdLFxuICAgICAgYm9va21hcmtzOiBbXVxuICB9O1xuXG4gICAgLy8gVXBkYXRlIGxlc3NvbiBwcm9ncmVzc1xuICAgIGxlc3NvblByb2dyZXNzW2xlc3NvbktleV0gPSB7XG4gICAgICAuLi5jdXJyZW50TGVzc29uUHJvZ3Jlc3MsXG4gICAgICBjb21wbGV0ZWQ6IHRydWUsXG4gICAgICBjb21wbGV0ZWREYXRlOiBub3csXG4gICAgICBsYXN0QWNjZXNzRGF0ZTogbm93LFxuICAgICAgdGltZVNwZW50OiBjdXJyZW50TGVzc29uUHJvZ3Jlc3MudGltZVNwZW50ICsgdGltZVNwZW50LFxuICAgICAgcHJvZ3Jlc3M6IDEwMCxcbiAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbiB8fCBjdXJyZW50TGVzc29uUHJvZ3Jlc3MucG9zaXRpb25cbiAgfTtcblxuICAgIC8vIFVwZGF0ZSBtb2R1bGUgcHJvZ3Jlc3NcbiAgICBjb25zdCBtb2R1bGVQcm9ncmVzcyA9IHByb2dyZXNzLm1vZHVsZVByb2dyZXNzIHx8IHt9O1xuICAgIGNvbnN0IGN1cnJlbnRNb2R1bGVQcm9ncmVzcyA9IG1vZHVsZVByb2dyZXNzW21vZHVsZUlkXSB8fCB7XG4gICAgICBtb2R1bGVJZCxcbiAgICAgIHN0YXJ0RGF0ZTogbm93LFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5vdyxcbiAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICBwcm9ncmVzczogMCxcbiAgICAgIHRpbWVTcGVudDogMCxcbiAgICAgIGNvbXBsZXRlZExlc3NvbnM6IDAsXG4gICAgICB0b3RhbExlc3NvbnM6IDBcbiAgfTtcblxuICAgIC8vIENvdW50IGNvbXBsZXRlZCBsZXNzb25zIGluIHRoaXMgbW9kdWxlXG4gICAgY29uc3QgY29tcGxldGVkTGVzc29uc0luTW9kdWxlID0gT2JqZWN0LmtleXMobGVzc29uUHJvZ3Jlc3MpXG4gICAgICAuZmlsdGVyKGtleSA9PiBrZXkuc3RhcnRzV2l0aChgJHttb2R1bGVJZH1fYCkgJiYgbGVzc29uUHJvZ3Jlc3Nba2V5XS5jb21wbGV0ZWQpXG4gICAgICAubGVuZ3RoO1xuXG4gICAgLy8gVXBkYXRlIG1vZHVsZSBwcm9ncmVzc1xuICAgIG1vZHVsZVByb2dyZXNzW21vZHVsZUlkXSA9IHtcbiAgICAgIC4uLmN1cnJlbnRNb2R1bGVQcm9ncmVzcyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICB0aW1lU3BlbnQ6IChjdXJyZW50TW9kdWxlUHJvZ3Jlc3MudGltZVNwZW50IHx8IDApICsgdGltZVNwZW50LFxuICAgICAgY29tcGxldGVkTGVzc29uczogY29tcGxldGVkTGVzc29uc0luTW9kdWxlLFxuICAgICAgcHJvZ3Jlc3M6IChjdXJyZW50TW9kdWxlUHJvZ3Jlc3MudG90YWxMZXNzb25zIHx8IDApID4gMFxuICAgICAgICA/IE1hdGgucm91bmQoKGNvbXBsZXRlZExlc3NvbnNJbk1vZHVsZSAvIChjdXJyZW50TW9kdWxlUHJvZ3Jlc3MudG90YWxMZXNzb25zIHx8IDEpKSAqIDEwMClcbiAgICAgICAgOiAwXG4gIH07XG5cbiAgICAvLyBVcGRhdGUgdGhlIHByb2dyZXNzIGRvY3VtZW50XG4gICAgY29uc3QgdXBkYXRlZFByb2dyZXNzID0ge1xuICAgICAgY29tcGxldGVkTGVzc29uczogYXJyYXlVbmlvbihsZXNzb25LZXkpLFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5vdyxcbiAgICAgIHRpbWVTcGVudDogcHJvZ3Jlc3MudGltZVNwZW50ICsgdGltZVNwZW50LFxuICAgICAgbGVzc29uUHJvZ3Jlc3MsXG4gICAgICBtb2R1bGVQcm9ncmVzcyxcbiAgICAgIGxhc3RQb3NpdGlvbjoge1xuICAgICAgICBtb2R1bGVJZCxcbiAgICAgICAgbGVzc29uSWQsXG4gICAgICAgIHBvc2l0aW9uXG4gICAgfSxcbiAgICAgIGxhc3RVcGRhdGVkOiBzZXJ2ZXJUaW1lc3RhbXAoKVxuICB9O1xuXG4gICAgYXdhaXQgdXBkYXRlRG9jKHByb2dyZXNzUmVmLCB1cGRhdGVkUHJvZ3Jlc3MpO1xuXG4gICAgLy8gQ2hlY2sgaWYgYWxsIGxlc3NvbnMgaW4gdGhlIG1vZHVsZSBhcmUgY29tcGxldGVkXG4gICAgYXdhaXQgY2hlY2tNb2R1bGVDb21wbGV0aW9uKHVzZXJJZCwgY291cnNlSWQsIG1vZHVsZUlkKTtcblxuICAgIC8vIFVwZGF0ZSBvdmVyYWxsIHByb2dyZXNzXG4gICAgYXdhaXQgdXBkYXRlT3ZlcmFsbFByb2dyZXNzKHVzZXJJZCwgY291cnNlSWQpO1xuXG4gICAgLy8gSW52YWxpZGF0ZSByZWxldmFudCBxdWVyaWVzIHRvIHRyaWdnZXIgVUkgdXBkYXRlc1xuICAgIHF1ZXJ5Q2xpZW50LmludmFsaWRhdGVRdWVyaWVzKHtcbiAgICAgIHF1ZXJ5S2V5OiBbJ2NvdXJzZVByb2dyZXNzJywgdXNlcklkLCBjb3Vyc2VJZF1cbiAgICB9KTtcbiAgICBxdWVyeUNsaWVudC5pbnZhbGlkYXRlUXVlcmllcyh7XG4gICAgICBxdWVyeUtleTogWydlbnJvbGxlZENvdXJzZXNXaXRoUHJvZ3Jlc3MnLCB1c2VySWRdXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFya2luZyBsZXNzb24gYXMgY29tcGxldGVkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfTtcbn07XG5cbi8qKlxuICogVXBkYXRlIGxlc3NvbiBwcm9ncmVzcyB3aXRob3V0IG1hcmtpbmcgaXQgYXMgY29tcGxldGVkXG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVMZXNzb25UcmFja2luZyA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIG1vZHVsZUlkOiBzdHJpbmcsXG4gIGxlc3NvbklkOiBzdHJpbmcsXG4gIHRpbWVTcGVudDogbnVtYmVyID0gMCxcbiAgcG9zaXRpb246IG51bWJlciA9IDAsXG4gIHByb2dyZXNzUGVyY2VudGFnZTogbnVtYmVyID0gMFxuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSBkb2MoZmlyZXN0b3JlLCAnY291cnNlUHJvZ3Jlc3MnLCBgJHt1c2VySWR9XyR7Y291cnNlSWR9YCk7XG4gICAgY29uc3QgcHJvZ3Jlc3NEb2MgPSBhd2FpdCBnZXREb2MocHJvZ3Jlc3NSZWYpO1xuXG4gICAgaWYgKCFwcm9ncmVzc0RvYy5leGlzdHMoKSkge1xuICAgICAgLy8gQ3JlYXRlIHByb2dyZXNzIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICAgIGF3YWl0IGluaXRpYWxpemVDb3Vyc2VQcm9ncmVzcyh1c2VySWQsIGNvdXJzZUlkLCAnVW5rbm93biBDb3Vyc2UnKTtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBwcm9ncmVzc0RvYy5kYXRhKCkgYXMgQ291cnNlUHJvZ3Jlc3M7XG4gICAgY29uc3QgbGVzc29uS2V5ID0gYCR7bW9kdWxlSWR9XyR7bGVzc29uSWR9YDtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICAvLyBVcGRhdGUgbGVzc29uIHByb2dyZXNzXG4gICAgY29uc3QgbGVzc29uUHJvZ3Jlc3MgPSBwcm9ncmVzcy5sZXNzb25Qcm9ncmVzcyB8fCB7fTtcbiAgICBjb25zdCBjdXJyZW50TGVzc29uUHJvZ3Jlc3MgPSBsZXNzb25Qcm9ncmVzc1tsZXNzb25LZXldIHx8IHtcbiAgICAgIGxlc3NvbklkLFxuICAgICAgbW9kdWxlSWQsXG4gICAgICBzdGFydERhdGU6IG5vdyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgdGltZVNwZW50OiAwLFxuICAgICAgcHJvZ3Jlc3M6IDAsXG4gICAgICBub3RlczogW10sXG4gICAgICBib29rbWFya3M6IFtdXG4gIH07XG5cbiAgICAvLyBJZiB0aGlzIGlzIHRoZSBmaXJzdCB0aW1lIGFjY2Vzc2luZyB0aGlzIGxlc3Nvbiwgc2V0IHRoZSBzdGFydCBkYXRlXG4gICAgaWYgKCFjdXJyZW50TGVzc29uUHJvZ3Jlc3Muc3RhcnREYXRlKSB7XG4gICAgICBjdXJyZW50TGVzc29uUHJvZ3Jlc3Muc3RhcnREYXRlID0gbm93O1xuICB9XG5cbiAgICAvLyBVcGRhdGUgbGVzc29uIHByb2dyZXNzXG4gICAgbGVzc29uUHJvZ3Jlc3NbbGVzc29uS2V5XSA9IHtcbiAgICAgIC4uLmN1cnJlbnRMZXNzb25Qcm9ncmVzcyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICB0aW1lU3BlbnQ6IGN1cnJlbnRMZXNzb25Qcm9ncmVzcy50aW1lU3BlbnQgKyB0aW1lU3BlbnQsXG4gICAgICBwcm9ncmVzczogTWF0aC5tYXgocHJvZ3Jlc3NQZXJjZW50YWdlLCBjdXJyZW50TGVzc29uUHJvZ3Jlc3MucHJvZ3Jlc3MgfHwgMCksXG4gICAgICBwb3NpdGlvbjogcG9zaXRpb25cbiAgfTtcblxuICAgIC8vIFVwZGF0ZSBtb2R1bGUgcHJvZ3Jlc3NcbiAgICBjb25zdCBtb2R1bGVQcm9ncmVzcyA9IHByb2dyZXNzLm1vZHVsZVByb2dyZXNzIHx8IHt9O1xuICAgIGNvbnN0IGN1cnJlbnRNb2R1bGVQcm9ncmVzcyA9IG1vZHVsZVByb2dyZXNzW21vZHVsZUlkXSB8fCB7XG4gICAgICBtb2R1bGVJZCxcbiAgICAgIHN0YXJ0RGF0ZTogbm93LFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5vdyxcbiAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICBwcm9ncmVzczogMCxcbiAgICAgIHRpbWVTcGVudDogMCxcbiAgICAgIGNvbXBsZXRlZExlc3NvbnM6IDAsXG4gICAgICB0b3RhbExlc3NvbnM6IDBcbiAgfTtcblxuICAgIC8vIElmIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgYWNjZXNzaW5nIHRoaXMgbW9kdWxlLCBzZXQgdGhlIHN0YXJ0IGRhdGVcbiAgICBpZiAoIWN1cnJlbnRNb2R1bGVQcm9ncmVzcy5zdGFydERhdGUpIHtcbiAgICAgIGN1cnJlbnRNb2R1bGVQcm9ncmVzcy5zdGFydERhdGUgPSBub3c7XG4gIH1cblxuICAgIC8vIENvdW50IGNvbXBsZXRlZCBsZXNzb25zIGluIHRoaXMgbW9kdWxlXG4gICAgY29uc3QgY29tcGxldGVkTGVzc29uc0luTW9kdWxlID0gT2JqZWN0LmtleXMobGVzc29uUHJvZ3Jlc3MpXG4gICAgICAuZmlsdGVyKGtleSA9PiBrZXkuc3RhcnRzV2l0aChgJHttb2R1bGVJZH1fYCkgJiYgbGVzc29uUHJvZ3Jlc3Nba2V5XS5jb21wbGV0ZWQpXG4gICAgICAubGVuZ3RoO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGF2ZXJhZ2UgcHJvZ3Jlc3MgZm9yIGluY29tcGxldGUgbGVzc29uc1xuICAgIGNvbnN0IGluY29tcGxldGVMZXNzb25zID0gT2JqZWN0LmtleXMobGVzc29uUHJvZ3Jlc3MpXG4gICAgICAuZmlsdGVyKGtleSA9PiBrZXkuc3RhcnRzV2l0aChgJHttb2R1bGVJZH1fYCkgJiYgIWxlc3NvblByb2dyZXNzW2tleV0uY29tcGxldGVkKTtcblxuICAgIGNvbnN0IGluY29tcGxldGVQcm9ncmVzcyA9IGluY29tcGxldGVMZXNzb25zLnJlZHVjZShcbiAgICAgIChzdW0sIGtleSkgPT4gc3VtICsgKGxlc3NvblByb2dyZXNzW2tleV0ucHJvZ3Jlc3MgfHwgMCksXG4gICAgICAwXG4gICAgKTtcblxuICAgIGNvbnN0IGF2ZXJhZ2VJbmNvbXBsZXRlUHJvZ3Jlc3MgPSBpbmNvbXBsZXRlTGVzc29ucy5sZW5ndGggPiAwXG4gICAgICA/IGluY29tcGxldGVQcm9ncmVzcyAvIGluY29tcGxldGVMZXNzb25zLmxlbmd0aFxuICAgICAgOiAwO1xuXG4gICAgLy8gQ2FsY3VsYXRlIG92ZXJhbGwgbW9kdWxlIHByb2dyZXNzXG4gICAgY29uc3QgdG90YWxMZXNzb25zID0gY3VycmVudE1vZHVsZVByb2dyZXNzLnRvdGFsTGVzc29ucyB8fCAxO1xuICAgIGNvbnN0IG1vZHVsZVByb2dyZXNzUGVyY2VudGFnZSA9IChcbiAgICAgIChjb21wbGV0ZWRMZXNzb25zSW5Nb2R1bGUgKiAxMDApICsgLy8gQ29tcGxldGVkIGxlc3NvbnMgY291bnQgYXMgMTAwJVxuICAgICAgKCh0b3RhbExlc3NvbnMgLSBjb21wbGV0ZWRMZXNzb25zSW5Nb2R1bGUpICogYXZlcmFnZUluY29tcGxldGVQcm9ncmVzcyAvIDEwMCkgLy8gQWRkIHBhcnRpYWwgcHJvZ3Jlc3NcbiAgICApIC8gdG90YWxMZXNzb25zO1xuXG4gICAgLy8gVXBkYXRlIG1vZHVsZSBwcm9ncmVzc1xuICAgIG1vZHVsZVByb2dyZXNzW21vZHVsZUlkXSA9IHtcbiAgICAgIC4uLmN1cnJlbnRNb2R1bGVQcm9ncmVzcyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICB0aW1lU3BlbnQ6IChjdXJyZW50TW9kdWxlUHJvZ3Jlc3MudGltZVNwZW50IHx8IDApICsgdGltZVNwZW50LFxuICAgICAgY29tcGxldGVkTGVzc29uczogY29tcGxldGVkTGVzc29uc0luTW9kdWxlLFxuICAgICAgcHJvZ3Jlc3M6IE1hdGgucm91bmQobW9kdWxlUHJvZ3Jlc3NQZXJjZW50YWdlKVxuICB9O1xuXG4gICAgLy8gVXBkYXRlIHRoZSBwcm9ncmVzcyBkb2N1bWVudFxuICAgIGNvbnN0IHVwZGF0ZWRQcm9ncmVzcyA9IHtcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICB0aW1lU3BlbnQ6IHByb2dyZXNzLnRpbWVTcGVudCArIHRpbWVTcGVudCxcbiAgICAgIGxlc3NvblByb2dyZXNzLFxuICAgICAgbW9kdWxlUHJvZ3Jlc3MsXG4gICAgICBsYXN0UG9zaXRpb246IHtcbiAgICAgICAgbW9kdWxlSWQsXG4gICAgICAgIGxlc3NvbklkLFxuICAgICAgICBwb3NpdGlvblxuICAgIH0sXG4gICAgICBsYXN0VXBkYXRlZDogc2VydmVyVGltZXN0YW1wKClcbiAgfTtcblxuICAgIGF3YWl0IHVwZGF0ZURvYyhwcm9ncmVzc1JlZiwgdXBkYXRlZFByb2dyZXNzKTtcblxuICAgIC8vIFVwZGF0ZSBvdmVyYWxsIHByb2dyZXNzIHdpdGhvdXQgbWFya2luZyBhbnl0aGluZyBhcyBjb21wbGV0ZWRcbiAgICBhd2FpdCB1cGRhdGVPdmVyYWxsUHJvZ3Jlc3NDYWxjdWxhdGlvbih1c2VySWQsIGNvdXJzZUlkKTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgbGVzc29uIHRyYWNraW5nOicsIGVycm9yKTtcbn1cbn07XG5cbi8qKlxuICogVXBkYXRlIG92ZXJhbGwgcHJvZ3Jlc3MgY2FsY3VsYXRpb24gd2l0aG91dCBtYXJraW5nIGFueXRoaW5nIGFzIGNvbXBsZXRlZFxuICovXG5jb25zdCB1cGRhdGVPdmVyYWxsUHJvZ3Jlc3NDYWxjdWxhdGlvbiA9IGFzeW5jICh1c2VySWQ6IHN0cmluZywgY291cnNlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHByb2dyZXNzUmVmID0gZG9jKGZpcmVzdG9yZSwgJ2NvdXJzZVByb2dyZXNzJywgYCR7dXNlcklkfV8ke2NvdXJzZUlkfWApO1xuICAgIGNvbnN0IHByb2dyZXNzRG9jID0gYXdhaXQgZ2V0RG9jKHByb2dyZXNzUmVmKTtcblxuICAgIGlmICghcHJvZ3Jlc3NEb2MuZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBwcm9ncmVzc0RvYy5kYXRhKCkgYXMgQ291cnNlUHJvZ3Jlc3M7XG5cbiAgICAvLyBDYWxjdWxhdGUgb3ZlcmFsbCBwcm9ncmVzcyBiYXNlZCBvbiBtb2R1bGUgcHJvZ3Jlc3NcbiAgICBjb25zdCBtb2R1bGVQcm9ncmVzc1ZhbHVlcyA9IE9iamVjdC52YWx1ZXMocHJvZ3Jlc3MubW9kdWxlUHJvZ3Jlc3MgfHwge30pO1xuXG4gICAgaWYgKG1vZHVsZVByb2dyZXNzVmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICB9XG5cbiAgICBjb25zdCBvdmVyYWxsUHJvZ3Jlc3MgPSBNYXRoLnJvdW5kKFxuICAgICAgbW9kdWxlUHJvZ3Jlc3NWYWx1ZXMucmVkdWNlKChzdW0sIG1vZHVsZSkgPT4gc3VtICsgbW9kdWxlLnByb2dyZXNzLCAwKSAvIG1vZHVsZVByb2dyZXNzVmFsdWVzLmxlbmd0aFxuICAgICk7XG5cbiAgICAvLyBVcGRhdGUgcHJvZ3Jlc3NcbiAgICBhd2FpdCB1cGRhdGVEb2MocHJvZ3Jlc3NSZWYsIHtcbiAgICAgIG92ZXJhbGxQcm9ncmVzcyxcbiAgICAgIGxhc3RVcGRhdGVkOiBzZXJ2ZXJUaW1lc3RhbXAoKVxuICB9KTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgb3ZlcmFsbCBwcm9ncmVzcyBjYWxjdWxhdGlvbjonLCBlcnJvcik7XG59XG59O1xuXG4vKipcbiAqIEFkZCBhIGJvb2ttYXJrIHRvIGEgbGVzc29uXG4gKi9cbmV4cG9ydCBjb25zdCBhZGRMZXNzb25Cb29rbWFyayA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIG1vZHVsZUlkOiBzdHJpbmcsXG4gIGxlc3NvbklkOiBzdHJpbmcsXG4gIHBvc2l0aW9uOiBudW1iZXIsXG4gIG5vdGU6IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSBkb2MoZmlyZXN0b3JlLCAnY291cnNlUHJvZ3Jlc3MnLCBgJHt1c2VySWR9XyR7Y291cnNlSWR9YCk7XG4gICAgY29uc3QgcHJvZ3Jlc3NEb2MgPSBhd2FpdCBnZXREb2MocHJvZ3Jlc3NSZWYpO1xuXG4gICAgaWYgKCFwcm9ncmVzc0RvYy5leGlzdHMoKSkge1xuICAgICAgLy8gQ3JlYXRlIHByb2dyZXNzIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICAgIGF3YWl0IGluaXRpYWxpemVDb3Vyc2VQcm9ncmVzcyh1c2VySWQsIGNvdXJzZUlkLCAnVW5rbm93biBDb3Vyc2UnKTtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBwcm9ncmVzc0RvYy5kYXRhKCkgYXMgQ291cnNlUHJvZ3Jlc3M7XG4gICAgY29uc3QgbGVzc29uS2V5ID0gYCR7bW9kdWxlSWR9XyR7bGVzc29uSWR9YDtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICAvLyBVcGRhdGUgbGVzc29uIHByb2dyZXNzXG4gICAgY29uc3QgbGVzc29uUHJvZ3Jlc3MgPSBwcm9ncmVzcy5sZXNzb25Qcm9ncmVzcyB8fCB7fTtcbiAgICBjb25zdCBjdXJyZW50TGVzc29uUHJvZ3Jlc3MgPSBsZXNzb25Qcm9ncmVzc1tsZXNzb25LZXldIHx8IHtcbiAgICAgIGxlc3NvbklkLFxuICAgICAgbW9kdWxlSWQsXG4gICAgICBzdGFydERhdGU6IG5vdyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgdGltZVNwZW50OiAwLFxuICAgICAgcHJvZ3Jlc3M6IDAsXG4gICAgICBub3RlczogW10sXG4gICAgICBib29rbWFya3M6IFtdXG4gIH07XG5cbiAgICAvLyBBZGQgYm9va21hcmtcbiAgICBjb25zdCBib29rbWFya3MgPSBjdXJyZW50TGVzc29uUHJvZ3Jlc3MuYm9va21hcmtzIHx8IFtdO1xuICAgIGNvbnN0IG5ld0Jvb2ttYXJrID0ge1xuICAgICAgaWQ6IGBib29rbWFya18ke0RhdGUubm93KCl9YCxcbiAgICAgIHBvc2l0aW9uLFxuICAgICAgbm90ZSxcbiAgICAgIGNyZWF0ZWRBdDogbm93XG4gIH07XG5cbiAgICAvLyBVcGRhdGUgbGVzc29uIHByb2dyZXNzXG4gICAgbGVzc29uUHJvZ3Jlc3NbbGVzc29uS2V5XSA9IHtcbiAgICAgIC4uLmN1cnJlbnRMZXNzb25Qcm9ncmVzcyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICBib29rbWFya3M6IFsuLi5ib29rbWFya3MsIG5ld0Jvb2ttYXJrXVxuICB9O1xuXG4gICAgLy8gVXBkYXRlIHRoZSBwcm9ncmVzcyBkb2N1bWVudFxuICAgIGF3YWl0IHVwZGF0ZURvYyhwcm9ncmVzc1JlZiwge1xuICAgICAgbGVzc29uUHJvZ3Jlc3MsXG4gICAgICBsYXN0QWNjZXNzRGF0ZTogbm93LFxuICAgICAgbGFzdFVwZGF0ZWQ6IHNlcnZlclRpbWVzdGFtcCgpXG4gIH0pO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhZGRpbmcgbGVzc29uIGJvb2ttYXJrOicsIGVycm9yKTtcbn1cbn07XG5cbi8qKlxuICogQWRkIGEgbm90ZSB0byBhIGxlc3NvblxuICovXG5leHBvcnQgY29uc3QgYWRkTGVzc29uTm90ZSA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIG1vZHVsZUlkOiBzdHJpbmcsXG4gIGxlc3NvbklkOiBzdHJpbmcsXG4gIG5vdGU6IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSBkb2MoZmlyZXN0b3JlLCAnY291cnNlUHJvZ3Jlc3MnLCBgJHt1c2VySWR9XyR7Y291cnNlSWR9YCk7XG4gICAgY29uc3QgcHJvZ3Jlc3NEb2MgPSBhd2FpdCBnZXREb2MocHJvZ3Jlc3NSZWYpO1xuXG4gICAgaWYgKCFwcm9ncmVzc0RvYy5leGlzdHMoKSkge1xuICAgICAgLy8gQ3JlYXRlIHByb2dyZXNzIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICAgIGF3YWl0IGluaXRpYWxpemVDb3Vyc2VQcm9ncmVzcyh1c2VySWQsIGNvdXJzZUlkLCAnVW5rbm93biBDb3Vyc2UnKTtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBwcm9ncmVzc0RvYy5kYXRhKCkgYXMgQ291cnNlUHJvZ3Jlc3M7XG4gICAgY29uc3QgbGVzc29uS2V5ID0gYCR7bW9kdWxlSWR9XyR7bGVzc29uSWR9YDtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICAvLyBVcGRhdGUgbGVzc29uIHByb2dyZXNzXG4gICAgY29uc3QgbGVzc29uUHJvZ3Jlc3MgPSBwcm9ncmVzcy5sZXNzb25Qcm9ncmVzcyB8fCB7fTtcbiAgICBjb25zdCBjdXJyZW50TGVzc29uUHJvZ3Jlc3MgPSBsZXNzb25Qcm9ncmVzc1tsZXNzb25LZXldIHx8IHtcbiAgICAgIGxlc3NvbklkLFxuICAgICAgbW9kdWxlSWQsXG4gICAgICBzdGFydERhdGU6IG5vdyxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBub3csXG4gICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgdGltZVNwZW50OiAwLFxuICAgICAgcHJvZ3Jlc3M6IDAsXG4gICAgICBub3RlczogW10sXG4gICAgICBib29rbWFya3M6IFtdXG4gIH07XG5cbiAgICAvLyBBZGQgbm90ZVxuICAgIGNvbnN0IG5vdGVzID0gY3VycmVudExlc3NvblByb2dyZXNzLm5vdGVzIHx8IFtdO1xuXG4gICAgLy8gVXBkYXRlIGxlc3NvbiBwcm9ncmVzc1xuICAgIGxlc3NvblByb2dyZXNzW2xlc3NvbktleV0gPSB7XG4gICAgICAuLi5jdXJyZW50TGVzc29uUHJvZ3Jlc3MsXG4gICAgICBsYXN0QWNjZXNzRGF0ZTogbm93LFxuICAgICAgbm90ZXM6IFsuLi5ub3Rlcywgbm90ZV1cbiAgfTtcblxuICAgIC8vIFVwZGF0ZSB0aGUgcHJvZ3Jlc3MgZG9jdW1lbnRcbiAgICBhd2FpdCB1cGRhdGVEb2MocHJvZ3Jlc3NSZWYsIHtcbiAgICAgIGxlc3NvblByb2dyZXNzLFxuICAgICAgbGFzdEFjY2Vzc0RhdGU6IG5vdyxcbiAgICAgIGxhc3RVcGRhdGVkOiBzZXJ2ZXJUaW1lc3RhbXAoKVxuICB9KTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgYWRkaW5nIGxlc3NvbiBub3RlOicsIGVycm9yKTtcbn1cbn07XG5cbi8qKlxuICogQ2hlY2sgaWYgYWxsIGxlc3NvbnMgaW4gYSBtb2R1bGUgYXJlIGNvbXBsZXRlZFxuICovXG5jb25zdCBjaGVja01vZHVsZUNvbXBsZXRpb24gPSBhc3luYyAodXNlcklkOiBzdHJpbmcsIGNvdXJzZUlkOiBzdHJpbmcsIG1vZHVsZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgdGhlIG1vZHVsZSBkYXRhXG4gICAgY29uc3QgbW9kdWxlUmVmID0gZG9jKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlcy8ke21vZHVsZUlkfWApO1xuICAgIGNvbnN0IG1vZHVsZVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jKG1vZHVsZVJlZik7XG5cbiAgICBpZiAoIW1vZHVsZVNuYXBzaG90LmV4aXN0cygpKSB7XG4gICAgICByZXR1cm47XG4gIH1cblxuICAgIC8vIEdldCBtb2R1bGUgZGF0YVxuICAgIC8vIGNvbnN0IG1vZHVsZURhdGEgPSBtb2R1bGVTbmFwc2hvdC5kYXRhKCkgYXMgTW9kdWxlOyAvLyBtb2R1bGVEYXRhIGlzIG5vdCB1c2VkXG5cbiAgICAvLyBHZXQgYWxsIGxlc3NvbnMgZm9yIHRoZSBtb2R1bGVcbiAgICBjb25zdCBsZXNzb25zUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH0vbGVzc29uc2ApO1xuICAgIGNvbnN0IGxlc3NvbnNRdWVyeSA9IHF1ZXJ5KGxlc3NvbnNSZWYsIHdoZXJlKCdzdGF0dXMnLCAnPT0nLCAncHVibGlzaGVkJykpO1xuICAgIGNvbnN0IGxlc3NvbnNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MobGVzc29uc1F1ZXJ5KTtcblxuICAgIGNvbnN0IGxlc3NvbklkcyA9IGxlc3NvbnNTbmFwc2hvdC5kb2NzLm1hcChkb2MgPT4gZG9jLmlkKTtcblxuICAgIC8vIEdldCB0aGUgdXNlcidzIHByb2dyZXNzXG4gICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSBkb2MoZmlyZXN0b3JlLCBgdXNlcnMvJHt1c2VySWR9L2NvdXJzZVByb2dyZXNzLyR7Y291cnNlSWR9YCk7XG4gICAgY29uc3QgcHJvZ3Jlc3NTbmFwc2hvdCA9IGF3YWl0IGdldERvYyhwcm9ncmVzc1JlZik7XG5cbiAgICBpZiAoIXByb2dyZXNzU25hcHNob3QuZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgY29uc3QgcHJvZ3Jlc3NEYXRhID0gcHJvZ3Jlc3NTbmFwc2hvdC5kYXRhKCkgYXMgQ291cnNlUHJvZ3Jlc3M7XG5cbiAgICAvLyBDaGVjayBpZiBhbGwgbGVzc29ucyBhcmUgY29tcGxldGVkXG4gICAgY29uc3QgYWxsTGVzc29uc0NvbXBsZXRlZCA9IGxlc3Nvbklkcy5ldmVyeShsZXNzb25JZCA9PlxuICAgICAgcHJvZ3Jlc3NEYXRhLmNvbXBsZXRlZExlc3NvbnMuaW5jbHVkZXMoYCR7bW9kdWxlSWR9XyR7bGVzc29uSWR9YClcbiAgICApO1xuXG4gICAgLy8gSWYgYWxsIGxlc3NvbnMgYXJlIGNvbXBsZXRlZCBhbmQgdGhlIG1vZHVsZSBpcyBub3QgYWxyZWFkeSBtYXJrZWQgYXMgY29tcGxldGVkXG4gICAgaWYgKGFsbExlc3NvbnNDb21wbGV0ZWQgJiYgIXByb2dyZXNzRGF0YS5jb21wbGV0ZWRNb2R1bGVzLmluY2x1ZGVzKG1vZHVsZUlkKSkge1xuICAgICAgYXdhaXQgdXBkYXRlRG9jKHByb2dyZXNzUmVmLCB7XG4gICAgICAgIGNvbXBsZXRlZE1vZHVsZXM6IGFycmF5VW5pb24obW9kdWxlSWQpLFxuICAgICAgICBsYXN0VXBkYXRlZDogc2VydmVyVGltZXN0YW1wKClcbiAgICB9KTtcbiAgfVxufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBtb2R1bGUgY29tcGxldGlvbjonLCBlcnJvcik7XG59XG59O1xuXG4vKipcbiAqIFVwZGF0ZSBvdmVyYWxsIGNvdXJzZSBwcm9ncmVzc1xuICovXG5jb25zdCB1cGRhdGVPdmVyYWxsUHJvZ3Jlc3MgPSBhc3luYyAodXNlcklkOiBzdHJpbmcsIGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgYWxsIHB1Ymxpc2hlZCBsZXNzb25zIGluIHRoZSBjb3Vyc2VcbiAgICBjb25zdCBtb2R1bGVzUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXNgKTtcbiAgICBjb25zdCBtb2R1bGVzUXVlcnkgPSBxdWVyeShtb2R1bGVzUmVmLCB3aGVyZSgnc3RhdHVzJywgJz09JywgJ3B1Ymxpc2hlZCcpKTtcbiAgICBjb25zdCBtb2R1bGVzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKG1vZHVsZXNRdWVyeSk7XG5cbiAgICBsZXQgdG90YWxMZXNzb25zID0gMDtcbiAgICBjb25zdCBtb2R1bGVJZHM6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBDb3VudCB0b3RhbCBsZXNzb25zXG4gICAgZm9yIChjb25zdCBtb2R1bGVEb2Mgb2YgbW9kdWxlc1NuYXBzaG90LmRvY3MpIHtcbiAgICAgIG1vZHVsZUlkcy5wdXNoKG1vZHVsZURvYy5pZCk7XG5cbiAgICAgIGNvbnN0IGxlc3NvbnNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlcy8ke21vZHVsZURvYy5pZH0vbGVzc29uc2ApO1xuICAgICAgY29uc3QgbGVzc29uc1F1ZXJ5ID0gcXVlcnkobGVzc29uc1JlZiwgd2hlcmUoJ3N0YXR1cycsICc9PScsICdwdWJsaXNoZWQnKSk7XG4gICAgICBjb25zdCBsZXNzb25zU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGxlc3NvbnNRdWVyeSk7XG5cbiAgICAgIHRvdGFsTGVzc29ucyArPSBsZXNzb25zU25hcHNob3Quc2l6ZTtcbiAgfVxuXG4gICAgLy8gR2V0IHVzZXIgcHJvZ3Jlc3NcbiAgICBjb25zdCBwcm9ncmVzc1JlZiA9IGRvYyhmaXJlc3RvcmUsIGB1c2Vycy8ke3VzZXJJZH0vY291cnNlUHJvZ3Jlc3MvJHtjb3Vyc2VJZH1gKTtcbiAgICBjb25zdCBwcm9ncmVzc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jKHByb2dyZXNzUmVmKTtcblxuICAgIGlmICghcHJvZ3Jlc3NTbmFwc2hvdC5leGlzdHMoKSkge1xuICAgICAgcmV0dXJuO1xuICB9XG5cbiAgICBjb25zdCBwcm9ncmVzc0RhdGEgPSBwcm9ncmVzc1NuYXBzaG90LmRhdGEoKSBhcyBDb3Vyc2VQcm9ncmVzcztcbiAgICBjb25zdCBjb21wbGV0ZWRMZXNzb25zID0gcHJvZ3Jlc3NEYXRhLmNvbXBsZXRlZExlc3NvbnMubGVuZ3RoO1xuXG4gICAgLy8gQ2FsY3VsYXRlIHByb2dyZXNzIHBlcmNlbnRhZ2VcbiAgICBjb25zdCBvdmVyYWxsUHJvZ3Jlc3MgPSB0b3RhbExlc3NvbnMgPiAwID8gTWF0aC5yb3VuZCgoY29tcGxldGVkTGVzc29ucyAvIHRvdGFsTGVzc29ucykgKiAxMDApIDogMDtcblxuICAgIC8vIENoZWNrIGlmIGFsbCBtb2R1bGVzIGFyZSBjb21wbGV0ZWRcbiAgICBjb25zdCBhbGxNb2R1bGVzQ29tcGxldGVkID0gbW9kdWxlSWRzLmV2ZXJ5KG1vZHVsZUlkID0+XG4gICAgICBwcm9ncmVzc0RhdGEuY29tcGxldGVkTW9kdWxlcy5pbmNsdWRlcyhtb2R1bGVJZClcbiAgICApO1xuXG4gICAgLy8gRGF0YSBmb3IgdGhlIGNvdXJzZVByb2dyZXNzIGRvY3VtZW50ICh1c2Vycy97dXNlcklkfS9jb3Vyc2VQcm9ncmVzcy97Y291cnNlSWR9KVxuICAgIGNvbnN0IGNvdXJzZVByb2dyZXNzVXBkYXRlRGF0YSA9IHtcbiAgICAgIG92ZXJhbGxQcm9ncmVzcyxcbiAgICAgIGNvbXBsZXRlZDogYWxsTW9kdWxlc0NvbXBsZXRlZCAmJiBvdmVyYWxsUHJvZ3Jlc3MgPT09IDEwMCxcbiAgICAgIGxhc3RVcGRhdGVkOiBzZXJ2ZXJUaW1lc3RhbXAoKVxuICAgIH07XG4gICAgYXdhaXQgdXBkYXRlRG9jKHByb2dyZXNzUmVmLCBjb3Vyc2VQcm9ncmVzc1VwZGF0ZURhdGEpO1xuXG4gICAgLy8gQWxzbyB1cGRhdGUgdGhlIGNvcnJlc3BvbmRpbmcgZW5yb2xsbWVudCBkb2N1bWVudCBpbiB1c2Vycy97dXNlcklkfS9lbnJvbGxtZW50cy97Y291cnNlSWR9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVucm9sbG1lbnREb2NSZWYgPSBkb2MoZmlyZXN0b3JlLCBgdXNlcnMvJHt1c2VySWR9L2Vucm9sbG1lbnRzLyR7Y291cnNlSWR9YCk7XG4gICAgICBjb25zdCBlbnJvbGxtZW50U25hcCA9IGF3YWl0IGdldERvYyhlbnJvbGxtZW50RG9jUmVmKTtcbiAgICAgIGxldCBjdXJyZW50RW5yb2xsbWVudFN0YXR1czogQ291cnNlRW5yb2xsbWVudFsnc3RhdHVzJ10gPSAnYWN0aXZlJzsgLy8gRGVmYXVsdCB0byAnYWN0aXZlJ1xuXG4gICAgICBpZiAoZW5yb2xsbWVudFNuYXAuZXhpc3RzKCkpIHtcbiAgICAgICAgY29uc3QgZW5yb2xsbWVudERhdGEgPSBlbnJvbGxtZW50U25hcC5kYXRhKCkgYXMgUGFydGlhbDxDb3Vyc2VFbnJvbGxtZW50PjtcbiAgICAgICAgY3VycmVudEVucm9sbG1lbnRTdGF0dXMgPSBlbnJvbGxtZW50RGF0YS5zdGF0dXMgfHwgJ2FjdGl2ZSc7XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSB0aGUgbWFpbiBlbnJvbGxtZW50IGRvY3VtZW50IHdpdGggdGhlIHNhbWUgcHJvZ3Jlc3MuXG4gICAgICBhd2FpdCB1cGRhdGVEb2MoZW5yb2xsbWVudERvY1JlZiwge1xuICAgICAgICBwcm9ncmVzczogb3ZlcmFsbFByb2dyZXNzLCAvLyBTeW5jIHRoZSBwcm9ncmVzcyB2YWx1ZVxuICAgICAgICBzdGF0dXM6IChhbGxNb2R1bGVzQ29tcGxldGVkICYmIG92ZXJhbGxQcm9ncmVzcyA9PT0gMTAwKSA/ICdjb21wbGV0ZWQnIDogY3VycmVudEVucm9sbG1lbnRTdGF0dXMsIC8vIFVzZSBmZXRjaGVkIHN0YXR1c1xuICAgICAgICBsYXN0QWNjZXNzZWRBdDogc2VydmVyVGltZXN0YW1wKCksIC8vIEtlZXAgbGFzdEFjY2Vzc2VkQXQgZnJlc2hcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVucm9sbG1lbnRFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgdXBkYXRpbmcgZW5yb2xsbWVudCBkb2N1bWVudCBmb3IgdXNlciAke3VzZXJJZH0sIGNvdXJzZSAke2NvdXJzZUlkfTpgLCBlbnJvbGxtZW50RXJyb3IpO1xuICAgICAgLy8gRGVjaWRlIGlmIHRoaXMgZXJyb3Igc2hvdWxkIHByb3BhZ2F0ZSBvciBiZSBoYW5kbGVkIHNpbGVudGx5XG4gICAgfVxuXG4gICAgLy8gSWYgY291cnNlIGlzIGNvbXBsZXRlZCwgdXBkYXRlIHVzZXIgc3RhdHNcbiAgICBpZiAoYWxsTW9kdWxlc0NvbXBsZXRlZCAmJiBvdmVyYWxsUHJvZ3Jlc3MgPT09IDEwMCAmJiAhcHJvZ3Jlc3NEYXRhLmNvbXBsZXRlZCkge1xuICAgICAgLy8gVXBkYXRlIHVzZXIgc3RhdHNcbiAgICAgIGNvbnN0IHVzZXJTdGF0c1JlZiA9IGRvYyhmaXJlc3RvcmUsIGB1c2Vycy8ke3VzZXJJZH0vc3RhdHMvY291cnNlc2ApO1xuICAgICAgY29uc3QgdXNlclN0YXRzU25hcHNob3QgPSBhd2FpdCBnZXREb2ModXNlclN0YXRzUmVmKTtcblxuICAgICAgaWYgKHVzZXJTdGF0c1NuYXBzaG90LmV4aXN0cygpKSB7XG4gICAgICAgIGF3YWl0IHVwZGF0ZURvYyh1c2VyU3RhdHNSZWYsIHtcbiAgICAgICAgICBjb21wbGV0ZWRDb3Vyc2VzOiBpbmNyZW1lbnQoMSksXG4gICAgICAgICAgbGFzdENvbXBsZXRpb25EYXRlOiBUaW1lc3RhbXAubm93KClcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHNldERvYyh1c2VyU3RhdHNSZWYsIHtcbiAgICAgICAgICBjb21wbGV0ZWRDb3Vyc2VzOiAxLFxuICAgICAgICAgIGxhc3RDb21wbGV0aW9uRGF0ZTogVGltZXN0YW1wLm5vdygpXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgb3ZlcmFsbCBwcm9ncmVzczonLCBlcnJvcik7XG59XG59O1xuXG4vKipcbiAqIEdldCBhbGwgY291cnNlcyBpbiBwcm9ncmVzcyBmb3IgYSB1c2VyXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRDb3Vyc2VzSW5Qcm9ncmVzcyA9IGFzeW5jICh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Q291cnNlUHJvZ3Jlc3NbXT4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHByb2dyZXNzUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsIGB1c2Vycy8ke3VzZXJJZH0vY291cnNlUHJvZ3Jlc3NgKTtcbiAgICBjb25zdCBwcm9ncmVzc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhwcm9ncmVzc1JlZik7XG5cbiAgICBjb25zdCBjb3Vyc2VzSW5Qcm9ncmVzczogQ291cnNlUHJvZ3Jlc3NbXSA9IFtdO1xuXG4gICAgcHJvZ3Jlc3NTbmFwc2hvdC5mb3JFYWNoKGRvYyA9PiB7XG4gICAgICBjb3Vyc2VzSW5Qcm9ncmVzcy5wdXNoKHtcbiAgICAgICAgLi4uZG9jLmRhdGEoKSBhcyBDb3Vyc2VQcm9ncmVzcyxcbiAgICAgICAgY291cnNlSWQ6IGRvYy5pZCxcbiAgICAgICAgdXNlcklkXG4gICAgfSk7XG4gIH0pO1xuXG4gICAgcmV0dXJuIGNvdXJzZXNJblByb2dyZXNzO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGNvdXJzZXMgaW4gcHJvZ3Jlc3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbn1cbn07XG5cbi8qKlxuICogUmVzZXQgY291cnNlIHByb2dyZXNzIGZvciBhIHVzZXJcbiAqL1xuZXhwb3J0IGNvbnN0IHJlc2V0Q291cnNlUHJvZ3Jlc3MgPSBhc3luYyAodXNlcklkOiBzdHJpbmcsIGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwcm9ncmVzc1JlZiA9IGRvYyhmaXJlc3RvcmUsIGB1c2Vycy8ke3VzZXJJZH0vY291cnNlUHJvZ3Jlc3MvJHtjb3Vyc2VJZH1gKTtcblxuICAgIGF3YWl0IHNldERvYyhwcm9ncmVzc1JlZiwge1xuICAgICAgY291cnNlSWQsXG4gICAgICB1c2VySWQsXG4gICAgICBzdGFydERhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGxhc3RBY2Nlc3NEYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBjb21wbGV0ZWRMZXNzb25zOiBbXSxcbiAgICAgIGNvbXBsZXRlZE1vZHVsZXM6IFtdLFxuICAgICAgcXVpelNjb3Jlczoge30sXG4gICAgICBvdmVyYWxsUHJvZ3Jlc3M6IDAsXG4gICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgbGFzdFVwZGF0ZWQ6IHNlcnZlclRpbWVzdGFtcCgpXG4gIH0pO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXNldHRpbmcgY291cnNlIHByb2dyZXNzOicsIGVycm9yKTtcbn1cbn07XG5cbi8qKlxuICogR2V0IGxlc3NvbiBwcm9ncmVzcyBmb3IgYSB1c2VyXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRMZXNzb25Qcm9ncmVzcyA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGNvdXJzZUlkOiBzdHJpbmcsXG4gIG1vZHVsZUlkOiBzdHJpbmcsXG4gIGxlc3NvbklkOiBzdHJpbmdcbik6IFByb21pc2U8TGVzc29uUHJvZ3Jlc3MgfCB7XG4gICAgY29tcGxldGVkOiBib29sZWFuO1xuICAgIHByb2dyZXNzOiBudW1iZXI7XG4gICAgdGltZVNwZW50OiBudW1iZXI7XG4gICAgY3VycmVudFBvc2l0aW9uOiBudW1iZXI7XG4gICAgYm9va21hcmtzOiBCb29rbWFya1tdXG4gIH0+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwcm9ncmVzc1JlZiA9IGRvYyhmaXJlc3RvcmUsICdjb3Vyc2VQcm9ncmVzcycsIGAke3VzZXJJZH1fJHtjb3Vyc2VJZH1gKTtcbiAgICBjb25zdCBwcm9ncmVzc0RvYyA9IGF3YWl0IGdldERvYyhwcm9ncmVzc1JlZik7XG5cbiAgICBpZiAoIXByb2dyZXNzRG9jLmV4aXN0cygpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBsZXNzb25JZCwgLy8gQWRkIG1pc3NpbmcgcHJvcGVydGllcyB0byBtYXRjaCBMZXNzb25Qcm9ncmVzcyBzdHJ1Y3R1cmVcbiAgICAgICAgbW9kdWxlSWQsXG4gICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgIHByb2dyZXNzOiAwLFxuICAgICAgICB0aW1lU3BlbnQ6IDAsXG4gICAgICAgIGN1cnJlbnRQb3NpdGlvbjogMCxcbiAgICAgICAgYm9va21hcmtzOiBbXVxuICAgIH07XG4gIH1cblxuICAgIGNvbnN0IHByb2dyZXNzRGF0YSA9IHByb2dyZXNzRG9jLmRhdGEoKSBhcyBDb3Vyc2VQcm9ncmVzcztcbiAgICBjb25zdCBsZXNzb25LZXkgPSBgJHttb2R1bGVJZH1fJHtsZXNzb25JZH1gO1xuXG4gICAgLy8gUmV0dXJuIGxlc3Nvbi1zcGVjaWZpYyBwcm9ncmVzcyBkYXRhXG4gICAgcmV0dXJuIHByb2dyZXNzRGF0YS5sZXNzb25Qcm9ncmVzcyAmJiBwcm9ncmVzc0RhdGEubGVzc29uUHJvZ3Jlc3NbbGVzc29uS2V5XVxuICAgICAgPyBwcm9ncmVzc0RhdGEubGVzc29uUHJvZ3Jlc3NbbGVzc29uS2V5XVxuICAgICAgOiB7XG4gICAgICAgICAgbGVzc29uSWQsXG4gICAgICAgICAgbW9kdWxlSWQsXG4gICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICBwcm9ncmVzczogMCxcbiAgICAgICAgICB0aW1lU3BlbnQ6IDAsXG4gICAgICAgICAgY3VycmVudFBvc2l0aW9uOiAwLFxuICAgICAgICAgIGJvb2ttYXJrczogW11cbiAgICAgIH07XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgbGVzc29uIHByb2dyZXNzOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgbGVzc29uSWQsXG4gICAgICBtb2R1bGVJZCxcbiAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICBwcm9ncmVzczogMCxcbiAgICAgIHRpbWVTcGVudDogMCxcbiAgICAgIGN1cnJlbnRQb3NpdGlvbjogMCxcbiAgICAgIGJvb2ttYXJrczogW11cbiAgfTtcbn1cbn07XG5cbi8qKlxuICogU3luYyBjb3Vyc2UgcHJvZ3Jlc3Mgd2l0aCBvcHRpbWl6ZWQgd3JpdGVzXG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgbGVzcyBmcmVxdWVudGx5LCBlLmcuLCB3aGVuIHVzZXIgbGVhdmVzIHRoZSBjb3Vyc2UgcGFnZVxuICovXG5leHBvcnQgY29uc3Qgc3luY0NvdXJzZVByb2dyZXNzID0gKHVzZXJJZDogc3RyaW5nLCBjb3Vyc2VJZDogc3RyaW5nKTogdm9pZCA9PiB7XG4gIGNvbnN0IGRvY0lkID0gYCR7dXNlcklkfV8ke2NvdXJzZUlkfWA7XG4gIGNvbnN0IGNhY2hlZCA9IHByb2dyZXNzQ2FjaGUuZ2V0KGRvY0lkKTtcblxuICBpZiAoIWNhY2hlZCkge1xuICAgIHJldHVybjsgLy8gTm90aGluZyB0byBzeW5jXG59XG5cbiAgdHJ5IHtcbiAgICAvLyBHZXQgdGhlIGxhdGVzdCBwcm9ncmVzcyBmcm9tIGNhY2hlXG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBjYWNoZWQuZGF0YSBhcyBDb3Vyc2VQcm9ncmVzczsgLy8gV2Uga25vdyBpdCdzIENvdXJzZVByb2dyZXNzIGlmIGNhY2hlZFxuXG4gICAgLy8gUXVldWUgdGhlIHdyaXRlIHRvIHRoZSBtYWluIGNvdXJzZVByb2dyZXNzIGRvY3VtZW50XG4gICAgLy8gVGhlIG9yaWdpbmFsIGludGVudGlvbiBtaWdodCBoYXZlIGJlZW4gdG8gdXBkYXRlIGEgc2VwYXJhdGUgJ2Vucm9sbG1lbnRzJyBjb2xsZWN0aW9uLFxuICAgIC8vIGJ1dCB0aGUgY3VycmVudCBgcXVldWVXcml0ZWAgaXMgZm9yIGBjb3Vyc2VQcm9ncmVzc2AuXG4gICAgLy8gSWYgYSBzZXBhcmF0ZSBlbnJvbGxtZW50cyBjb2xsZWN0aW9uIG5lZWRzIHVwZGF0aW5nLCB0aGF0J3MgYSBkaWZmZXJlbnQgbG9naWMuXG4gICAgLy8gRm9yIG5vdywgdGhpcyBzeW5jcyB0aGUgY2FjaGVkIGBjb3Vyc2VQcm9ncmVzc2AgZGF0YS5cbiAgICAvLyBUaGUgYHByb2dyZXNzYCBvYmplY3QgaXRzZWxmIGlzIHdoYXQncyBpbiBgY291cnNlUHJvZ3Jlc3MvJHtkb2NJZH1gXG4gICAgLy8gU28gd2UgYXJlIGVzc2VudGlhbGx5IHJlLXF1ZXVlaW5nIHRoZSBsYXRlc3Qgc3RhdGUgZnJvbSBjYWNoZS5cbiAgICBxdWV1ZVdyaXRlKGBjb3Vyc2VQcm9ncmVzcy8ke2RvY0lkfWAsIHByb2dyZXNzIGFzIFVwZGF0ZURhdGE8Q291cnNlUHJvZ3Jlc3M+KTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc3luY2luZyBjb3Vyc2UgcHJvZ3Jlc3M6JywgZXJyb3IpO1xufVxufTtcbiJdLCJuYW1lcyI6WyJkb2MiLCJnZXREb2MiLCJ1cGRhdGVEb2MiLCJzZXREb2MiLCJjb2xsZWN0aW9uIiwicXVlcnkiLCJ3aGVyZSIsImdldERvY3MiLCJzZXJ2ZXJUaW1lc3RhbXAiLCJhcnJheVVuaW9uIiwiaW5jcmVtZW50IiwiVGltZXN0YW1wIiwib3JkZXJCeSIsIndyaXRlQmF0Y2giLCJkZWxldGVGaWVsZCIsImZpcmVzdG9yZSIsImNyZWF0ZVByb2dyZXNzUmVtaW5kZXIiLCJjcmVhdGVDb21wbGV0aW9uUmVtaW5kZXIiLCJjcmVhdGVJbmFjdGl2aXR5UmVtaW5kZXIiLCJnZW5lcmF0ZUNlcnRpZmljYXRlIiwiZ2V0RGVmYXVsdENlcnRpZmljYXRlVGVtcGxhdGUiLCJwcm9ncmVzc0NhY2hlIiwiTWFwIiwiQ0FDSEVfVFRMIiwid3JpdGVRdWV1ZSIsIndyaXRlVGltZXIiLCJCQVRDSF9JTlRFUlZBTCIsIk1BWF9CQVRDSF9TSVpFIiwicXVldWVXcml0ZSIsImRvY1BhdGgiLCJkYXRhIiwicHVzaCIsInRpbWVzdGFtcCIsIkRhdGUiLCJub3ciLCJzZXRUaW1lb3V0IiwicHJvY2Vzc0JhdGNoV3JpdGVzIiwibGVuZ3RoIiwib3BlcmF0aW9ucyIsInNwbGljZSIsInRpbWVHcm91cHMiLCJmb3JFYWNoIiwib3AiLCJ0aW1lS2V5IiwiTWF0aCIsImZsb29yIiwidG9TdHJpbmciLCJiYXRjaCIsImdyb3VwT3BzIiwiZG9jUmVmIiwidXBkYXRlIiwibGFzdFVwZGF0ZWQiLCJjb21taXQiLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiLCJnZXRDb3Vyc2VQcm9ncmVzcyIsInVzZXJJZCIsImNvdXJzZUlkIiwiZG9jSWQiLCJjYWNoZWQiLCJnZXQiLCJwcm9ncmVzc1JlZiIsInByb2dyZXNzRG9jIiwiZXhpc3RzIiwicHJvZ3Jlc3MiLCJzZXQiLCJpbml0aWFsaXplQ291cnNlUHJvZ3Jlc3MiLCJjb3Vyc2VOYW1lIiwibW9kdWxlc1JlZiIsIm1vZHVsZXNRdWVyeSIsIm1vZHVsZXNTbmFwc2hvdCIsIm1vZHVsZVByb2dyZXNzIiwibGVzc29uUHJvZ3Jlc3MiLCJtb2R1bGVEb2MiLCJkb2NzIiwibW9kdWxlSWQiLCJpZCIsImxlc3NvbnNSZWYiLCJsZXNzb25zUXVlcnkiLCJsZXNzb25zU25hcHNob3QiLCJzdGFydERhdGUiLCJsYXN0QWNjZXNzRGF0ZSIsImNvbXBsZXRlZCIsInRpbWVTcGVudCIsImNvbXBsZXRlZExlc3NvbnMiLCJ0b3RhbExlc3NvbnMiLCJzaXplIiwibGVzc29uRG9jIiwibGVzc29uSWQiLCJub3RlcyIsImJvb2ttYXJrcyIsIm5ld1Byb2dyZXNzIiwidG9JU09TdHJpbmciLCJjb21wbGV0ZWRNb2R1bGVzIiwicXVpelNjb3JlcyIsInF1aXpBdHRlbXB0cyIsIm92ZXJhbGxQcm9ncmVzcyIsImNhbGN1bGF0ZUNvdXJzZVByb2dyZXNzIiwic2FmZVRvdGFsTGVzc29ucyIsIm1heCIsInVwZGF0ZUxlc3NvblByb2dyZXNzIiwiRXJyb3IiLCJsZXNzb25JbmRleCIsImluZGV4T2YiLCJpc0NvbXBsZXRlZCIsInVwZGF0ZURhdGEiLCJjb21wbGV0ZWREYXRlIiwicmF3Q29tcGxldGVkRGF0ZUZyb21VcGRhdGVEYXRhIiwicmVzdE9mVXBkYXRlRGF0YSIsInJlc29sdmVkQ29tcGxldGVkRGF0ZUZvckNhY2hlIiwidW5kZWZpbmVkIiwidXBkYXRlZFByb2dyZXNzIiwibWFya01vZHVsZUNvbXBsZXRlIiwiaW5jbHVkZXMiLCJtYXJrQ291cnNlQ29tcGxldGUiLCJtb2R1bGVJZHMiLCJhY3R1YWxQcm9ncmVzcyIsInJvdW5kIiwiaXNBY3R1YWxseUNvbXBsZXRlIiwiY29tcGxldGlvbkRhdGUiLCJpc3N1ZUNlcnRpZmljYXRlRm9yQ291cnNlIiwiY291cnNlUmVmIiwiY291cnNlRG9jIiwiY291cnNlRGF0YSIsImNlcnRpZmljYXRlc0VuYWJsZWQiLCJ1c2VyUmVmIiwidXNlckRvYyIsInVzZXJEYXRhIiwidGVtcGxhdGVJZCIsImNlcnRpZmljYXRlVGVtcGxhdGVJZCIsInRlbXBsYXRlIiwidGVtcGxhdGVSZWYiLCJ0ZW1wbGF0ZURvYyIsImRlZmF1bHRUZW1wbGF0ZSIsImNlcnRpZmljYXRlIiwidmFsdWVzIiwic3R1ZGVudE5hbWUiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwidGl0bGUiLCJpc3N1ZXJOYW1lIiwiaW5zdHJ1Y3Rvck5hbWUiLCJpc3N1ZXJUaXRsZSIsImluc3RydWN0b3JUaXRsZSIsImlzUHVibGljIiwicHVibGljQ2VydGlmaWNhdGVzIiwiY2hlY2tJbmFjdGl2ZUVucm9sbG1lbnRzIiwic2V2ZW5EYXlzQWdvIiwiZ2V0VGltZSIsInNldmVuRGF5c0Fnb1N0ciIsInByb2dyZXNzUXVlcnkiLCJwcm9ncmVzc1NuYXBzaG90IiwiY291bnQiLCJkYXlzU2luY2VMYXN0QWNjZXNzIiwidXBkYXRlUXVpelNjb3JlIiwic2NvcmUiLCJnZXRRdWVyeUNsaWVudCIsIm1hcmtMZXNzb25Db21wbGV0ZWQiLCJwb3NpdGlvbiIsInF1ZXJ5Q2xpZW50IiwibGVzc29uS2V5IiwiY3VycmVudExlc3NvblByb2dyZXNzIiwiY3VycmVudE1vZHVsZVByb2dyZXNzIiwiY29tcGxldGVkTGVzc29uc0luTW9kdWxlIiwiT2JqZWN0Iiwia2V5cyIsImZpbHRlciIsImtleSIsInN0YXJ0c1dpdGgiLCJsYXN0UG9zaXRpb24iLCJjaGVja01vZHVsZUNvbXBsZXRpb24iLCJ1cGRhdGVPdmVyYWxsUHJvZ3Jlc3MiLCJpbnZhbGlkYXRlUXVlcmllcyIsInF1ZXJ5S2V5IiwidXBkYXRlTGVzc29uVHJhY2tpbmciLCJwcm9ncmVzc1BlcmNlbnRhZ2UiLCJpbmNvbXBsZXRlTGVzc29ucyIsImluY29tcGxldGVQcm9ncmVzcyIsInJlZHVjZSIsInN1bSIsImF2ZXJhZ2VJbmNvbXBsZXRlUHJvZ3Jlc3MiLCJtb2R1bGVQcm9ncmVzc1BlcmNlbnRhZ2UiLCJ1cGRhdGVPdmVyYWxsUHJvZ3Jlc3NDYWxjdWxhdGlvbiIsIm1vZHVsZVByb2dyZXNzVmFsdWVzIiwibW9kdWxlIiwiYWRkTGVzc29uQm9va21hcmsiLCJub3RlIiwibmV3Qm9va21hcmsiLCJjcmVhdGVkQXQiLCJhZGRMZXNzb25Ob3RlIiwibW9kdWxlUmVmIiwibW9kdWxlU25hcHNob3QiLCJsZXNzb25JZHMiLCJtYXAiLCJwcm9ncmVzc0RhdGEiLCJhbGxMZXNzb25zQ29tcGxldGVkIiwiZXZlcnkiLCJhbGxNb2R1bGVzQ29tcGxldGVkIiwiY291cnNlUHJvZ3Jlc3NVcGRhdGVEYXRhIiwiZW5yb2xsbWVudERvY1JlZiIsImVucm9sbG1lbnRTbmFwIiwiY3VycmVudEVucm9sbG1lbnRTdGF0dXMiLCJlbnJvbGxtZW50RGF0YSIsInN0YXR1cyIsImxhc3RBY2Nlc3NlZEF0IiwiZW5yb2xsbWVudEVycm9yIiwidXNlclN0YXRzUmVmIiwidXNlclN0YXRzU25hcHNob3QiLCJjb21wbGV0ZWRDb3Vyc2VzIiwibGFzdENvbXBsZXRpb25EYXRlIiwiZ2V0Q291cnNlc0luUHJvZ3Jlc3MiLCJjb3Vyc2VzSW5Qcm9ncmVzcyIsInJlc2V0Q291cnNlUHJvZ3Jlc3MiLCJnZXRMZXNzb25Qcm9ncmVzcyIsImN1cnJlbnRQb3NpdGlvbiIsInN5bmNDb3Vyc2VQcm9ncmVzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/services/courseProgressService.ts\n");

/***/ }),

/***/ "./src/services/firebase.ts":
/*!**********************************!*\
  !*** ./src/services/firebase.ts ***!
  \**********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   app: () => (/* binding */ app),\n/* harmony export */   auth: () => (/* binding */ auth),\n/* harmony export */   firestore: () => (/* binding */ firestore),\n/* harmony export */   storage: () => (/* binding */ storage)\n/* harmony export */ });\n/* harmony import */ var firebase_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/app */ \"firebase/app\");\n/* harmony import */ var firebase_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/auth */ \"firebase/auth\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var firebase_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! firebase/storage */ \"firebase/storage\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_app__WEBPACK_IMPORTED_MODULE_0__, firebase_auth__WEBPACK_IMPORTED_MODULE_1__, firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, firebase_storage__WEBPACK_IMPORTED_MODULE_3__]);\n([firebase_app__WEBPACK_IMPORTED_MODULE_0__, firebase_auth__WEBPACK_IMPORTED_MODULE_1__, firebase_firestore__WEBPACK_IMPORTED_MODULE_2__, firebase_storage__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n// Firebase configuration\nconst firebaseConfig = {\n    apiKey: \"AIzaSyBdi4YO2FV5hzYT1iT2GZFJVkhlcsrD2Vw\",\n    authDomain: \"gen-lang-client-00697788-5c2c3.firebaseapp.com\",\n    projectId: \"gen-lang-client-00697788-5c2c3\",\n    storageBucket: \"gen-lang-client-00697788-5c2c3.firebasestorage.app\",\n    messagingSenderId: \"846318340379\",\n    appId: \"1:846318340379:web:9da5ed83b960851563ebbe\",\n    measurementId: \"G-NECRD4FN4L\"\n};\n// Validate that all required Firebase config values are present\nif (!firebaseConfig.apiKey || !firebaseConfig.authDomain || !firebaseConfig.projectId || !firebaseConfig.storageBucket) {\n    console.error(\"Firebase configuration is incomplete. Make sure all required environment variables are set.\");\n}\n// Initialize Firebase\nconst app = !(0,firebase_app__WEBPACK_IMPORTED_MODULE_0__.getApps)().length ? (0,firebase_app__WEBPACK_IMPORTED_MODULE_0__.initializeApp)(firebaseConfig) : (0,firebase_app__WEBPACK_IMPORTED_MODULE_0__.getApp)();\nconst auth = (0,firebase_auth__WEBPACK_IMPORTED_MODULE_1__.getAuth)(app);\n// Initialize Firestore with persistence enabled (only in browser environment)\nconst firestore =  false ? 0 : (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.getFirestore)(app);\nconst storage = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_3__.getStorage)(app);\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2VydmljZXMvZmlyZWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBNkQ7QUFDdEI7QUFDaUY7QUFDM0U7QUFFN0MseUJBQXlCO0FBQ3pCLE1BQU1TLGlCQUFpQjtJQUNyQkMsUUFBUUMseUNBQXdDO0lBQ2hERyxZQUFZSCxnREFBNEM7SUFDeERLLFdBQVdMLGdDQUEyQztJQUN0RE8sZUFBZVAsb0RBQStDO0lBQzlEUyxtQkFBbUJULGNBQW9EO0lBQ3ZFVyxPQUFPWCwyQ0FBdUM7SUFDOUNhLGVBQWViLGNBQStDO0FBQ2hFO0FBRUEsZ0VBQWdFO0FBQ2hFLElBQUksQ0FBQ0YsZUFBZUMsTUFBTSxJQUFJLENBQUNELGVBQWVLLFVBQVUsSUFBSSxDQUFDTCxlQUFlTyxTQUFTLElBQUksQ0FBQ1AsZUFBZVMsYUFBYSxFQUFFO0lBQ3RIUSxRQUFRQyxLQUFLLENBQUM7QUFDaEI7QUFFQSxzQkFBc0I7QUFDdEIsTUFBTUMsTUFBTSxDQUFDM0IscURBQU9BLEdBQUc0QixNQUFNLEdBQUc3QiwyREFBYUEsQ0FBQ1Msa0JBQWtCUCxvREFBTUE7QUFDdEUsTUFBTTRCLE9BQU8zQixzREFBT0EsQ0FBQ3lCO0FBRXJCLDhFQUE4RTtBQUM5RSxNQUFNRyxZQUFZLE1BQWtCLEdBQ2hDMUIsQ0FJQSxHQUNBRCxnRUFBWUEsQ0FBQ3dCO0FBRWpCLE1BQU1PLFVBQVUzQiw0REFBVUEsQ0FBQ29CO0FBRWEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmFpbmluZy1wbGF0Zm9ybS8uL3NyYy9zZXJ2aWNlcy9maXJlYmFzZS50cz8wOGMwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aW5pdGlhbGl6ZUFwcCwgZ2V0QXBwcywgZ2V0QXBwIH0gZnJvbSAnZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7Z2V0QXV0aCB9IGZyb20gJ2ZpcmViYXNlL2F1dGgnO1xuaW1wb3J0IHtnZXRGaXJlc3RvcmUsIGluaXRpYWxpemVGaXJlc3RvcmUsIHBlcnNpc3RlbnRMb2NhbENhY2hlLCBwZXJzaXN0ZW50U2luZ2xlVGFiTWFuYWdlciB9IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7XG5pbXBvcnQge2dldFN0b3JhZ2UgfSBmcm9tICdmaXJlYmFzZS9zdG9yYWdlJztcblxuLy8gRmlyZWJhc2UgY29uZmlndXJhdGlvblxuY29uc3QgZmlyZWJhc2VDb25maWcgPSB7XG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfQVBJX0tFWSxcbiAgYXV0aERvbWFpbjogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfQVVUSF9ET01BSU4sXG4gIHByb2plY3RJZDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfUFJPSkVDVF9JRCxcbiAgc3RvcmFnZUJ1Y2tldDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfU1RPUkFHRV9CVUNLRVQsXG4gIG1lc3NhZ2luZ1NlbmRlcklkOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19GSVJFQkFTRV9NRVNTQUdJTkdfU0VOREVSX0lELFxuICBhcHBJZDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfQVBQX0lELFxuICBtZWFzdXJlbWVudElkOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19GSVJFQkFTRV9NRUFTVVJFTUVOVF9JRCxcbn07XG5cbi8vIFZhbGlkYXRlIHRoYXQgYWxsIHJlcXVpcmVkIEZpcmViYXNlIGNvbmZpZyB2YWx1ZXMgYXJlIHByZXNlbnRcbmlmICghZmlyZWJhc2VDb25maWcuYXBpS2V5IHx8ICFmaXJlYmFzZUNvbmZpZy5hdXRoRG9tYWluIHx8ICFmaXJlYmFzZUNvbmZpZy5wcm9qZWN0SWQgfHwgIWZpcmViYXNlQ29uZmlnLnN0b3JhZ2VCdWNrZXQpIHtcbiAgY29uc29sZS5lcnJvcignRmlyZWJhc2UgY29uZmlndXJhdGlvbiBpcyBpbmNvbXBsZXRlLiBNYWtlIHN1cmUgYWxsIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgc2V0LicpO1xufVxuXG4vLyBJbml0aWFsaXplIEZpcmViYXNlXG5jb25zdCBhcHAgPSAhZ2V0QXBwcygpLmxlbmd0aCA/IGluaXRpYWxpemVBcHAoZmlyZWJhc2VDb25maWcpIDogZ2V0QXBwKCk7XG5jb25zdCBhdXRoID0gZ2V0QXV0aChhcHApO1xuXG4vLyBJbml0aWFsaXplIEZpcmVzdG9yZSB3aXRoIHBlcnNpc3RlbmNlIGVuYWJsZWQgKG9ubHkgaW4gYnJvd3NlciBlbnZpcm9ubWVudClcbmNvbnN0IGZpcmVzdG9yZSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnIFxuICA/IGluaXRpYWxpemVGaXJlc3RvcmUoYXBwLCB7XG4gICAgICBsb2NhbENhY2hlOiBwZXJzaXN0ZW50TG9jYWxDYWNoZSh7XG4gICAgICAgIHRhYk1hbmFnZXI6IHBlcnNpc3RlbnRTaW5nbGVUYWJNYW5hZ2VyKHtmb3JjZU93bmVyc2hpcDogdHJ1ZSB9KVxuICAgIH0pXG4gIH0pXG4gIDogZ2V0RmlyZXN0b3JlKGFwcCk7XG5cbmNvbnN0IHN0b3JhZ2UgPSBnZXRTdG9yYWdlKGFwcCk7XG5cbmV4cG9ydCB7YXBwLCBhdXRoLCBmaXJlc3RvcmUsIHN0b3JhZ2UgfTtcblxuXG5cbiJdLCJuYW1lcyI6WyJpbml0aWFsaXplQXBwIiwiZ2V0QXBwcyIsImdldEFwcCIsImdldEF1dGgiLCJnZXRGaXJlc3RvcmUiLCJpbml0aWFsaXplRmlyZXN0b3JlIiwicGVyc2lzdGVudExvY2FsQ2FjaGUiLCJwZXJzaXN0ZW50U2luZ2xlVGFiTWFuYWdlciIsImdldFN0b3JhZ2UiLCJmaXJlYmFzZUNvbmZpZyIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19GSVJFQkFTRV9BUElfS0VZIiwiYXV0aERvbWFpbiIsIk5FWFRfUFVCTElDX0ZJUkVCQVNFX0FVVEhfRE9NQUlOIiwicHJvamVjdElkIiwiTkVYVF9QVUJMSUNfRklSRUJBU0VfUFJPSkVDVF9JRCIsInN0b3JhZ2VCdWNrZXQiLCJORVhUX1BVQkxJQ19GSVJFQkFTRV9TVE9SQUdFX0JVQ0tFVCIsIm1lc3NhZ2luZ1NlbmRlcklkIiwiTkVYVF9QVUJMSUNfRklSRUJBU0VfTUVTU0FHSU5HX1NFTkRFUl9JRCIsImFwcElkIiwiTkVYVF9QVUJMSUNfRklSRUJBU0VfQVBQX0lEIiwibWVhc3VyZW1lbnRJZCIsIk5FWFRfUFVCTElDX0ZJUkVCQVNFX01FQVNVUkVNRU5UX0lEIiwiY29uc29sZSIsImVycm9yIiwiYXBwIiwibGVuZ3RoIiwiYXV0aCIsImZpcmVzdG9yZSIsImxvY2FsQ2FjaGUiLCJ0YWJNYW5hZ2VyIiwiZm9yY2VPd25lcnNoaXAiLCJzdG9yYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/services/firebase.ts\n");

/***/ }),

/***/ "./src/services/moduleService.ts":
/*!***************************************!*\
  !*** ./src/services/moduleService.ts ***!
  \***************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLesson: () => (/* binding */ createLesson),\n/* harmony export */   createModule: () => (/* binding */ createModule),\n/* harmony export */   deleteLesson: () => (/* binding */ deleteLesson),\n/* harmony export */   deleteModule: () => (/* binding */ deleteModule),\n/* harmony export */   fetchLesson: () => (/* binding */ fetchLesson),\n/* harmony export */   fetchLessons: () => (/* binding */ fetchLessons),\n/* harmony export */   fetchModule: () => (/* binding */ fetchModule),\n/* harmony export */   fetchModules: () => (/* binding */ fetchModules),\n/* harmony export */   updateCourseLessonCount: () => (/* binding */ updateCourseLessonCount),\n/* harmony export */   updateCourseModuleCount: () => (/* binding */ updateCourseModuleCount),\n/* harmony export */   updateLesson: () => (/* binding */ updateLesson),\n/* harmony export */   updateLessonOrder: () => (/* binding */ updateLessonOrder),\n/* harmony export */   updateModule: () => (/* binding */ updateModule),\n/* harmony export */   updateModuleLessonCount: () => (/* binding */ updateModuleLessonCount),\n/* harmony export */   updateModuleOrder: () => (/* binding */ updateModuleOrder),\n/* harmony export */   verifyAllCourseModuleCounts: () => (/* binding */ verifyAllCourseModuleCounts),\n/* harmony export */   verifyAllModuleLessonCounts: () => (/* binding */ verifyAllModuleLessonCounts)\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _services_firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/services/firebase */ \"./src/services/firebase.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _services_firebase__WEBPACK_IMPORTED_MODULE_1__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _services_firebase__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n/**\n * Fetch all modules for a course\n */ const fetchModules = async (courseId)=>{\n    try {\n        const modulesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules`);\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(modulesRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"order\", \"asc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const modulesList = [];\n        querySnapshot.forEach((doc)=>{\n            modulesList.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return modulesList;\n    } catch (error) {\n        console.error(\"Error fetching modules:\", error);\n        throw error;\n    }\n};\n/**\n * Fetch a single module by ID\n */ const fetchModule = async (courseId, moduleId)=>{\n    try {\n        const moduleRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}`);\n        const moduleDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(moduleRef);\n        if (!moduleDoc.exists()) {\n            throw new Error(\"Module not found\");\n        }\n        return {\n            id: moduleDoc.id,\n            ...moduleDoc.data()\n        };\n    } catch (error) {\n        console.error(\"Error fetching module:\", error);\n        throw error;\n    }\n};\n/**\n * Create a new module\n */ const createModule = async (courseId, moduleData)=>{\n    try {\n        // Get the highest order value\n        const modules = await fetchModules(courseId);\n        const highestOrder = modules.length > 0 ? Math.max(...modules.map((m)=>m.order)) : -1;\n        const now = new Date().toISOString();\n        const newModule = {\n            ...moduleData,\n            order: highestOrder + 1,\n            createdAt: now,\n            updatedAt: now\n        };\n        const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules`), newModule);\n        // Update the course's module count\n        await updateCourseModuleCount(courseId);\n        return docRef.id;\n    } catch (error) {\n        console.error(\"Error creating module:\", error);\n        throw error;\n    }\n};\n/**\n * Update an existing module\n */ const updateModule = async (courseId, moduleId, moduleData)=>{\n    try {\n        const moduleRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}`);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(moduleRef, {\n            ...moduleData,\n            updatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"Error updating module:\", error);\n        throw error;\n    }\n};\n/**\n * Delete a module and all its lessons\n */ const deleteModule = async (courseId, moduleId)=>{\n    try {\n        // First, get all lessons for this module\n        const lessonsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons`);\n        const lessonsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(lessonsRef);\n        // Use a batch to delete all lessons and the module\n        const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore);\n        // Add lesson deletions to batch\n        lessonsSnapshot.forEach((lessonDoc)=>{\n            batch.delete((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons/${lessonDoc.id}`));\n        });\n        // Add module deletion to batch\n        batch.delete((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}`));\n        // Commit the batch\n        await batch.commit();\n        // Update the course's module count\n        await updateCourseModuleCount(courseId);\n        // Update the course's total lesson count\n        await updateCourseLessonCount(courseId);\n    } catch (error) {\n        console.error(\"Error deleting module:\", error);\n        throw error;\n    }\n};\n/**\n * Update the order of modules\n */ const updateModuleOrder = async (courseId, moduleOrders)=>{\n    try {\n        const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore);\n        moduleOrders.forEach(({ id, order })=>{\n            const moduleRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${id}`);\n            batch.update(moduleRef, {\n                order\n            });\n        });\n        await batch.commit();\n    } catch (error) {\n        console.error(\"Error updating module order:\", error);\n        throw error;\n    }\n};\n/**\n * Fetch all lessons for a module\n */ const fetchLessons = async (courseId, moduleId)=>{\n    try {\n        const lessonsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons`);\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(lessonsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"order\", \"asc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const lessonsList = [];\n        querySnapshot.forEach((doc)=>{\n            lessonsList.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return lessonsList;\n    } catch (error) {\n        console.error(\"Error fetching lessons:\", error);\n        throw error;\n    }\n};\n/**\n * Fetch a single lesson by ID\n */ const fetchLesson = async (courseId, moduleId, lessonId)=>{\n    try {\n        const lessonRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons/${lessonId}`);\n        const lessonDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(lessonRef);\n        if (!lessonDoc.exists()) {\n            throw new Error(\"Lesson not found\");\n        }\n        return {\n            id: lessonDoc.id,\n            ...lessonDoc.data()\n        };\n    } catch (error) {\n        console.error(\"Error fetching lesson:\", error);\n        throw error;\n    }\n};\n/**\n * Create a new lesson\n */ const createLesson = async (courseId, moduleId, lessonData)=>{\n    try {\n        // Get the highest order value\n        const lessons = await fetchLessons(courseId, moduleId);\n        const highestOrder = lessons.length > 0 ? Math.max(...lessons.map((l)=>l.order)) : -1;\n        const now = new Date().toISOString();\n        const newLesson = {\n            ...lessonData,\n            order: highestOrder + 1,\n            createdAt: now,\n            updatedAt: now\n        };\n        const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons`), newLesson);\n        // Update the module's lesson count\n        await updateModuleLessonCount(courseId, moduleId);\n        // Update the course's total lesson count\n        await updateCourseLessonCount(courseId);\n        return docRef.id;\n    } catch (error) {\n        console.error(\"Error creating lesson:\", error);\n        throw error;\n    }\n};\n/**\n * Update an existing lesson\n */ const updateLesson = async (courseId, moduleId, lessonId, lessonData)=>{\n    try {\n        const lessonRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons/${lessonId}`);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(lessonRef, {\n            ...lessonData,\n            updatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"Error updating lesson:\", error);\n        throw error;\n    }\n};\n/**\n * Delete a lesson\n */ const deleteLesson = async (courseId, moduleId, lessonId)=>{\n    try {\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons/${lessonId}`));\n        // Update the module's lesson count\n        await updateModuleLessonCount(courseId, moduleId);\n        // Update the course's total lesson count\n        await updateCourseLessonCount(courseId);\n    } catch (error) {\n        console.error(\"Error deleting lesson:\", error);\n        throw error;\n    }\n};\n/**\n * Update the order of lessons\n */ const updateLessonOrder = async (courseId, moduleId, lessonOrders)=>{\n    try {\n        const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore);\n        lessonOrders.forEach(({ id, order })=>{\n            const lessonRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}/lessons/${id}`);\n            batch.update(lessonRef, {\n                order\n            });\n        });\n        await batch.commit();\n    } catch (error) {\n        console.error(\"Error updating lesson order:\", error);\n        throw error;\n    }\n};\n/**\n * Update the lesson count for a module\n */ const updateModuleLessonCount = async (courseId, moduleId)=>{\n    try {\n        const lessons = await fetchLessons(courseId, moduleId);\n        const moduleRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleId}`);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(moduleRef, {\n            lessonCount: lessons.length,\n            updatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"Error updating module lesson count:\", error);\n        throw error;\n    }\n};\n/**\n * Update the module count for a course\n */ // ModuleService.ts\nconst updateCourseModuleCount = async (courseId)=>{\n    try {\n        // Directly query the modules subcollection to get an accurate count\n        const modulesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules`);\n        const modulesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(modulesRef); // <--- This gets the actual count\n        const moduleCount = modulesSnapshot.size;\n        // Get module IDs for the modulesList field\n        const moduleIds = modulesSnapshot.docs.map((doc)=>doc.id);\n        const courseRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}`);\n        const courseDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(courseRef);\n        if (!courseDoc.exists()) {\n            console.error(`Course document with ID ${courseId} does not exist.`);\n            // Consider throwing an error or handling this case more explicitly\n            // if a course document MUST exist when modules are being managed.\n            return;\n        }\n        // Update the course document\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(courseRef, {\n            modules: moduleCount,\n            modulesList: moduleIds,\n            updatedAt: new Date().toISOString() // Or serverTimestamp()\n        });\n        console.log(`Updated module count for course ${courseId} to ${moduleCount}`);\n    } catch (error) {\n        console.error(\"Error updating course module count:\", error);\n        throw error; // Re-throw to allow calling function to handle it\n    }\n};\n/**\n * Verify and update all module lesson counts for a course\n */ const verifyAllModuleLessonCounts = async (courseId)=>{\n    try {\n        const modules = await fetchModules(courseId);\n        const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore);\n        // Update each module's lesson count\n        for (const moduleItem of modules){\n            const lessons = await fetchLessons(courseId, moduleItem.id);\n            const moduleRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules/${moduleItem.id}`);\n            batch.update(moduleRef, {\n                lessonCount: lessons.length,\n                updatedAt: new Date().toISOString()\n            });\n        }\n        // Commit all updates in a single batch\n        await batch.commit();\n        // Now update the course's total lesson count\n        await updateCourseLessonCount(courseId);\n    } catch (error) {\n        console.error(\"Error verifying module lesson counts:\", error);\n        throw error;\n    }\n};\n/**\n * Update the total lesson count for a course\n */ const updateCourseLessonCount = async (courseId)=>{\n    try {\n        const modules = await fetchModules(courseId);\n        let totalLessons = 0;\n        // Sum up lesson counts from all modules using their lessonCount property\n        // This is more efficient than fetching all lessons for each module\n        for (const moduleData of modules){\n            // Use the module's lessonCount if available, otherwise fetch lessons\n            if (typeof moduleData.lessonCount === \"number\") {\n                totalLessons += moduleData.lessonCount;\n            } else {\n                const lessons = await fetchLessons(courseId, moduleData.id);\n                totalLessons += lessons.length;\n            }\n        }\n        const courseRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}`);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(courseRef, {\n            lessons: totalLessons,\n            updatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"Error updating course lesson count:\", error);\n        throw error;\n    }\n};\n/**\n * Verify and fix module counts for all courses\n * This utility function can be used to ensure all courses have correct module counts\n */ // ModuleService.ts - verifyAllCourseModuleCounts\n// This function is good. No changes needed here for its logic.\nconst verifyAllCourseModuleCounts = async ()=>{\n    try {\n        const coursesRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"courses\");\n        const coursesSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(coursesRef);\n        let fixedCount = 0;\n        const totalCourses = coursesSnapshot.size;\n        const errorCourses = [];\n        for (const courseDoc of coursesSnapshot.docs){\n            const courseId = courseDoc.id;\n            const courseData = courseDoc.data();\n            let needsUpdate = false;\n            try {\n                const modulesSubcollectionRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}/modules`);\n                const modulesSubcollectionSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(modulesSubcollectionRef);\n                const actualModuleCount = modulesSubcollectionSnapshot.size; // Number\n                const actualModuleIds = modulesSubcollectionSnapshot.docs.map((doc)=>doc.id); // string[]\n                const dataToUpdate = {\n                    updatedAt: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now()\n                };\n                // Check if 'modules' field needs fixing (either wrong type or wrong value)\n                if (typeof courseData.modules !== \"number\" || courseData.modules !== actualModuleCount) {\n                    dataToUpdate.modules = actualModuleCount;\n                    needsUpdate = true;\n                    console.log(`Course ${courseId}: Fixing 'modules' field. Stored: ${courseData.modules} (type: ${typeof courseData.modules}), Actual count: ${actualModuleCount}`);\n                }\n                // Check if 'modulesList' field needs fixing or adding\n                // Simple check: if it doesn't exist or its length doesn't match actual count\n                // More robust: deep comparison of arrays if order matters and is guaranteed\n                if (!courseData.modulesList || !Array.isArray(courseData.modulesList) || courseData.modulesList.length !== actualModuleIds.length || !actualModuleIds.every((id)=>Array.isArray(courseData.modulesList) && courseData.modulesList.includes(id)) || // Ensure all actual IDs are present\n                !(Array.isArray(courseData.modulesList) && courseData.modulesList.every((id)=>typeof id === \"string\" && actualModuleIds.includes(id)) // Ensure all stored IDs are actual and strings\n                )) {\n                    dataToUpdate.modulesList = actualModuleIds;\n                    needsUpdate = true;\n                    console.log(`Course ${courseId}: Fixing 'modulesList' field.`);\n                }\n                // If 'modulesCount' field exists and is different, you might want to remove it or ensure it's also correct\n                // For now, focusing on 'modules' and 'modulesList'\n                // Example: if (courseData.hasOwnProperty('modulesCount')) {dataToUpdate.modulesCount = deleteField(); needsUpdate = true; }\n                if (needsUpdate) {\n                    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, `courses/${courseId}`), dataToUpdate);\n                    fixedCount++;\n                }\n            } catch (err) {\n                console.error(`Error processing course ${courseId} during verification:`, err);\n                errorCourses.push(courseId);\n            }\n        }\n        console.log(`Verification complete. Processed ${totalCourses} courses. Fixed/Updated ${fixedCount} courses. Errors on: ${errorCourses.join(\", \")}`);\n        return {\n            fixed: fixedCount,\n            total: totalCourses,\n            errors: errorCourses\n        };\n    } catch (error) {\n        console.error(\"Error verifying course module counts:\", error);\n        throw error;\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bkYsUUFBUSxvQ0FBb0M7Z0JBQzVKLENBQUVnRixDQUFBQSxNQUFNQyxPQUFPLENBQUNSLFdBQVc1RSxXQUFXLEtBQUs0RSxXQUFXNUUsV0FBVyxDQUFDcUYsS0FBSyxDQUFDLENBQUNsRixLQUFnQixPQUFPQSxPQUFPLFlBQVk4RSxnQkFBZ0JLLFFBQVEsQ0FBQ25GLEtBQU0sK0NBQStDO2dCQUFsRCxHQUNqSjtvQkFDQStFLGFBQWFsRixXQUFXLEdBQUdpRjtvQkFDM0JKLGNBQWM7b0JBQ2R2RSxRQUFRNEQsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFdEUsU0FBUyw2QkFBNkIsQ0FBQztnQkFDakU7Z0JBRUUsMkdBQTJHO2dCQUMzRyxtREFBbUQ7Z0JBQ25ELDRIQUE0SDtnQkFHNUgsSUFBSWlGLGFBQWE7b0JBQ2YsTUFBTXpGLDZEQUFTQSxDQUFDSix1REFBR0EsQ0FBQ1UseURBQVNBLEVBQUUsQ0FBQyxRQUFRLEVBQUVFLFNBQVMsQ0FBQyxHQUFHc0Y7b0JBQ3ZEVDtnQkFDSjtZQUNGLEVBQUUsT0FBT2MsS0FBYztnQkFDbkJqRixRQUFRRCxLQUFLLENBQUMsQ0FBQyx3QkFBd0IsRUFBRVQsU0FBUyxxQkFBcUIsQ0FBQyxFQUFFMkY7Z0JBQzFFWixhQUFhekUsSUFBSSxDQUFDTjtZQUN0QjtRQUNGO1FBQ0VVLFFBQVE0RCxHQUFHLENBQUMsQ0FBQyxpQ0FBaUMsRUFBRVEsYUFBYSx3QkFBd0IsRUFBRUQsV0FBVyxxQkFBcUIsRUFBRUUsYUFBYWEsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUNsSixPQUFPO1lBQUNDLE9BQU9oQjtZQUFZaUIsT0FBT2hCO1lBQWNpQixRQUFRaEI7UUFBYTtJQUN6RSxFQUFFLE9BQU90RSxPQUFPO1FBQ1pDLFFBQVFELEtBQUssQ0FBQyx5Q0FBeUNBO1FBQ3ZELE1BQU1BO0lBQ1Y7QUFDQSxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhaW5pbmctcGxhdGZvcm0vLi9zcmMvc2VydmljZXMvbW9kdWxlU2VydmljZS50cz9hZTgzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGNvbGxlY3Rpb24sXG4gIGRvYyxcbiAgZ2V0RG9jLFxuICBnZXREb2NzLFxuICBhZGREb2MsXG4gIHVwZGF0ZURvYyxcbiAgZGVsZXRlRG9jLFxuICBxdWVyeSxcbiAgb3JkZXJCeSxcbiAgd3JpdGVCYXRjaCxcbiAgVGltZXN0YW1wLFxuICBEb2N1bWVudERhdGFcbn0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJztcbmltcG9ydCB7ZmlyZXN0b3JlIH0gZnJvbSAnQC9zZXJ2aWNlcy9maXJlYmFzZSc7XG5pbXBvcnQge01vZHVsZSwgTGVzc29uIH0gZnJvbSAnQC90eXBlcy9jb3Vyc2UudHlwZXMnO1xuXG4vKipcbiAqIEZldGNoIGFsbCBtb2R1bGVzIGZvciBhIGNvdXJzZVxuICovXG5leHBvcnQgY29uc3QgZmV0Y2hNb2R1bGVzID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPE1vZHVsZVtdPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgbW9kdWxlc1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCBgY291cnNlcy8ke2NvdXJzZUlkfS9tb2R1bGVzYCk7XG4gICAgY29uc3QgcSA9IHF1ZXJ5KG1vZHVsZXNSZWYsIG9yZGVyQnkoJ29yZGVyJywgJ2FzYycpKTtcbiAgICBjb25zdCBxdWVyeVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgIGNvbnN0IG1vZHVsZXNMaXN0OiBNb2R1bGVbXSA9IFtdO1xuICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XG4gICAgICBtb2R1bGVzTGlzdC5wdXNoKHtcbiAgICAgICAgaWQ6IGRvYy5pZCxcbiAgICAgICAgLi4uZG9jLmRhdGEoKSBhcyBPbWl0PE1vZHVsZSwgJ2lkJz5cbiAgICB9KTtcbiAgfSk7XG5cbiAgICByZXR1cm4gbW9kdWxlc0xpc3Q7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG1vZHVsZXM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBGZXRjaCBhIHNpbmdsZSBtb2R1bGUgYnkgSURcbiAqL1xuZXhwb3J0IGNvbnN0IGZldGNoTW9kdWxlID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcsIG1vZHVsZUlkOiBzdHJpbmcpOiBQcm9taXNlPE1vZHVsZT4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG1vZHVsZVJlZiA9IGRvYyhmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH1gKTtcbiAgICBjb25zdCBtb2R1bGVEb2MgPSBhd2FpdCBnZXREb2MobW9kdWxlUmVmKTtcblxuICAgIGlmICghbW9kdWxlRG9jLmV4aXN0cygpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBub3QgZm91bmQnKTtcbiAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBtb2R1bGVEb2MuaWQsXG4gICAgICAuLi5tb2R1bGVEb2MuZGF0YSgpIGFzIE9taXQ8TW9kdWxlLCAnaWQnPlxuICB9O1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBtb2R1bGU6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgbW9kdWxlXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVNb2R1bGUgPSBhc3luYyAoY291cnNlSWQ6IHN0cmluZywgbW9kdWxlRGF0YTogUGFydGlhbDxNb2R1bGU+KTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgdGhlIGhpZ2hlc3Qgb3JkZXIgdmFsdWVcbiAgICBjb25zdCBtb2R1bGVzID0gYXdhaXQgZmV0Y2hNb2R1bGVzKGNvdXJzZUlkKTtcbiAgICBjb25zdCBoaWdoZXN0T3JkZXIgPSBtb2R1bGVzLmxlbmd0aCA+IDBcbiAgICAgID8gTWF0aC5tYXgoLi4ubW9kdWxlcy5tYXAobSA9PiBtLm9yZGVyKSlcbiAgICAgIDogLTE7XG5cbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICBjb25zdCBuZXdNb2R1bGUgPSB7XG4gICAgICAuLi5tb2R1bGVEYXRhLFxuICAgICAgb3JkZXI6IGhpZ2hlc3RPcmRlciArIDEsXG4gICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgIHVwZGF0ZWRBdDogbm93XG4gIH07XG5cbiAgICBjb25zdCBkb2NSZWYgPSBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXNgKSwgbmV3TW9kdWxlKTtcblxuICAgIC8vIFVwZGF0ZSB0aGUgY291cnNlJ3MgbW9kdWxlIGNvdW50XG4gICAgYXdhaXQgdXBkYXRlQ291cnNlTW9kdWxlQ291bnQoY291cnNlSWQpO1xuXG4gICAgcmV0dXJuIGRvY1JlZi5pZDtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgbW9kdWxlOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbn1cbn07XG5cbi8qKlxuICogVXBkYXRlIGFuIGV4aXN0aW5nIG1vZHVsZVxuICovXG5leHBvcnQgY29uc3QgdXBkYXRlTW9kdWxlID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcsIG1vZHVsZUlkOiBzdHJpbmcsIG1vZHVsZURhdGE6IFBhcnRpYWw8TW9kdWxlPik6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG1vZHVsZVJlZiA9IGRvYyhmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH1gKTtcblxuICAgIGF3YWl0IHVwZGF0ZURvYyhtb2R1bGVSZWYsIHtcbiAgICAgIC4uLm1vZHVsZURhdGEsXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICB9KTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgbW9kdWxlOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbn1cbn07XG5cbi8qKlxuICogRGVsZXRlIGEgbW9kdWxlIGFuZCBhbGwgaXRzIGxlc3NvbnNcbiAqL1xuZXhwb3J0IGNvbnN0IGRlbGV0ZU1vZHVsZSA9IGFzeW5jIChjb3Vyc2VJZDogc3RyaW5nLCBtb2R1bGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgLy8gRmlyc3QsIGdldCBhbGwgbGVzc29ucyBmb3IgdGhpcyBtb2R1bGVcbiAgICBjb25zdCBsZXNzb25zUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH0vbGVzc29uc2ApO1xuICAgIGNvbnN0IGxlc3NvbnNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MobGVzc29uc1JlZik7XG5cbiAgICAvLyBVc2UgYSBiYXRjaCB0byBkZWxldGUgYWxsIGxlc3NvbnMgYW5kIHRoZSBtb2R1bGVcbiAgICBjb25zdCBiYXRjaCA9IHdyaXRlQmF0Y2goZmlyZXN0b3JlKTtcblxuICAgIC8vIEFkZCBsZXNzb24gZGVsZXRpb25zIHRvIGJhdGNoXG4gICAgbGVzc29uc1NuYXBzaG90LmZvckVhY2goKGxlc3NvbkRvYykgPT4ge1xuICAgICAgYmF0Y2guZGVsZXRlKGRvYyhmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH0vbGVzc29ucy8ke2xlc3NvbkRvYy5pZH1gKSk7XG4gIH0pO1xuXG4gICAgLy8gQWRkIG1vZHVsZSBkZWxldGlvbiB0byBiYXRjaFxuICAgIGJhdGNoLmRlbGV0ZShkb2MoZmlyZXN0b3JlLCBgY291cnNlcy8ke2NvdXJzZUlkfS9tb2R1bGVzLyR7bW9kdWxlSWR9YCkpO1xuXG4gICAgLy8gQ29tbWl0IHRoZSBiYXRjaFxuICAgIGF3YWl0IGJhdGNoLmNvbW1pdCgpO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBjb3Vyc2UncyBtb2R1bGUgY291bnRcbiAgICBhd2FpdCB1cGRhdGVDb3Vyc2VNb2R1bGVDb3VudChjb3Vyc2VJZCk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIGNvdXJzZSdzIHRvdGFsIGxlc3NvbiBjb3VudFxuICAgIGF3YWl0IHVwZGF0ZUNvdXJzZUxlc3NvbkNvdW50KGNvdXJzZUlkKTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgbW9kdWxlOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbn1cbn07XG5cbi8qKlxuICogVXBkYXRlIHRoZSBvcmRlciBvZiBtb2R1bGVzXG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVNb2R1bGVPcmRlciA9IGFzeW5jIChjb3Vyc2VJZDogc3RyaW5nLCBtb2R1bGVPcmRlcnM6IHtpZDogc3RyaW5nLCBvcmRlcjogbnVtYmVyIH1bXSk6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGJhdGNoID0gd3JpdGVCYXRjaChmaXJlc3RvcmUpO1xuXG4gICAgbW9kdWxlT3JkZXJzLmZvckVhY2goKHtpZCwgb3JkZXIgfSkgPT4ge1xuICAgICAgY29uc3QgbW9kdWxlUmVmID0gZG9jKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlcy8ke2lkfWApO1xuICAgICAgYmF0Y2gudXBkYXRlKG1vZHVsZVJlZiwge29yZGVyIH0pO1xuICB9KTtcblxuICAgIGF3YWl0IGJhdGNoLmNvbW1pdCgpO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBtb2R1bGUgb3JkZXI6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBGZXRjaCBhbGwgbGVzc29ucyBmb3IgYSBtb2R1bGVcbiAqL1xuZXhwb3J0IGNvbnN0IGZldGNoTGVzc29ucyA9IGFzeW5jIChjb3Vyc2VJZDogc3RyaW5nLCBtb2R1bGVJZDogc3RyaW5nKTogUHJvbWlzZTxMZXNzb25bXT4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGxlc3NvbnNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlcy8ke21vZHVsZUlkfS9sZXNzb25zYCk7XG4gICAgY29uc3QgcSA9IHF1ZXJ5KGxlc3NvbnNSZWYsIG9yZGVyQnkoJ29yZGVyJywgJ2FzYycpKTtcbiAgICBjb25zdCBxdWVyeVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgIGNvbnN0IGxlc3NvbnNMaXN0OiBMZXNzb25bXSA9IFtdO1xuICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XG4gICAgICBsZXNzb25zTGlzdC5wdXNoKHtcbiAgICAgICAgaWQ6IGRvYy5pZCxcbiAgICAgICAgLi4uZG9jLmRhdGEoKSBhcyBPbWl0PExlc3NvbiwgJ2lkJz5cbiAgICB9KTtcbiAgfSk7XG5cbiAgICByZXR1cm4gbGVzc29uc0xpc3Q7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGxlc3NvbnM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBGZXRjaCBhIHNpbmdsZSBsZXNzb24gYnkgSURcbiAqL1xuZXhwb3J0IGNvbnN0IGZldGNoTGVzc29uID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcsIG1vZHVsZUlkOiBzdHJpbmcsIGxlc3NvbklkOiBzdHJpbmcpOiBQcm9taXNlPExlc3Nvbj4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGxlc3NvblJlZiA9IGRvYyhmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH0vbGVzc29ucy8ke2xlc3NvbklkfWApO1xuICAgIGNvbnN0IGxlc3NvbkRvYyA9IGF3YWl0IGdldERvYyhsZXNzb25SZWYpO1xuXG4gICAgaWYgKCFsZXNzb25Eb2MuZXhpc3RzKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTGVzc29uIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGxlc3NvbkRvYy5pZCxcbiAgICAgIC4uLmxlc3NvbkRvYy5kYXRhKCkgYXMgT21pdDxMZXNzb24sICdpZCc+XG4gIH07XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGxlc3NvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBsZXNzb25cbiAqL1xuZXhwb3J0IGNvbnN0IGNyZWF0ZUxlc3NvbiA9IGFzeW5jIChjb3Vyc2VJZDogc3RyaW5nLCBtb2R1bGVJZDogc3RyaW5nLCBsZXNzb25EYXRhOiBQYXJ0aWFsPExlc3Nvbj4pOiBQcm9taXNlPHN0cmluZz4gPT4ge1xuICB0cnkge1xuICAgIC8vIEdldCB0aGUgaGlnaGVzdCBvcmRlciB2YWx1ZVxuICAgIGNvbnN0IGxlc3NvbnMgPSBhd2FpdCBmZXRjaExlc3NvbnMoY291cnNlSWQsIG1vZHVsZUlkKTtcbiAgICBjb25zdCBoaWdoZXN0T3JkZXIgPSBsZXNzb25zLmxlbmd0aCA+IDBcbiAgICAgID8gTWF0aC5tYXgoLi4ubGVzc29ucy5tYXAobCA9PiBsLm9yZGVyKSlcbiAgICAgIDogLTE7XG5cbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICBjb25zdCBuZXdMZXNzb24gPSB7XG4gICAgICAuLi5sZXNzb25EYXRhLFxuICAgICAgb3JkZXI6IGhpZ2hlc3RPcmRlciArIDEsXG4gICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgIHVwZGF0ZWRBdDogbm93XG4gIH07XG5cbiAgICBjb25zdCBkb2NSZWYgPSBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH0vbGVzc29uc2ApLCBuZXdMZXNzb24pO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBtb2R1bGUncyBsZXNzb24gY291bnRcbiAgICBhd2FpdCB1cGRhdGVNb2R1bGVMZXNzb25Db3VudChjb3Vyc2VJZCwgbW9kdWxlSWQpO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBjb3Vyc2UncyB0b3RhbCBsZXNzb24gY291bnRcbiAgICBhd2FpdCB1cGRhdGVDb3Vyc2VMZXNzb25Db3VudChjb3Vyc2VJZCk7XG5cbiAgICByZXR1cm4gZG9jUmVmLmlkO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBsZXNzb246JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBVcGRhdGUgYW4gZXhpc3RpbmcgbGVzc29uXG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVMZXNzb24gPSBhc3luYyAoY291cnNlSWQ6IHN0cmluZywgbW9kdWxlSWQ6IHN0cmluZywgbGVzc29uSWQ6IHN0cmluZywgbGVzc29uRGF0YTogUGFydGlhbDxMZXNzb24+KTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgbGVzc29uUmVmID0gZG9jKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlcy8ke21vZHVsZUlkfS9sZXNzb25zLyR7bGVzc29uSWR9YCk7XG5cbiAgICBhd2FpdCB1cGRhdGVEb2MobGVzc29uUmVmLCB7XG4gICAgICAuLi5sZXNzb25EYXRhLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfSk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGxlc3NvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIERlbGV0ZSBhIGxlc3NvblxuICovXG5leHBvcnQgY29uc3QgZGVsZXRlTGVzc29uID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcsIG1vZHVsZUlkOiBzdHJpbmcsIGxlc3NvbklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkZWxldGVEb2MoZG9jKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlcy8ke21vZHVsZUlkfS9sZXNzb25zLyR7bGVzc29uSWR9YCkpO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBtb2R1bGUncyBsZXNzb24gY291bnRcbiAgICBhd2FpdCB1cGRhdGVNb2R1bGVMZXNzb25Db3VudChjb3Vyc2VJZCwgbW9kdWxlSWQpO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBjb3Vyc2UncyB0b3RhbCBsZXNzb24gY291bnRcbiAgICBhd2FpdCB1cGRhdGVDb3Vyc2VMZXNzb25Db3VudChjb3Vyc2VJZCk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGxlc3NvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIFVwZGF0ZSB0aGUgb3JkZXIgb2YgbGVzc29uc1xuICovXG5leHBvcnQgY29uc3QgdXBkYXRlTGVzc29uT3JkZXIgPSBhc3luYyAoY291cnNlSWQ6IHN0cmluZywgbW9kdWxlSWQ6IHN0cmluZywgbGVzc29uT3JkZXJzOiB7aWQ6IHN0cmluZywgb3JkZXI6IG51bWJlciB9W10pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXRjaCA9IHdyaXRlQmF0Y2goZmlyZXN0b3JlKTtcblxuICAgIGxlc3Nvbk9yZGVycy5mb3JFYWNoKCh7aWQsIG9yZGVyIH0pID0+IHtcbiAgICAgIGNvbnN0IGxlc3NvblJlZiA9IGRvYyhmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJZH0vbGVzc29ucy8ke2lkfWApO1xuICAgICAgYmF0Y2gudXBkYXRlKGxlc3NvblJlZiwge29yZGVyIH0pO1xuICB9KTtcblxuICAgIGF3YWl0IGJhdGNoLmNvbW1pdCgpO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBsZXNzb24gb3JkZXI6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBVcGRhdGUgdGhlIGxlc3NvbiBjb3VudCBmb3IgYSBtb2R1bGVcbiAqL1xuZXhwb3J0IGNvbnN0IHVwZGF0ZU1vZHVsZUxlc3NvbkNvdW50ID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcsIG1vZHVsZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBsZXNzb25zID0gYXdhaXQgZmV0Y2hMZXNzb25zKGNvdXJzZUlkLCBtb2R1bGVJZCk7XG4gICAgY29uc3QgbW9kdWxlUmVmID0gZG9jKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlcy8ke21vZHVsZUlkfWApO1xuXG4gICAgYXdhaXQgdXBkYXRlRG9jKG1vZHVsZVJlZiwge1xuICAgICAgbGVzc29uQ291bnQ6IGxlc3NvbnMubGVuZ3RoLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfSk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIG1vZHVsZSBsZXNzb24gY291bnQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBVcGRhdGUgdGhlIG1vZHVsZSBjb3VudCBmb3IgYSBjb3Vyc2VcbiAqL1xuLy8gTW9kdWxlU2VydmljZS50c1xuZXhwb3J0IGNvbnN0IHVwZGF0ZUNvdXJzZU1vZHVsZUNvdW50ID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBEaXJlY3RseSBxdWVyeSB0aGUgbW9kdWxlcyBzdWJjb2xsZWN0aW9uIHRvIGdldCBhbiBhY2N1cmF0ZSBjb3VudFxuICAgIGNvbnN0IG1vZHVsZXNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH0vbW9kdWxlc2ApO1xuICAgIGNvbnN0IG1vZHVsZXNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MobW9kdWxlc1JlZik7IC8vIDwtLS0gVGhpcyBnZXRzIHRoZSBhY3R1YWwgY291bnRcbiAgICBjb25zdCBtb2R1bGVDb3VudCA9IG1vZHVsZXNTbmFwc2hvdC5zaXplO1xuXG4gICAgLy8gR2V0IG1vZHVsZSBJRHMgZm9yIHRoZSBtb2R1bGVzTGlzdCBmaWVsZFxuICAgIGNvbnN0IG1vZHVsZUlkcyA9IG1vZHVsZXNTbmFwc2hvdC5kb2NzLm1hcChkb2MgPT4gZG9jLmlkKTtcblxuICAgIGNvbnN0IGNvdXJzZVJlZiA9IGRvYyhmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9YCk7XG4gICAgY29uc3QgY291cnNlRG9jID0gYXdhaXQgZ2V0RG9jKGNvdXJzZVJlZik7XG4gICAgaWYgKCFjb3Vyc2VEb2MuZXhpc3RzKCkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYENvdXJzZSBkb2N1bWVudCB3aXRoIElEICR7Y291cnNlSWR9IGRvZXMgbm90IGV4aXN0LmApO1xuICAgICAgLy8gQ29uc2lkZXIgdGhyb3dpbmcgYW4gZXJyb3Igb3IgaGFuZGxpbmcgdGhpcyBjYXNlIG1vcmUgZXhwbGljaXRseVxuICAgICAgLy8gaWYgYSBjb3Vyc2UgZG9jdW1lbnQgTVVTVCBleGlzdCB3aGVuIG1vZHVsZXMgYXJlIGJlaW5nIG1hbmFnZWQuXG4gICAgICByZXR1cm47XG4gIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgY291cnNlIGRvY3VtZW50XG4gICAgYXdhaXQgdXBkYXRlRG9jKGNvdXJzZVJlZiwge1xuICAgICAgbW9kdWxlczogbW9kdWxlQ291bnQsICAgIC8vIDwtLS0gVGhpcyBpcyB0aGUgY3JpdGljYWwgdXBkYXRlXG4gICAgICBtb2R1bGVzTGlzdDogbW9kdWxlSWRzLCAgLy8gU3RvcmUgbW9kdWxlIElEcyBhcyBhcnJheVxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgLy8gT3Igc2VydmVyVGltZXN0YW1wKClcbiAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhgVXBkYXRlZCBtb2R1bGUgY291bnQgZm9yIGNvdXJzZSAke2NvdXJzZUlkfSB0byAke21vZHVsZUNvdW50fWApO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBjb3Vyc2UgbW9kdWxlIGNvdW50OicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjsgLy8gUmUtdGhyb3cgdG8gYWxsb3cgY2FsbGluZyBmdW5jdGlvbiB0byBoYW5kbGUgaXRcbn1cbn07XG5cbi8qKlxuICogVmVyaWZ5IGFuZCB1cGRhdGUgYWxsIG1vZHVsZSBsZXNzb24gY291bnRzIGZvciBhIGNvdXJzZVxuICovXG5leHBvcnQgY29uc3QgdmVyaWZ5QWxsTW9kdWxlTGVzc29uQ291bnRzID0gYXN5bmMgKGNvdXJzZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBtb2R1bGVzID0gYXdhaXQgZmV0Y2hNb2R1bGVzKGNvdXJzZUlkKTtcbiAgICBjb25zdCBiYXRjaCA9IHdyaXRlQmF0Y2goZmlyZXN0b3JlKTtcblxuICAgIC8vIFVwZGF0ZSBlYWNoIG1vZHVsZSdzIGxlc3NvbiBjb3VudFxuICAgIGZvciAoY29uc3QgbW9kdWxlSXRlbSBvZiBtb2R1bGVzKSB7XG4gICAgICBjb25zdCBsZXNzb25zID0gYXdhaXQgZmV0Y2hMZXNzb25zKGNvdXJzZUlkLCBtb2R1bGVJdGVtLmlkKTtcbiAgICAgIGNvbnN0IG1vZHVsZVJlZiA9IGRvYyhmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXMvJHttb2R1bGVJdGVtLmlkfWApO1xuXG4gICAgICBiYXRjaC51cGRhdGUobW9kdWxlUmVmLCB7XG4gICAgICAgIGxlc3NvbkNvdW50OiBsZXNzb25zLmxlbmd0aCxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KTtcbiAgfVxuXG4gICAgLy8gQ29tbWl0IGFsbCB1cGRhdGVzIGluIGEgc2luZ2xlIGJhdGNoXG4gICAgYXdhaXQgYmF0Y2guY29tbWl0KCk7XG5cbiAgICAvLyBOb3cgdXBkYXRlIHRoZSBjb3Vyc2UncyB0b3RhbCBsZXNzb24gY291bnRcbiAgICBhd2FpdCB1cGRhdGVDb3Vyc2VMZXNzb25Db3VudChjb3Vyc2VJZCk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHZlcmlmeWluZyBtb2R1bGUgbGVzc29uIGNvdW50czonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIFVwZGF0ZSB0aGUgdG90YWwgbGVzc29uIGNvdW50IGZvciBhIGNvdXJzZVxuICovXG5leHBvcnQgY29uc3QgdXBkYXRlQ291cnNlTGVzc29uQ291bnQgPSBhc3luYyAoY291cnNlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG1vZHVsZXMgPSBhd2FpdCBmZXRjaE1vZHVsZXMoY291cnNlSWQpO1xuICAgIGxldCB0b3RhbExlc3NvbnMgPSAwO1xuXG4gICAgLy8gU3VtIHVwIGxlc3NvbiBjb3VudHMgZnJvbSBhbGwgbW9kdWxlcyB1c2luZyB0aGVpciBsZXNzb25Db3VudCBwcm9wZXJ0eVxuICAgIC8vIFRoaXMgaXMgbW9yZSBlZmZpY2llbnQgdGhhbiBmZXRjaGluZyBhbGwgbGVzc29ucyBmb3IgZWFjaCBtb2R1bGVcbiAgICBmb3IgKGNvbnN0IG1vZHVsZURhdGEgb2YgbW9kdWxlcykge1xuICAgICAgLy8gVXNlIHRoZSBtb2R1bGUncyBsZXNzb25Db3VudCBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSBmZXRjaCBsZXNzb25zXG4gICAgICBpZiAodHlwZW9mIG1vZHVsZURhdGEubGVzc29uQ291bnQgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHRvdGFsTGVzc29ucyArPSBtb2R1bGVEYXRhLmxlc3NvbkNvdW50O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGxlc3NvbnMgPSBhd2FpdCBmZXRjaExlc3NvbnMoY291cnNlSWQsIG1vZHVsZURhdGEuaWQpO1xuICAgICAgICB0b3RhbExlc3NvbnMgKz0gbGVzc29ucy5sZW5ndGg7XG4gICAgfVxuICB9XG5cbiAgICBjb25zdCBjb3Vyc2VSZWYgPSBkb2MoZmlyZXN0b3JlLCBgY291cnNlcy8ke2NvdXJzZUlkfWApO1xuXG4gICAgYXdhaXQgdXBkYXRlRG9jKGNvdXJzZVJlZiwge1xuICAgICAgbGVzc29uczogdG90YWxMZXNzb25zLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfSk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNvdXJzZSBsZXNzb24gY291bnQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBWZXJpZnkgYW5kIGZpeCBtb2R1bGUgY291bnRzIGZvciBhbGwgY291cnNlc1xuICogVGhpcyB1dGlsaXR5IGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGVuc3VyZSBhbGwgY291cnNlcyBoYXZlIGNvcnJlY3QgbW9kdWxlIGNvdW50c1xuICovXG4vLyBNb2R1bGVTZXJ2aWNlLnRzIC0gdmVyaWZ5QWxsQ291cnNlTW9kdWxlQ291bnRzXG4vLyBUaGlzIGZ1bmN0aW9uIGlzIGdvb2QuIE5vIGNoYW5nZXMgbmVlZGVkIGhlcmUgZm9yIGl0cyBsb2dpYy5cbmV4cG9ydCBjb25zdCB2ZXJpZnlBbGxDb3Vyc2VNb2R1bGVDb3VudHMgPSBhc3luYyAoKTogUHJvbWlzZTx7Zml4ZWQ6IG51bWJlciwgdG90YWw6IG51bWJlciwgZXJyb3JzOiBzdHJpbmdbXSB9PiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY291cnNlc1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAnY291cnNlcycpO1xuICAgIGNvbnN0IGNvdXJzZXNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoY291cnNlc1JlZik7XG4gICAgbGV0IGZpeGVkQ291bnQgPSAwO1xuICAgIGNvbnN0IHRvdGFsQ291cnNlcyA9IGNvdXJzZXNTbmFwc2hvdC5zaXplO1xuICAgIGNvbnN0IGVycm9yQ291cnNlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgY291cnNlRG9jIG9mIGNvdXJzZXNTbmFwc2hvdC5kb2NzKSB7XG4gICAgICBjb25zdCBjb3Vyc2VJZCA9IGNvdXJzZURvYy5pZDtcbiAgICAgIGNvbnN0IGNvdXJzZURhdGEgPSBjb3Vyc2VEb2MuZGF0YSgpO1xuICAgICAgbGV0IG5lZWRzVXBkYXRlID0gZmFsc2U7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZXNTdWJjb2xsZWN0aW9uUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsIGBjb3Vyc2VzLyR7Y291cnNlSWR9L21vZHVsZXNgKTtcbiAgICAgICAgY29uc3QgbW9kdWxlc1N1YmNvbGxlY3Rpb25TbmFwc2hvdCA9IGF3YWl0IGdldERvY3MobW9kdWxlc1N1YmNvbGxlY3Rpb25SZWYpO1xuICAgICAgICBjb25zdCBhY3R1YWxNb2R1bGVDb3VudCA9IG1vZHVsZXNTdWJjb2xsZWN0aW9uU25hcHNob3Quc2l6ZTsgLy8gTnVtYmVyXG4gICAgICAgIGNvbnN0IGFjdHVhbE1vZHVsZUlkcyA9IG1vZHVsZXNTdWJjb2xsZWN0aW9uU25hcHNob3QuZG9jcy5tYXAoZG9jID0+IGRvYy5pZCk7IC8vIHN0cmluZ1tdXG5cbiAgICAgICAgY29uc3QgZGF0YVRvVXBkYXRlOiBEb2N1bWVudERhdGEgPSB7dXBkYXRlZEF0OiBUaW1lc3RhbXAubm93KCkgfTtcblxuICAgICAgICAvLyBDaGVjayBpZiAnbW9kdWxlcycgZmllbGQgbmVlZHMgZml4aW5nIChlaXRoZXIgd3JvbmcgdHlwZSBvciB3cm9uZyB2YWx1ZSlcbiAgICAgICAgaWYgKHR5cGVvZiBjb3Vyc2VEYXRhLm1vZHVsZXMgIT09ICdudW1iZXInIHx8IGNvdXJzZURhdGEubW9kdWxlcyAhPT0gYWN0dWFsTW9kdWxlQ291bnQpIHtcbiAgICAgICAgICBkYXRhVG9VcGRhdGUubW9kdWxlcyA9IGFjdHVhbE1vZHVsZUNvdW50O1xuICAgICAgICAgIG5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgQ291cnNlICR7Y291cnNlSWR9OiBGaXhpbmcgJ21vZHVsZXMnIGZpZWxkLiBTdG9yZWQ6ICR7Y291cnNlRGF0YS5tb2R1bGVzfSAodHlwZTogJHt0eXBlb2YgY291cnNlRGF0YS5tb2R1bGVzfSksIEFjdHVhbCBjb3VudDogJHthY3R1YWxNb2R1bGVDb3VudH1gKTtcbiAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiAnbW9kdWxlc0xpc3QnIGZpZWxkIG5lZWRzIGZpeGluZyBvciBhZGRpbmdcbiAgICAgICAgLy8gU2ltcGxlIGNoZWNrOiBpZiBpdCBkb2Vzbid0IGV4aXN0IG9yIGl0cyBsZW5ndGggZG9lc24ndCBtYXRjaCBhY3R1YWwgY291bnRcbiAgICAgICAgLy8gTW9yZSByb2J1c3Q6IGRlZXAgY29tcGFyaXNvbiBvZiBhcnJheXMgaWYgb3JkZXIgbWF0dGVycyBhbmQgaXMgZ3VhcmFudGVlZFxuICAgICAgICBpZiAoIWNvdXJzZURhdGEubW9kdWxlc0xpc3QgfHwgIUFycmF5LmlzQXJyYXkoY291cnNlRGF0YS5tb2R1bGVzTGlzdCkgfHwgY291cnNlRGF0YS5tb2R1bGVzTGlzdC5sZW5ndGggIT09IGFjdHVhbE1vZHVsZUlkcy5sZW5ndGggfHxcbiAgICAgICAgICAgICFhY3R1YWxNb2R1bGVJZHMuZXZlcnkoKGlkOiBzdHJpbmcpID0+IEFycmF5LmlzQXJyYXkoY291cnNlRGF0YS5tb2R1bGVzTGlzdCkgJiYgY291cnNlRGF0YS5tb2R1bGVzTGlzdC5pbmNsdWRlcyhpZCkpIHx8IC8vIEVuc3VyZSBhbGwgYWN0dWFsIElEcyBhcmUgcHJlc2VudFxuICAgICAgICAgICAgIShBcnJheS5pc0FycmF5KGNvdXJzZURhdGEubW9kdWxlc0xpc3QpICYmIGNvdXJzZURhdGEubW9kdWxlc0xpc3QuZXZlcnkoKGlkOiB1bmtub3duKSA9PiB0eXBlb2YgaWQgPT09ICdzdHJpbmcnICYmIGFjdHVhbE1vZHVsZUlkcy5pbmNsdWRlcyhpZCkpKSAvLyBFbnN1cmUgYWxsIHN0b3JlZCBJRHMgYXJlIGFjdHVhbCBhbmQgc3RyaW5nc1xuICAgICAgICApIHtcbiAgICAgICAgICBkYXRhVG9VcGRhdGUubW9kdWxlc0xpc3QgPSBhY3R1YWxNb2R1bGVJZHM7XG4gICAgICAgICAgbmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBDb3Vyc2UgJHtjb3Vyc2VJZH06IEZpeGluZyAnbW9kdWxlc0xpc3QnIGZpZWxkLmApO1xuICAgICAgfVxuXG4gICAgICAgIC8vIElmICdtb2R1bGVzQ291bnQnIGZpZWxkIGV4aXN0cyBhbmQgaXMgZGlmZmVyZW50LCB5b3UgbWlnaHQgd2FudCB0byByZW1vdmUgaXQgb3IgZW5zdXJlIGl0J3MgYWxzbyBjb3JyZWN0XG4gICAgICAgIC8vIEZvciBub3csIGZvY3VzaW5nIG9uICdtb2R1bGVzJyBhbmQgJ21vZHVsZXNMaXN0J1xuICAgICAgICAvLyBFeGFtcGxlOiBpZiAoY291cnNlRGF0YS5oYXNPd25Qcm9wZXJ0eSgnbW9kdWxlc0NvdW50JykpIHtkYXRhVG9VcGRhdGUubW9kdWxlc0NvdW50ID0gZGVsZXRlRmllbGQoKTsgbmVlZHNVcGRhdGUgPSB0cnVlOyB9XG5cblxuICAgICAgICBpZiAobmVlZHNVcGRhdGUpIHtcbiAgICAgICAgICBhd2FpdCB1cGRhdGVEb2MoZG9jKGZpcmVzdG9yZSwgYGNvdXJzZXMvJHtjb3Vyc2VJZH1gKSwgZGF0YVRvVXBkYXRlKTtcbiAgICAgICAgICBmaXhlZENvdW50Kys7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyOiB1bmtub3duKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgY291cnNlICR7Y291cnNlSWR9IGR1cmluZyB2ZXJpZmljYXRpb246YCwgZXJyKTtcbiAgICAgICAgZXJyb3JDb3Vyc2VzLnB1c2goY291cnNlSWQpO1xuICAgIH1cbiAgfVxuICAgIGNvbnNvbGUubG9nKGBWZXJpZmljYXRpb24gY29tcGxldGUuIFByb2Nlc3NlZCAke3RvdGFsQ291cnNlc30gY291cnNlcy4gRml4ZWQvVXBkYXRlZCAke2ZpeGVkQ291bnR9IGNvdXJzZXMuIEVycm9ycyBvbjogJHtlcnJvckNvdXJzZXMuam9pbignLCAnKX1gKTtcbiAgICByZXR1cm4ge2ZpeGVkOiBmaXhlZENvdW50LCB0b3RhbDogdG90YWxDb3Vyc2VzLCBlcnJvcnM6IGVycm9yQ291cnNlcyB9O1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB2ZXJpZnlpbmcgY291cnNlIG1vZHVsZSBjb3VudHM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcbiJdLCJuYW1lcyI6WyJjb2xsZWN0aW9uIiwiZG9jIiwiZ2V0RG9jIiwiZ2V0RG9jcyIsImFkZERvYyIsInVwZGF0ZURvYyIsImRlbGV0ZURvYyIsInF1ZXJ5Iiwib3JkZXJCeSIsIndyaXRlQmF0Y2giLCJUaW1lc3RhbXAiLCJmaXJlc3RvcmUiLCJmZXRjaE1vZHVsZXMiLCJjb3Vyc2VJZCIsIm1vZHVsZXNSZWYiLCJxIiwicXVlcnlTbmFwc2hvdCIsIm1vZHVsZXNMaXN0IiwiZm9yRWFjaCIsInB1c2giLCJpZCIsImRhdGEiLCJlcnJvciIsImNvbnNvbGUiLCJmZXRjaE1vZHVsZSIsIm1vZHVsZUlkIiwibW9kdWxlUmVmIiwibW9kdWxlRG9jIiwiZXhpc3RzIiwiRXJyb3IiLCJjcmVhdGVNb2R1bGUiLCJtb2R1bGVEYXRhIiwibW9kdWxlcyIsImhpZ2hlc3RPcmRlciIsImxlbmd0aCIsIk1hdGgiLCJtYXgiLCJtYXAiLCJtIiwib3JkZXIiLCJub3ciLCJEYXRlIiwidG9JU09TdHJpbmciLCJuZXdNb2R1bGUiLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJkb2NSZWYiLCJ1cGRhdGVDb3Vyc2VNb2R1bGVDb3VudCIsInVwZGF0ZU1vZHVsZSIsImRlbGV0ZU1vZHVsZSIsImxlc3NvbnNSZWYiLCJsZXNzb25zU25hcHNob3QiLCJiYXRjaCIsImxlc3NvbkRvYyIsImRlbGV0ZSIsImNvbW1pdCIsInVwZGF0ZUNvdXJzZUxlc3NvbkNvdW50IiwidXBkYXRlTW9kdWxlT3JkZXIiLCJtb2R1bGVPcmRlcnMiLCJ1cGRhdGUiLCJmZXRjaExlc3NvbnMiLCJsZXNzb25zTGlzdCIsImZldGNoTGVzc29uIiwibGVzc29uSWQiLCJsZXNzb25SZWYiLCJjcmVhdGVMZXNzb24iLCJsZXNzb25EYXRhIiwibGVzc29ucyIsImwiLCJuZXdMZXNzb24iLCJ1cGRhdGVNb2R1bGVMZXNzb25Db3VudCIsInVwZGF0ZUxlc3NvbiIsImRlbGV0ZUxlc3NvbiIsInVwZGF0ZUxlc3Nvbk9yZGVyIiwibGVzc29uT3JkZXJzIiwibGVzc29uQ291bnQiLCJtb2R1bGVzU25hcHNob3QiLCJtb2R1bGVDb3VudCIsInNpemUiLCJtb2R1bGVJZHMiLCJkb2NzIiwiY291cnNlUmVmIiwiY291cnNlRG9jIiwibG9nIiwidmVyaWZ5QWxsTW9kdWxlTGVzc29uQ291bnRzIiwibW9kdWxlSXRlbSIsInRvdGFsTGVzc29ucyIsInZlcmlmeUFsbENvdXJzZU1vZHVsZUNvdW50cyIsImNvdXJzZXNSZWYiLCJjb3Vyc2VzU25hcHNob3QiLCJmaXhlZENvdW50IiwidG90YWxDb3Vyc2VzIiwiZXJyb3JDb3Vyc2VzIiwiY291cnNlRGF0YSIsIm5lZWRzVXBkYXRlIiwibW9kdWxlc1N1YmNvbGxlY3Rpb25SZWYiLCJtb2R1bGVzU3ViY29sbGVjdGlvblNuYXBzaG90IiwiYWN0dWFsTW9kdWxlQ291bnQiLCJhY3R1YWxNb2R1bGVJZHMiLCJkYXRhVG9VcGRhdGUiLCJBcnJheSIsImlzQXJyYXkiLCJldmVyeSIsImluY2x1ZGVzIiwiZXJyIiwiam9pbiIsImZpeGVkIiwidG90YWwiLCJlcnJvcnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/services/moduleService.ts\n");

/***/ }),

/***/ "./src/services/notificationService.ts":
/*!*********************************************!*\
  !*** ./src/services/notificationService.ts ***!
  \*********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createNotification: () => (/* binding */ createNotification),\n/* harmony export */   deleteAllNotifications: () => (/* binding */ deleteAllNotifications),\n/* harmony export */   deleteExpiredNotifications: () => (/* binding */ deleteExpiredNotifications),\n/* harmony export */   deleteNotification: () => (/* binding */ deleteNotification),\n/* harmony export */   getUnreadNotificationsCount: () => (/* binding */ getUnreadNotificationsCount),\n/* harmony export */   getUserNotifications: () => (/* binding */ getUserNotifications),\n/* harmony export */   markAllNotificationsAsRead: () => (/* binding */ markAllNotificationsAsRead),\n/* harmony export */   markNotificationAsRead: () => (/* binding */ markNotificationAsRead)\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _services_firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/services/firebase */ \"./src/services/firebase.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _services_firebase__WEBPACK_IMPORTED_MODULE_1__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _services_firebase__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n/**\n * Create a notification\n */ const createNotification = async (notification)=>{\n    try {\n        const notificationsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\");\n        const now = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)();\n        const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)(notificationsRef, {\n            ...notification,\n            isRead: false,\n            createdAt: now\n        });\n        return docRef.id;\n    } catch (error) {\n        console.error(\"Error creating notification:\", error);\n        throw error;\n    }\n};\n/**\n * Get notifications for a user\n */ const getUserNotifications = async (userId, limitCount = 50)=>{\n    try {\n        const notificationsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\");\n        // Try to use the composite index first\n        try {\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(notificationsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.limit)(limitCount));\n            const notificationsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            return notificationsSnapshot.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                }));\n        } catch (indexError) {\n            // If we get an index error, fall back to a simpler query without ordering\n            console.warn(\"Index error, falling back to simpler query:\", indexError);\n            // Fallback query without ordering\n            const fallbackQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(notificationsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.limit)(limitCount));\n            const fallbackSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(fallbackQuery);\n            // Sort the results in memory\n            const notifications = fallbackSnapshot.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                }));\n            // Sort by createdAt in descending order if the field exists\n            return notifications.sort((a, b)=>{\n                const dateA = a.createdAt ? a.createdAt instanceof firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp ? a.createdAt.toMillis() : new Date(a.createdAt).getTime() : 0;\n                const dateB = b.createdAt ? b.createdAt instanceof firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp ? b.createdAt.toMillis() : new Date(b.createdAt).getTime() : 0;\n                return dateB - dateA;\n            });\n        }\n    } catch (error) {\n        console.error(\"Error getting user notifications:\", error);\n        // Return empty array instead of throwing to prevent app crashes\n        return [];\n    }\n};\n/**\n * Get unread notifications count for a user\n */ const getUnreadNotificationsCount = async (userId)=>{\n    try {\n        const notificationsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(notificationsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"isRead\", \"==\", false));\n        const notificationsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return notificationsSnapshot.size;\n    } catch (error) {\n        console.error(\"Error getting unread notifications count:\", error);\n        throw error;\n    }\n};\n/**\n * Mark a notification as read\n */ const markNotificationAsRead = async (notificationId)=>{\n    try {\n        const notificationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\", notificationId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(notificationRef, {\n            isRead: true\n        });\n    } catch (error) {\n        console.error(\"Error marking notification as read:\", error);\n        throw error;\n    }\n};\n/**\n * Mark all notifications as read for a user\n */ const markAllNotificationsAsRead = async (userId)=>{\n    try {\n        const notificationsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(notificationsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"isRead\", \"==\", false));\n        const notificationsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        // Update each notification\n        const updatePromises = notificationsSnapshot.docs.map((doc)=>(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(doc.ref, {\n                isRead: true\n            }));\n        await Promise.all(updatePromises);\n    } catch (error) {\n        console.error(\"Error marking all notifications as read:\", error);\n        throw error;\n    }\n};\n/**\n * Delete a notification\n */ const deleteNotification = async (notificationId)=>{\n    try {\n        const notificationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\", notificationId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(notificationRef);\n    } catch (error) {\n        console.error(\"Error deleting notification:\", error);\n        throw error;\n    }\n};\n/**\n * Delete all notifications for a user\n */ const deleteAllNotifications = async (userId)=>{\n    try {\n        const notificationsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(notificationsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId));\n        const notificationsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        // Delete each notification\n        const deletePromises = notificationsSnapshot.docs.map((doc)=>(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(doc.ref));\n        await Promise.all(deletePromises);\n    } catch (error) {\n        console.error(\"Error deleting all notifications:\", error);\n        throw error;\n    }\n};\n/**\n * Delete expired notifications\n */ const deleteExpiredNotifications = async ()=>{\n    try {\n        const now = new Date().toISOString();\n        const notificationsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_services_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"notifications\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(notificationsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"expiresAt\", \"<=\", now));\n        const notificationsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        // Delete each expired notification\n        const deletePromises = notificationsSnapshot.docs.map((doc)=>(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(doc.ref));\n        await Promise.all(deletePromises);\n        return notificationsSnapshot.size;\n    } catch (error) {\n        console.error(\"Error deleting expired notifications:\", error);\n        return 0;\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNHO1FBRWxCLE9BQU83QixzQkFBc0JrQixJQUFJO0lBQ3JDLEVBQUUsT0FBT3hCLE9BQU87UUFDWkMsUUFBUUQsS0FBSyxDQUFDLHlDQUF5Q0E7UUFDdkQsT0FBTztJQUNYO0FBQ0EsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL3NlcnZpY2VzL25vdGlmaWNhdGlvblNlcnZpY2UudHM/ZjE4OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBjb2xsZWN0aW9uLFxuICBkb2MsXG4gIGdldERvY3MsXG4gIHF1ZXJ5LFxuICB3aGVyZSxcbiAgYWRkRG9jLFxuICB1cGRhdGVEb2MsXG4gIGRlbGV0ZURvYyxcbiAgc2VydmVyVGltZXN0YW1wLFxuICBUaW1lc3RhbXAsXG4gIG9yZGVyQnksXG4gIGxpbWl0XG59IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7XG5pbXBvcnQge2ZpcmVzdG9yZSB9IGZyb20gJ0Avc2VydmljZXMvZmlyZWJhc2UnO1xuaW1wb3J0IHtOb3RpZmljYXRpb25UZW1wbGF0ZVR5cGUgfSBmcm9tICdAL3R5cGVzL25vdGlmaWNhdGlvbi10ZW1wbGF0ZXMudHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIE5vdGlmaWNhdGlvbiB7XG4gIGlkOiBzdHJpbmc7XG4gIHVzZXJJZDogc3RyaW5nO1xuICB0eXBlOiBOb3RpZmljYXRpb25UZW1wbGF0ZVR5cGU7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgaXNSZWFkOiBib29sZWFuO1xuICBjcmVhdGVkQXQ6IFRpbWVzdGFtcDtcbiAgbGluaz86IHN0cmluZztcbiAgZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICBleHBpcmVzQXQ/OiBUaW1lc3RhbXA7XG4gIHByaW9yaXR5PzogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJztcbiAgc2VuZGVyPzoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGF2YXRhcj86IHN0cmluZztcbn07XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbm90aWZpY2F0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVOb3RpZmljYXRpb24gPSBhc3luYyAobm90aWZpY2F0aW9uOiBPbWl0PE5vdGlmaWNhdGlvbiwgJ2lkJyB8ICdpc1JlYWQnIHwgJ2NyZWF0ZWRBdCc+KTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBub3RpZmljYXRpb25zUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsICdub3RpZmljYXRpb25zJyk7XG4gICAgY29uc3Qgbm93ID0gc2VydmVyVGltZXN0YW1wKCk7XG5cbiAgICBjb25zdCBkb2NSZWYgPSBhd2FpdCBhZGREb2Mobm90aWZpY2F0aW9uc1JlZiwge1xuICAgICAgLi4ubm90aWZpY2F0aW9uLFxuICAgICAgaXNSZWFkOiBmYWxzZSxcbiAgICAgIGNyZWF0ZWRBdDogbm93XG4gIH0pO1xuXG4gICAgcmV0dXJuIGRvY1JlZi5pZDtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgbm90aWZpY2F0aW9uOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbn1cbn07XG5cbi8qKlxuICogR2V0IG5vdGlmaWNhdGlvbnMgZm9yIGEgdXNlclxuICovXG5leHBvcnQgY29uc3QgZ2V0VXNlck5vdGlmaWNhdGlvbnMgPSBhc3luYyAodXNlcklkOiBzdHJpbmcsIGxpbWl0Q291bnQgPSA1MCk6IFByb21pc2U8Tm90aWZpY2F0aW9uW10+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBub3RpZmljYXRpb25zUmVmID0gY29sbGVjdGlvbihmaXJlc3RvcmUsICdub3RpZmljYXRpb25zJyk7XG5cbiAgICAvLyBUcnkgdG8gdXNlIHRoZSBjb21wb3NpdGUgaW5kZXggZmlyc3RcbiAgICB0cnkge1xuICAgICAgY29uc3QgcSA9IHF1ZXJ5KFxuICAgICAgICBub3RpZmljYXRpb25zUmVmLFxuICAgICAgICB3aGVyZSgndXNlcklkJywgJz09JywgdXNlcklkKSxcbiAgICAgICAgb3JkZXJCeSgnY3JlYXRlZEF0JywgJ2Rlc2MnKSxcbiAgICAgICAgbGltaXQobGltaXRDb3VudClcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbnNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG5cbiAgICAgIHJldHVybiBub3RpZmljYXRpb25zU25hcHNob3QuZG9jcy5tYXAoZG9jID0+ICh7XG4gICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgIC4uLmRvYy5kYXRhKClcbiAgICB9KSkgYXMgTm90aWZpY2F0aW9uW107XG4gIH0gY2F0Y2ggKGluZGV4RXJyb3IpIHtcbiAgICAgIC8vIElmIHdlIGdldCBhbiBpbmRleCBlcnJvciwgZmFsbCBiYWNrIHRvIGEgc2ltcGxlciBxdWVyeSB3aXRob3V0IG9yZGVyaW5nXG4gICAgICBjb25zb2xlLndhcm4oJ0luZGV4IGVycm9yLCBmYWxsaW5nIGJhY2sgdG8gc2ltcGxlciBxdWVyeTonLCBpbmRleEVycm9yKTtcblxuICAgICAgLy8gRmFsbGJhY2sgcXVlcnkgd2l0aG91dCBvcmRlcmluZ1xuICAgICAgY29uc3QgZmFsbGJhY2tRdWVyeSA9IHF1ZXJ5KFxuICAgICAgICBub3RpZmljYXRpb25zUmVmLFxuICAgICAgICB3aGVyZSgndXNlcklkJywgJz09JywgdXNlcklkKSxcbiAgICAgICAgbGltaXQobGltaXRDb3VudClcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZhbGxiYWNrU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGZhbGxiYWNrUXVlcnkpO1xuXG4gICAgICAvLyBTb3J0IHRoZSByZXN1bHRzIGluIG1lbW9yeVxuICAgICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IGZhbGxiYWNrU25hcHNob3QuZG9jcy5tYXAoZG9jID0+ICh7XG4gICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgIC4uLmRvYy5kYXRhKClcbiAgICB9KSkgYXMgTm90aWZpY2F0aW9uW107XG5cbiAgICAgIC8vIFNvcnQgYnkgY3JlYXRlZEF0IGluIGRlc2NlbmRpbmcgb3JkZXIgaWYgdGhlIGZpZWxkIGV4aXN0c1xuICAgICAgcmV0dXJuIG5vdGlmaWNhdGlvbnMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBjb25zdCBkYXRlQSA9IGEuY3JlYXRlZEF0ID8gKGEuY3JlYXRlZEF0IGluc3RhbmNlb2YgVGltZXN0YW1wID8gYS5jcmVhdGVkQXQudG9NaWxsaXMoKSA6IG5ldyBEYXRlKGEuY3JlYXRlZEF0IGFzIHN0cmluZyB8IG51bWJlcikuZ2V0VGltZSgpKSA6IDA7XG4gICAgICAgIGNvbnN0IGRhdGVCID0gYi5jcmVhdGVkQXQgPyAoYi5jcmVhdGVkQXQgaW5zdGFuY2VvZiBUaW1lc3RhbXAgPyBiLmNyZWF0ZWRBdC50b01pbGxpcygpIDogbmV3IERhdGUoYi5jcmVhdGVkQXQgYXMgc3RyaW5nIHwgbnVtYmVyKS5nZXRUaW1lKCkpIDogMDtcbiAgICAgICAgcmV0dXJuIGRhdGVCIC0gZGF0ZUE7XG4gICAgfSk7XG4gIH1cbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB1c2VyIG5vdGlmaWNhdGlvbnM6JywgZXJyb3IpO1xuICAgIC8vIFJldHVybiBlbXB0eSBhcnJheSBpbnN0ZWFkIG9mIHRocm93aW5nIHRvIHByZXZlbnQgYXBwIGNyYXNoZXNcbiAgICByZXR1cm4gW107XG59XG59O1xuXG4vKipcbiAqIEdldCB1bnJlYWQgbm90aWZpY2F0aW9ucyBjb3VudCBmb3IgYSB1c2VyXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRVbnJlYWROb3RpZmljYXRpb25zQ291bnQgPSBhc3luYyAodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvbnNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ25vdGlmaWNhdGlvbnMnKTtcbiAgICBjb25zdCBxID0gcXVlcnkoXG4gICAgICBub3RpZmljYXRpb25zUmVmLFxuICAgICAgd2hlcmUoJ3VzZXJJZCcsICc9PScsIHVzZXJJZCksXG4gICAgICB3aGVyZSgnaXNSZWFkJywgJz09JywgZmFsc2UpXG4gICAgKTtcblxuICAgIGNvbnN0IG5vdGlmaWNhdGlvbnNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG5cbiAgICByZXR1cm4gbm90aWZpY2F0aW9uc1NuYXBzaG90LnNpemU7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdW5yZWFkIG5vdGlmaWNhdGlvbnMgY291bnQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBNYXJrIGEgbm90aWZpY2F0aW9uIGFzIHJlYWRcbiAqL1xuZXhwb3J0IGNvbnN0IG1hcmtOb3RpZmljYXRpb25Bc1JlYWQgPSBhc3luYyAobm90aWZpY2F0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvblJlZiA9IGRvYyhmaXJlc3RvcmUsICdub3RpZmljYXRpb25zJywgbm90aWZpY2F0aW9uSWQpO1xuXG4gICAgYXdhaXQgdXBkYXRlRG9jKG5vdGlmaWNhdGlvblJlZiwge1xuICAgICAgaXNSZWFkOiB0cnVlXG4gIH0pO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIG5vdGlmaWNhdGlvbiBhcyByZWFkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbn1cbn07XG5cbi8qKlxuICogTWFyayBhbGwgbm90aWZpY2F0aW9ucyBhcyByZWFkIGZvciBhIHVzZXJcbiAqL1xuZXhwb3J0IGNvbnN0IG1hcmtBbGxOb3RpZmljYXRpb25zQXNSZWFkID0gYXN5bmMgKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgbm90aWZpY2F0aW9uc1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAnbm90aWZpY2F0aW9ucycpO1xuICAgIGNvbnN0IHEgPSBxdWVyeShcbiAgICAgIG5vdGlmaWNhdGlvbnNSZWYsXG4gICAgICB3aGVyZSgndXNlcklkJywgJz09JywgdXNlcklkKSxcbiAgICAgIHdoZXJlKCdpc1JlYWQnLCAnPT0nLCBmYWxzZSlcbiAgICApO1xuXG4gICAgY29uc3Qgbm90aWZpY2F0aW9uc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgIC8vIFVwZGF0ZSBlYWNoIG5vdGlmaWNhdGlvblxuICAgIGNvbnN0IHVwZGF0ZVByb21pc2VzID0gbm90aWZpY2F0aW9uc1NuYXBzaG90LmRvY3MubWFwKGRvYyA9PlxuICAgICAgdXBkYXRlRG9jKGRvYy5yZWYsIHtpc1JlYWQ6IHRydWUgfSlcbiAgICApO1xuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwodXBkYXRlUHJvbWlzZXMpO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIGFsbCBub3RpZmljYXRpb25zIGFzIHJlYWQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xufVxufTtcblxuLyoqXG4gKiBEZWxldGUgYSBub3RpZmljYXRpb25cbiAqL1xuZXhwb3J0IGNvbnN0IGRlbGV0ZU5vdGlmaWNhdGlvbiA9IGFzeW5jIChub3RpZmljYXRpb25JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgbm90aWZpY2F0aW9uUmVmID0gZG9jKGZpcmVzdG9yZSwgJ25vdGlmaWNhdGlvbnMnLCBub3RpZmljYXRpb25JZCk7XG4gICAgYXdhaXQgZGVsZXRlRG9jKG5vdGlmaWNhdGlvblJlZik7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIG5vdGlmaWNhdGlvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIERlbGV0ZSBhbGwgbm90aWZpY2F0aW9ucyBmb3IgYSB1c2VyXG4gKi9cbmV4cG9ydCBjb25zdCBkZWxldGVBbGxOb3RpZmljYXRpb25zID0gYXN5bmMgKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgbm90aWZpY2F0aW9uc1JlZiA9IGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAnbm90aWZpY2F0aW9ucycpO1xuICAgIGNvbnN0IHEgPSBxdWVyeShcbiAgICAgIG5vdGlmaWNhdGlvbnNSZWYsXG4gICAgICB3aGVyZSgndXNlcklkJywgJz09JywgdXNlcklkKVxuICAgICk7XG5cbiAgICBjb25zdCBub3RpZmljYXRpb25zU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xuXG4gICAgLy8gRGVsZXRlIGVhY2ggbm90aWZpY2F0aW9uXG4gICAgY29uc3QgZGVsZXRlUHJvbWlzZXMgPSBub3RpZmljYXRpb25zU25hcHNob3QuZG9jcy5tYXAoZG9jID0+XG4gICAgICBkZWxldGVEb2MoZG9jLnJlZilcbiAgICApO1xuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoZGVsZXRlUHJvbWlzZXMpO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBhbGwgbm90aWZpY2F0aW9uczonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIERlbGV0ZSBleHBpcmVkIG5vdGlmaWNhdGlvbnNcbiAqL1xuZXhwb3J0IGNvbnN0IGRlbGV0ZUV4cGlyZWROb3RpZmljYXRpb25zID0gYXN5bmMgKCk6IFByb21pc2U8bnVtYmVyPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvbnNSZWYgPSBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ25vdGlmaWNhdGlvbnMnKTtcbiAgICBjb25zdCBxID0gcXVlcnkoXG4gICAgICBub3RpZmljYXRpb25zUmVmLFxuICAgICAgd2hlcmUoJ2V4cGlyZXNBdCcsICc8PScsIG5vdylcbiAgICApO1xuXG4gICAgY29uc3Qgbm90aWZpY2F0aW9uc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcblxuICAgIC8vIERlbGV0ZSBlYWNoIGV4cGlyZWQgbm90aWZpY2F0aW9uXG4gICAgY29uc3QgZGVsZXRlUHJvbWlzZXMgPSBub3RpZmljYXRpb25zU25hcHNob3QuZG9jcy5tYXAoZG9jID0+XG4gICAgICBkZWxldGVEb2MoZG9jLnJlZilcbiAgICApO1xuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoZGVsZXRlUHJvbWlzZXMpO1xuXG4gICAgcmV0dXJuIG5vdGlmaWNhdGlvbnNTbmFwc2hvdC5zaXplO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBleHBpcmVkIG5vdGlmaWNhdGlvbnM6JywgZXJyb3IpO1xuICAgIHJldHVybiAwO1xufVxufTtcbiJdLCJuYW1lcyI6WyJjb2xsZWN0aW9uIiwiZG9jIiwiZ2V0RG9jcyIsInF1ZXJ5Iiwid2hlcmUiLCJhZGREb2MiLCJ1cGRhdGVEb2MiLCJkZWxldGVEb2MiLCJzZXJ2ZXJUaW1lc3RhbXAiLCJUaW1lc3RhbXAiLCJvcmRlckJ5IiwibGltaXQiLCJmaXJlc3RvcmUiLCJjcmVhdGVOb3RpZmljYXRpb24iLCJub3RpZmljYXRpb24iLCJub3RpZmljYXRpb25zUmVmIiwibm93IiwiZG9jUmVmIiwiaXNSZWFkIiwiY3JlYXRlZEF0IiwiaWQiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRVc2VyTm90aWZpY2F0aW9ucyIsInVzZXJJZCIsImxpbWl0Q291bnQiLCJxIiwibm90aWZpY2F0aW9uc1NuYXBzaG90IiwiZG9jcyIsIm1hcCIsImRhdGEiLCJpbmRleEVycm9yIiwid2FybiIsImZhbGxiYWNrUXVlcnkiLCJmYWxsYmFja1NuYXBzaG90Iiwibm90aWZpY2F0aW9ucyIsInNvcnQiLCJhIiwiYiIsImRhdGVBIiwidG9NaWxsaXMiLCJEYXRlIiwiZ2V0VGltZSIsImRhdGVCIiwiZ2V0VW5yZWFkTm90aWZpY2F0aW9uc0NvdW50Iiwic2l6ZSIsIm1hcmtOb3RpZmljYXRpb25Bc1JlYWQiLCJub3RpZmljYXRpb25JZCIsIm5vdGlmaWNhdGlvblJlZiIsIm1hcmtBbGxOb3RpZmljYXRpb25zQXNSZWFkIiwidXBkYXRlUHJvbWlzZXMiLCJyZWYiLCJQcm9taXNlIiwiYWxsIiwiZGVsZXRlTm90aWZpY2F0aW9uIiwiZGVsZXRlQWxsTm90aWZpY2F0aW9ucyIsImRlbGV0ZVByb21pc2VzIiwiZGVsZXRlRXhwaXJlZE5vdGlmaWNhdGlvbnMiLCJ0b0lTT1N0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/services/notificationService.ts\n");

/***/ }),

/***/ "./src/services/reminderService.ts":
/*!*****************************************!*\
  !*** ./src/services/reminderService.ts ***!
  \*****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkInactiveEnrollments: () => (/* binding */ checkInactiveEnrollments),\n/* harmony export */   createCompletionReminder: () => (/* binding */ createCompletionReminder),\n/* harmony export */   createInactivityReminder: () => (/* binding */ createInactivityReminder),\n/* harmony export */   createProgressReminder: () => (/* binding */ createProgressReminder),\n/* harmony export */   getUserReminderSettings: () => (/* binding */ getUserReminderSettings),\n/* harmony export */   getUserReminders: () => (/* binding */ getUserReminders),\n/* harmony export */   markReminderAsRead: () => (/* binding */ markReminderAsRead),\n/* harmony export */   processDueReminders: () => (/* binding */ processDueReminders),\n/* harmony export */   updateProgressReminders: () => (/* binding */ updateProgressReminders),\n/* harmony export */   updateUserReminderSettings: () => (/* binding */ updateUserReminderSettings)\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./firebase */ \"./src/services/firebase.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n/**\n * Get reminder settings for a user\n */ const getUserReminderSettings = async (userId)=>{\n    try {\n        const userDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"users\", userId));\n        if (!userDoc.exists()) {\n            throw new Error(\"User not found\");\n        }\n        const userData = userDoc.data();\n        // Return reminder settings or default values\n        return {\n            enabled: userData.reminderSettings?.enabled ?? true,\n            frequency: userData.reminderSettings?.frequency ?? \"weekly\",\n            lastSent: userData.reminderSettings?.lastSent\n        };\n    } catch (error) {\n        console.error(\"Error getting user reminder settings:\", error);\n        // Return default settings\n        return {\n            enabled: true,\n            frequency: \"weekly\"\n        };\n    }\n};\n/**\n * Update reminder settings for a user\n */ const updateUserReminderSettings = async (userId, settings)=>{\n    try {\n        const userRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"users\", userId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(userRef, {\n            \"reminderSettings.enabled\": settings.enabled !== undefined ? settings.enabled : true,\n            \"reminderSettings.frequency\": settings.frequency || \"weekly\"\n        });\n    } catch (error) {\n        console.error(\"Error updating user reminder settings:\", error);\n        throw error;\n    }\n};\n/**\n * Get all reminders for a user\n */ const getUserReminders = async (userId)=>{\n    try {\n        const remindersQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"in\", [\n            \"pending\",\n            \"sent\"\n        ]));\n        const remindersSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(remindersQuery);\n        const reminders = [];\n        remindersSnapshot.forEach((doc)=>{\n            const data = doc.data();\n            reminders.push({\n                id: doc.id,\n                userId: data.userId,\n                courseId: data.courseId,\n                courseName: data.courseName,\n                type: data.type,\n                message: data.message,\n                status: data.status,\n                createdAt: data.createdAt,\n                scheduledFor: data.scheduledFor,\n                sentAt: data.sentAt,\n                readAt: data.readAt\n            });\n        });\n        return reminders;\n    } catch (error) {\n        console.error(\"Error getting user reminders:\", error);\n        return [];\n    }\n};\n/**\n * Mark a reminder as read\n */ const markReminderAsRead = async (reminderId)=>{\n    try {\n        const reminderRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\", reminderId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(reminderRef, {\n            status: \"read\",\n            readAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"Error marking reminder as read:\", error);\n        throw error;\n    }\n};\n/**\n * Create a progress reminder for a user\n */ const createProgressReminder = async (userId, courseId, courseName, progress)=>{\n    try {\n        // Check if user has reminder settings enabled\n        const settings = await getUserReminderSettings(userId);\n        if (!settings.enabled) {\n            return;\n        }\n        // Create reminder message based on progress\n        let message = \"\";\n        if (progress < 25) {\n            message = `You've started the \"${courseName}\" course. Continue learning to improve your skills!`;\n        } else if (progress < 50) {\n            message = `You're making progress in \"${courseName}\". Keep going to reach the halfway point!`;\n        } else if (progress < 75) {\n            message = `You're more than halfway through \"${courseName}\". Keep up the good work!`;\n        } else if (progress < 100) {\n            message = `You're almost done with \"${courseName}\". Just a little more to complete the course!`;\n        }\n        if (!message) {\n            return;\n        }\n        // Calculate scheduled date based on frequency\n        const now = new Date();\n        const scheduledDate = new Date();\n        switch(settings.frequency){\n            case \"daily\":\n                scheduledDate.setDate(now.getDate() + 1);\n                break;\n            case \"weekly\":\n                scheduledDate.setDate(now.getDate() + 7);\n                break;\n            case \"monthly\":\n                scheduledDate.setMonth(now.getMonth() + 1);\n                break;\n        }\n        // Create reminder\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\"), {\n            userId,\n            courseId,\n            courseName,\n            type: \"progress\",\n            message,\n            status: \"pending\",\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            scheduledFor: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(scheduledDate)\n        });\n    } catch (error) {\n        console.error(\"Error creating progress reminder:\", error);\n    }\n};\n/**\n * Create an inactivity reminder for a user\n */ const createInactivityReminder = async (userId, courseId, courseName, lastAccessedDays)=>{\n    try {\n        // Check if user has reminder settings enabled\n        const settings = await getUserReminderSettings(userId);\n        if (!settings.enabled) {\n            return;\n        }\n        // Create reminder message based on inactivity\n        let message = \"\";\n        if (lastAccessedDays >= 7 && lastAccessedDays < 14) {\n            message = `It's been a week since you last accessed \"${courseName}\". Don't lose your momentum!`;\n        } else if (lastAccessedDays >= 14 && lastAccessedDays < 30) {\n            message = `It's been two weeks since you last accessed \"${courseName}\". Continue your learning journey!`;\n        } else if (lastAccessedDays >= 30) {\n            message = `It's been a month since you last accessed \"${courseName}\". Don't forget to complete your course!`;\n        }\n        if (!message) {\n            return;\n        }\n        // Calculate scheduled date (send immediately for inactivity)\n        const now = new Date();\n        // Create reminder\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\"), {\n            userId,\n            courseId,\n            courseName,\n            type: \"inactivity\",\n            message,\n            status: \"pending\",\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            scheduledFor: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(now)\n        });\n    } catch (error) {\n        console.error(\"Error creating inactivity reminder:\", error);\n    }\n};\n/**\n * Create a completion reminder for a user\n */ const createCompletionReminder = async (userId, courseId, courseName)=>{\n    try {\n        // Create reminder message\n        const message = `Congratulations! You've completed \"${courseName}\". Don't forget to download your certificate!`;\n        // Create reminder (send immediately for completion)\n        const now = new Date();\n        // Create reminder\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\"), {\n            userId,\n            courseId,\n            courseName,\n            type: \"completion\",\n            message,\n            status: \"pending\",\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            scheduledFor: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(now)\n        });\n    } catch (error) {\n        console.error(\"Error creating completion reminder:\", error);\n    }\n};\n/**\n * Process reminders that are due to be sent\n * This would typically be called by a scheduled function\n */ const processDueReminders = async ()=>{\n    try {\n        const now = firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now();\n        // Query for reminders that are due\n        const remindersQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"pending\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"scheduledFor\", \"<=\", now));\n        const remindersSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(remindersQuery);\n        let count = 0;\n        // Process each reminder\n        for (const reminderDoc of remindersSnapshot.docs){\n            const reminderRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\", reminderDoc.id);\n            // Update reminder status\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(reminderRef, {\n                status: \"sent\",\n                sentAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n            // Here you would typically send an email or push notification\n            // This would be integrated with your notification service\n            count++;\n        }\n        return count;\n    } catch (error) {\n        console.error(\"Error processing due reminders:\", error);\n        return 0;\n    }\n};\n/**\n * Check for inactive enrollments and create reminders\n * This would typically be called by a scheduled function\n */ const checkInactiveEnrollments = async ()=>{\n    try {\n        const now = new Date();\n        const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n        const sevenDaysAgoTimestamp = firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(sevenDaysAgo);\n        // Query for enrollments that haven't been accessed in a while\n        const enrollmentsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"enrollments\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"lastAccessedAt\", \"<=\", sevenDaysAgoTimestamp), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"active\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"progress\", \"<\", 100));\n        const enrollmentsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(enrollmentsQuery);\n        let count = 0;\n        // Process each enrollment\n        for (const enrollmentDoc of enrollmentsSnapshot.docs){\n            const enrollmentData = enrollmentDoc.data();\n            // Calculate days since last access\n            const lastAccessedAt = enrollmentData.lastAccessedAt.toDate();\n            const daysSinceLastAccess = Math.floor((now.getTime() - lastAccessedAt.getTime()) / (24 * 60 * 60 * 1000));\n            // Create inactivity reminder\n            await createInactivityReminder(enrollmentData.userId, enrollmentData.courseId, enrollmentData.courseName, daysSinceLastAccess);\n            count++;\n        }\n        return count;\n    } catch (error) {\n        console.error(\"Error checking inactive enrollments:\", error);\n        return 0;\n    }\n};\n/**\n * Update progress reminders for a user's enrollment\n */ const updateProgressReminders = async (userId, courseId, courseName, progress)=>{\n    try {\n        // Only create reminders at certain progress milestones\n        const milestones = [\n            25,\n            50,\n            75,\n            90\n        ];\n        // Find the highest milestone achieved\n        const achievedMilestone = milestones.filter((milestone)=>progress >= milestone).pop();\n        if (achievedMilestone) {\n            // Check if a reminder already exists for this milestone\n            const remindersQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"courseId\", \"==\", courseId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"type\", \"==\", \"progress\"));\n            const remindersSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(remindersQuery);\n            // If no reminders exist or the most recent one is for a lower milestone, create a new one\n            if (remindersSnapshot.empty) {\n                await createProgressReminder(userId, courseId, courseName, progress);\n            }\n        }\n        // If course is completed, create completion reminder\n        if (progress >= 100) {\n            // Check if a completion reminder already exists\n            const completionRemindersQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.firestore, \"reminders\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"courseId\", \"==\", courseId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"type\", \"==\", \"completion\"));\n            const completionRemindersSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(completionRemindersQuery);\n            // If no completion reminder exists, create one\n            if (completionRemindersSnapshot.empty) {\n                await createCompletionReminder(userId, courseId, courseName);\n            }\n        }\n    } catch (error) {\n        console.error(\"Error updating progress reminders:\", error);\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUIsVUFBVUM7WUFDckQ7UUFDRjtJQUNGLEVBQUUsT0FBT2QsT0FBTztRQUNaQyxRQUFRRCxLQUFLLENBQUMsc0NBQXNDQTtJQUN4RDtBQUNBLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmFpbmluZy1wbGF0Zm9ybS8uL3NyYy9zZXJ2aWNlcy9yZW1pbmRlclNlcnZpY2UudHM/ZTQxMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBjb2xsZWN0aW9uLFxuICBxdWVyeSxcbiAgd2hlcmUsXG4gIGdldERvY3MsXG4gIGRvYyxcbiAgZ2V0RG9jLFxuICB1cGRhdGVEb2MsXG4gIFRpbWVzdGFtcCxcbiAgYWRkRG9jLFxuICBzZXJ2ZXJUaW1lc3RhbXBcbn0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJztcbmltcG9ydCB7ZmlyZXN0b3JlIH0gZnJvbSAnLi9maXJlYmFzZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVtaW5kZXJTZXR0aW5ncyB7XG4gIGVuYWJsZWQ6IGJvb2xlYW47XG4gIGZyZXF1ZW5jeTogJ2RhaWx5JyB8ICd3ZWVrbHknIHwgJ21vbnRobHknO1xuICBsYXN0U2VudD86IFRpbWVzdGFtcDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZW1pbmRlciB7XG4gIGlkOiBzdHJpbmc7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBjb3Vyc2VJZDogc3RyaW5nO1xuICBjb3Vyc2VOYW1lOiBzdHJpbmc7XG4gIHR5cGU6ICdwcm9ncmVzcycgfCAnY29tcGxldGlvbicgfCAnaW5hY3Rpdml0eSc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgc3RhdHVzOiAncGVuZGluZycgfCAnc2VudCcgfCAncmVhZCc7XG4gIGNyZWF0ZWRBdDogVGltZXN0YW1wO1xuICBzY2hlZHVsZWRGb3I6IFRpbWVzdGFtcDtcbiAgc2VudEF0PzogVGltZXN0YW1wO1xuICByZWFkQXQ/OiBUaW1lc3RhbXA7XG59XG5cbi8qKlxuICogR2V0IHJlbWluZGVyIHNldHRpbmdzIGZvciBhIHVzZXJcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFVzZXJSZW1pbmRlclNldHRpbmdzID0gYXN5bmMgKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxSZW1pbmRlclNldHRpbmdzPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlckRvYyA9IGF3YWl0IGdldERvYyhkb2MoZmlyZXN0b3JlLCAndXNlcnMnLCB1c2VySWQpKTtcblxuICAgIGlmICghdXNlckRvYy5leGlzdHMoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgICBjb25zdCB1c2VyRGF0YSA9IHVzZXJEb2MuZGF0YSgpO1xuXG4gICAgLy8gUmV0dXJuIHJlbWluZGVyIHNldHRpbmdzIG9yIGRlZmF1bHQgdmFsdWVzXG4gICAgcmV0dXJuIHtcbiAgICAgIGVuYWJsZWQ6ICh1c2VyRGF0YS5yZW1pbmRlclNldHRpbmdzPy5lbmFibGVkIGFzIGJvb2xlYW4pID8/IHRydWUsXG4gICAgICBmcmVxdWVuY3k6ICh1c2VyRGF0YS5yZW1pbmRlclNldHRpbmdzPy5mcmVxdWVuY3kgYXMgJ2RhaWx5JyB8ICd3ZWVrbHknIHwgJ21vbnRobHknKSA/PyAnd2Vla2x5JyxcbiAgICAgIGxhc3RTZW50OiB1c2VyRGF0YS5yZW1pbmRlclNldHRpbmdzPy5sYXN0U2VudCBhcyBUaW1lc3RhbXAgfCB1bmRlZmluZWQsXG4gIH07XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciByZW1pbmRlciBzZXR0aW5nczonLCBlcnJvcik7XG4gICAgLy8gUmV0dXJuIGRlZmF1bHQgc2V0dGluZ3NcbiAgICByZXR1cm4ge1xuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIGZyZXF1ZW5jeTogJ3dlZWtseScsXG4gIH07XG59XG59O1xuXG4vKipcbiAqIFVwZGF0ZSByZW1pbmRlciBzZXR0aW5ncyBmb3IgYSB1c2VyXG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVVc2VyUmVtaW5kZXJTZXR0aW5ncyA9IGFzeW5jIChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIHNldHRpbmdzOiBQYXJ0aWFsPFJlbWluZGVyU2V0dGluZ3M+XG4pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyUmVmID0gZG9jKGZpcmVzdG9yZSwgJ3VzZXJzJywgdXNlcklkKTtcblxuICAgIGF3YWl0IHVwZGF0ZURvYyh1c2VyUmVmLCB7XG4gICAgICAncmVtaW5kZXJTZXR0aW5ncy5lbmFibGVkJzogc2V0dGluZ3MuZW5hYmxlZCAhPT0gdW5kZWZpbmVkID8gc2V0dGluZ3MuZW5hYmxlZCA6IHRydWUsXG4gICAgICAncmVtaW5kZXJTZXR0aW5ncy5mcmVxdWVuY3knOiBzZXR0aW5ncy5mcmVxdWVuY3kgfHwgJ3dlZWtseScsXG4gIH0pO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyB1c2VyIHJlbWluZGVyIHNldHRpbmdzOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbn1cbn07XG5cbi8qKlxuICogR2V0IGFsbCByZW1pbmRlcnMgZm9yIGEgdXNlclxuICovXG5leHBvcnQgY29uc3QgZ2V0VXNlclJlbWluZGVycyA9IGFzeW5jICh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8UmVtaW5kZXJbXT4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlbWluZGVyc1F1ZXJ5ID0gcXVlcnkoXG4gICAgICBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ3JlbWluZGVycycpLFxuICAgICAgd2hlcmUoJ3VzZXJJZCcsICc9PScsIHVzZXJJZCksXG4gICAgICB3aGVyZSgnc3RhdHVzJywgJ2luJywgWydwZW5kaW5nJywgJ3NlbnQnXSlcbiAgICApO1xuXG4gICAgY29uc3QgcmVtaW5kZXJzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHJlbWluZGVyc1F1ZXJ5KTtcblxuICAgIGNvbnN0IHJlbWluZGVyczogUmVtaW5kZXJbXSA9IFtdO1xuXG4gICAgcmVtaW5kZXJzU25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0gZG9jLmRhdGEoKTtcbiAgICAgIHJlbWluZGVycy5wdXNoKHtcbiAgICAgICAgaWQ6IGRvYy5pZCxcbiAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCBhcyBzdHJpbmcsXG4gICAgICAgIGNvdXJzZUlkOiBkYXRhLmNvdXJzZUlkIGFzIHN0cmluZyxcbiAgICAgICAgY291cnNlTmFtZTogZGF0YS5jb3Vyc2VOYW1lIGFzIHN0cmluZyxcbiAgICAgICAgdHlwZTogZGF0YS50eXBlIGFzICdwcm9ncmVzcycgfCAnY29tcGxldGlvbicgfCAnaW5hY3Rpdml0eScsXG4gICAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZSBhcyBzdHJpbmcsXG4gICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMgYXMgJ3BlbmRpbmcnIHwgJ3NlbnQnIHwgJ3JlYWQnLFxuICAgICAgICBjcmVhdGVkQXQ6IGRhdGEuY3JlYXRlZEF0IGFzIFRpbWVzdGFtcCxcbiAgICAgICAgc2NoZWR1bGVkRm9yOiBkYXRhLnNjaGVkdWxlZEZvciBhcyBUaW1lc3RhbXAsXG4gICAgICAgIHNlbnRBdDogZGF0YS5zZW50QXQgYXMgVGltZXN0YW1wIHwgdW5kZWZpbmVkLFxuICAgICAgICByZWFkQXQ6IGRhdGEucmVhZEF0IGFzIFRpbWVzdGFtcCB8IHVuZGVmaW5lZCxcbiAgICB9KTtcbiAgfSk7XG5cbiAgICByZXR1cm4gcmVtaW5kZXJzO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHVzZXIgcmVtaW5kZXJzOicsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG59XG59O1xuXG4vKipcbiAqIE1hcmsgYSByZW1pbmRlciBhcyByZWFkXG4gKi9cbmV4cG9ydCBjb25zdCBtYXJrUmVtaW5kZXJBc1JlYWQgPSBhc3luYyAocmVtaW5kZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVtaW5kZXJSZWYgPSBkb2MoZmlyZXN0b3JlLCAncmVtaW5kZXJzJywgcmVtaW5kZXJJZCk7XG5cbiAgICBhd2FpdCB1cGRhdGVEb2MocmVtaW5kZXJSZWYsIHtcbiAgICAgIHN0YXR1czogJ3JlYWQnLFxuICAgICAgcmVhZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgfSk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG1hcmtpbmcgcmVtaW5kZXIgYXMgcmVhZDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG59XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIHByb2dyZXNzIHJlbWluZGVyIGZvciBhIHVzZXJcbiAqL1xuZXhwb3J0IGNvbnN0IGNyZWF0ZVByb2dyZXNzUmVtaW5kZXIgPSBhc3luYyAoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjb3Vyc2VJZDogc3RyaW5nLFxuICBjb3Vyc2VOYW1lOiBzdHJpbmcsXG4gIHByb2dyZXNzOiBudW1iZXJcbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIC8vIENoZWNrIGlmIHVzZXIgaGFzIHJlbWluZGVyIHNldHRpbmdzIGVuYWJsZWRcbiAgICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IGdldFVzZXJSZW1pbmRlclNldHRpbmdzKHVzZXJJZCk7XG5cbiAgICBpZiAoIXNldHRpbmdzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgLy8gQ3JlYXRlIHJlbWluZGVyIG1lc3NhZ2UgYmFzZWQgb24gcHJvZ3Jlc3NcbiAgICBsZXQgbWVzc2FnZSA9ICcnO1xuXG4gICAgaWYgKHByb2dyZXNzIDwgMjUpIHtcbiAgICAgIG1lc3NhZ2UgPSBgWW91J3ZlIHN0YXJ0ZWQgdGhlIFwiJHtjb3Vyc2VOYW1lfVwiIGNvdXJzZS4gQ29udGludWUgbGVhcm5pbmcgdG8gaW1wcm92ZSB5b3VyIHNraWxscyFgO1xuICB9IGVsc2UgaWYgKHByb2dyZXNzIDwgNTApIHtcbiAgICAgIG1lc3NhZ2UgPSBgWW91J3JlIG1ha2luZyBwcm9ncmVzcyBpbiBcIiR7Y291cnNlTmFtZX1cIi4gS2VlcCBnb2luZyB0byByZWFjaCB0aGUgaGFsZndheSBwb2ludCFgO1xuICB9IGVsc2UgaWYgKHByb2dyZXNzIDwgNzUpIHtcbiAgICAgIG1lc3NhZ2UgPSBgWW91J3JlIG1vcmUgdGhhbiBoYWxmd2F5IHRocm91Z2ggXCIke2NvdXJzZU5hbWV9XCIuIEtlZXAgdXAgdGhlIGdvb2Qgd29yayFgO1xuICB9IGVsc2UgaWYgKHByb2dyZXNzIDwgMTAwKSB7XG4gICAgICBtZXNzYWdlID0gYFlvdSdyZSBhbG1vc3QgZG9uZSB3aXRoIFwiJHtjb3Vyc2VOYW1lfVwiLiBKdXN0IGEgbGl0dGxlIG1vcmUgdG8gY29tcGxldGUgdGhlIGNvdXJzZSFgO1xuICB9XG5cbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHNjaGVkdWxlZCBkYXRlIGJhc2VkIG9uIGZyZXF1ZW5jeVxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3Qgc2NoZWR1bGVkRGF0ZSA9IG5ldyBEYXRlKCk7XG5cbiAgICBzd2l0Y2ggKHNldHRpbmdzLmZyZXF1ZW5jeSkge1xuICAgICAgY2FzZSAnZGFpbHknOlxuICAgICAgICBzY2hlZHVsZWREYXRlLnNldERhdGUobm93LmdldERhdGUoKSArIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3dlZWtseSc6XG4gICAgICAgIHNjaGVkdWxlZERhdGUuc2V0RGF0ZShub3cuZ2V0RGF0ZSgpICsgNyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbW9udGhseSc6XG4gICAgICAgIHNjaGVkdWxlZERhdGUuc2V0TW9udGgobm93LmdldE1vbnRoKCkgKyAxKTtcbiAgICAgICAgYnJlYWs7XG4gIH1cblxuICAgIC8vIENyZWF0ZSByZW1pbmRlclxuICAgIGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ3JlbWluZGVycycpLCB7XG4gICAgICB1c2VySWQsXG4gICAgICBjb3Vyc2VJZCxcbiAgICAgIGNvdXJzZU5hbWUsXG4gICAgICB0eXBlOiAncHJvZ3Jlc3MnLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgIHNjaGVkdWxlZEZvcjogVGltZXN0YW1wLmZyb21EYXRlKHNjaGVkdWxlZERhdGUpLFxuICB9KTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZ3Jlc3MgcmVtaW5kZXI6JywgZXJyb3IpO1xufVxufTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gaW5hY3Rpdml0eSByZW1pbmRlciBmb3IgYSB1c2VyXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVJbmFjdGl2aXR5UmVtaW5kZXIgPSBhc3luYyAoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjb3Vyc2VJZDogc3RyaW5nLFxuICBjb3Vyc2VOYW1lOiBzdHJpbmcsXG4gIGxhc3RBY2Nlc3NlZERheXM6IG51bWJlclxuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgcmVtaW5kZXIgc2V0dGluZ3MgZW5hYmxlZFxuICAgIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgZ2V0VXNlclJlbWluZGVyU2V0dGluZ3ModXNlcklkKTtcblxuICAgIGlmICghc2V0dGluZ3MuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICB9XG5cbiAgICAvLyBDcmVhdGUgcmVtaW5kZXIgbWVzc2FnZSBiYXNlZCBvbiBpbmFjdGl2aXR5XG4gICAgbGV0IG1lc3NhZ2UgPSAnJztcblxuICAgIGlmIChsYXN0QWNjZXNzZWREYXlzID49IDcgJiYgbGFzdEFjY2Vzc2VkRGF5cyA8IDE0KSB7XG4gICAgICBtZXNzYWdlID0gYEl0J3MgYmVlbiBhIHdlZWsgc2luY2UgeW91IGxhc3QgYWNjZXNzZWQgXCIke2NvdXJzZU5hbWV9XCIuIERvbid0IGxvc2UgeW91ciBtb21lbnR1bSFgO1xuICB9IGVsc2UgaWYgKGxhc3RBY2Nlc3NlZERheXMgPj0gMTQgJiYgbGFzdEFjY2Vzc2VkRGF5cyA8IDMwKSB7XG4gICAgICBtZXNzYWdlID0gYEl0J3MgYmVlbiB0d28gd2Vla3Mgc2luY2UgeW91IGxhc3QgYWNjZXNzZWQgXCIke2NvdXJzZU5hbWV9XCIuIENvbnRpbnVlIHlvdXIgbGVhcm5pbmcgam91cm5leSFgO1xuICB9IGVsc2UgaWYgKGxhc3RBY2Nlc3NlZERheXMgPj0gMzApIHtcbiAgICAgIG1lc3NhZ2UgPSBgSXQncyBiZWVuIGEgbW9udGggc2luY2UgeW91IGxhc3QgYWNjZXNzZWQgXCIke2NvdXJzZU5hbWV9XCIuIERvbid0IGZvcmdldCB0byBjb21wbGV0ZSB5b3VyIGNvdXJzZSFgO1xuICB9XG5cbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHNjaGVkdWxlZCBkYXRlIChzZW5kIGltbWVkaWF0ZWx5IGZvciBpbmFjdGl2aXR5KVxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAvLyBDcmVhdGUgcmVtaW5kZXJcbiAgICBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihmaXJlc3RvcmUsICdyZW1pbmRlcnMnKSwge1xuICAgICAgdXNlcklkLFxuICAgICAgY291cnNlSWQsXG4gICAgICBjb3Vyc2VOYW1lLFxuICAgICAgdHlwZTogJ2luYWN0aXZpdHknLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgIHNjaGVkdWxlZEZvcjogVGltZXN0YW1wLmZyb21EYXRlKG5vdyksXG4gIH0pO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBpbmFjdGl2aXR5IHJlbWluZGVyOicsIGVycm9yKTtcbn1cbn07XG5cbi8qKlxuICogQ3JlYXRlIGEgY29tcGxldGlvbiByZW1pbmRlciBmb3IgYSB1c2VyXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVDb21wbGV0aW9uUmVtaW5kZXIgPSBhc3luYyAoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjb3Vyc2VJZDogc3RyaW5nLFxuICBjb3Vyc2VOYW1lOiBzdHJpbmdcbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIC8vIENyZWF0ZSByZW1pbmRlciBtZXNzYWdlXG4gICAgY29uc3QgbWVzc2FnZSA9IGBDb25ncmF0dWxhdGlvbnMhIFlvdSd2ZSBjb21wbGV0ZWQgXCIke2NvdXJzZU5hbWV9XCIuIERvbid0IGZvcmdldCB0byBkb3dubG9hZCB5b3VyIGNlcnRpZmljYXRlIWA7XG5cbiAgICAvLyBDcmVhdGUgcmVtaW5kZXIgKHNlbmQgaW1tZWRpYXRlbHkgZm9yIGNvbXBsZXRpb24pXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblxuICAgIC8vIENyZWF0ZSByZW1pbmRlclxuICAgIGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ3JlbWluZGVycycpLCB7XG4gICAgICB1c2VySWQsXG4gICAgICBjb3Vyc2VJZCxcbiAgICAgIGNvdXJzZU5hbWUsXG4gICAgICB0eXBlOiAnY29tcGxldGlvbicsXG4gICAgICBtZXNzYWdlLFxuICAgICAgc3RhdHVzOiAncGVuZGluZycsXG4gICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgc2NoZWR1bGVkRm9yOiBUaW1lc3RhbXAuZnJvbURhdGUobm93KSxcbiAgfSk7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNvbXBsZXRpb24gcmVtaW5kZXI6JywgZXJyb3IpO1xufVxufTtcblxuLyoqXG4gKiBQcm9jZXNzIHJlbWluZGVycyB0aGF0IGFyZSBkdWUgdG8gYmUgc2VudFxuICogVGhpcyB3b3VsZCB0eXBpY2FsbHkgYmUgY2FsbGVkIGJ5IGEgc2NoZWR1bGVkIGZ1bmN0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBwcm9jZXNzRHVlUmVtaW5kZXJzID0gYXN5bmMgKCk6IFByb21pc2U8bnVtYmVyPiA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgbm93ID0gVGltZXN0YW1wLm5vdygpO1xuXG4gICAgLy8gUXVlcnkgZm9yIHJlbWluZGVycyB0aGF0IGFyZSBkdWVcbiAgICBjb25zdCByZW1pbmRlcnNRdWVyeSA9IHF1ZXJ5KFxuICAgICAgY29sbGVjdGlvbihmaXJlc3RvcmUsICdyZW1pbmRlcnMnKSxcbiAgICAgIHdoZXJlKCdzdGF0dXMnLCAnPT0nLCAncGVuZGluZycpLFxuICAgICAgd2hlcmUoJ3NjaGVkdWxlZEZvcicsICc8PScsIG5vdylcbiAgICApO1xuXG4gICAgY29uc3QgcmVtaW5kZXJzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHJlbWluZGVyc1F1ZXJ5KTtcblxuICAgIGxldCBjb3VudCA9IDA7XG5cbiAgICAvLyBQcm9jZXNzIGVhY2ggcmVtaW5kZXJcbiAgICBmb3IgKGNvbnN0IHJlbWluZGVyRG9jIG9mIHJlbWluZGVyc1NuYXBzaG90LmRvY3MpIHtcbiAgICAgIGNvbnN0IHJlbWluZGVyUmVmID0gZG9jKGZpcmVzdG9yZSwgJ3JlbWluZGVycycsIHJlbWluZGVyRG9jLmlkKTtcblxuICAgICAgLy8gVXBkYXRlIHJlbWluZGVyIHN0YXR1c1xuICAgICAgYXdhaXQgdXBkYXRlRG9jKHJlbWluZGVyUmVmLCB7XG4gICAgICAgIHN0YXR1czogJ3NlbnQnLFxuICAgICAgICBzZW50QXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgIH0pO1xuXG4gICAgICAvLyBIZXJlIHlvdSB3b3VsZCB0eXBpY2FsbHkgc2VuZCBhbiBlbWFpbCBvciBwdXNoIG5vdGlmaWNhdGlvblxuICAgICAgLy8gVGhpcyB3b3VsZCBiZSBpbnRlZ3JhdGVkIHdpdGggeW91ciBub3RpZmljYXRpb24gc2VydmljZVxuXG4gICAgICBjb3VudCsrO1xuICB9XG5cbiAgICByZXR1cm4gY291bnQ7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgZHVlIHJlbWluZGVyczonLCBlcnJvcik7XG4gICAgcmV0dXJuIDA7XG59XG59O1xuXG4vKipcbiAqIENoZWNrIGZvciBpbmFjdGl2ZSBlbnJvbGxtZW50cyBhbmQgY3JlYXRlIHJlbWluZGVyc1xuICogVGhpcyB3b3VsZCB0eXBpY2FsbHkgYmUgY2FsbGVkIGJ5IGEgc2NoZWR1bGVkIGZ1bmN0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBjaGVja0luYWN0aXZlRW5yb2xsbWVudHMgPSBhc3luYyAoKTogUHJvbWlzZTxudW1iZXI+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHNldmVuRGF5c0FnbyA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSA3ICogMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgY29uc3Qgc2V2ZW5EYXlzQWdvVGltZXN0YW1wID0gVGltZXN0YW1wLmZyb21EYXRlKHNldmVuRGF5c0Fnbyk7XG5cbiAgICAvLyBRdWVyeSBmb3IgZW5yb2xsbWVudHMgdGhhdCBoYXZlbid0IGJlZW4gYWNjZXNzZWQgaW4gYSB3aGlsZVxuICAgIGNvbnN0IGVucm9sbG1lbnRzUXVlcnkgPSBxdWVyeShcbiAgICAgIGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAnZW5yb2xsbWVudHMnKSxcbiAgICAgIHdoZXJlKCdsYXN0QWNjZXNzZWRBdCcsICc8PScsIHNldmVuRGF5c0Fnb1RpbWVzdGFtcCksXG4gICAgICB3aGVyZSgnc3RhdHVzJywgJz09JywgJ2FjdGl2ZScpLFxuICAgICAgd2hlcmUoJ3Byb2dyZXNzJywgJzwnLCAxMDApXG4gICAgKTtcblxuICAgIGNvbnN0IGVucm9sbG1lbnRzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGVucm9sbG1lbnRzUXVlcnkpO1xuXG4gICAgbGV0IGNvdW50ID0gMDtcblxuICAgIC8vIFByb2Nlc3MgZWFjaCBlbnJvbGxtZW50XG4gICAgZm9yIChjb25zdCBlbnJvbGxtZW50RG9jIG9mIGVucm9sbG1lbnRzU25hcHNob3QuZG9jcykge1xuICAgICAgY29uc3QgZW5yb2xsbWVudERhdGEgPSBlbnJvbGxtZW50RG9jLmRhdGEoKTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGRheXMgc2luY2UgbGFzdCBhY2Nlc3NcbiAgICAgIGNvbnN0IGxhc3RBY2Nlc3NlZEF0ID0gKGVucm9sbG1lbnREYXRhLmxhc3RBY2Nlc3NlZEF0IGFzIFRpbWVzdGFtcCkudG9EYXRlKCk7XG4gICAgICBjb25zdCBkYXlzU2luY2VMYXN0QWNjZXNzID0gTWF0aC5mbG9vcigobm93LmdldFRpbWUoKSAtIGxhc3RBY2Nlc3NlZEF0LmdldFRpbWUoKSkgLyAoMjQgKiA2MCAqIDYwICogMTAwMCkpO1xuXG4gICAgICAvLyBDcmVhdGUgaW5hY3Rpdml0eSByZW1pbmRlclxuICAgICAgYXdhaXQgY3JlYXRlSW5hY3Rpdml0eVJlbWluZGVyKFxuICAgICAgICBlbnJvbGxtZW50RGF0YS51c2VySWQgYXMgc3RyaW5nLFxuICAgICAgICBlbnJvbGxtZW50RGF0YS5jb3Vyc2VJZCBhcyBzdHJpbmcsXG4gICAgICAgIGVucm9sbG1lbnREYXRhLmNvdXJzZU5hbWUgYXMgc3RyaW5nLFxuICAgICAgICBkYXlzU2luY2VMYXN0QWNjZXNzXG4gICAgICApO1xuXG4gICAgICBjb3VudCsrO1xuICB9XG5cbiAgICByZXR1cm4gY291bnQ7XG59IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIGluYWN0aXZlIGVucm9sbG1lbnRzOicsIGVycm9yKTtcbiAgICByZXR1cm4gMDtcbn1cbn07XG5cbi8qKlxuICogVXBkYXRlIHByb2dyZXNzIHJlbWluZGVycyBmb3IgYSB1c2VyJ3MgZW5yb2xsbWVudFxuICovXG5leHBvcnQgY29uc3QgdXBkYXRlUHJvZ3Jlc3NSZW1pbmRlcnMgPSBhc3luYyAoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjb3Vyc2VJZDogc3RyaW5nLFxuICBjb3Vyc2VOYW1lOiBzdHJpbmcsXG4gIHByb2dyZXNzOiBudW1iZXJcbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICB0cnkge1xuICAgIC8vIE9ubHkgY3JlYXRlIHJlbWluZGVycyBhdCBjZXJ0YWluIHByb2dyZXNzIG1pbGVzdG9uZXNcbiAgICBjb25zdCBtaWxlc3RvbmVzID0gWzI1LCA1MCwgNzUsIDkwXTtcblxuICAgIC8vIEZpbmQgdGhlIGhpZ2hlc3QgbWlsZXN0b25lIGFjaGlldmVkXG4gICAgY29uc3QgYWNoaWV2ZWRNaWxlc3RvbmUgPSBtaWxlc3RvbmVzLmZpbHRlcihtaWxlc3RvbmUgPT4gcHJvZ3Jlc3MgPj0gbWlsZXN0b25lKS5wb3AoKTtcblxuICAgIGlmIChhY2hpZXZlZE1pbGVzdG9uZSkge1xuICAgICAgLy8gQ2hlY2sgaWYgYSByZW1pbmRlciBhbHJlYWR5IGV4aXN0cyBmb3IgdGhpcyBtaWxlc3RvbmVcbiAgICAgIGNvbnN0IHJlbWluZGVyc1F1ZXJ5ID0gcXVlcnkoXG4gICAgICAgIGNvbGxlY3Rpb24oZmlyZXN0b3JlLCAncmVtaW5kZXJzJyksXG4gICAgICAgIHdoZXJlKCd1c2VySWQnLCAnPT0nLCB1c2VySWQpLFxuICAgICAgICB3aGVyZSgnY291cnNlSWQnLCAnPT0nLCBjb3Vyc2VJZCksXG4gICAgICAgIHdoZXJlKCd0eXBlJywgJz09JywgJ3Byb2dyZXNzJylcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlbWluZGVyc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhyZW1pbmRlcnNRdWVyeSk7XG5cbiAgICAgIC8vIElmIG5vIHJlbWluZGVycyBleGlzdCBvciB0aGUgbW9zdCByZWNlbnQgb25lIGlzIGZvciBhIGxvd2VyIG1pbGVzdG9uZSwgY3JlYXRlIGEgbmV3IG9uZVxuICAgICAgaWYgKHJlbWluZGVyc1NuYXBzaG90LmVtcHR5KSB7XG4gICAgICAgIGF3YWl0IGNyZWF0ZVByb2dyZXNzUmVtaW5kZXIodXNlcklkLCBjb3Vyc2VJZCwgY291cnNlTmFtZSwgcHJvZ3Jlc3MpO1xuICAgIH1cbiAgfVxuXG4gICAgLy8gSWYgY291cnNlIGlzIGNvbXBsZXRlZCwgY3JlYXRlIGNvbXBsZXRpb24gcmVtaW5kZXJcbiAgICBpZiAocHJvZ3Jlc3MgPj0gMTAwKSB7XG4gICAgICAvLyBDaGVjayBpZiBhIGNvbXBsZXRpb24gcmVtaW5kZXIgYWxyZWFkeSBleGlzdHNcbiAgICAgIGNvbnN0IGNvbXBsZXRpb25SZW1pbmRlcnNRdWVyeSA9IHF1ZXJ5KFxuICAgICAgICBjb2xsZWN0aW9uKGZpcmVzdG9yZSwgJ3JlbWluZGVycycpLFxuICAgICAgICB3aGVyZSgndXNlcklkJywgJz09JywgdXNlcklkKSxcbiAgICAgICAgd2hlcmUoJ2NvdXJzZUlkJywgJz09JywgY291cnNlSWQpLFxuICAgICAgICB3aGVyZSgndHlwZScsICc9PScsICdjb21wbGV0aW9uJylcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGNvbXBsZXRpb25SZW1pbmRlcnNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoY29tcGxldGlvblJlbWluZGVyc1F1ZXJ5KTtcblxuICAgICAgLy8gSWYgbm8gY29tcGxldGlvbiByZW1pbmRlciBleGlzdHMsIGNyZWF0ZSBvbmVcbiAgICAgIGlmIChjb21wbGV0aW9uUmVtaW5kZXJzU25hcHNob3QuZW1wdHkpIHtcbiAgICAgICAgYXdhaXQgY3JlYXRlQ29tcGxldGlvblJlbWluZGVyKHVzZXJJZCwgY291cnNlSWQsIGNvdXJzZU5hbWUpO1xuICAgIH1cbiAgfVxufSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9ncmVzcyByZW1pbmRlcnM6JywgZXJyb3IpO1xufVxufTtcbiJdLCJuYW1lcyI6WyJjb2xsZWN0aW9uIiwicXVlcnkiLCJ3aGVyZSIsImdldERvY3MiLCJkb2MiLCJnZXREb2MiLCJ1cGRhdGVEb2MiLCJUaW1lc3RhbXAiLCJhZGREb2MiLCJzZXJ2ZXJUaW1lc3RhbXAiLCJmaXJlc3RvcmUiLCJnZXRVc2VyUmVtaW5kZXJTZXR0aW5ncyIsInVzZXJJZCIsInVzZXJEb2MiLCJleGlzdHMiLCJFcnJvciIsInVzZXJEYXRhIiwiZGF0YSIsImVuYWJsZWQiLCJyZW1pbmRlclNldHRpbmdzIiwiZnJlcXVlbmN5IiwibGFzdFNlbnQiLCJlcnJvciIsImNvbnNvbGUiLCJ1cGRhdGVVc2VyUmVtaW5kZXJTZXR0aW5ncyIsInNldHRpbmdzIiwidXNlclJlZiIsInVuZGVmaW5lZCIsImdldFVzZXJSZW1pbmRlcnMiLCJyZW1pbmRlcnNRdWVyeSIsInJlbWluZGVyc1NuYXBzaG90IiwicmVtaW5kZXJzIiwiZm9yRWFjaCIsInB1c2giLCJpZCIsImNvdXJzZUlkIiwiY291cnNlTmFtZSIsInR5cGUiLCJtZXNzYWdlIiwic3RhdHVzIiwiY3JlYXRlZEF0Iiwic2NoZWR1bGVkRm9yIiwic2VudEF0IiwicmVhZEF0IiwibWFya1JlbWluZGVyQXNSZWFkIiwicmVtaW5kZXJJZCIsInJlbWluZGVyUmVmIiwiY3JlYXRlUHJvZ3Jlc3NSZW1pbmRlciIsInByb2dyZXNzIiwibm93IiwiRGF0ZSIsInNjaGVkdWxlZERhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInNldE1vbnRoIiwiZ2V0TW9udGgiLCJmcm9tRGF0ZSIsImNyZWF0ZUluYWN0aXZpdHlSZW1pbmRlciIsImxhc3RBY2Nlc3NlZERheXMiLCJjcmVhdGVDb21wbGV0aW9uUmVtaW5kZXIiLCJwcm9jZXNzRHVlUmVtaW5kZXJzIiwiY291bnQiLCJyZW1pbmRlckRvYyIsImRvY3MiLCJjaGVja0luYWN0aXZlRW5yb2xsbWVudHMiLCJzZXZlbkRheXNBZ28iLCJnZXRUaW1lIiwic2V2ZW5EYXlzQWdvVGltZXN0YW1wIiwiZW5yb2xsbWVudHNRdWVyeSIsImVucm9sbG1lbnRzU25hcHNob3QiLCJlbnJvbGxtZW50RG9jIiwiZW5yb2xsbWVudERhdGEiLCJsYXN0QWNjZXNzZWRBdCIsInRvRGF0ZSIsImRheXNTaW5jZUxhc3RBY2Nlc3MiLCJNYXRoIiwiZmxvb3IiLCJ1cGRhdGVQcm9ncmVzc1JlbWluZGVycyIsIm1pbGVzdG9uZXMiLCJhY2hpZXZlZE1pbGVzdG9uZSIsImZpbHRlciIsIm1pbGVzdG9uZSIsInBvcCIsImVtcHR5IiwiY29tcGxldGlvblJlbWluZGVyc1F1ZXJ5IiwiY29tcGxldGlvblJlbWluZGVyc1NuYXBzaG90Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/services/reminderService.ts\n");

/***/ }),

/***/ "./src/utils/createEmotionCache.ts":
/*!*****************************************!*\
  !*** ./src/utils/createEmotionCache.ts ***!
  \*****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ createEmotionCache)\n/* harmony export */ });\n/* harmony import */ var _emotion_cache__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @emotion/cache */ \"@emotion/cache\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_emotion_cache__WEBPACK_IMPORTED_MODULE_0__]);\n_emotion_cache__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n/**\n * Creates an Emotion cache for styling\n * @return {Object} Emotion cache instance\n */ function createEmotionCache() {\n    return (0,_emotion_cache__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n        key: \"css\",\n        prepend: true\n    });\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvY3JlYXRlRW1vdGlvbkNhY2hlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXlDO0FBRXpDOzs7Q0FHQyxHQUNjLFNBQVNDO0lBQ3RCLE9BQU9ELDBEQUFXQSxDQUFDO1FBQUNFLEtBQUs7UUFBT0MsU0FBUztJQUFJO0FBQy9DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhaW5pbmctcGxhdGZvcm0vLi9zcmMvdXRpbHMvY3JlYXRlRW1vdGlvbkNhY2hlLnRzP2ViYzYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyZWF0ZUNhY2hlIGZyb20gXCJAZW1vdGlvbi9jYWNoZVwiO1xuXG4vKipcbiAqIENyZWF0ZXMgYW4gRW1vdGlvbiBjYWNoZSBmb3Igc3R5bGluZ1xuICogQHJldHVybiB7T2JqZWN0fSBFbW90aW9uIGNhY2hlIGluc3RhbmNlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZUVtb3Rpb25DYWNoZSgpIHtcbiAgcmV0dXJuIGNyZWF0ZUNhY2hlKHtrZXk6IFwiY3NzXCIsIHByZXBlbmQ6IHRydWV9KTtcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVDYWNoZSIsImNyZWF0ZUVtb3Rpb25DYWNoZSIsImtleSIsInByZXBlbmQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/createEmotionCache.ts\n");

/***/ }),

/***/ "./src/utils/digitalSignature.ts":
/*!***************************************!*\
  !*** ./src/utils/digitalSignature.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateSignature: () => (/* binding */ generateSignature),\n/* harmony export */   verifySignature: () => (/* binding */ verifySignature)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\n * Secret key for signing certificates\n * In a production environment, this should be stored securely in environment\n * variables\n */ const SECRET_KEY = process.env.CERTIFICATE_SIGNATURE_SECRET || \"certificate-signature-secret-key\";\n/**\n * Generate a digital signature for a certificate\n * @param {Record<string, unknown>} data The data to sign\n * @return {string} The digital signature\n */ const generateSignature = (data)=>{\n    // Create a deterministic string representation of the data\n    const sortedData = sortObjectKeys(data);\n    const dataString = JSON.stringify(sortedData);\n    // Generate HMAC signature using SHA-256\n    return (0,crypto__WEBPACK_IMPORTED_MODULE_0__.createHmac)(\"sha256\", SECRET_KEY).update(dataString).digest(\"hex\");\n};\n/**\n * Verify a digital signature for a certificate\n * @param {Record<string, unknown>} data The data that was signed\n * @param {string} signature The signature to verify\n * @return {boolean} Whether the signature is valid\n */ const verifySignature = (data, signature)=>{\n    // Generate a new signature from the data\n    const expectedSignature = generateSignature(data);\n    // Compare the signatures\n    return expectedSignature === signature;\n};\n/**\n * Sort object keys recursively to ensure deterministic JSON stringification\n * @param {unknown} obj The object to sort\n * @return {unknown} A new object with sorted keys\n */ const sortObjectKeys = (obj)=>{\n    // If not an object or null, return as is\n    if (obj === null || typeof obj !== \"object\" || Array.isArray(obj)) {\n        return obj;\n    }\n    // Get all keys and sort them\n    const sortedKeys = Object.keys(obj).sort();\n    // Create a new object with sorted keys\n    const sortedObj = {};\n    for (const key of sortedKeys){\n        sortedObj[key] = sortObjectKeys(obj[key]);\n    }\n    return sortedObj;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvZGlnaXRhbFNpZ25hdHVyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWtDO0FBRWxDOzs7O0NBSUMsR0FDRCxNQUFNQyxhQUFhQyxRQUFRQyxHQUFHLENBQUNDLDRCQUE0QixJQUN6RDtBQUVGOzs7O0NBSUMsR0FDTSxNQUFNQyxvQkFBb0IsQ0FBQ0M7SUFDaEMsMkRBQTJEO0lBQzNELE1BQU1DLGFBQWFDLGVBQWVGO0lBQ2xDLE1BQU1HLGFBQWFDLEtBQUtDLFNBQVMsQ0FBQ0o7SUFFbEMsd0NBQXdDO0lBQ3hDLE9BQU9QLGtEQUFVQSxDQUFDLFVBQVVDLFlBQ3pCVyxNQUFNLENBQUNILFlBQ1BJLE1BQU0sQ0FBQztBQUNaLEVBQUU7QUFFRjs7Ozs7Q0FLQyxHQUNNLE1BQU1DLGtCQUFrQixDQUM3QlIsTUFDQVM7SUFFQSx5Q0FBeUM7SUFDekMsTUFBTUMsb0JBQW9CWCxrQkFBa0JDO0lBRTVDLHlCQUF5QjtJQUN6QixPQUFPVSxzQkFBc0JEO0FBQy9CLEVBQUU7QUFFRjs7OztDQUlDLEdBQ0QsTUFBTVAsaUJBQWlCLENBQUNTO0lBQ3RCLHlDQUF5QztJQUN6QyxJQUFJQSxRQUFRLFFBQVEsT0FBT0EsUUFBUSxZQUFZQyxNQUFNQyxPQUFPLENBQUNGLE1BQU07UUFDakUsT0FBT0E7SUFDWDtJQUVFLDZCQUE2QjtJQUM3QixNQUFNRyxhQUFhQyxPQUFPQyxJQUFJLENBQUNMLEtBQWdDTSxJQUFJO0lBRW5FLHVDQUF1QztJQUN2QyxNQUFNQyxZQUFxQyxDQUFDO0lBQzVDLEtBQUssTUFBTUMsT0FBT0wsV0FBWTtRQUM1QkksU0FBUyxDQUFDQyxJQUFJLEdBQUdqQixlQUFlLEdBQWdDLENBQUNpQixJQUFJO0lBQ3pFO0lBRUUsT0FBT0Q7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYWluaW5nLXBsYXRmb3JtLy4vc3JjL3V0aWxzL2RpZ2l0YWxTaWduYXR1cmUudHM/MjEwOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2NyZWF0ZUhtYWN9IGZyb20gXCJjcnlwdG9cIjtcblxuLyoqXG4gKiBTZWNyZXQga2V5IGZvciBzaWduaW5nIGNlcnRpZmljYXRlc1xuICogSW4gYSBwcm9kdWN0aW9uIGVudmlyb25tZW50LCB0aGlzIHNob3VsZCBiZSBzdG9yZWQgc2VjdXJlbHkgaW4gZW52aXJvbm1lbnRcbiAqIHZhcmlhYmxlc1xuICovXG5jb25zdCBTRUNSRVRfS0VZID0gcHJvY2Vzcy5lbnYuQ0VSVElGSUNBVEVfU0lHTkFUVVJFX1NFQ1JFVCB8fFxuICBcImNlcnRpZmljYXRlLXNpZ25hdHVyZS1zZWNyZXQta2V5XCI7XG5cbi8qKlxuICogR2VuZXJhdGUgYSBkaWdpdGFsIHNpZ25hdHVyZSBmb3IgYSBjZXJ0aWZpY2F0ZVxuICogQHBhcmFtIHtSZWNvcmQ8c3RyaW5nLCB1bmtub3duPn0gZGF0YSBUaGUgZGF0YSB0byBzaWduXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBkaWdpdGFsIHNpZ25hdHVyZVxuICovXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVTaWduYXR1cmUgPSAoZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBzdHJpbmcgPT4ge1xuICAvLyBDcmVhdGUgYSBkZXRlcm1pbmlzdGljIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZGF0YVxuICBjb25zdCBzb3J0ZWREYXRhID0gc29ydE9iamVjdEtleXMoZGF0YSk7XG4gIGNvbnN0IGRhdGFTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShzb3J0ZWREYXRhKTtcblxuICAvLyBHZW5lcmF0ZSBITUFDIHNpZ25hdHVyZSB1c2luZyBTSEEtMjU2XG4gIHJldHVybiBjcmVhdGVIbWFjKFwic2hhMjU2XCIsIFNFQ1JFVF9LRVkpXG4gICAgLnVwZGF0ZShkYXRhU3RyaW5nKVxuICAgIC5kaWdlc3QoXCJoZXhcIik7XG59O1xuXG4vKipcbiAqIFZlcmlmeSBhIGRpZ2l0YWwgc2lnbmF0dXJlIGZvciBhIGNlcnRpZmljYXRlXG4gKiBAcGFyYW0ge1JlY29yZDxzdHJpbmcsIHVua25vd24+fSBkYXRhIFRoZSBkYXRhIHRoYXQgd2FzIHNpZ25lZFxuICogQHBhcmFtIHtzdHJpbmd9IHNpZ25hdHVyZSBUaGUgc2lnbmF0dXJlIHRvIHZlcmlmeVxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGUgc2lnbmF0dXJlIGlzIHZhbGlkXG4gKi9cbmV4cG9ydCBjb25zdCB2ZXJpZnlTaWduYXR1cmUgPSAoXG4gIGRhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICBzaWduYXR1cmU6IHN0cmluZ1xuKTogYm9vbGVhbiA9PiB7XG4gIC8vIEdlbmVyYXRlIGEgbmV3IHNpZ25hdHVyZSBmcm9tIHRoZSBkYXRhXG4gIGNvbnN0IGV4cGVjdGVkU2lnbmF0dXJlID0gZ2VuZXJhdGVTaWduYXR1cmUoZGF0YSk7XG5cbiAgLy8gQ29tcGFyZSB0aGUgc2lnbmF0dXJlc1xuICByZXR1cm4gZXhwZWN0ZWRTaWduYXR1cmUgPT09IHNpZ25hdHVyZTtcbn07XG5cbi8qKlxuICogU29ydCBvYmplY3Qga2V5cyByZWN1cnNpdmVseSB0byBlbnN1cmUgZGV0ZXJtaW5pc3RpYyBKU09OIHN0cmluZ2lmaWNhdGlvblxuICogQHBhcmFtIHt1bmtub3dufSBvYmogVGhlIG9iamVjdCB0byBzb3J0XG4gKiBAcmV0dXJuIHt1bmtub3dufSBBIG5ldyBvYmplY3Qgd2l0aCBzb3J0ZWQga2V5c1xuICovXG5jb25zdCBzb3J0T2JqZWN0S2V5cyA9IChvYmo6IHVua25vd24pOiB1bmtub3duID0+IHtcbiAgLy8gSWYgbm90IGFuIG9iamVjdCBvciBudWxsLCByZXR1cm4gYXMgaXNcbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiIHx8IEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgIHJldHVybiBvYmo7XG59XG5cbiAgLy8gR2V0IGFsbCBrZXlzIGFuZCBzb3J0IHRoZW1cbiAgY29uc3Qgc29ydGVkS2V5cyA9IE9iamVjdC5rZXlzKG9iaiBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikuc29ydCgpO1xuXG4gIC8vIENyZWF0ZSBhIG5ldyBvYmplY3Qgd2l0aCBzb3J0ZWQga2V5c1xuICBjb25zdCBzb3J0ZWRPYmo6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG4gIGZvciAoY29uc3Qga2V5IG9mIHNvcnRlZEtleXMpIHtcbiAgICBzb3J0ZWRPYmpba2V5XSA9IHNvcnRPYmplY3RLZXlzKChvYmogYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pW2tleV0pO1xufVxuXG4gIHJldHVybiBzb3J0ZWRPYmo7XG59O1xuIl0sIm5hbWVzIjpbImNyZWF0ZUhtYWMiLCJTRUNSRVRfS0VZIiwicHJvY2VzcyIsImVudiIsIkNFUlRJRklDQVRFX1NJR05BVFVSRV9TRUNSRVQiLCJnZW5lcmF0ZVNpZ25hdHVyZSIsImRhdGEiLCJzb3J0ZWREYXRhIiwic29ydE9iamVjdEtleXMiLCJkYXRhU3RyaW5nIiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZSIsImRpZ2VzdCIsInZlcmlmeVNpZ25hdHVyZSIsInNpZ25hdHVyZSIsImV4cGVjdGVkU2lnbmF0dXJlIiwib2JqIiwiQXJyYXkiLCJpc0FycmF5Iiwic29ydGVkS2V5cyIsIk9iamVjdCIsImtleXMiLCJzb3J0Iiwic29ydGVkT2JqIiwia2V5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/utils/digitalSignature.ts\n");

/***/ }),

/***/ "./src/utils/pdfGenerator.ts":
/*!***********************************!*\
  !*** ./src/utils/pdfGenerator.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generatePDF: () => (/* binding */ generatePDF),\n/* harmony export */   generatePDFPreview: () => (/* binding */ generatePDFPreview)\n/* harmony export */ });\n// Import puppeteer types and use dynamic import only on server-side\n// Using dynamic import with type assertion for server-side only\nconst puppeteer =  true ? Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! puppeteer */ \"puppeteer\")) : 0;\n// Import Node.js Buffer constructor\nlet BufferClass = null;\nif (true) {\n    // Only import on server side\n    // eslint-disable-next-line @typescript-eslint/no-require-imports\n    const bufferModule = __webpack_require__(/*! buffer */ \"buffer\");\n    BufferClass = bufferModule.Buffer;\n}\n/**\n * Generate a PDF from HTML content (Server-side implementation)\n * @param html HTML content to convert to PDF\n * @param options PDF generation options\n * @returns PDF buffer\n */ const generatePDFServer = async (html, options = {})=>{\n    if (!puppeteer || !BufferClass) {\n        throw new Error(\"Puppeteer or Buffer is not available in this environment\");\n    }\n    try {\n        const puppeteerModule = await puppeteer;\n        const browser = await puppeteerModule.launch({\n            headless: true,\n            args: [\n                \"--no-sandbox\",\n                \"--disable-setuid-sandbox\"\n            ]\n        });\n        const page = await browser.newPage();\n        // Set content\n        await page.setContent(html, {\n            waitUntil: \"networkidle0\"\n        });\n        // Generate PDF\n        const pdfBuffer = await page.pdf({\n            format: options.format || \"A4\",\n            landscape: options.landscape || false,\n            margin: options.margin || {\n                top: \"1cm\",\n                bottom: \"1cm\",\n                left: \"1cm\",\n                right: \"1cm\"\n            },\n            printBackground: options.printBackground !== false,\n            scale: options.scale || 1,\n            headerTemplate: options.headerTemplate || \"\",\n            footerTemplate: options.footerTemplate || \"\",\n            displayHeaderFooter: options.displayHeaderFooter || false,\n            pageRanges: options.pageRanges || \"\"\n        });\n        // Convert Uint8Array to Buffer\n        const buffer = BufferClass.from(pdfBuffer);\n        await browser.close();\n        return buffer;\n    } catch (error) {\n        console.error(\"Error generating PDF:\", error);\n        throw error;\n    }\n};\n/**\n * Generate a PDF from HTML content (Client-side implementation)\n * @param html HTML content to convert to PDF\n * @param options PDF generation options\n * @returns PDF buffer as Uint8Array\n */ const generatePDFClient = async (html, options = {})=>{\n    const response = await fetch(\"/api/generate-pdf\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            html,\n            options\n        })\n    });\n    if (!response.ok) {\n        throw new Error(\"Failed to generate PDF\");\n    }\n    const data = await response.arrayBuffer();\n    return new Uint8Array(data);\n};\n/**\n * Generate a PDF from HTML content\n * @param html HTML content to convert to PDF\n * @param options PDF generation options\n * @returns PDF buffer (Buffer on server, Uint8Array on client)\n */ const generatePDF = async (html, options = {})=>{\n    if (false) {} else {\n        // TypeScript needs help understanding that this branch returns Buffer\n        return generatePDFServer(html, options);\n    }\n};\n/**\n * Generate a PDF preview image from HTML content (Server-side implementation)\n * @param html HTML content to convert to image\n * @returns Image buffer (PNG) as Buffer\n */ const generatePDFPreviewServer = async (html)=>{\n    if (!puppeteer || !BufferClass) {\n        throw new Error(\"Puppeteer or Buffer is not available in this environment\");\n    }\n    try {\n        const puppeteerModule = await puppeteer;\n        const browser = await puppeteerModule.launch({\n            headless: true,\n            args: [\n                \"--no-sandbox\",\n                \"--disable-setuid-sandbox\"\n            ]\n        });\n        const page = await browser.newPage();\n        // Set viewport size (A4 dimensions at 96 DPI)\n        await page.setViewport({\n            width: 794,\n            height: 1123,\n            deviceScaleFactor: 2\n        });\n        // Set content\n        await page.setContent(html, {\n            waitUntil: \"networkidle0\"\n        });\n        // Generate screenshot\n        const screenshotBuffer = await page.screenshot({\n            type: \"png\",\n            fullPage: true\n        });\n        // Convert Uint8Array to Buffer\n        const imageBuffer = BufferClass.from(screenshotBuffer);\n        await browser.close();\n        return imageBuffer;\n    } catch (error) {\n        console.error(\"Error generating PDF preview:\", error);\n        throw error;\n    }\n};\n/**\n * Generate a PDF preview image from HTML content (Client-side implementation)\n * @param html HTML content to convert to image\n * @returns Image buffer (PNG) as Uint8Array\n */ const generatePDFPreviewClient = async (html)=>{\n    const response = await fetch(\"/api/generate-pdf-preview\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            html\n        })\n    });\n    if (!response.ok) {\n        throw new Error(\"Failed to generate PDF preview\");\n    }\n    const data = await response.arrayBuffer();\n    return new Uint8Array(data);\n};\n/**\n * Generate a PDF preview image from HTML content\n * @param html HTML content to convert to image\n * @returns Image buffer (PNG) (Buffer on server, Uint8Array on client)\n */ const generatePDFPreview = async (html)=>{\n    if (false) {} else {\n        // TypeScript needs help understanding that this branch returns Buffer\n        return generatePDFPreviewServer(html);\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y2s6Ly90cmFpbmluZy1wbGF0Zm9ybS8uL3NyYy91dGlscy9wZGZHZW5lcmF0b3IudHM/ZGMxYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJbXBvcnQgcHVwcGV0ZWVyIHR5cGVzIGFuZCB1c2UgZHluYW1pYyBpbXBvcnQgb25seSBvbiBzZXJ2ZXItc2lkZVxuaW1wb3J0IHR5cGUgeyBCcm93c2VyLCBQYWdlIH0gZnJvbSAncHVwcGV0ZWVyJztcbmltcG9ydCB0eXBlIHsgQnVmZmVyIGFzIE5vZGVCdWZmZXIgfSBmcm9tICdidWZmZXInO1xuLy8gVXNpbmcgZHluYW1pYyBpbXBvcnQgd2l0aCB0eXBlIGFzc2VydGlvbiBmb3Igc2VydmVyLXNpZGUgb25seVxuY29uc3QgcHVwcGV0ZWVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgPyBpbXBvcnQoJ3B1cHBldGVlcicpIDogbnVsbDtcbi8vIEltcG9ydCBOb2RlLmpzIEJ1ZmZlciBjb25zdHJ1Y3RvclxubGV0IEJ1ZmZlckNsYXNzOiB0eXBlb2YgTm9kZUJ1ZmZlciB8IG51bGwgPSBudWxsO1xuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gIC8vIE9ubHkgaW1wb3J0IG9uIHNlcnZlciBzaWRlXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzXG4gIGNvbnN0IGJ1ZmZlck1vZHVsZSA9IHJlcXVpcmUoJ2J1ZmZlcicpO1xuICBCdWZmZXJDbGFzcyA9IGJ1ZmZlck1vZHVsZS5CdWZmZXIgYXMgdHlwZW9mIE5vZGVCdWZmZXI7XG59XG5cbmludGVyZmFjZSBQREZPcHRpb25zIHtcbiAgZm9ybWF0PzogJ0E0JyB8ICdBMycgfCAnTGV0dGVyJyB8ICdMZWdhbCcgfCAnVGFibG9pZCc7XG4gIGxhbmRzY2FwZT86IGJvb2xlYW47XG4gIG1hcmdpbj86IHtcbiAgICB0b3A/OiBzdHJpbmc7XG4gICAgYm90dG9tPzogc3RyaW5nO1xuICAgIGxlZnQ/OiBzdHJpbmc7XG4gICAgcmlnaHQ/OiBzdHJpbmc7XG4gIH07XG4gIHByaW50QmFja2dyb3VuZD86IGJvb2xlYW47XG4gIHNjYWxlPzogbnVtYmVyO1xuICBoZWFkZXJUZW1wbGF0ZT86IHN0cmluZztcbiAgZm9vdGVyVGVtcGxhdGU/OiBzdHJpbmc7XG4gIGRpc3BsYXlIZWFkZXJGb290ZXI/OiBib29sZWFuO1xuICBwYWdlUmFuZ2VzPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGEgUERGIGZyb20gSFRNTCBjb250ZW50IChTZXJ2ZXItc2lkZSBpbXBsZW1lbnRhdGlvbilcbiAqIEBwYXJhbSBodG1sIEhUTUwgY29udGVudCB0byBjb252ZXJ0IHRvIFBERlxuICogQHBhcmFtIG9wdGlvbnMgUERGIGdlbmVyYXRpb24gb3B0aW9uc1xuICogQHJldHVybnMgUERGIGJ1ZmZlclxuICovXG5jb25zdCBnZW5lcmF0ZVBERlNlcnZlciA9IGFzeW5jIChodG1sOiBzdHJpbmcsIG9wdGlvbnM6IFBERk9wdGlvbnMgPSB7fSk6IFByb21pc2U8Tm9kZUJ1ZmZlcj4gPT4ge1xuICBpZiAoIXB1cHBldGVlciB8fCAhQnVmZmVyQ2xhc3MpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1B1cHBldGVlciBvciBCdWZmZXIgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHB1cHBldGVlck1vZHVsZSA9IGF3YWl0IHB1cHBldGVlcjtcbiAgICBjb25zdCBicm93c2VyOiBCcm93c2VyID0gYXdhaXQgcHVwcGV0ZWVyTW9kdWxlLmxhdW5jaCh7XG4gICAgICBoZWFkbGVzczogdHJ1ZSxcbiAgICAgIGFyZ3M6IFsnLS1uby1zYW5kYm94JywgJy0tZGlzYWJsZS1zZXR1aWQtc2FuZGJveCddLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcGFnZTogUGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuXG4gICAgLy8gU2V0IGNvbnRlbnRcbiAgICBhd2FpdCBwYWdlLnNldENvbnRlbnQoaHRtbCwge1xuICAgICAgd2FpdFVudGlsOiAnbmV0d29ya2lkbGUwJyxcbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIFBERlxuICAgIGNvbnN0IHBkZkJ1ZmZlciA9IGF3YWl0IHBhZ2UucGRmKHtcbiAgICAgIGZvcm1hdDogb3B0aW9ucy5mb3JtYXQgfHwgJ0E0JyxcbiAgICAgIGxhbmRzY2FwZTogb3B0aW9ucy5sYW5kc2NhcGUgfHwgZmFsc2UsXG4gICAgICBtYXJnaW46IG9wdGlvbnMubWFyZ2luIHx8IHtcbiAgICAgICAgdG9wOiAnMWNtJyxcbiAgICAgICAgYm90dG9tOiAnMWNtJyxcbiAgICAgICAgbGVmdDogJzFjbScsXG4gICAgICAgIHJpZ2h0OiAnMWNtJyxcbiAgICAgIH0sXG4gICAgICBwcmludEJhY2tncm91bmQ6IG9wdGlvbnMucHJpbnRCYWNrZ3JvdW5kICE9PSBmYWxzZSxcbiAgICAgIHNjYWxlOiBvcHRpb25zLnNjYWxlIHx8IDEsXG4gICAgICBoZWFkZXJUZW1wbGF0ZTogb3B0aW9ucy5oZWFkZXJUZW1wbGF0ZSB8fCAnJyxcbiAgICAgIGZvb3RlclRlbXBsYXRlOiBvcHRpb25zLmZvb3RlclRlbXBsYXRlIHx8ICcnLFxuICAgICAgZGlzcGxheUhlYWRlckZvb3Rlcjogb3B0aW9ucy5kaXNwbGF5SGVhZGVyRm9vdGVyIHx8IGZhbHNlLFxuICAgICAgcGFnZVJhbmdlczogb3B0aW9ucy5wYWdlUmFuZ2VzIHx8ICcnLFxuICAgIH0pO1xuXG4gICAgLy8gQ29udmVydCBVaW50OEFycmF5IHRvIEJ1ZmZlclxuICAgIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlckNsYXNzLmZyb20ocGRmQnVmZmVyKTtcblxuICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcblxuICAgIHJldHVybiBidWZmZXI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2VuZXJhdGluZyBQREY6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG4vKipcbiAqIEdlbmVyYXRlIGEgUERGIGZyb20gSFRNTCBjb250ZW50IChDbGllbnQtc2lkZSBpbXBsZW1lbnRhdGlvbilcbiAqIEBwYXJhbSBodG1sIEhUTUwgY29udGVudCB0byBjb252ZXJ0IHRvIFBERlxuICogQHBhcmFtIG9wdGlvbnMgUERGIGdlbmVyYXRpb24gb3B0aW9uc1xuICogQHJldHVybnMgUERGIGJ1ZmZlciBhcyBVaW50OEFycmF5XG4gKi9cbmNvbnN0IGdlbmVyYXRlUERGQ2xpZW50ID0gYXN5bmMgKGh0bWw6IHN0cmluZywgb3B0aW9uczogUERGT3B0aW9ucyA9IHt9KTogUHJvbWlzZTxVaW50OEFycmF5PiA9PiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvZ2VuZXJhdGUtcGRmJywge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgfSxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGh0bWwsIG9wdGlvbnMgfSksXG4gIH0pO1xuXG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBQREYnKTtcbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpO1xuICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG59O1xuXG4vKipcbiAqIEdlbmVyYXRlIGEgUERGIGZyb20gSFRNTCBjb250ZW50XG4gKiBAcGFyYW0gaHRtbCBIVE1MIGNvbnRlbnQgdG8gY29udmVydCB0byBQREZcbiAqIEBwYXJhbSBvcHRpb25zIFBERiBnZW5lcmF0aW9uIG9wdGlvbnNcbiAqIEByZXR1cm5zIFBERiBidWZmZXIgKEJ1ZmZlciBvbiBzZXJ2ZXIsIFVpbnQ4QXJyYXkgb24gY2xpZW50KVxuICovXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVQREYgPSBhc3luYyAoXG4gIGh0bWw6IHN0cmluZyxcbiAgb3B0aW9uczogUERGT3B0aW9ucyA9IHt9XG4pOiBQcm9taXNlPE5vZGVCdWZmZXIgfCBVaW50OEFycmF5PiA9PiB7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIFR5cGVTY3JpcHQgbmVlZHMgaGVscCB1bmRlcnN0YW5kaW5nIHRoYXQgdGhpcyBicmFuY2ggcmV0dXJucyBVaW50OEFycmF5XG4gICAgcmV0dXJuIGdlbmVyYXRlUERGQ2xpZW50KGh0bWwsIG9wdGlvbnMpO1xuICB9IGVsc2Uge1xuICAgIC8vIFR5cGVTY3JpcHQgbmVlZHMgaGVscCB1bmRlcnN0YW5kaW5nIHRoYXQgdGhpcyBicmFuY2ggcmV0dXJucyBCdWZmZXJcbiAgICByZXR1cm4gZ2VuZXJhdGVQREZTZXJ2ZXIoaHRtbCwgb3B0aW9ucyk7XG4gIH1cbn07XG5cbi8qKlxuICogR2VuZXJhdGUgYSBQREYgcHJldmlldyBpbWFnZSBmcm9tIEhUTUwgY29udGVudCAoU2VydmVyLXNpZGUgaW1wbGVtZW50YXRpb24pXG4gKiBAcGFyYW0gaHRtbCBIVE1MIGNvbnRlbnQgdG8gY29udmVydCB0byBpbWFnZVxuICogQHJldHVybnMgSW1hZ2UgYnVmZmVyIChQTkcpIGFzIEJ1ZmZlclxuICovXG5jb25zdCBnZW5lcmF0ZVBERlByZXZpZXdTZXJ2ZXIgPSBhc3luYyAoaHRtbDogc3RyaW5nKTogUHJvbWlzZTxOb2RlQnVmZmVyPiA9PiB7XG4gIGlmICghcHVwcGV0ZWVyIHx8ICFCdWZmZXJDbGFzcykge1xuICAgIHRocm93IG5ldyBFcnJvcignUHVwcGV0ZWVyIG9yIEJ1ZmZlciBpcyBub3QgYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgcHVwcGV0ZWVyTW9kdWxlID0gYXdhaXQgcHVwcGV0ZWVyO1xuICAgIGNvbnN0IGJyb3dzZXI6IEJyb3dzZXIgPSBhd2FpdCBwdXBwZXRlZXJNb2R1bGUubGF1bmNoKHtcbiAgICAgIGhlYWRsZXNzOiB0cnVlLFxuICAgICAgYXJnczogWyctLW5vLXNhbmRib3gnLCAnLS1kaXNhYmxlLXNldHVpZC1zYW5kYm94J10sXG4gICAgfSk7XG5cbiAgICBjb25zdCBwYWdlOiBQYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XG5cbiAgICAvLyBTZXQgdmlld3BvcnQgc2l6ZSAoQTQgZGltZW5zaW9ucyBhdCA5NiBEUEkpXG4gICAgYXdhaXQgcGFnZS5zZXRWaWV3cG9ydCh7XG4gICAgICB3aWR0aDogNzk0LCAvLyBBNCB3aWR0aCBpbiBwaXhlbHMgYXQgOTYgRFBJXG4gICAgICBoZWlnaHQ6IDExMjMsIC8vIEE0IGhlaWdodCBpbiBwaXhlbHMgYXQgOTYgRFBJXG4gICAgICBkZXZpY2VTY2FsZUZhY3RvcjogMiwgLy8gSGlnaGVyIHJlc29sdXRpb25cbiAgICB9KTtcblxuICAgIC8vIFNldCBjb250ZW50XG4gICAgYXdhaXQgcGFnZS5zZXRDb250ZW50KGh0bWwsIHtcbiAgICAgIHdhaXRVbnRpbDogJ25ldHdvcmtpZGxlMCcsXG4gICAgfSk7XG5cbiAgICAvLyBHZW5lcmF0ZSBzY3JlZW5zaG90XG4gICAgY29uc3Qgc2NyZWVuc2hvdEJ1ZmZlciA9IGF3YWl0IHBhZ2Uuc2NyZWVuc2hvdCh7XG4gICAgICB0eXBlOiAncG5nJyxcbiAgICAgIGZ1bGxQYWdlOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgLy8gQ29udmVydCBVaW50OEFycmF5IHRvIEJ1ZmZlclxuICAgIGNvbnN0IGltYWdlQnVmZmVyID0gQnVmZmVyQ2xhc3MuZnJvbShzY3JlZW5zaG90QnVmZmVyKTtcblxuICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcblxuICAgIHJldHVybiBpbWFnZUJ1ZmZlcjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIFBERiBwcmV2aWV3OicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuLyoqXG4gKiBHZW5lcmF0ZSBhIFBERiBwcmV2aWV3IGltYWdlIGZyb20gSFRNTCBjb250ZW50IChDbGllbnQtc2lkZSBpbXBsZW1lbnRhdGlvbilcbiAqIEBwYXJhbSBodG1sIEhUTUwgY29udGVudCB0byBjb252ZXJ0IHRvIGltYWdlXG4gKiBAcmV0dXJucyBJbWFnZSBidWZmZXIgKFBORykgYXMgVWludDhBcnJheVxuICovXG5jb25zdCBnZW5lcmF0ZVBERlByZXZpZXdDbGllbnQgPSBhc3luYyAoaHRtbDogc3RyaW5nKTogUHJvbWlzZTxVaW50OEFycmF5PiA9PiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvZ2VuZXJhdGUtcGRmLXByZXZpZXcnLCB7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgaGVhZGVyczoge1xuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICB9LFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaHRtbCB9KSxcbiAgfSk7XG5cbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIFBERiBwcmV2aWV3Jyk7XG4gIH1cblxuICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGRhdGEpO1xufTtcblxuLyoqXG4gKiBHZW5lcmF0ZSBhIFBERiBwcmV2aWV3IGltYWdlIGZyb20gSFRNTCBjb250ZW50XG4gKiBAcGFyYW0gaHRtbCBIVE1MIGNvbnRlbnQgdG8gY29udmVydCB0byBpbWFnZVxuICogQHJldHVybnMgSW1hZ2UgYnVmZmVyIChQTkcpIChCdWZmZXIgb24gc2VydmVyLCBVaW50OEFycmF5IG9uIGNsaWVudClcbiAqL1xuZXhwb3J0IGNvbnN0IGdlbmVyYXRlUERGUHJldmlldyA9IGFzeW5jIChodG1sOiBzdHJpbmcpOiBQcm9taXNlPE5vZGVCdWZmZXIgfCBVaW50OEFycmF5PiA9PiB7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIFR5cGVTY3JpcHQgbmVlZHMgaGVscCB1bmRlcnN0YW5kaW5nIHRoYXQgdGhpcyBicmFuY2ggcmV0dXJucyBVaW50OEFycmF5XG4gICAgcmV0dXJuIGdlbmVyYXRlUERGUHJldmlld0NsaWVudChodG1sKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBUeXBlU2NyaXB0IG5lZWRzIGhlbHAgdW5kZXJzdGFuZGluZyB0aGF0IHRoaXMgYnJhbmNoIHJldHVybnMgQnVmZmVyXG4gICAgcmV0dXJuIGdlbmVyYXRlUERGUHJldmlld1NlcnZlcihodG1sKTtcbiAgfVxufTtcblxuXG4iXSwibmFtZXMiOlsicHVwcGV0ZWVyIiwiQnVmZmVyQ2xhc3MiLCJidWZmZXJNb2R1bGUiLCJyZXF1aXJlIiwiQnVmZmVyIiwiZ2VuZXJhdGVQREZTZXJ2ZXIiLCJodG1sIiwib3B0aW9ucyIsIkVycm9yIiwicHVwcGV0ZWVyTW9kdWxlIiwiYnJvd3NlciIsImxhdW5jaCIsImhlYWRsZXNzIiwiYXJncyIsInBhZ2UiLCJuZXdQYWdlIiwic2V0Q29udGVudCIsIndhaXRVbnRpbCIsInBkZkJ1ZmZlciIsInBkZiIsImZvcm1hdCIsImxhbmRzY2FwZSIsIm1hcmdpbiIsInRvcCIsImJvdHRvbSIsImxlZnQiLCJyaWdodCIsInByaW50QmFja2dyb3VuZCIsInNjYWxlIiwiaGVhZGVyVGVtcGxhdGUiLCJmb290ZXJUZW1wbGF0ZSIsImRpc3BsYXlIZWFkZXJGb290ZXIiLCJwYWdlUmFuZ2VzIiwiYnVmZmVyIiwiZnJvbSIsImNsb3NlIiwiZXJyb3IiLCJjb25zb2xlIiwiZ2VuZXJhdGVQREZDbGllbnQiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwib2siLCJkYXRhIiwiYXJyYXlCdWZmZXIiLCJVaW50OEFycmF5IiwiZ2VuZXJhdGVQREYiLCJnZW5lcmF0ZVBERlByZXZpZXdTZXJ2ZXIiLCJzZXRWaWV3cG9ydCIsIndpZHRoIiwiaGVpZ2h0IiwiZGV2aWNlU2NhbGVGYWN0b3IiLCJzY3JlZW5zaG90QnVmZmVyIiwic2NyZWVuc2hvdCIsInR5cGUiLCJmdWxsUGFnZSIsImltYWdlQnVmZmVyIiwiZ2VuZXJhdGVQREZQcmV2aWV3Q2xpZW50IiwiZ2VuZXJhdGVQREZQcmV2aWV3Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/utils/pdfGenerator.ts\n");

/***/ }),

/***/ "./src/utils/queryClient.ts":
/*!**********************************!*\
  !*** ./src/utils/queryClient.ts ***!
  \**********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   STALE_TIMES: () => (/* binding */ STALE_TIMES),\n/* harmony export */   createQueryClient: () => (/* binding */ createQueryClient),\n/* harmony export */   getQueryClient: () => (/* binding */ getQueryClient),\n/* harmony export */   queryClient: () => (/* binding */ queryClient)\n/* harmony export */ });\n/* harmony import */ var _tanstack_react_query__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @tanstack/react-query */ \"@tanstack/react-query\");\n/* harmony import */ var _tanstack_query_sync_storage_persister__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @tanstack/query-sync-storage-persister */ \"@tanstack/query-sync-storage-persister\");\n/* harmony import */ var _tanstack_react_query_persist_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @tanstack/react-query-persist-client */ \"@tanstack/react-query-persist-client\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_tanstack_react_query__WEBPACK_IMPORTED_MODULE_0__, _tanstack_query_sync_storage_persister__WEBPACK_IMPORTED_MODULE_1__, _tanstack_react_query_persist_client__WEBPACK_IMPORTED_MODULE_2__]);\n([_tanstack_react_query__WEBPACK_IMPORTED_MODULE_0__, _tanstack_query_sync_storage_persister__WEBPACK_IMPORTED_MODULE_1__, _tanstack_react_query_persist_client__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n// Define data type categories with appropriate stale times\nconst STALE_TIMES = {\n    // Static data that rarely changes\n    STATIC: 24 * 60 * 60 * 1000,\n    // Semi-static data that changes occasionally\n    SEMI_STATIC: 6 * 60 * 60 * 1000,\n    // Dynamic data that changes frequently\n    DYNAMIC: 5 * 60 * 1000,\n    // Real-time data that needs to be fresh\n    REAL_TIME: 30 * 1000\n};\nconst getQueryClient = ()=>new _tanstack_react_query__WEBPACK_IMPORTED_MODULE_0__.QueryClient({\n        defaultOptions: {\n            queries: {\n                staleTime: 1000 * 60 * 5,\n                refetchOnWindowFocus: false,\n                retry: 1\n            }\n        }\n    });\n// Export a singleton instance\nconst queryClient = getQueryClient();\n// Create a client with optimized default options\nconst createQueryClient = ()=>{\n    const queryClient = new _tanstack_react_query__WEBPACK_IMPORTED_MODULE_0__.QueryClient({\n        defaultOptions: {\n            queries: {\n                staleTime: STALE_TIMES.SEMI_STATIC,\n                // Set reasonable defaults for caching behavior\n                gcTime: 7 * 24 * 60 * 60 * 1000,\n                retry: 2,\n                retryDelay: (attemptIndex)=>Math.min(1000 * 2 ** attemptIndex, 30000)\n            }\n        }\n    });\n    // Only run in browser environment\n    if (false) {}\n    return queryClient;\n};\n// Export stale times for use in specific queries\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvcXVlcnlDbGllbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFtRDtBQUNpQztBQUVYO0FBRXpFLDJEQUEyRDtBQUMzRCxNQUFNRyxjQUFjO0lBQ2xCLGtDQUFrQztJQUNsQ0MsUUFBUSxLQUFLLEtBQUssS0FBSztJQUN2Qiw2Q0FBNkM7SUFDN0NDLGFBQWEsSUFBSSxLQUFLLEtBQUs7SUFDM0IsdUNBQXVDO0lBQ3ZDQyxTQUFTLElBQUksS0FBSztJQUNsQix3Q0FBd0M7SUFDeENDLFdBQVcsS0FBSztBQUNsQjtBQUVPLE1BQU1DLGlCQUFpQixJQUFNLElBQUlSLDhEQUFXQSxDQUFDO1FBQ2xEUyxnQkFBZ0I7WUFDZEMsU0FBUztnQkFDUEMsV0FBVyxPQUFPLEtBQUs7Z0JBQ3ZCQyxzQkFBc0I7Z0JBQ3RCQyxPQUFPO1lBQ1Q7UUFDRjtJQUNGLEdBQUc7QUFFSCw4QkFBOEI7QUFDdkIsTUFBTUMsY0FBY04saUJBQWlCO0FBRTVDLGlEQUFpRDtBQUMxQyxNQUFNTyxvQkFBb0I7SUFDL0IsTUFBTUQsY0FBYyxJQUFJZCw4REFBV0EsQ0FBQztRQUNsQ1MsZ0JBQWdCO1lBQ2RDLFNBQVM7Z0JBQ1BDLFdBQVdSLFlBQVlFLFdBQVc7Z0JBQ2xDLCtDQUErQztnQkFDL0NXLFFBQVEsSUFBSSxLQUFLLEtBQUssS0FBSztnQkFDM0JILE9BQU87Z0JBQ1BJLFlBQVlDLENBQUFBLGVBQWdCQyxLQUFLQyxHQUFHLENBQUMsT0FBTyxLQUFLRixjQUFjO1lBQ25FO1FBQ0Y7SUFDRjtJQUVFLGtDQUFrQztJQUNsQyxJQUFJLEtBQWtCLEVBQWEsRUFzQnBDO0lBRUMsT0FBT0o7QUFDVCxFQUFFO0FBRUYsaURBQWlEO0FBQzNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhaW5pbmctcGxhdGZvcm0vLi9zcmMvdXRpbHMvcXVlcnlDbGllbnQudHM/MDgzYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1F1ZXJ5Q2xpZW50IH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCB7IGNyZWF0ZVN5bmNTdG9yYWdlUGVyc2lzdGVyIH0gZnJvbSAnQHRhbnN0YWNrL3F1ZXJ5LXN5bmMtc3RvcmFnZS1wZXJzaXN0ZXInO1xuaW1wb3J0IHsgUGVyc2lzdGVkQ2xpZW50IH0gZnJvbSAnQHRhbnN0YWNrL3F1ZXJ5LXBlcnNpc3QtY2xpZW50LWNvcmUnO1xuaW1wb3J0IHtwZXJzaXN0UXVlcnlDbGllbnQgfSBmcm9tICdAdGFuc3RhY2svcmVhY3QtcXVlcnktcGVyc2lzdC1jbGllbnQnO1xuXG4vLyBEZWZpbmUgZGF0YSB0eXBlIGNhdGVnb3JpZXMgd2l0aCBhcHByb3ByaWF0ZSBzdGFsZSB0aW1lc1xuY29uc3QgU1RBTEVfVElNRVMgPSB7XG4gIC8vIFN0YXRpYyBkYXRhIHRoYXQgcmFyZWx5IGNoYW5nZXNcbiAgU1RBVElDOiAyNCAqIDYwICogNjAgKiAxMDAwLCAvLyAyNCBob3Vyc1xuICAvLyBTZW1pLXN0YXRpYyBkYXRhIHRoYXQgY2hhbmdlcyBvY2Nhc2lvbmFsbHlcbiAgU0VNSV9TVEFUSUM6IDYgKiA2MCAqIDYwICogMTAwMCwgLy8gNiBob3Vyc1xuICAvLyBEeW5hbWljIGRhdGEgdGhhdCBjaGFuZ2VzIGZyZXF1ZW50bHlcbiAgRFlOQU1JQzogNSAqIDYwICogMTAwMCwgLy8gNSBtaW51dGVzXG4gIC8vIFJlYWwtdGltZSBkYXRhIHRoYXQgbmVlZHMgdG8gYmUgZnJlc2hcbiAgUkVBTF9USU1FOiAzMCAqIDEwMDAsIC8vIDMwIHNlY29uZHNcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRRdWVyeUNsaWVudCA9ICgpID0+IG5ldyBRdWVyeUNsaWVudCh7XG4gIGRlZmF1bHRPcHRpb25zOiB7XG4gICAgcXVlcmllczoge1xuICAgICAgc3RhbGVUaW1lOiAxMDAwICogNjAgKiA1LCAvLyA1IG1pbnV0ZXNcbiAgICAgIHJlZmV0Y2hPbldpbmRvd0ZvY3VzOiBmYWxzZSxcbiAgICAgIHJldHJ5OiAxLFxuICAgIH0sXG4gIH0sXG59KTtcblxuLy8gRXhwb3J0IGEgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgcXVlcnlDbGllbnQgPSBnZXRRdWVyeUNsaWVudCgpO1xuXG4vLyBDcmVhdGUgYSBjbGllbnQgd2l0aCBvcHRpbWl6ZWQgZGVmYXVsdCBvcHRpb25zXG5leHBvcnQgY29uc3QgY3JlYXRlUXVlcnlDbGllbnQgPSAoKSA9PiB7XG4gIGNvbnN0IHF1ZXJ5Q2xpZW50ID0gbmV3IFF1ZXJ5Q2xpZW50KHtcbiAgICBkZWZhdWx0T3B0aW9uczoge1xuICAgICAgcXVlcmllczoge1xuICAgICAgICBzdGFsZVRpbWU6IFNUQUxFX1RJTUVTLlNFTUlfU1RBVElDLCAvLyBEZWZhdWx0IHRvIDYgaG91cnMgZm9yIG1vc3QgZGF0YVxuICAgICAgICAvLyBTZXQgcmVhc29uYWJsZSBkZWZhdWx0cyBmb3IgY2FjaGluZyBiZWhhdmlvclxuICAgICAgICBnY1RpbWU6IDcgKiAyNCAqIDYwICogNjAgKiAxMDAwLCAvLyA3IGRheXMgLSBob3cgbG9uZyB0byBrZWVwIHVudXNlZCBkYXRhIGluIGNhY2hlXG4gICAgICAgIHJldHJ5OiAyLCAvLyBSZXRyeSBmYWlsZWQgcXVlcmllcyB0d2ljZVxuICAgICAgICByZXRyeURlbGF5OiBhdHRlbXB0SW5kZXggPT4gTWF0aC5taW4oMTAwMCAqIDIgKiogYXR0ZW1wdEluZGV4LCAzMDAwMCksIC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICB9LFxuICB9LFxufSk7XG5cbiAgLy8gT25seSBydW4gaW4gYnJvd3NlciBlbnZpcm9ubWVudFxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB0cnkge1xuICAgICAgLy8gQ3JlYXRlIGEgcGVyc2lzdGVyIGZvciB0aGUgcXVlcnkgY2FjaGUgdXNpbmcgbG9jYWxTdG9yYWdlXG4gICAgICBjb25zdCBsb2NhbFN0b3JhZ2VQZXJzaXN0ZXIgPSBjcmVhdGVTeW5jU3RvcmFnZVBlcnNpc3Rlcih7XG4gICAgICAgIHN0b3JhZ2U6IHdpbmRvdy5sb2NhbFN0b3JhZ2UsXG4gICAgICAgIGtleTogJ1RSQUlOSU5HX1BMQVRGT1JNX1FVRVJZX0NBQ0hFJywgLy8gQ3VzdG9tIGtleSBmb3IgbG9jYWxTdG9yYWdlXG4gICAgICAgIHRocm90dGxlVGltZTogMTAwMCwgLy8gVGhyb3R0bGUgd3JpdGVzIHRvIHN0b3JhZ2UgdG8gcHJldmVudCBleGNlc3NpdmUgd3JpdGVzXG4gICAgICAgIHNlcmlhbGl6ZTogKGNsaWVudDogUGVyc2lzdGVkQ2xpZW50KSA9PiBKU09OLnN0cmluZ2lmeShjbGllbnQpLFxuICAgICAgICBkZXNlcmlhbGl6ZTogKGRhdGE6IHN0cmluZyk6IFBlcnNpc3RlZENsaWVudCA9PiBKU09OLnBhcnNlKGRhdGEpIGFzIFBlcnNpc3RlZENsaWVudCxcbiAgICB9KTtcblxuICAgICAgLy8gUGVyc2lzdCB0aGUgUmVhY3QgUXVlcnkgY2FjaGUgdG8gbG9jYWxTdG9yYWdlXG4gICAgICB2b2lkIHBlcnNpc3RRdWVyeUNsaWVudCh7XG4gICAgICAgIHF1ZXJ5Q2xpZW50LFxuICAgICAgICBwZXJzaXN0ZXI6IGxvY2FsU3RvcmFnZVBlcnNpc3RlcixcbiAgICAgICAgbWF4QWdlOiAyNCAqIDYwICogNjAgKiAxMDAwLCAvLyAyNCBob3VycyAtIGhvdyBsb25nIHRvIHBlcnNpc3QgY2FjaGVcbiAgICAgICAgYnVzdGVyOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUFBfVkVSU0lPTiB8fCAnMS4wLjAnLCAvLyBDYWNoZSBidXN0ZXIgb24gYXBwIHVwZGF0ZXNcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIExvZyBhbnkgZXJyb3JzIGJ1dCBkb24ndCBicmVhayB0aGUgYXBwbGljYXRpb25cbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNldHRpbmcgdXAgUmVhY3QgUXVlcnkgcGVyc2lzdGVuY2U6JywgZXJyb3IpO1xuICB9XG59XG5cbiAgcmV0dXJuIHF1ZXJ5Q2xpZW50O1xufTtcblxuLy8gRXhwb3J0IHN0YWxlIHRpbWVzIGZvciB1c2UgaW4gc3BlY2lmaWMgcXVlcmllc1xuZXhwb3J0IHtTVEFMRV9USU1FUyB9O1xuIl0sIm5hbWVzIjpbIlF1ZXJ5Q2xpZW50IiwiY3JlYXRlU3luY1N0b3JhZ2VQZXJzaXN0ZXIiLCJwZXJzaXN0UXVlcnlDbGllbnQiLCJTVEFMRV9USU1FUyIsIlNUQVRJQyIsIlNFTUlfU1RBVElDIiwiRFlOQU1JQyIsIlJFQUxfVElNRSIsImdldFF1ZXJ5Q2xpZW50IiwiZGVmYXVsdE9wdGlvbnMiLCJxdWVyaWVzIiwic3RhbGVUaW1lIiwicmVmZXRjaE9uV2luZG93Rm9jdXMiLCJyZXRyeSIsInF1ZXJ5Q2xpZW50IiwiY3JlYXRlUXVlcnlDbGllbnQiLCJnY1RpbWUiLCJyZXRyeURlbGF5IiwiYXR0ZW1wdEluZGV4IiwiTWF0aCIsIm1pbiIsImxvY2FsU3RvcmFnZVBlcnNpc3RlciIsInN0b3JhZ2UiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJrZXkiLCJ0aHJvdHRsZVRpbWUiLCJzZXJpYWxpemUiLCJjbGllbnQiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVzZXJpYWxpemUiLCJkYXRhIiwicGFyc2UiLCJwZXJzaXN0ZXIiLCJtYXhBZ2UiLCJidXN0ZXIiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQVBQX1ZFUlNJT04iLCJlcnJvciIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/queryClient.ts\n");

/***/ }),

/***/ "./src/styles/globals.css":
/*!********************************!*\
  !*** ./src/styles/globals.css ***!
  \********************************/
/***/ (() => {



/***/ }),

/***/ "next/dist/compiled/next-server/pages.runtime.dev.js":
/*!**********************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages.runtime.dev.js" ***!
  \**********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/pages.runtime.dev.js");

/***/ }),

/***/ "qrcode":
/*!*************************!*\
  !*** external "qrcode" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("qrcode");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("react");

/***/ }),

/***/ "react/jsx-dev-runtime":
/*!****************************************!*\
  !*** external "react/jsx-dev-runtime" ***!
  \****************************************/
/***/ ((module) => {

"use strict";
module.exports = require("react/jsx-dev-runtime");

/***/ }),

/***/ "react/jsx-runtime":
/*!************************************!*\
  !*** external "react/jsx-runtime" ***!
  \************************************/
/***/ ((module) => {

"use strict";
module.exports = require("react/jsx-runtime");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "@emotion/cache":
/*!*********************************!*\
  !*** external "@emotion/cache" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = import("@emotion/cache");;

/***/ }),

/***/ "@emotion/react":
/*!*********************************!*\
  !*** external "@emotion/react" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = import("@emotion/react");;

/***/ }),

/***/ "@emotion/server/create-instance":
/*!**************************************************!*\
  !*** external "@emotion/server/create-instance" ***!
  \**************************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@emotion/server/create-instance");;

/***/ }),

/***/ "@mui/material/CssBaseline":
/*!********************************************!*\
  !*** external "@mui/material/CssBaseline" ***!
  \********************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@mui/material/CssBaseline");;

/***/ }),

/***/ "@mui/material/styles":
/*!***************************************!*\
  !*** external "@mui/material/styles" ***!
  \***************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@mui/material/styles");;

/***/ }),

/***/ "@tanstack/query-sync-storage-persister":
/*!*********************************************************!*\
  !*** external "@tanstack/query-sync-storage-persister" ***!
  \*********************************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@tanstack/query-sync-storage-persister");;

/***/ }),

/***/ "@tanstack/react-query":
/*!****************************************!*\
  !*** external "@tanstack/react-query" ***!
  \****************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@tanstack/react-query");;

/***/ }),

/***/ "@tanstack/react-query-devtools":
/*!*************************************************!*\
  !*** external "@tanstack/react-query-devtools" ***!
  \*************************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@tanstack/react-query-devtools");;

/***/ }),

/***/ "@tanstack/react-query-persist-client":
/*!*******************************************************!*\
  !*** external "@tanstack/react-query-persist-client" ***!
  \*******************************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@tanstack/react-query-persist-client");;

/***/ }),

/***/ "firebase/app":
/*!*******************************!*\
  !*** external "firebase/app" ***!
  \*******************************/
/***/ ((module) => {

"use strict";
module.exports = import("firebase/app");;

/***/ }),

/***/ "firebase/auth":
/*!********************************!*\
  !*** external "firebase/auth" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = import("firebase/auth");;

/***/ }),

/***/ "firebase/firestore":
/*!*************************************!*\
  !*** external "firebase/firestore" ***!
  \*************************************/
/***/ ((module) => {

"use strict";
module.exports = import("firebase/firestore");;

/***/ }),

/***/ "firebase/storage":
/*!***********************************!*\
  !*** external "firebase/storage" ***!
  \***********************************/
/***/ ((module) => {

"use strict";
module.exports = import("firebase/storage");;

/***/ }),

/***/ "puppeteer":
/*!****************************!*\
  !*** external "puppeteer" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = import("puppeteer");;

/***/ }),

/***/ "react-hot-toast":
/*!**********************************!*\
  !*** external "react-hot-toast" ***!
  \**********************************/
/***/ ((module) => {

"use strict";
module.exports = import("react-hot-toast");;

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = import("uuid");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@swc"], () => (__webpack_exec__("./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F_error&preferredRegion=&absolutePagePath=private-next-pages%2F_error&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();